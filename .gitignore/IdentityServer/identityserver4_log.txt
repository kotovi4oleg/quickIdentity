2019-08-05 13:10:35.929 +03:00 [INF] Starting IdentityServer4 version 2.5.0.0
2019-08-05 13:10:36.044 +03:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2019-08-05 13:10:36.064 +03:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2019-08-05 13:10:36.065 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for authentication
2019-08-05 13:10:36.066 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-in
2019-08-05 13:10:36.066 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-out
2019-08-05 13:10:36.067 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for challenge
2019-08-05 13:10:36.067 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for forbid
2019-08-05 13:10:56.280 +03:00 [DBG] Login Url: /Account/Login
2019-08-05 13:10:56.285 +03:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-08-05 13:10:56.286 +03:00 [DBG] Logout Url: /Account/Logout
2019-08-05 13:10:56.286 +03:00 [DBG] ConsentUrl Url: /consent
2019-08-05 13:10:56.286 +03:00 [DBG] Consent Return Url Parameter: returnUrl
2019-08-05 13:10:56.287 +03:00 [DBG] Error Url: /home/error
2019-08-05 13:10:56.287 +03:00 [DBG] Error Id Parameter: errorId
2019-08-05 13:10:57.778 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-05 13:10:57.787 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-05 13:10:57.789 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-05 13:10:57.799 +03:00 [DBG] Start discovery request
2019-08-05 13:18:25.766 +03:00 [INF] Starting IdentityServer4 version 2.5.0.0
2019-08-05 13:18:25.850 +03:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2019-08-05 13:18:25.864 +03:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2019-08-05 13:18:25.865 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for authentication
2019-08-05 13:18:25.865 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-in
2019-08-05 13:18:25.866 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-out
2019-08-05 13:18:25.866 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for challenge
2019-08-05 13:18:25.866 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for forbid
2019-08-05 13:19:37.494 +03:00 [DBG] Login Url: /Account/Login
2019-08-05 13:19:37.497 +03:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-08-05 13:19:37.498 +03:00 [DBG] Logout Url: /Account/Logout
2019-08-05 13:19:37.499 +03:00 [DBG] ConsentUrl Url: /consent
2019-08-05 13:19:37.499 +03:00 [DBG] Consent Return Url Parameter: returnUrl
2019-08-05 13:19:37.500 +03:00 [DBG] Error Url: /home/error
2019-08-05 13:19:37.500 +03:00 [DBG] Error Id Parameter: errorId
2019-08-05 13:19:37.555 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-05 13:19:37.562 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-05 13:19:37.564 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-05 13:19:37.576 +03:00 [DBG] Start discovery request
2019-08-05 13:19:41.331 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-05 13:19:41.346 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-05 13:19:41.355 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-05 13:19:41.365 +03:00 [DBG] Start key discovery request
2019-08-05 13:19:52.750 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-05 13:19:52.767 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-05 13:19:52.769 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-05 13:19:52.789 +03:00 [DBG] Start token request.
2019-08-05 13:19:52.798 +03:00 [DBG] Start client validation
2019-08-05 13:19:52.807 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-05 13:19:52.812 +03:00 [DBG] Start parsing for secret in post body
2019-08-05 13:19:52.846 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-05 13:19:52.847 +03:00 [DBG] Secret id found: client
2019-08-05 13:19:52.870 +03:00 [DBG] client configuration validation for client client succeeded.
2019-08-05 13:19:52.886 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-05 13:19:52.886 +03:00 [DBG] Client validation success
2019-08-05 13:19:52.910 +03:00 [DBG] Start token request validation
2019-08-05 13:19:52.922 +03:00 [DBG] Start client credentials token request validation
2019-08-05 13:19:52.946 +03:00 [ERR] Requested scope not allowed: api1
2019-08-05 13:19:52.969 +03:00 [ERR] {"ClientId":"client","ClientName":null,"GrantType":"client_credentials","Scopes":null,"AuthorizationCode":null,"RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"client_credentials","scope":"api1","client_id":"client","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2019-08-05 13:21:46.033 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-05 13:21:46.037 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-05 13:21:46.044 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-05 13:21:46.048 +03:00 [DBG] Start discovery request
2019-08-05 13:21:46.198 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-05 13:21:46.202 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-05 13:21:46.206 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-05 13:21:46.209 +03:00 [DBG] Start key discovery request
2019-08-05 13:21:53.617 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-05 13:21:53.623 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-05 13:21:53.627 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-05 13:21:53.633 +03:00 [DBG] Start token request.
2019-08-05 13:21:53.635 +03:00 [DBG] Start client validation
2019-08-05 13:21:53.637 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-05 13:21:53.639 +03:00 [DBG] Start parsing for secret in post body
2019-08-05 13:21:53.643 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-05 13:21:53.646 +03:00 [DBG] Secret id found: client
2019-08-05 13:21:53.647 +03:00 [DBG] client configuration validation for client client succeeded.
2019-08-05 13:21:53.658 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-05 13:21:53.659 +03:00 [DBG] Client validation success
2019-08-05 13:21:53.661 +03:00 [DBG] Start token request validation
2019-08-05 13:21:53.662 +03:00 [DBG] Start client credentials token request validation
2019-08-05 13:21:53.664 +03:00 [ERR] Requested scope not allowed: api1
2019-08-05 13:21:53.666 +03:00 [ERR] {"ClientId":"client","ClientName":null,"GrantType":"client_credentials","Scopes":null,"AuthorizationCode":null,"RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"client_credentials","scope":"api1","client_id":"client","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2019-08-05 13:22:39.070 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-05 13:22:39.074 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-05 13:22:39.080 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-05 13:22:39.085 +03:00 [DBG] Start discovery request
2019-08-05 13:22:39.219 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-05 13:22:39.222 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-05 13:22:39.226 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-05 13:22:39.228 +03:00 [DBG] Start key discovery request
2019-08-05 13:22:40.330 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-05 13:22:40.335 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-05 13:22:40.338 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-05 13:22:40.340 +03:00 [DBG] Start token request.
2019-08-05 13:22:40.341 +03:00 [DBG] Start client validation
2019-08-05 13:22:40.347 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-05 13:22:40.349 +03:00 [DBG] Start parsing for secret in post body
2019-08-05 13:22:40.353 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-05 13:22:40.353 +03:00 [DBG] Secret id found: client
2019-08-05 13:22:40.355 +03:00 [DBG] client configuration validation for client client succeeded.
2019-08-05 13:22:40.362 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-05 13:22:40.363 +03:00 [DBG] Client validation success
2019-08-05 13:22:40.365 +03:00 [DBG] Start token request validation
2019-08-05 13:22:40.366 +03:00 [DBG] Start client credentials token request validation
2019-08-05 13:22:40.368 +03:00 [ERR] Requested scope not allowed: api1
2019-08-05 13:22:40.368 +03:00 [ERR] {"ClientId":"client","ClientName":null,"GrantType":"client_credentials","Scopes":null,"AuthorizationCode":null,"RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"client_credentials","scope":"api1","client_id":"client","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2019-08-05 13:23:51.609 +03:00 [INF] Starting IdentityServer4 version 2.5.0.0
2019-08-05 13:23:51.682 +03:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2019-08-05 13:23:51.696 +03:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2019-08-05 13:23:51.697 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for authentication
2019-08-05 13:23:51.697 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-in
2019-08-05 13:23:51.697 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-out
2019-08-05 13:23:51.698 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for challenge
2019-08-05 13:23:51.699 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for forbid
2019-08-05 13:24:17.101 +03:00 [DBG] Login Url: /Account/Login
2019-08-05 13:24:17.104 +03:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-08-05 13:24:17.105 +03:00 [DBG] Logout Url: /Account/Logout
2019-08-05 13:24:17.105 +03:00 [DBG] ConsentUrl Url: /consent
2019-08-05 13:24:17.106 +03:00 [DBG] Consent Return Url Parameter: returnUrl
2019-08-05 13:24:17.107 +03:00 [DBG] Error Url: /home/error
2019-08-05 13:24:17.107 +03:00 [DBG] Error Id Parameter: errorId
2019-08-05 13:24:17.174 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-05 13:24:17.187 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-05 13:24:17.189 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-05 13:24:17.202 +03:00 [DBG] Start discovery request
2019-08-05 13:24:17.444 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-05 13:24:17.455 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-05 13:24:17.457 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-05 13:24:17.468 +03:00 [DBG] Start key discovery request
2019-08-05 13:24:18.856 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-05 13:24:18.874 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-05 13:24:18.876 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-05 13:24:18.890 +03:00 [DBG] Start token request.
2019-08-05 13:24:18.905 +03:00 [DBG] Start client validation
2019-08-05 13:24:18.921 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-05 13:24:18.930 +03:00 [DBG] Start parsing for secret in post body
2019-08-05 13:24:18.958 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-05 13:24:18.958 +03:00 [DBG] Secret id found: client
2019-08-05 13:24:18.982 +03:00 [DBG] client configuration validation for client client succeeded.
2019-08-05 13:24:18.998 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-05 13:24:18.999 +03:00 [DBG] Client validation success
2019-08-05 13:24:19.016 +03:00 [DBG] Start token request validation
2019-08-05 13:24:19.033 +03:00 [DBG] Start client credentials token request validation
2019-08-05 13:24:19.077 +03:00 [DBG] client credentials token request validation success
2019-08-05 13:24:19.096 +03:00 [INF] Token request validation success, {"ClientId":"client","ClientName":null,"GrantType":"client_credentials","Scopes":"afcpayroll","AuthorizationCode":null,"RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"client_credentials","scope":"afcpayroll","client_id":"client","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2019-08-05 13:24:19.165 +03:00 [DBG] Getting claims for access token for client: client
2019-08-05 13:24:19.287 +03:00 [DBG] Token request success.
2019-08-05 13:24:56.747 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-05 13:24:56.751 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-05 13:24:56.761 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-05 13:24:56.766 +03:00 [DBG] Start discovery request
2019-08-05 13:24:56.895 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-05 13:24:56.901 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-05 13:24:56.903 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-05 13:24:56.905 +03:00 [DBG] Start key discovery request
2019-08-05 13:37:55.969 +03:00 [INF] Starting IdentityServer4 version 2.5.0.0
2019-08-05 13:37:56.043 +03:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2019-08-05 13:37:56.056 +03:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2019-08-05 13:37:56.057 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for authentication
2019-08-05 13:37:56.057 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-in
2019-08-05 13:37:56.057 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-out
2019-08-05 13:37:56.058 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for challenge
2019-08-05 13:37:56.058 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for forbid
2019-08-05 13:38:01.123 +03:00 [DBG] Login Url: /Account/Login
2019-08-05 13:38:01.127 +03:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-08-05 13:38:01.128 +03:00 [DBG] Logout Url: /Account/Logout
2019-08-05 13:38:01.128 +03:00 [DBG] ConsentUrl Url: /consent
2019-08-05 13:38:01.129 +03:00 [DBG] Consent Return Url Parameter: returnUrl
2019-08-05 13:38:01.129 +03:00 [DBG] Error Url: /home/error
2019-08-05 13:38:01.129 +03:00 [DBG] Error Id Parameter: errorId
2019-08-05 13:38:01.192 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-05 13:38:01.213 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-05 13:38:01.214 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-05 13:38:01.230 +03:00 [DBG] Start discovery request
2019-08-05 13:38:06.070 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-05 13:38:06.074 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-05 13:38:06.078 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-05 13:38:06.089 +03:00 [DBG] Start key discovery request
2019-08-05 13:38:06.496 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-05 13:38:06.510 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-05 13:38:06.511 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-05 13:38:06.527 +03:00 [DBG] Start token request.
2019-08-05 13:38:06.537 +03:00 [DBG] Start client validation
2019-08-05 13:38:06.547 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-05 13:38:06.552 +03:00 [DBG] Start parsing for secret in post body
2019-08-05 13:38:06.582 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-05 13:38:06.582 +03:00 [DBG] Secret id found: client
2019-08-05 13:38:06.618 +03:00 [DBG] client configuration validation for client client succeeded.
2019-08-05 13:38:06.632 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-05 13:38:06.633 +03:00 [DBG] Client validation success
2019-08-05 13:38:06.651 +03:00 [DBG] Start token request validation
2019-08-05 13:38:06.665 +03:00 [DBG] Start client credentials token request validation
2019-08-05 13:38:36.242 +03:00 [DBG] client credentials token request validation success
2019-08-05 13:38:36.262 +03:00 [INF] Token request validation success, {"ClientId":"client","ClientName":null,"GrantType":"client_credentials","Scopes":"afcpayroll","AuthorizationCode":null,"RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"client_credentials","scope":"afcpayroll","client_id":"client","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2019-08-05 13:38:36.330 +03:00 [DBG] Getting claims for access token for client: client
2019-08-05 13:38:36.448 +03:00 [DBG] Token request success.
2019-08-05 13:38:51.789 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-05 13:38:51.793 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-05 13:38:51.799 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-05 13:38:51.800 +03:00 [DBG] Start discovery request
2019-08-05 13:38:59.326 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-05 13:38:59.330 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-05 13:38:59.334 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-05 13:38:59.336 +03:00 [DBG] Start key discovery request
2019-08-05 13:38:59.739 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-05 13:38:59.743 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-05 13:38:59.747 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-05 13:38:59.754 +03:00 [DBG] Start token request.
2019-08-05 13:38:59.756 +03:00 [DBG] Start client validation
2019-08-05 13:38:59.757 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-05 13:38:59.760 +03:00 [DBG] Start parsing for secret in post body
2019-08-05 13:38:59.763 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-05 13:38:59.763 +03:00 [DBG] Secret id found: client
2019-08-05 13:38:59.764 +03:00 [DBG] client configuration validation for client client succeeded.
2019-08-05 13:38:59.773 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-05 13:38:59.774 +03:00 [DBG] Client validation success
2019-08-05 13:38:59.775 +03:00 [DBG] Start token request validation
2019-08-05 13:38:59.776 +03:00 [DBG] Start client credentials token request validation
2019-08-05 13:39:02.881 +03:00 [DBG] client credentials token request validation success
2019-08-05 13:39:02.882 +03:00 [INF] Token request validation success, {"ClientId":"client","ClientName":null,"GrantType":"client_credentials","Scopes":"afcpayroll","AuthorizationCode":null,"RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"client_credentials","scope":"afcpayroll","client_id":"client","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2019-08-05 13:39:02.899 +03:00 [DBG] Getting claims for access token for client: client
2019-08-05 13:39:02.905 +03:00 [DBG] Token request success.
2019-08-05 13:45:38.718 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-05 13:45:38.722 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-05 13:45:38.726 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-05 13:45:38.728 +03:00 [DBG] Start discovery request
2019-08-05 13:45:39.934 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-05 13:45:39.937 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-05 13:45:39.941 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-05 13:45:39.943 +03:00 [DBG] Start key discovery request
2019-08-05 13:45:42.166 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-05 13:45:42.183 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-05 13:45:42.186 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-05 13:45:42.188 +03:00 [DBG] Start token request.
2019-08-05 13:45:42.192 +03:00 [DBG] Start client validation
2019-08-05 13:45:42.195 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-05 13:45:42.196 +03:00 [DBG] Start parsing for secret in post body
2019-08-05 13:45:42.198 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-05 13:45:42.198 +03:00 [DBG] Secret id found: ro.client
2019-08-05 13:45:42.201 +03:00 [DBG] client configuration validation for client ro.client succeeded.
2019-08-05 13:45:42.211 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-05 13:45:42.212 +03:00 [DBG] Client validation success
2019-08-05 13:45:42.213 +03:00 [DBG] Start token request validation
2019-08-05 13:45:42.225 +03:00 [DBG] Start resource owner password token request validation
2019-08-05 13:45:49.090 +03:00 [INF] Resource owner password credential type not supported. Configure an IResourceOwnerPasswordValidator.
2019-08-05 13:45:49.094 +03:00 [ERR] Resource owner password credential grant type not supported, {"ClientId":"ro.client","ClientName":null,"GrantType":"password","Scopes":"afcpayroll","AuthorizationCode":null,"RefreshToken":null,"UserName":"alice","AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"password","username":"alice","password":"***REDACTED***","scope":"afcpayroll","client_id":"ro.client","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2019-08-05 13:46:32.939 +03:00 [INF] Starting IdentityServer4 version 2.5.0.0
2019-08-05 13:46:33.002 +03:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2019-08-05 13:46:33.015 +03:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2019-08-05 13:46:33.016 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for authentication
2019-08-05 13:46:33.016 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-in
2019-08-05 13:46:33.017 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-out
2019-08-05 13:46:33.017 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for challenge
2019-08-05 13:46:33.017 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for forbid
2019-08-05 13:46:51.449 +03:00 [DBG] Login Url: /Account/Login
2019-08-05 13:46:51.455 +03:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-08-05 13:46:51.456 +03:00 [DBG] Logout Url: /Account/Logout
2019-08-05 13:46:51.456 +03:00 [DBG] ConsentUrl Url: /consent
2019-08-05 13:46:51.456 +03:00 [DBG] Consent Return Url Parameter: returnUrl
2019-08-05 13:46:51.457 +03:00 [DBG] Error Url: /home/error
2019-08-05 13:46:51.457 +03:00 [DBG] Error Id Parameter: errorId
2019-08-05 13:46:51.519 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-05 13:46:51.528 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-05 13:46:51.536 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-05 13:46:51.547 +03:00 [DBG] Start discovery request
2019-08-05 13:46:51.949 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-05 13:46:51.981 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-05 13:46:51.989 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-05 13:46:52.001 +03:00 [DBG] Start key discovery request
2019-08-05 13:46:58.438 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-05 13:46:58.455 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-05 13:46:58.457 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-05 13:46:58.477 +03:00 [DBG] Start token request.
2019-08-05 13:46:58.491 +03:00 [DBG] Start client validation
2019-08-05 13:46:58.502 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-05 13:46:58.508 +03:00 [DBG] Start parsing for secret in post body
2019-08-05 13:46:58.543 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-05 13:46:58.544 +03:00 [DBG] Secret id found: ro.client
2019-08-05 13:46:58.583 +03:00 [DBG] client configuration validation for client ro.client succeeded.
2019-08-05 13:46:58.601 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-05 13:46:58.601 +03:00 [DBG] Client validation success
2019-08-05 13:46:58.621 +03:00 [DBG] Start token request validation
2019-08-05 13:46:58.642 +03:00 [DBG] Start resource owner password token request validation
2019-08-05 13:46:58.686 +03:00 [INF] Resource owner password credential type not supported. Configure an IResourceOwnerPasswordValidator.
2019-08-05 13:46:58.730 +03:00 [ERR] Resource owner password credential grant type not supported, {"ClientId":"ro.client","ClientName":null,"GrantType":"password","Scopes":"afcpayroll","AuthorizationCode":null,"RefreshToken":null,"UserName":"alice","AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"password","username":"alice","password":"***REDACTED***","scope":"afcpayroll","client_id":"ro.client","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2019-08-05 13:49:44.188 +03:00 [INF] Starting IdentityServer4 version 2.5.0.0
2019-08-05 13:49:44.265 +03:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2019-08-05 13:49:44.279 +03:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2019-08-05 13:49:44.279 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for authentication
2019-08-05 13:49:44.279 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-in
2019-08-05 13:49:44.280 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-out
2019-08-05 13:49:44.280 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for challenge
2019-08-05 13:49:44.280 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for forbid
2019-08-05 13:49:52.511 +03:00 [DBG] Login Url: /Account/Login
2019-08-05 13:49:52.514 +03:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-08-05 13:49:52.515 +03:00 [DBG] Logout Url: /Account/Logout
2019-08-05 13:49:52.516 +03:00 [DBG] ConsentUrl Url: /consent
2019-08-05 13:49:52.516 +03:00 [DBG] Consent Return Url Parameter: returnUrl
2019-08-05 13:49:52.516 +03:00 [DBG] Error Url: /home/error
2019-08-05 13:49:52.517 +03:00 [DBG] Error Id Parameter: errorId
2019-08-05 13:49:52.573 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-05 13:49:52.582 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-05 13:49:52.584 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-05 13:49:52.594 +03:00 [DBG] Start discovery request
2019-08-05 13:49:52.853 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-05 13:49:52.861 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-05 13:49:52.863 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-05 13:49:52.870 +03:00 [DBG] Start key discovery request
2019-08-05 13:50:10.409 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-05 13:50:10.426 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-05 13:50:10.428 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-05 13:50:10.447 +03:00 [DBG] Start token request.
2019-08-05 13:50:10.456 +03:00 [DBG] Start client validation
2019-08-05 13:50:10.466 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-05 13:50:10.471 +03:00 [DBG] Start parsing for secret in post body
2019-08-05 13:50:10.499 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-05 13:50:10.500 +03:00 [DBG] Secret id found: ro.client
2019-08-05 13:50:10.537 +03:00 [DBG] client configuration validation for client ro.client succeeded.
2019-08-05 13:50:10.558 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-05 13:50:10.559 +03:00 [DBG] Client validation success
2019-08-05 13:50:10.578 +03:00 [DBG] Start token request validation
2019-08-05 13:50:10.597 +03:00 [DBG] Start resource owner password token request validation
2019-08-05 13:51:36.943 +03:00 [FTL] Unhandled exception: The method or operation is not implemented.
System.NotImplementedException: The method or operation is not implemented.
   at IdentityServer.Stores.ProfileService.IsActiveAsync(IsActiveContext context) in E:\GIT\Identity\src\IdentityServer\Stores\ProfileService.cs:line 14
   at IdentityServer4.Validation.TokenRequestValidator.ValidateResourceOwnerCredentialRequestAsync(NameValueCollection parameters) in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\src\Validation\Default\TokenRequestValidator.cs:line 455
   at IdentityServer4.Validation.TokenRequestValidator.RunValidationAsync(Func`2 validationFunc, NameValueCollection parameters) in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\src\Validation\Default\TokenRequestValidator.cs:line 151
   at IdentityServer4.Validation.TokenRequestValidator.ValidateRequestAsync(NameValueCollection parameters, ClientSecretValidationResult clientValidationResult) in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\src\Validation\Default\TokenRequestValidator.cs:line 138
   at IdentityServer4.Endpoints.TokenEndpoint.ProcessTokenRequestAsync(HttpContext context) in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\src\Endpoints\TokenEndpoint.cs:line 88
   at IdentityServer4.Endpoints.TokenEndpoint.ProcessAsync(HttpContext context) in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\src\Endpoints\TokenEndpoint.cs:line 70
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events) in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\src\Hosting\IdentityServerMiddleware.cs:line 54
2019-08-05 13:51:37.172 +03:00 [ERR] An unhandled exception has occurred while executing the request.
System.NotImplementedException: The method or operation is not implemented.
   at IdentityServer.Stores.ProfileService.IsActiveAsync(IsActiveContext context) in E:\GIT\Identity\src\IdentityServer\Stores\ProfileService.cs:line 14
   at IdentityServer4.Validation.TokenRequestValidator.ValidateResourceOwnerCredentialRequestAsync(NameValueCollection parameters) in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\src\Validation\Default\TokenRequestValidator.cs:line 455
   at IdentityServer4.Validation.TokenRequestValidator.RunValidationAsync(Func`2 validationFunc, NameValueCollection parameters) in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\src\Validation\Default\TokenRequestValidator.cs:line 151
   at IdentityServer4.Validation.TokenRequestValidator.ValidateRequestAsync(NameValueCollection parameters, ClientSecretValidationResult clientValidationResult) in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\src\Validation\Default\TokenRequestValidator.cs:line 138
   at IdentityServer4.Endpoints.TokenEndpoint.ProcessTokenRequestAsync(HttpContext context) in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\src\Endpoints\TokenEndpoint.cs:line 88
   at IdentityServer4.Endpoints.TokenEndpoint.ProcessAsync(HttpContext context) in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\src\Endpoints\TokenEndpoint.cs:line 70
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events) in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\src\Hosting\IdentityServerMiddleware.cs:line 54
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events) in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\src\Hosting\IdentityServerMiddleware.cs:line 69
   at IdentityServer4.Hosting.MutualTlsTokenEndpointMiddleware.Invoke(HttpContext context, IAuthenticationSchemeProvider schemes) in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\src\Hosting\MtlsTokenEndpointMiddleware.cs:line 60
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Cors.Infrastructure.CorsMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context) in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\src\Hosting\BaseUrlMiddleware.cs:line 36
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext context)
2019-08-05 13:52:43.923 +03:00 [INF] Starting IdentityServer4 version 2.5.0.0
2019-08-05 13:52:44.049 +03:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2019-08-05 13:52:44.072 +03:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2019-08-05 13:52:44.073 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for authentication
2019-08-05 13:52:44.074 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-in
2019-08-05 13:52:44.074 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-out
2019-08-05 13:52:44.075 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for challenge
2019-08-05 13:52:44.077 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for forbid
2019-08-05 13:52:46.681 +03:00 [DBG] Login Url: /Account/Login
2019-08-05 13:52:46.684 +03:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-08-05 13:52:46.685 +03:00 [DBG] Logout Url: /Account/Logout
2019-08-05 13:52:46.685 +03:00 [DBG] ConsentUrl Url: /consent
2019-08-05 13:52:46.686 +03:00 [DBG] Consent Return Url Parameter: returnUrl
2019-08-05 13:52:46.686 +03:00 [DBG] Error Url: /home/error
2019-08-05 13:52:46.686 +03:00 [DBG] Error Id Parameter: errorId
2019-08-05 13:52:46.746 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-05 13:52:46.754 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-05 13:52:46.758 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-05 13:52:46.767 +03:00 [DBG] Start discovery request
2019-08-05 13:52:47.027 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-05 13:52:47.041 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-05 13:52:47.047 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-05 13:52:47.076 +03:00 [DBG] Start key discovery request
2019-08-05 13:52:48.442 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-05 13:52:48.455 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-05 13:52:48.456 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-05 13:52:48.475 +03:00 [DBG] Start token request.
2019-08-05 13:52:48.485 +03:00 [DBG] Start client validation
2019-08-05 13:52:48.497 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-05 13:52:48.504 +03:00 [DBG] Start parsing for secret in post body
2019-08-05 13:52:48.546 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-05 13:52:48.548 +03:00 [DBG] Secret id found: ro.client
2019-08-05 13:52:48.588 +03:00 [DBG] client configuration validation for client ro.client succeeded.
2019-08-05 13:52:48.604 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-05 13:52:48.605 +03:00 [DBG] Client validation success
2019-08-05 13:52:48.623 +03:00 [DBG] Start token request validation
2019-08-05 13:52:48.643 +03:00 [DBG] Start resource owner password token request validation
2019-08-05 13:53:14.307 +03:00 [DBG] Resource owner password token request validation success.
2019-08-05 13:53:14.327 +03:00 [INF] Token request validation success, {"ClientId":"ro.client","ClientName":null,"GrantType":"password","Scopes":"afcpayroll","AuthorizationCode":null,"RefreshToken":null,"UserName":"alice","AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"password","username":"alice","password":"***REDACTED***","scope":"afcpayroll","client_id":"ro.client","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2019-08-05 13:53:14.390 +03:00 [DBG] Getting claims for access token for client: ro.client
2019-08-05 13:53:14.391 +03:00 [DBG] Getting claims for access token for subject: 1
2019-08-05 13:54:07.763 +03:00 [INF] Starting IdentityServer4 version 2.5.0.0
2019-08-05 13:54:07.865 +03:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2019-08-05 13:54:07.888 +03:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2019-08-05 13:54:07.894 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for authentication
2019-08-05 13:54:07.895 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-in
2019-08-05 13:54:07.896 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-out
2019-08-05 13:54:07.896 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for challenge
2019-08-05 13:54:07.897 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for forbid
2019-08-05 13:54:08.626 +03:00 [DBG] Login Url: /Account/Login
2019-08-05 13:54:08.629 +03:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-08-05 13:54:08.630 +03:00 [DBG] Logout Url: /Account/Logout
2019-08-05 13:54:08.631 +03:00 [DBG] ConsentUrl Url: /consent
2019-08-05 13:54:08.631 +03:00 [DBG] Consent Return Url Parameter: returnUrl
2019-08-05 13:54:08.631 +03:00 [DBG] Error Url: /home/error
2019-08-05 13:54:08.631 +03:00 [DBG] Error Id Parameter: errorId
2019-08-05 13:54:08.689 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-05 13:54:08.715 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-05 13:54:08.727 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-05 13:54:08.736 +03:00 [DBG] Start discovery request
2019-08-05 13:54:08.994 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-05 13:54:09.000 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-05 13:54:09.003 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-05 13:54:09.010 +03:00 [DBG] Start key discovery request
2019-08-05 13:54:13.017 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-05 13:54:13.036 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-05 13:54:13.037 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-05 13:54:13.062 +03:00 [DBG] Start token request.
2019-08-05 13:54:13.073 +03:00 [DBG] Start client validation
2019-08-05 13:54:13.084 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-05 13:54:13.089 +03:00 [DBG] Start parsing for secret in post body
2019-08-05 13:54:13.120 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-05 13:54:13.121 +03:00 [DBG] Secret id found: ro.client
2019-08-05 13:54:13.155 +03:00 [DBG] client configuration validation for client ro.client succeeded.
2019-08-05 13:54:13.171 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-05 13:54:13.172 +03:00 [DBG] Client validation success
2019-08-05 13:54:13.190 +03:00 [DBG] Start token request validation
2019-08-05 13:54:13.214 +03:00 [DBG] Start resource owner password token request validation
2019-08-05 13:54:13.251 +03:00 [DBG] Resource owner password token request validation success.
2019-08-05 13:54:13.273 +03:00 [INF] Token request validation success, {"ClientId":"ro.client","ClientName":null,"GrantType":"password","Scopes":"afcpayroll","AuthorizationCode":null,"RefreshToken":null,"UserName":"alice","AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"password","username":"alice","password":"***REDACTED***","scope":"afcpayroll","client_id":"ro.client","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2019-08-05 13:54:13.345 +03:00 [DBG] Getting claims for access token for client: ro.client
2019-08-05 13:54:13.346 +03:00 [DBG] Getting claims for access token for subject: 1
2019-08-05 13:54:49.881 +03:00 [DBG] Token request success.
2019-08-05 13:57:28.082 +03:00 [INF] Starting IdentityServer4 version 2.5.0.0
2019-08-05 13:57:28.225 +03:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2019-08-05 13:57:28.252 +03:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2019-08-05 13:57:28.261 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for authentication
2019-08-05 13:57:28.263 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-in
2019-08-05 13:57:28.264 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-out
2019-08-05 13:57:28.265 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for challenge
2019-08-05 13:57:28.267 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for forbid
2019-08-05 13:57:28.904 +03:00 [DBG] Login Url: /Account/Login
2019-08-05 13:57:28.908 +03:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-08-05 13:57:28.909 +03:00 [DBG] Logout Url: /Account/Logout
2019-08-05 13:57:28.910 +03:00 [DBG] ConsentUrl Url: /consent
2019-08-05 13:57:28.911 +03:00 [DBG] Consent Return Url Parameter: returnUrl
2019-08-05 13:57:28.911 +03:00 [DBG] Error Url: /home/error
2019-08-05 13:57:28.912 +03:00 [DBG] Error Id Parameter: errorId
2019-08-05 13:57:28.974 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-05 13:57:28.983 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-05 13:57:28.985 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-05 13:57:28.997 +03:00 [DBG] Start discovery request
2019-08-05 13:57:29.281 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-05 13:57:29.289 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-05 13:57:29.291 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-05 13:57:29.301 +03:00 [DBG] Start key discovery request
2019-08-05 13:57:29.723 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-05 13:57:29.744 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-05 13:57:29.747 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-05 13:57:29.766 +03:00 [DBG] Start token request.
2019-08-05 13:57:29.777 +03:00 [DBG] Start client validation
2019-08-05 13:57:29.788 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-05 13:57:29.794 +03:00 [DBG] Start parsing for secret in post body
2019-08-05 13:57:29.824 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-05 13:57:29.824 +03:00 [DBG] Secret id found: ro.client
2019-08-05 13:57:29.871 +03:00 [DBG] client configuration validation for client ro.client succeeded.
2019-08-05 13:57:29.889 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-05 13:57:29.890 +03:00 [DBG] Client validation success
2019-08-05 13:57:29.906 +03:00 [DBG] Start token request validation
2019-08-05 13:57:29.924 +03:00 [DBG] Start resource owner password token request validation
2019-08-05 13:57:29.967 +03:00 [DBG] Resource owner password token request validation success.
2019-08-05 13:57:29.987 +03:00 [INF] Token request validation success, {"ClientId":"ro.client","ClientName":null,"GrantType":"password","Scopes":"afcpayroll","AuthorizationCode":null,"RefreshToken":null,"UserName":"alice","AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"password","username":"alice","password":"***REDACTED***","scope":"afcpayroll","client_id":"ro.client","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2019-08-05 13:57:30.055 +03:00 [DBG] Getting claims for access token for client: ro.client
2019-08-05 13:57:30.058 +03:00 [DBG] Getting claims for access token for subject: 1
2019-08-05 13:57:30.193 +03:00 [DBG] Token request success.
2019-08-05 14:03:35.867 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-05 14:03:35.876 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-05 14:03:35.890 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-05 14:03:35.897 +03:00 [DBG] Start discovery request
2019-08-05 14:03:36.077 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-05 14:03:36.082 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-05 14:03:36.085 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-05 14:03:36.087 +03:00 [DBG] Start key discovery request
2019-08-05 14:03:36.511 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-05 14:03:36.514 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-05 14:03:36.518 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-05 14:03:36.520 +03:00 [DBG] Start token request.
2019-08-05 14:03:36.521 +03:00 [DBG] Start client validation
2019-08-05 14:03:36.527 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-05 14:03:36.528 +03:00 [DBG] Start parsing for secret in post body
2019-08-05 14:03:36.532 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-05 14:03:36.533 +03:00 [DBG] Secret id found: ro.client
2019-08-05 14:03:36.534 +03:00 [DBG] client configuration validation for client ro.client succeeded.
2019-08-05 14:03:36.536 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-05 14:03:36.536 +03:00 [DBG] Client validation success
2019-08-05 14:03:36.543 +03:00 [DBG] Start token request validation
2019-08-05 14:03:36.546 +03:00 [DBG] Start resource owner password token request validation
2019-08-05 14:03:36.547 +03:00 [DBG] Resource owner password token request validation success.
2019-08-05 14:03:36.548 +03:00 [INF] Token request validation success, {"ClientId":"ro.client","ClientName":null,"GrantType":"password","Scopes":"afcpayroll","AuthorizationCode":null,"RefreshToken":null,"UserName":"alice","AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"password","username":"alice","password":"***REDACTED***","scope":"afcpayroll","client_id":"ro.client","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2019-08-05 14:03:36.560 +03:00 [DBG] Getting claims for access token for client: ro.client
2019-08-05 14:03:36.561 +03:00 [DBG] Getting claims for access token for subject: 1
2019-08-05 14:03:36.566 +03:00 [DBG] Token request success.
2019-08-05 14:03:47.009 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-05 14:03:47.013 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-05 14:03:47.017 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-05 14:03:47.019 +03:00 [DBG] Start discovery request
2019-08-05 14:03:47.148 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-05 14:03:47.151 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-05 14:03:47.155 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-05 14:03:47.157 +03:00 [DBG] Start key discovery request
2019-08-05 14:03:47.558 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-05 14:03:47.561 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-05 14:03:47.566 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-05 14:03:47.568 +03:00 [DBG] Start token request.
2019-08-05 14:03:47.569 +03:00 [DBG] Start client validation
2019-08-05 14:03:47.573 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-05 14:03:47.576 +03:00 [DBG] Start parsing for secret in post body
2019-08-05 14:03:47.577 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-05 14:03:47.578 +03:00 [DBG] Secret id found: ro.client
2019-08-05 14:03:47.580 +03:00 [DBG] client configuration validation for client ro.client succeeded.
2019-08-05 14:03:47.587 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-05 14:03:47.589 +03:00 [DBG] Client validation success
2019-08-05 14:03:47.590 +03:00 [DBG] Start token request validation
2019-08-05 14:03:47.591 +03:00 [DBG] Start resource owner password token request validation
2019-08-05 14:03:47.592 +03:00 [DBG] Resource owner password token request validation success.
2019-08-05 14:03:47.593 +03:00 [INF] Token request validation success, {"ClientId":"ro.client","ClientName":null,"GrantType":"password","Scopes":"afcpayroll","AuthorizationCode":null,"RefreshToken":null,"UserName":"alice","AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"password","username":"alice","password":"***REDACTED***","scope":"afcpayroll","client_id":"ro.client","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2019-08-05 14:03:47.611 +03:00 [DBG] Getting claims for access token for client: ro.client
2019-08-05 14:03:47.616 +03:00 [DBG] Getting claims for access token for subject: 1
2019-08-05 14:04:44.053 +03:00 [DBG] Token request success.
2019-08-05 14:05:23.196 +03:00 [INF] Starting IdentityServer4 version 2.5.0.0
2019-08-05 14:05:23.355 +03:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2019-08-05 14:05:23.371 +03:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2019-08-05 14:05:23.371 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for authentication
2019-08-05 14:05:23.371 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-in
2019-08-05 14:05:23.372 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-out
2019-08-05 14:05:23.372 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for challenge
2019-08-05 14:05:23.373 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for forbid
2019-08-05 14:05:23.916 +03:00 [DBG] Login Url: /Account/Login
2019-08-05 14:05:23.920 +03:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-08-05 14:05:23.921 +03:00 [DBG] Logout Url: /Account/Logout
2019-08-05 14:05:23.922 +03:00 [DBG] ConsentUrl Url: /consent
2019-08-05 14:05:23.922 +03:00 [DBG] Consent Return Url Parameter: returnUrl
2019-08-05 14:05:23.922 +03:00 [DBG] Error Url: /home/error
2019-08-05 14:05:23.923 +03:00 [DBG] Error Id Parameter: errorId
2019-08-05 14:05:23.982 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-05 14:05:23.991 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-05 14:05:23.994 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-05 14:05:24.008 +03:00 [DBG] Start discovery request
2019-08-05 14:05:24.270 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-05 14:05:24.275 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-05 14:05:24.278 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-05 14:05:24.284 +03:00 [DBG] Start key discovery request
2019-08-05 14:05:24.745 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-05 14:05:24.758 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-05 14:05:24.760 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-05 14:05:24.777 +03:00 [DBG] Start token request.
2019-08-05 14:05:24.789 +03:00 [DBG] Start client validation
2019-08-05 14:05:24.800 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-05 14:05:24.809 +03:00 [DBG] Start parsing for secret in post body
2019-08-05 14:05:24.842 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-05 14:05:24.843 +03:00 [DBG] Secret id found: ro.client
2019-08-05 14:05:24.876 +03:00 [DBG] client configuration validation for client ro.client succeeded.
2019-08-05 14:05:24.891 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-05 14:05:24.891 +03:00 [DBG] Client validation success
2019-08-05 14:05:24.907 +03:00 [DBG] Start token request validation
2019-08-05 14:05:24.924 +03:00 [DBG] Start resource owner password token request validation
2019-08-05 14:05:24.960 +03:00 [DBG] Resource owner password token request validation success.
2019-08-05 14:05:24.979 +03:00 [INF] Token request validation success, {"ClientId":"ro.client","ClientName":null,"GrantType":"password","Scopes":"afcpayroll","AuthorizationCode":null,"RefreshToken":null,"UserName":"alice","AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"password","username":"alice","password":"***REDACTED***","scope":"afcpayroll","client_id":"ro.client","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2019-08-05 14:05:25.100 +03:00 [DBG] Getting claims for access token for client: ro.client
2019-08-05 14:05:25.102 +03:00 [DBG] Getting claims for access token for subject: 1
2019-08-05 14:05:51.215 +03:00 [DBG] Token request success.
2019-08-05 14:10:47.903 +03:00 [INF] Starting IdentityServer4 version 2.5.0.0
2019-08-05 14:10:48.018 +03:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2019-08-05 14:10:48.044 +03:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2019-08-05 14:10:48.045 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for authentication
2019-08-05 14:10:48.046 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-in
2019-08-05 14:10:48.046 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-out
2019-08-05 14:10:48.047 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for challenge
2019-08-05 14:10:48.049 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for forbid
2019-08-05 14:10:50.633 +03:00 [DBG] Login Url: /Account/Login
2019-08-05 14:10:50.637 +03:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-08-05 14:10:50.638 +03:00 [DBG] Logout Url: /Account/Logout
2019-08-05 14:10:50.638 +03:00 [DBG] ConsentUrl Url: /consent
2019-08-05 14:10:50.639 +03:00 [DBG] Consent Return Url Parameter: returnUrl
2019-08-05 14:10:50.639 +03:00 [DBG] Error Url: /home/error
2019-08-05 14:10:50.639 +03:00 [DBG] Error Id Parameter: errorId
2019-08-05 14:10:50.697 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-05 14:10:50.706 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-05 14:10:50.707 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-05 14:10:50.717 +03:00 [DBG] Start discovery request
2019-08-05 14:10:50.976 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-05 14:10:50.986 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-05 14:10:50.990 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-05 14:10:50.996 +03:00 [DBG] Start key discovery request
2019-08-05 14:10:51.506 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-05 14:10:51.528 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-05 14:10:51.530 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-05 14:10:51.553 +03:00 [DBG] Start token request.
2019-08-05 14:10:51.562 +03:00 [DBG] Start client validation
2019-08-05 14:10:51.573 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-05 14:10:51.580 +03:00 [DBG] Start parsing for secret in post body
2019-08-05 14:10:51.618 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-05 14:10:51.618 +03:00 [DBG] Secret id found: ro.client
2019-08-05 14:10:51.656 +03:00 [DBG] client configuration validation for client ro.client succeeded.
2019-08-05 14:10:51.673 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-05 14:10:51.675 +03:00 [DBG] Client validation success
2019-08-05 14:10:51.695 +03:00 [DBG] Start token request validation
2019-08-05 14:10:51.724 +03:00 [DBG] Start resource owner password token request validation
2019-08-05 14:10:51.770 +03:00 [DBG] Resource owner password token request validation success.
2019-08-05 14:10:51.790 +03:00 [INF] Token request validation success, {"ClientId":"ro.client","ClientName":null,"GrantType":"password","Scopes":"afcpayroll","AuthorizationCode":null,"RefreshToken":null,"UserName":"alice","AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"password","username":"alice","password":"***REDACTED***","scope":"afcpayroll","client_id":"ro.client","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2019-08-05 14:10:51.855 +03:00 [DBG] Getting claims for access token for client: ro.client
2019-08-05 14:10:51.856 +03:00 [DBG] Getting claims for access token for subject: 1
2019-08-05 14:11:06.494 +03:00 [DBG] Token request success.
2019-08-05 14:14:35.828 +03:00 [INF] Starting IdentityServer4 version 2.5.0.0
2019-08-05 14:14:35.925 +03:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2019-08-05 14:14:35.939 +03:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2019-08-05 14:14:35.940 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for authentication
2019-08-05 14:14:35.940 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-in
2019-08-05 14:14:35.941 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-out
2019-08-05 14:14:35.941 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for challenge
2019-08-05 14:14:35.942 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for forbid
2019-08-05 14:14:36.370 +03:00 [DBG] Login Url: /Account/Login
2019-08-05 14:14:36.374 +03:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-08-05 14:14:36.375 +03:00 [DBG] Logout Url: /Account/Logout
2019-08-05 14:14:36.375 +03:00 [DBG] ConsentUrl Url: /consent
2019-08-05 14:14:36.375 +03:00 [DBG] Consent Return Url Parameter: returnUrl
2019-08-05 14:14:36.376 +03:00 [DBG] Error Url: /home/error
2019-08-05 14:14:36.377 +03:00 [DBG] Error Id Parameter: errorId
2019-08-05 14:14:36.426 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-05 14:14:36.435 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-05 14:14:36.437 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-05 14:14:36.450 +03:00 [DBG] Start discovery request
2019-08-05 14:14:36.703 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-05 14:14:36.719 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-05 14:14:36.723 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-05 14:14:36.735 +03:00 [DBG] Start key discovery request
2019-08-05 14:14:37.211 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-05 14:14:37.224 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-05 14:14:37.225 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-05 14:14:37.242 +03:00 [DBG] Start token request.
2019-08-05 14:14:37.252 +03:00 [DBG] Start client validation
2019-08-05 14:14:37.261 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-05 14:14:37.267 +03:00 [DBG] Start parsing for secret in post body
2019-08-05 14:14:37.299 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-05 14:14:37.301 +03:00 [DBG] Secret id found: ro.client
2019-08-05 14:14:37.339 +03:00 [DBG] client configuration validation for client ro.client succeeded.
2019-08-05 14:14:37.358 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-05 14:14:37.359 +03:00 [DBG] Client validation success
2019-08-05 14:14:37.385 +03:00 [DBG] Start token request validation
2019-08-05 14:14:37.411 +03:00 [DBG] Start resource owner password token request validation
2019-08-05 14:14:37.457 +03:00 [DBG] Resource owner password token request validation success.
2019-08-05 14:14:37.478 +03:00 [INF] Token request validation success, {"ClientId":"ro.client","ClientName":null,"GrantType":"password","Scopes":"afcpayroll","AuthorizationCode":null,"RefreshToken":null,"UserName":"alice","AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"password","username":"alice","password":"***REDACTED***","scope":"afcpayroll","client_id":"ro.client","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2019-08-05 14:14:37.557 +03:00 [DBG] Getting claims for access token for client: ro.client
2019-08-05 14:14:37.558 +03:00 [DBG] Getting claims for access token for subject: 1
2019-08-05 14:14:48.735 +03:00 [DBG] Token request success.
2019-08-05 14:15:16.006 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-05 14:15:16.010 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-05 14:15:16.014 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-05 14:15:16.016 +03:00 [DBG] Start discovery request
2019-08-05 14:15:16.188 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-05 14:15:16.195 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-05 14:15:16.200 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-05 14:15:16.202 +03:00 [DBG] Start key discovery request
2019-08-05 14:15:16.588 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-05 14:15:16.592 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-05 14:15:16.596 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-05 14:15:16.602 +03:00 [DBG] Start token request.
2019-08-05 14:15:16.606 +03:00 [DBG] Start client validation
2019-08-05 14:15:16.607 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-05 14:15:16.609 +03:00 [DBG] Start parsing for secret in post body
2019-08-05 14:15:16.614 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-05 14:15:16.617 +03:00 [DBG] Secret id found: ro.client
2019-08-05 14:15:16.619 +03:00 [DBG] client configuration validation for client ro.client succeeded.
2019-08-05 14:15:16.623 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-05 14:15:16.624 +03:00 [DBG] Client validation success
2019-08-05 14:15:16.625 +03:00 [DBG] Start token request validation
2019-08-05 14:15:16.627 +03:00 [DBG] Start resource owner password token request validation
2019-08-05 14:15:16.634 +03:00 [DBG] Resource owner password token request validation success.
2019-08-05 14:15:16.635 +03:00 [INF] Token request validation success, {"ClientId":"ro.client","ClientName":null,"GrantType":"password","Scopes":"afcpayroll","AuthorizationCode":null,"RefreshToken":null,"UserName":"alice","AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"password","username":"alice","password":"***REDACTED***","scope":"afcpayroll","client_id":"ro.client","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2019-08-05 14:15:16.646 +03:00 [DBG] Getting claims for access token for client: ro.client
2019-08-05 14:15:16.648 +03:00 [DBG] Getting claims for access token for subject: 1
2019-08-05 14:15:36.487 +03:00 [INF] Starting IdentityServer4 version 2.5.0.0
2019-08-05 14:15:36.546 +03:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2019-08-05 14:15:36.560 +03:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2019-08-05 14:15:36.561 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for authentication
2019-08-05 14:15:36.561 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-in
2019-08-05 14:15:36.561 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-out
2019-08-05 14:15:36.562 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for challenge
2019-08-05 14:15:36.562 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for forbid
2019-08-05 14:15:40.058 +03:00 [DBG] Login Url: /Account/Login
2019-08-05 14:15:40.062 +03:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-08-05 14:15:40.063 +03:00 [DBG] Logout Url: /Account/Logout
2019-08-05 14:15:40.063 +03:00 [DBG] ConsentUrl Url: /consent
2019-08-05 14:15:40.064 +03:00 [DBG] Consent Return Url Parameter: returnUrl
2019-08-05 14:15:40.064 +03:00 [DBG] Error Url: /home/error
2019-08-05 14:15:40.065 +03:00 [DBG] Error Id Parameter: errorId
2019-08-05 14:15:40.125 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-05 14:15:40.136 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-05 14:15:40.168 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-05 14:15:40.180 +03:00 [DBG] Start discovery request
2019-08-05 14:15:40.428 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-05 14:15:40.438 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-05 14:15:40.440 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-05 14:15:40.450 +03:00 [DBG] Start key discovery request
2019-08-05 14:15:40.887 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-05 14:15:40.902 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-05 14:15:40.903 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-05 14:15:40.920 +03:00 [DBG] Start token request.
2019-08-05 14:15:40.932 +03:00 [DBG] Start client validation
2019-08-05 14:15:40.942 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-05 14:15:40.955 +03:00 [DBG] Start parsing for secret in post body
2019-08-05 14:15:40.994 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-05 14:15:40.995 +03:00 [DBG] Secret id found: ro.client
2019-08-05 14:15:41.037 +03:00 [DBG] client configuration validation for client ro.client succeeded.
2019-08-05 14:15:41.052 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-05 14:15:41.053 +03:00 [DBG] Client validation success
2019-08-05 14:15:41.071 +03:00 [DBG] Start token request validation
2019-08-05 14:15:41.090 +03:00 [DBG] Start resource owner password token request validation
2019-08-05 14:15:41.136 +03:00 [DBG] Resource owner password token request validation success.
2019-08-05 14:15:41.162 +03:00 [INF] Token request validation success, {"ClientId":"ro.client","ClientName":null,"GrantType":"password","Scopes":"afcpayroll","AuthorizationCode":null,"RefreshToken":null,"UserName":"alice","AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"password","username":"alice","password":"***REDACTED***","scope":"afcpayroll","client_id":"ro.client","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2019-08-05 14:15:41.230 +03:00 [DBG] Getting claims for access token for client: ro.client
2019-08-05 14:15:41.232 +03:00 [DBG] Getting claims for access token for subject: 1
2019-08-05 14:15:42.393 +03:00 [DBG] Token request success.
2019-08-05 14:18:44.829 +03:00 [INF] Starting IdentityServer4 version 2.5.0.0
2019-08-05 14:18:44.899 +03:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2019-08-05 14:18:44.913 +03:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2019-08-05 14:18:44.913 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for authentication
2019-08-05 14:18:44.914 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-in
2019-08-05 14:18:44.914 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-out
2019-08-05 14:18:44.914 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for challenge
2019-08-05 14:18:44.915 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for forbid
2019-08-05 14:18:46.674 +03:00 [DBG] Login Url: /Account/Login
2019-08-05 14:18:46.678 +03:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-08-05 14:18:46.679 +03:00 [DBG] Logout Url: /Account/Logout
2019-08-05 14:18:46.679 +03:00 [DBG] ConsentUrl Url: /consent
2019-08-05 14:18:46.679 +03:00 [DBG] Consent Return Url Parameter: returnUrl
2019-08-05 14:18:46.679 +03:00 [DBG] Error Url: /home/error
2019-08-05 14:18:46.680 +03:00 [DBG] Error Id Parameter: errorId
2019-08-05 14:18:46.743 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-05 14:18:46.754 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-05 14:18:46.757 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-05 14:18:46.774 +03:00 [DBG] Start discovery request
2019-08-05 14:18:47.019 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-05 14:18:47.024 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-05 14:18:47.028 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-05 14:18:47.035 +03:00 [DBG] Start key discovery request
2019-08-05 14:18:48.475 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-05 14:18:48.493 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-05 14:18:48.495 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-05 14:18:48.511 +03:00 [DBG] Start token request.
2019-08-05 14:18:48.520 +03:00 [DBG] Start client validation
2019-08-05 14:18:48.533 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-05 14:18:48.539 +03:00 [DBG] Start parsing for secret in post body
2019-08-05 14:18:48.568 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-05 14:18:48.569 +03:00 [DBG] Secret id found: ro.client
2019-08-05 14:18:48.610 +03:00 [DBG] client configuration validation for client ro.client succeeded.
2019-08-05 14:18:48.627 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-05 14:18:48.628 +03:00 [DBG] Client validation success
2019-08-05 14:18:48.645 +03:00 [DBG] Start token request validation
2019-08-05 14:18:48.668 +03:00 [DBG] Start resource owner password token request validation
2019-08-05 14:18:48.710 +03:00 [DBG] Resource owner password token request validation success.
2019-08-05 14:18:48.728 +03:00 [INF] Token request validation success, {"ClientId":"ro.client","ClientName":null,"GrantType":"password","Scopes":"afcpayroll","AuthorizationCode":null,"RefreshToken":null,"UserName":"alice","AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"password","username":"alice","password":"***REDACTED***","scope":"afcpayroll","client_id":"ro.client","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2019-08-05 14:18:48.795 +03:00 [DBG] Getting claims for access token for client: ro.client
2019-08-05 14:18:48.796 +03:00 [DBG] Getting claims for access token for subject: 1
2019-08-05 14:19:02.361 +03:00 [DBG] Token request success.
2019-08-05 14:19:26.104 +03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-08-05 14:19:26.109 +03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-08-05 14:19:26.112 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-08-05 14:19:26.124 +03:00 [DBG] Start userinfo request
2019-08-05 14:19:26.129 +03:00 [DBG] Bearer token found in header
2019-08-05 14:19:32.495 +03:00 [DBG] client configuration validation for client ro.client succeeded.
2019-08-05 14:19:34.372 +03:00 [DBG] client configuration validation for client ro.client succeeded.
2019-08-05 14:19:34.381 +03:00 [ERR] Checking for expected scope openid failed
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1565003942,"exp":1565007542,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","afcpayroll"],"client_id":"ro.client","sub":"1","auth_time":1565003928,"idp":"local","name":"alice","email":"alice@email.com","scope":"afcpayroll","amr":"Bearer"},"$type":"TokenValidationLog"}
2019-08-05 14:22:37.120 +03:00 [INF] Starting IdentityServer4 version 2.5.0.0
2019-08-05 14:22:37.284 +03:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2019-08-05 14:22:37.301 +03:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2019-08-05 14:22:37.318 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for authentication
2019-08-05 14:22:37.319 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-in
2019-08-05 14:22:37.320 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-out
2019-08-05 14:22:37.322 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for challenge
2019-08-05 14:22:37.324 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for forbid
2019-08-05 14:22:40.824 +03:00 [DBG] Login Url: /Account/Login
2019-08-05 14:22:40.827 +03:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-08-05 14:22:40.828 +03:00 [DBG] Logout Url: /Account/Logout
2019-08-05 14:22:40.829 +03:00 [DBG] ConsentUrl Url: /consent
2019-08-05 14:22:40.829 +03:00 [DBG] Consent Return Url Parameter: returnUrl
2019-08-05 14:22:40.829 +03:00 [DBG] Error Url: /home/error
2019-08-05 14:22:40.829 +03:00 [DBG] Error Id Parameter: errorId
2019-08-05 14:22:40.883 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-05 14:22:40.891 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-05 14:22:40.892 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-05 14:22:40.902 +03:00 [DBG] Start discovery request
2019-08-05 14:22:41.140 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-05 14:22:41.163 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-05 14:22:41.166 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-05 14:22:41.174 +03:00 [DBG] Start key discovery request
2019-08-05 14:22:41.654 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-05 14:22:41.671 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-05 14:22:41.673 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-05 14:22:41.693 +03:00 [DBG] Start token request.
2019-08-05 14:22:41.703 +03:00 [DBG] Start client validation
2019-08-05 14:22:41.711 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-05 14:22:41.716 +03:00 [DBG] Start parsing for secret in post body
2019-08-05 14:22:41.759 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-05 14:22:41.759 +03:00 [DBG] Secret id found: ro.client
2019-08-05 14:22:47.188 +03:00 [DBG] client configuration validation for client ro.client succeeded.
2019-08-05 14:22:47.205 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-05 14:22:47.205 +03:00 [DBG] Client validation success
2019-08-05 14:22:47.229 +03:00 [DBG] Start token request validation
2019-08-05 14:22:47.250 +03:00 [DBG] Start resource owner password token request validation
2019-08-05 14:22:47.287 +03:00 [DBG] Resource owner password token request validation success.
2019-08-05 14:22:47.307 +03:00 [INF] Token request validation success, {"ClientId":"ro.client","ClientName":null,"GrantType":"password","Scopes":"afcpayroll","AuthorizationCode":null,"RefreshToken":null,"UserName":"alice","AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"password","username":"alice","password":"***REDACTED***","scope":"afcpayroll","client_id":"ro.client","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2019-08-05 14:22:47.374 +03:00 [DBG] Getting claims for access token for client: ro.client
2019-08-05 14:22:47.375 +03:00 [DBG] Getting claims for access token for subject: 1
2019-08-05 14:22:49.472 +03:00 [DBG] Token request success.
2019-08-05 14:22:52.591 +03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-08-05 14:22:52.596 +03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-08-05 14:22:52.601 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-08-05 14:22:52.618 +03:00 [DBG] Start userinfo request
2019-08-05 14:22:52.623 +03:00 [DBG] Bearer token found in header
2019-08-05 14:22:58.484 +03:00 [DBG] client configuration validation for client ro.client succeeded.
2019-08-05 14:23:04.080 +03:00 [DBG] client configuration validation for client ro.client succeeded.
2019-08-05 14:23:04.086 +03:00 [ERR] Checking for expected scope openid failed
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1565004169,"exp":1565007769,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","afcpayroll"],"client_id":"ro.client","sub":"1","auth_time":1565004167,"idp":"local","name":"alice","email":"alice@email.com","scope":"afcpayroll","amr":"Bearer"},"$type":"TokenValidationLog"}
2019-08-05 14:23:56.064 +03:00 [INF] Starting IdentityServer4 version 2.5.0.0
2019-08-05 14:23:56.125 +03:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2019-08-05 14:23:56.138 +03:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2019-08-05 14:23:56.139 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for authentication
2019-08-05 14:23:56.139 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-in
2019-08-05 14:23:56.139 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-out
2019-08-05 14:23:56.140 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for challenge
2019-08-05 14:23:56.140 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for forbid
2019-08-05 14:24:06.469 +03:00 [DBG] Login Url: /Account/Login
2019-08-05 14:24:06.473 +03:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-08-05 14:24:06.474 +03:00 [DBG] Logout Url: /Account/Logout
2019-08-05 14:24:06.474 +03:00 [DBG] ConsentUrl Url: /consent
2019-08-05 14:24:06.474 +03:00 [DBG] Consent Return Url Parameter: returnUrl
2019-08-05 14:24:06.475 +03:00 [DBG] Error Url: /home/error
2019-08-05 14:24:06.475 +03:00 [DBG] Error Id Parameter: errorId
2019-08-05 14:24:06.545 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-05 14:24:06.558 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-05 14:24:06.560 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-05 14:24:06.573 +03:00 [DBG] Start discovery request
2019-08-05 14:24:06.834 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-05 14:24:06.848 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-05 14:24:06.852 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-05 14:24:06.864 +03:00 [DBG] Start key discovery request
2019-08-05 14:24:07.925 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-05 14:24:07.943 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-05 14:24:07.946 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-05 14:24:07.968 +03:00 [DBG] Start token request.
2019-08-05 14:24:07.981 +03:00 [DBG] Start client validation
2019-08-05 14:24:07.990 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-05 14:24:07.995 +03:00 [DBG] Start parsing for secret in post body
2019-08-05 14:24:08.024 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-05 14:24:08.024 +03:00 [DBG] Secret id found: ro.client
2019-08-05 14:24:12.401 +03:00 [DBG] client configuration validation for client ro.client succeeded.
2019-08-05 14:24:12.421 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-05 14:24:12.422 +03:00 [DBG] Client validation success
2019-08-05 14:24:12.449 +03:00 [DBG] Start token request validation
2019-08-05 14:24:12.467 +03:00 [DBG] Start resource owner password token request validation
2019-08-05 14:24:12.491 +03:00 [ERR] Requested scope not allowed: openid
2019-08-05 14:24:12.517 +03:00 [ERR] {"ClientId":"ro.client","ClientName":null,"GrantType":"password","Scopes":null,"AuthorizationCode":null,"RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"password","username":"alice","password":"***REDACTED***","scope":"afcpayroll openid","client_id":"ro.client","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2019-08-05 14:26:02.916 +03:00 [INF] Starting IdentityServer4 version 2.5.0.0
2019-08-05 14:26:03.002 +03:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2019-08-05 14:26:03.015 +03:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2019-08-05 14:26:03.015 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for authentication
2019-08-05 14:26:03.016 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-in
2019-08-05 14:26:03.016 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-out
2019-08-05 14:26:03.017 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for challenge
2019-08-05 14:26:03.018 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for forbid
2019-08-05 14:26:11.352 +03:00 [DBG] Login Url: /Account/Login
2019-08-05 14:26:11.355 +03:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-08-05 14:26:11.356 +03:00 [DBG] Logout Url: /Account/Logout
2019-08-05 14:26:11.357 +03:00 [DBG] ConsentUrl Url: /consent
2019-08-05 14:26:11.357 +03:00 [DBG] Consent Return Url Parameter: returnUrl
2019-08-05 14:26:11.357 +03:00 [DBG] Error Url: /home/error
2019-08-05 14:26:11.358 +03:00 [DBG] Error Id Parameter: errorId
2019-08-05 14:26:11.408 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-05 14:26:11.416 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-05 14:26:11.418 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-05 14:26:11.426 +03:00 [DBG] Start discovery request
2019-08-05 14:26:11.669 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-05 14:26:11.680 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-05 14:26:11.682 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-05 14:26:11.692 +03:00 [DBG] Start key discovery request
2019-08-05 14:26:13.887 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-05 14:26:13.902 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-05 14:26:13.903 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-05 14:26:13.921 +03:00 [DBG] Start token request.
2019-08-05 14:26:13.932 +03:00 [DBG] Start client validation
2019-08-05 14:26:13.941 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-05 14:26:13.948 +03:00 [DBG] Start parsing for secret in post body
2019-08-05 14:26:13.980 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-05 14:26:13.980 +03:00 [DBG] Secret id found: ro.client
2019-08-05 14:26:14.021 +03:00 [DBG] client configuration validation for client ro.client succeeded.
2019-08-05 14:26:14.037 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-05 14:26:14.037 +03:00 [DBG] Client validation success
2019-08-05 14:26:14.053 +03:00 [DBG] Start token request validation
2019-08-05 14:26:14.073 +03:00 [DBG] Start resource owner password token request validation
2019-08-05 14:26:14.115 +03:00 [DBG] Resource owner password token request validation success.
2019-08-05 14:26:14.134 +03:00 [INF] Token request validation success, {"ClientId":"ro.client","ClientName":null,"GrantType":"password","Scopes":"afcpayroll openid","AuthorizationCode":null,"RefreshToken":null,"UserName":"alice","AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"password","username":"alice","password":"***REDACTED***","scope":"afcpayroll openid","client_id":"ro.client","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2019-08-05 14:26:14.203 +03:00 [DBG] Getting claims for access token for client: ro.client
2019-08-05 14:26:14.204 +03:00 [DBG] Getting claims for access token for subject: 1
2019-08-05 14:26:27.843 +03:00 [DBG] Token request success.
2019-08-05 14:26:30.404 +03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-08-05 14:26:30.409 +03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-08-05 14:26:30.412 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-08-05 14:26:30.427 +03:00 [DBG] Start userinfo request
2019-08-05 14:26:30.435 +03:00 [DBG] Bearer token found in header
2019-08-05 14:26:30.527 +03:00 [DBG] client configuration validation for client ro.client succeeded.
2019-08-05 14:26:30.535 +03:00 [DBG] client configuration validation for client ro.client succeeded.
2019-08-05 14:26:30.538 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-08-05 14:26:30.546 +03:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1565004387,"exp":1565007987,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","afcpayroll"],"client_id":"ro.client","sub":"1","auth_time":1565004374,"idp":"local","name":"alice","email":"alice@email.com","scope":["openid","afcpayroll"],"amr":"Bearer"},"$type":"TokenValidationLog"}
2019-08-05 14:26:30.569 +03:00 [DBG] Creating userinfo response
2019-08-05 14:26:30.576 +03:00 [DBG] Scopes in access token: openid afcpayroll
2019-08-05 14:26:30.586 +03:00 [DBG] Scopes in access token: openid afcpayroll
2019-08-05 14:26:30.591 +03:00 [DBG] Requested claim types: sub
2019-08-05 14:26:30.591 +03:00 [DBG] Scopes in access token: openid afcpayroll
2019-08-05 14:26:45.361 +03:00 [INF] Profile service returned the following claim types: sub
2019-08-05 14:26:45.366 +03:00 [ERR] Profile service returned incorrect subject value: sub: alice@email.com
2019-08-05 14:26:45.616 +03:00 [FTL] Unhandled exception: Profile service returned incorrect subject value
System.InvalidOperationException: Profile service returned incorrect subject value
   at IdentityServer4.ResponseHandling.UserInfoResponseGenerator.ProcessAsync(UserInfoRequestValidationResult validationResult)
   at IdentityServer4.Endpoints.UserInfoEndpoint.ProcessUserInfoRequestAsync(HttpContext context) in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\src\Endpoints\UserInfoEndpoint.cs:line 89
   at IdentityServer4.Endpoints.UserInfoEndpoint.ProcessAsync(HttpContext context) in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\src\Endpoints\UserInfoEndpoint.cs:line 60
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events) in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\src\Hosting\IdentityServerMiddleware.cs:line 54
2019-08-05 14:26:45.822 +03:00 [ERR] An unhandled exception has occurred while executing the request.
System.InvalidOperationException: Profile service returned incorrect subject value
   at IdentityServer4.ResponseHandling.UserInfoResponseGenerator.ProcessAsync(UserInfoRequestValidationResult validationResult)
   at IdentityServer4.Endpoints.UserInfoEndpoint.ProcessUserInfoRequestAsync(HttpContext context) in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\src\Endpoints\UserInfoEndpoint.cs:line 89
   at IdentityServer4.Endpoints.UserInfoEndpoint.ProcessAsync(HttpContext context) in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\src\Endpoints\UserInfoEndpoint.cs:line 60
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events) in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\src\Hosting\IdentityServerMiddleware.cs:line 54
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events) in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\src\Hosting\IdentityServerMiddleware.cs:line 69
   at IdentityServer4.Hosting.MutualTlsTokenEndpointMiddleware.Invoke(HttpContext context, IAuthenticationSchemeProvider schemes) in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\src\Hosting\MtlsTokenEndpointMiddleware.cs:line 60
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Cors.Infrastructure.CorsMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context) in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\src\Hosting\BaseUrlMiddleware.cs:line 36
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext context)
2019-08-05 14:28:31.466 +03:00 [INF] Starting IdentityServer4 version 2.5.0.0
2019-08-05 14:28:31.537 +03:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2019-08-05 14:28:31.550 +03:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2019-08-05 14:28:31.551 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for authentication
2019-08-05 14:28:31.551 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-in
2019-08-05 14:28:31.552 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-out
2019-08-05 14:28:31.552 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for challenge
2019-08-05 14:28:31.552 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for forbid
2019-08-05 14:28:40.523 +03:00 [DBG] Login Url: /Account/Login
2019-08-05 14:28:40.526 +03:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-08-05 14:28:40.527 +03:00 [DBG] Logout Url: /Account/Logout
2019-08-05 14:28:40.528 +03:00 [DBG] ConsentUrl Url: /consent
2019-08-05 14:28:40.528 +03:00 [DBG] Consent Return Url Parameter: returnUrl
2019-08-05 14:28:40.528 +03:00 [DBG] Error Url: /home/error
2019-08-05 14:28:40.529 +03:00 [DBG] Error Id Parameter: errorId
2019-08-05 14:28:40.587 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-05 14:28:40.597 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-05 14:28:40.600 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-05 14:28:40.613 +03:00 [DBG] Start discovery request
2019-08-05 14:28:40.852 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-05 14:28:40.868 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-05 14:28:40.873 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-05 14:28:40.884 +03:00 [DBG] Start key discovery request
2019-08-05 14:28:41.349 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-05 14:28:41.365 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-05 14:28:41.368 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-05 14:28:41.386 +03:00 [DBG] Start token request.
2019-08-05 14:28:41.397 +03:00 [DBG] Start client validation
2019-08-05 14:28:41.405 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-05 14:28:41.411 +03:00 [DBG] Start parsing for secret in post body
2019-08-05 14:28:41.440 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-05 14:28:41.440 +03:00 [DBG] Secret id found: ro.client
2019-08-05 14:28:41.477 +03:00 [DBG] client configuration validation for client ro.client succeeded.
2019-08-05 14:28:41.494 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-05 14:28:41.495 +03:00 [DBG] Client validation success
2019-08-05 14:28:41.512 +03:00 [DBG] Start token request validation
2019-08-05 14:28:41.531 +03:00 [DBG] Start resource owner password token request validation
2019-08-05 14:28:41.581 +03:00 [DBG] Resource owner password token request validation success.
2019-08-05 14:28:41.612 +03:00 [INF] Token request validation success, {"ClientId":"ro.client","ClientName":null,"GrantType":"password","Scopes":"afcpayroll openid","AuthorizationCode":null,"RefreshToken":null,"UserName":"alice","AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"password","username":"alice","password":"***REDACTED***","scope":"afcpayroll openid","client_id":"ro.client","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2019-08-05 14:28:41.689 +03:00 [DBG] Getting claims for access token for client: ro.client
2019-08-05 14:28:41.690 +03:00 [DBG] Getting claims for access token for subject: 1
2019-08-05 14:28:49.890 +03:00 [DBG] Token request success.
2019-08-05 14:28:53.328 +03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-08-05 14:28:53.332 +03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-08-05 14:28:53.340 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-08-05 14:28:53.357 +03:00 [DBG] Start userinfo request
2019-08-05 14:28:53.366 +03:00 [DBG] Bearer token found in header
2019-08-05 14:28:53.449 +03:00 [DBG] client configuration validation for client ro.client succeeded.
2019-08-05 14:28:53.458 +03:00 [DBG] client configuration validation for client ro.client succeeded.
2019-08-05 14:28:53.461 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-08-05 14:28:53.468 +03:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1565004529,"exp":1565008129,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","afcpayroll"],"client_id":"ro.client","sub":"1","auth_time":1565004521,"idp":"local","name":"alice","email":"alice@email.com","scope":["openid","afcpayroll"],"amr":"Bearer"},"$type":"TokenValidationLog"}
2019-08-05 14:28:53.492 +03:00 [DBG] Creating userinfo response
2019-08-05 14:28:53.497 +03:00 [DBG] Scopes in access token: openid afcpayroll
2019-08-05 14:28:53.502 +03:00 [DBG] Scopes in access token: openid afcpayroll
2019-08-05 14:28:53.506 +03:00 [DBG] Requested claim types: sub
2019-08-05 14:28:53.506 +03:00 [DBG] Scopes in access token: openid afcpayroll
2019-08-05 14:29:04.516 +03:00 [INF] Profile service returned the following claim types: sub
2019-08-05 14:29:04.520 +03:00 [DBG] End userinfo request
2019-08-05 14:32:00.005 +03:00 [INF] Starting IdentityServer4 version 2.5.0.0
2019-08-05 14:32:00.099 +03:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2019-08-05 14:32:00.123 +03:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2019-08-05 14:32:00.127 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for authentication
2019-08-05 14:32:00.130 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-in
2019-08-05 14:32:00.134 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-out
2019-08-05 14:32:00.135 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for challenge
2019-08-05 14:32:00.135 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for forbid
2019-08-05 14:32:05.303 +03:00 [DBG] Login Url: /Account/Login
2019-08-05 14:32:05.307 +03:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-08-05 14:32:05.309 +03:00 [DBG] Logout Url: /Account/Logout
2019-08-05 14:32:05.309 +03:00 [DBG] ConsentUrl Url: /consent
2019-08-05 14:32:05.309 +03:00 [DBG] Consent Return Url Parameter: returnUrl
2019-08-05 14:32:05.310 +03:00 [DBG] Error Url: /home/error
2019-08-05 14:32:05.310 +03:00 [DBG] Error Id Parameter: errorId
2019-08-05 14:32:05.371 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-05 14:32:05.380 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-05 14:32:05.382 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-05 14:32:05.391 +03:00 [DBG] Start discovery request
2019-08-05 14:32:05.669 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-05 14:32:05.680 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-05 14:32:05.682 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-05 14:32:05.691 +03:00 [DBG] Start key discovery request
2019-08-05 14:32:06.208 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-05 14:32:06.220 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-05 14:32:06.221 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-05 14:32:06.237 +03:00 [DBG] Start token request.
2019-08-05 14:32:06.246 +03:00 [DBG] Start client validation
2019-08-05 14:32:06.256 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-05 14:32:06.262 +03:00 [DBG] Start parsing for secret in post body
2019-08-05 14:32:06.294 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-05 14:32:06.294 +03:00 [DBG] Secret id found: ro.client
2019-08-05 14:32:06.335 +03:00 [DBG] client configuration validation for client ro.client succeeded.
2019-08-05 14:32:06.357 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-05 14:32:06.361 +03:00 [DBG] Client validation success
2019-08-05 14:32:06.383 +03:00 [DBG] Start token request validation
2019-08-05 14:32:06.404 +03:00 [DBG] Start resource owner password token request validation
2019-08-05 14:32:06.448 +03:00 [DBG] Resource owner password token request validation success.
2019-08-05 14:32:06.469 +03:00 [INF] Token request validation success, {"ClientId":"ro.client","ClientName":null,"GrantType":"password","Scopes":"afcpayroll test_identity","AuthorizationCode":null,"RefreshToken":null,"UserName":"alice","AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"password","username":"alice","password":"***REDACTED***","scope":"afcpayroll test_identity","client_id":"ro.client","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2019-08-05 14:32:06.548 +03:00 [DBG] Getting claims for access token for client: ro.client
2019-08-05 14:32:06.555 +03:00 [DBG] Getting claims for access token for subject: 1
2019-08-05 14:32:13.551 +03:00 [DBG] Token request success.
2019-08-05 14:32:17.647 +03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-08-05 14:32:17.652 +03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-08-05 14:32:17.655 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-08-05 14:32:17.667 +03:00 [DBG] Start userinfo request
2019-08-05 14:32:17.673 +03:00 [DBG] Bearer token found in header
2019-08-05 14:32:17.757 +03:00 [DBG] client configuration validation for client ro.client succeeded.
2019-08-05 14:32:17.766 +03:00 [DBG] client configuration validation for client ro.client succeeded.
2019-08-05 14:32:17.774 +03:00 [ERR] Checking for expected scope openid failed
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1565004733,"exp":1565008333,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","afcpayroll"],"client_id":"ro.client","sub":"1","auth_time":1565004726,"idp":"local","name":"alice","email":"alice@email.com","scope":["test_identity","afcpayroll"],"amr":"Bearer"},"$type":"TokenValidationLog"}
2019-08-05 14:33:04.420 +03:00 [INF] Starting IdentityServer4 version 2.5.0.0
2019-08-05 14:33:04.495 +03:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2019-08-05 14:33:04.511 +03:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2019-08-05 14:33:04.512 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for authentication
2019-08-05 14:33:04.512 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-in
2019-08-05 14:33:04.513 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-out
2019-08-05 14:33:04.513 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for challenge
2019-08-05 14:33:04.513 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for forbid
2019-08-05 14:33:20.943 +03:00 [DBG] Login Url: /Account/Login
2019-08-05 14:33:20.947 +03:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-08-05 14:33:20.948 +03:00 [DBG] Logout Url: /Account/Logout
2019-08-05 14:33:20.948 +03:00 [DBG] ConsentUrl Url: /consent
2019-08-05 14:33:20.949 +03:00 [DBG] Consent Return Url Parameter: returnUrl
2019-08-05 14:33:20.949 +03:00 [DBG] Error Url: /home/error
2019-08-05 14:33:20.950 +03:00 [DBG] Error Id Parameter: errorId
2019-08-05 14:33:21.005 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-05 14:33:21.014 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-05 14:33:21.015 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-05 14:33:21.025 +03:00 [DBG] Start discovery request
2019-08-05 14:33:21.299 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-05 14:33:21.321 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-05 14:33:21.325 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-05 14:33:21.336 +03:00 [DBG] Start key discovery request
2019-08-05 14:33:21.808 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-05 14:33:21.821 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-05 14:33:21.824 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-05 14:33:21.838 +03:00 [DBG] Start token request.
2019-08-05 14:33:21.847 +03:00 [DBG] Start client validation
2019-08-05 14:33:21.856 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-05 14:33:21.862 +03:00 [DBG] Start parsing for secret in post body
2019-08-05 14:33:21.893 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-05 14:33:21.893 +03:00 [DBG] Secret id found: ro.client
2019-08-05 14:33:21.935 +03:00 [DBG] client configuration validation for client ro.client succeeded.
2019-08-05 14:33:21.952 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-05 14:33:21.953 +03:00 [DBG] Client validation success
2019-08-05 14:33:21.981 +03:00 [DBG] Start token request validation
2019-08-05 14:33:22.005 +03:00 [DBG] Start resource owner password token request validation
2019-08-05 14:33:22.047 +03:00 [DBG] Resource owner password token request validation success.
2019-08-05 14:33:22.067 +03:00 [INF] Token request validation success, {"ClientId":"ro.client","ClientName":null,"GrantType":"password","Scopes":"afcpayroll test_identity","AuthorizationCode":null,"RefreshToken":null,"UserName":"alice","AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"password","username":"alice","password":"***REDACTED***","scope":"afcpayroll test_identity","client_id":"ro.client","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2019-08-05 14:33:22.138 +03:00 [DBG] Getting claims for access token for client: ro.client
2019-08-05 14:33:22.139 +03:00 [DBG] Getting claims for access token for subject: 1
2019-08-05 14:33:36.416 +03:00 [DBG] Token request success.
2019-08-05 14:33:42.465 +03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-08-05 14:33:42.473 +03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-08-05 14:33:42.474 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-08-05 14:33:42.488 +03:00 [DBG] Start userinfo request
2019-08-05 14:33:42.494 +03:00 [DBG] Bearer token found in header
2019-08-05 14:33:42.585 +03:00 [DBG] client configuration validation for client ro.client succeeded.
2019-08-05 14:33:42.593 +03:00 [DBG] client configuration validation for client ro.client succeeded.
2019-08-05 14:33:42.599 +03:00 [ERR] Checking for expected scope openid failed
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1565004816,"exp":1565008416,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","afcpayroll"],"client_id":"ro.client","sub":"1","auth_time":1565004802,"idp":"local","name":"alice","email":"alice@email.com","scope":["test_identity","afcpayroll"],"amr":"Bearer"},"$type":"TokenValidationLog"}
2019-08-05 14:34:01.129 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-05 14:34:01.133 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-05 14:34:01.138 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-05 14:34:01.139 +03:00 [DBG] Start discovery request
2019-08-05 14:34:01.302 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-05 14:34:01.305 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-05 14:34:01.309 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-05 14:34:01.311 +03:00 [DBG] Start key discovery request
2019-08-05 14:34:01.780 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-05 14:34:01.784 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-05 14:34:01.788 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-05 14:34:01.790 +03:00 [DBG] Start token request.
2019-08-05 14:34:01.794 +03:00 [DBG] Start client validation
2019-08-05 14:34:01.795 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-05 14:34:01.799 +03:00 [DBG] Start parsing for secret in post body
2019-08-05 14:34:01.801 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-05 14:34:01.801 +03:00 [DBG] Secret id found: ro.client
2019-08-05 14:34:01.802 +03:00 [DBG] client configuration validation for client ro.client succeeded.
2019-08-05 14:34:01.809 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-05 14:34:01.813 +03:00 [DBG] Client validation success
2019-08-05 14:34:01.815 +03:00 [DBG] Start token request validation
2019-08-05 14:34:01.816 +03:00 [DBG] Start resource owner password token request validation
2019-08-05 14:34:01.821 +03:00 [DBG] Resource owner password token request validation success.
2019-08-05 14:34:01.822 +03:00 [INF] Token request validation success, {"ClientId":"ro.client","ClientName":null,"GrantType":"password","Scopes":"afcpayroll openid test_identity","AuthorizationCode":null,"RefreshToken":null,"UserName":"alice","AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"password","username":"alice","password":"***REDACTED***","scope":"afcpayroll test_identity openid","client_id":"ro.client","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2019-08-05 14:34:01.833 +03:00 [DBG] Getting claims for access token for client: ro.client
2019-08-05 14:34:01.834 +03:00 [DBG] Getting claims for access token for subject: 1
2019-08-05 14:34:03.289 +03:00 [DBG] Token request success.
2019-08-05 14:34:05.505 +03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-08-05 14:34:05.511 +03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-08-05 14:34:05.513 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-08-05 14:34:05.517 +03:00 [DBG] Start userinfo request
2019-08-05 14:34:05.522 +03:00 [DBG] Bearer token found in header
2019-08-05 14:34:05.527 +03:00 [DBG] client configuration validation for client ro.client succeeded.
2019-08-05 14:34:05.531 +03:00 [DBG] client configuration validation for client ro.client succeeded.
2019-08-05 14:34:05.535 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-08-05 14:34:05.538 +03:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1565004843,"exp":1565008443,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","afcpayroll"],"client_id":"ro.client","sub":"1","auth_time":1565004841,"idp":"local","name":"alice","email":"alice@email.com","scope":["openid","test_identity","afcpayroll"],"amr":"Bearer"},"$type":"TokenValidationLog"}
2019-08-05 14:34:05.565 +03:00 [DBG] Creating userinfo response
2019-08-05 14:34:05.573 +03:00 [DBG] Scopes in access token: openid test_identity afcpayroll
2019-08-05 14:34:05.582 +03:00 [DBG] Scopes in access token: openid test_identity afcpayroll
2019-08-05 14:34:05.594 +03:00 [DBG] Requested claim types: sub phone sex
2019-08-05 14:34:05.595 +03:00 [DBG] Scopes in access token: openid test_identity afcpayroll
2019-08-05 14:34:59.981 +03:00 [INF] Starting IdentityServer4 version 2.5.0.0
2019-08-05 14:35:00.046 +03:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2019-08-05 14:35:00.060 +03:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2019-08-05 14:35:00.061 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for authentication
2019-08-05 14:35:00.061 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-in
2019-08-05 14:35:00.062 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-out
2019-08-05 14:35:00.062 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for challenge
2019-08-05 14:35:00.063 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for forbid
2019-08-05 14:35:08.001 +03:00 [DBG] Login Url: /Account/Login
2019-08-05 14:35:08.008 +03:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-08-05 14:35:08.009 +03:00 [DBG] Logout Url: /Account/Logout
2019-08-05 14:35:08.010 +03:00 [DBG] ConsentUrl Url: /consent
2019-08-05 14:35:08.010 +03:00 [DBG] Consent Return Url Parameter: returnUrl
2019-08-05 14:35:08.010 +03:00 [DBG] Error Url: /home/error
2019-08-05 14:35:08.011 +03:00 [DBG] Error Id Parameter: errorId
2019-08-05 14:35:08.074 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-05 14:35:08.082 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-05 14:35:08.086 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-05 14:35:08.096 +03:00 [DBG] Start discovery request
2019-08-05 14:35:08.358 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-05 14:35:08.369 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-05 14:35:08.371 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-05 14:35:08.383 +03:00 [DBG] Start key discovery request
2019-08-05 14:35:08.896 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-05 14:35:08.915 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-05 14:35:08.917 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-05 14:35:08.938 +03:00 [DBG] Start token request.
2019-08-05 14:35:08.953 +03:00 [DBG] Start client validation
2019-08-05 14:35:08.964 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-05 14:35:08.970 +03:00 [DBG] Start parsing for secret in post body
2019-08-05 14:35:09.004 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-05 14:35:09.005 +03:00 [DBG] Secret id found: ro.client
2019-08-05 14:35:09.043 +03:00 [DBG] client configuration validation for client ro.client succeeded.
2019-08-05 14:35:09.067 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-05 14:35:09.067 +03:00 [DBG] Client validation success
2019-08-05 14:35:09.100 +03:00 [DBG] Start token request validation
2019-08-05 14:35:09.121 +03:00 [DBG] Start resource owner password token request validation
2019-08-05 14:35:09.162 +03:00 [DBG] Resource owner password token request validation success.
2019-08-05 14:35:09.183 +03:00 [INF] Token request validation success, {"ClientId":"ro.client","ClientName":null,"GrantType":"password","Scopes":"afcpayroll openid test_identity","AuthorizationCode":null,"RefreshToken":null,"UserName":"alice","AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"password","username":"alice","password":"***REDACTED***","scope":"afcpayroll test_identity openid","client_id":"ro.client","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2019-08-05 14:35:09.254 +03:00 [DBG] Getting claims for access token for client: ro.client
2019-08-05 14:35:09.262 +03:00 [DBG] Getting claims for access token for subject: 1
2019-08-05 14:35:13.003 +03:00 [DBG] Token request success.
2019-08-05 14:35:15.527 +03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-08-05 14:35:15.532 +03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-08-05 14:35:15.535 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-08-05 14:35:15.551 +03:00 [DBG] Start userinfo request
2019-08-05 14:35:15.560 +03:00 [DBG] Bearer token found in header
2019-08-05 14:35:15.649 +03:00 [DBG] client configuration validation for client ro.client succeeded.
2019-08-05 14:35:15.657 +03:00 [DBG] client configuration validation for client ro.client succeeded.
2019-08-05 14:35:15.663 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-08-05 14:35:15.671 +03:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1565004912,"exp":1565008512,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","afcpayroll"],"client_id":"ro.client","sub":"1","auth_time":1565004909,"idp":"local","name":"alice","email":"alice@email.com","scope":["openid","test_identity","afcpayroll"],"amr":"Bearer"},"$type":"TokenValidationLog"}
2019-08-05 14:35:15.695 +03:00 [DBG] Creating userinfo response
2019-08-05 14:35:15.700 +03:00 [DBG] Scopes in access token: openid test_identity afcpayroll
2019-08-05 14:35:15.705 +03:00 [DBG] Scopes in access token: openid test_identity afcpayroll
2019-08-05 14:35:15.711 +03:00 [DBG] Requested claim types: sub phone sex
2019-08-05 14:35:15.711 +03:00 [DBG] Scopes in access token: openid test_identity afcpayroll
2019-08-05 14:35:26.373 +03:00 [INF] Profile service returned the following claim types: sub phone sex
2019-08-05 14:35:26.378 +03:00 [DBG] End userinfo request
2019-08-05 14:55:57.903 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-05 14:55:57.907 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-05 14:55:57.909 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-05 14:55:57.911 +03:00 [DBG] Start discovery request
2019-08-05 15:41:06.351 +03:00 [INF] Starting IdentityServer4 version 2.5.0.0
2019-08-05 15:41:06.415 +03:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2019-08-05 15:41:06.429 +03:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2019-08-05 15:41:06.430 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for authentication
2019-08-05 15:41:06.430 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-in
2019-08-05 15:41:06.430 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-out
2019-08-05 15:41:06.431 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for challenge
2019-08-05 15:41:06.431 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for forbid
2019-08-05 15:43:07.542 +03:00 [INF] Starting IdentityServer4 version 2.5.0.0
2019-08-05 15:43:07.628 +03:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2019-08-05 15:43:07.646 +03:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2019-08-05 15:43:07.647 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for authentication
2019-08-05 15:43:07.647 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-in
2019-08-05 15:43:07.648 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-out
2019-08-05 15:43:07.648 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for challenge
2019-08-05 15:43:07.651 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for forbid
2019-08-05 15:43:44.465 +03:00 [DBG] Login Url: /Account/Login
2019-08-05 15:43:44.469 +03:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-08-05 15:43:44.470 +03:00 [DBG] Logout Url: /Account/Logout
2019-08-05 15:43:44.471 +03:00 [DBG] ConsentUrl Url: /consent
2019-08-05 15:43:44.471 +03:00 [DBG] Consent Return Url Parameter: returnUrl
2019-08-05 15:43:44.472 +03:00 [DBG] Error Url: /home/error
2019-08-05 15:43:44.472 +03:00 [DBG] Error Id Parameter: errorId
2019-08-05 15:43:44.526 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-05 15:43:44.531 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-05 15:43:44.532 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-05 15:43:44.537 +03:00 [DBG] Start discovery request
2019-08-05 15:43:44.742 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-05 15:43:44.750 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-05 15:43:44.751 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-05 15:43:44.757 +03:00 [DBG] Start key discovery request
2019-08-05 15:43:44.879 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-08-05 15:43:46.287 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-08-05 15:43:46.292 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-08-05 15:43:46.299 +03:00 [DBG] Start authorize request
2019-08-05 15:43:46.314 +03:00 [DBG] No user present in authorize request
2019-08-05 15:43:46.322 +03:00 [DBG] Start authorize request protocol validation
2019-08-05 15:43:46.360 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-05 15:43:46.401 +03:00 [ERR] Invalid redirect_uri: http://localhost:57002/signin-oidc
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":null,"AllowedRedirectUris":["http://localhost:5002/signin-oidc"],"SubjectId":"anonymous","ResponseType":null,"ResponseMode":null,"GrantType":null,"RequestedScopes":"","State":null,"UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"mvc","redirect_uri":"http://localhost:57002/signin-oidc","response_type":"id_token","scope":"openid profile","response_mode":"form_post","nonce":"637006058248073451.NjY3OTA1MDctNjUxYy00YmZlLWI1YjgtOThjM2Q0MjYwMDUyMmVlNmE5MjQtNDI5My00NTgzLTg4NTYtZWZmZTQxM2YxMDJk","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9Nx9ydY4kNtf_ocU3OfyjAUChkyPLcnxLfWgZfrRxKlLSu8clWWKcSy9T7LPf6UAu_MV2KvWWEvAOYty889ngAo6nNCKiwGDzooYZGZ8AuY1Q2AnY6XLtlsQe9Kp6bt-GQkA6kS5kbAeqQ4Q6V07PfGRbmN-dZ2R6oWNXLDruMIry9OFJRMI8TZcLfyGjBmd8Phpj1JLzm5AyzLKj3txh4sUsv2_LCFAKMSOlpvpYUYVq6qiiZqGJS96sTQNpCNltUVsEpoK1PDMaAqWzrD_J6aR2ObQkOKaFp20JkzoFs3dQ","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-05 15:43:46.450 +03:00 [ERR] Request validation failed
2019-08-05 15:43:46.450 +03:00 [INF] {"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":null,"AllowedRedirectUris":["http://localhost:5002/signin-oidc"],"SubjectId":"anonymous","ResponseType":null,"ResponseMode":null,"GrantType":null,"RequestedScopes":"","State":null,"UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"mvc","redirect_uri":"http://localhost:57002/signin-oidc","response_type":"id_token","scope":"openid profile","response_mode":"form_post","nonce":"637006058248073451.NjY3OTA1MDctNjUxYy00YmZlLWI1YjgtOThjM2Q0MjYwMDUyMmVlNmE5MjQtNDI5My00NTgzLTg4NTYtZWZmZTQxM2YxMDJk","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9Nx9ydY4kNtf_ocU3OfyjAUChkyPLcnxLfWgZfrRxKlLSu8clWWKcSy9T7LPf6UAu_MV2KvWWEvAOYty889ngAo6nNCKiwGDzooYZGZ8AuY1Q2AnY6XLtlsQe9Kp6bt-GQkA6kS5kbAeqQ4Q6V07PfGRbmN-dZ2R6oWNXLDruMIry9OFJRMI8TZcLfyGjBmd8Phpj1JLzm5AyzLKj3txh4sUsv2_LCFAKMSOlpvpYUYVq6qiiZqGJS96sTQNpCNltUVsEpoK1PDMaAqWzrD_J6aR2ObQkOKaFp20JkzoFs3dQ","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-06 08:56:58.348 +03:00 [INF] Starting IdentityServer4 version 2.5.0.0
2019-08-06 08:56:58.493 +03:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2019-08-06 08:56:58.541 +03:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2019-08-06 08:56:58.543 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for authentication
2019-08-06 08:56:58.543 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-in
2019-08-06 08:56:58.544 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-out
2019-08-06 08:56:58.545 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for challenge
2019-08-06 08:56:58.545 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for forbid
2019-08-06 08:57:33.112 +03:00 [DBG] Login Url: /Account/Login
2019-08-06 08:57:33.126 +03:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-08-06 08:57:33.132 +03:00 [DBG] Logout Url: /Account/Logout
2019-08-06 08:57:33.133 +03:00 [DBG] ConsentUrl Url: /consent
2019-08-06 08:57:33.140 +03:00 [DBG] Consent Return Url Parameter: returnUrl
2019-08-06 08:57:33.141 +03:00 [DBG] Error Url: /home/error
2019-08-06 08:57:33.141 +03:00 [DBG] Error Id Parameter: errorId
2019-08-06 08:57:33.379 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-06 08:57:33.393 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-06 08:57:33.398 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-06 08:57:33.414 +03:00 [DBG] Start discovery request
2019-08-06 08:57:33.779 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-06 08:57:33.813 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-06 08:57:33.820 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-06 08:57:33.832 +03:00 [DBG] Start key discovery request
2019-08-06 08:57:34.395 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-08-06 08:57:34.822 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-08-06 08:57:34.902 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-08-06 08:57:35.030 +03:00 [DBG] Start authorize request
2019-08-06 08:57:35.071 +03:00 [DBG] No user present in authorize request
2019-08-06 08:57:35.112 +03:00 [DBG] Start authorize request protocol validation
2019-08-06 08:57:47.528 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-06 08:57:47.607 +03:00 [ERR] Invalid redirect_uri: http://localhost:57002/signin-oidc
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":null,"AllowedRedirectUris":["http://localhost:5002/signin-oidc"],"SubjectId":"anonymous","ResponseType":null,"ResponseMode":null,"GrantType":null,"RequestedScopes":"","State":null,"UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"mvc","redirect_uri":"http://localhost:57002/signin-oidc","response_type":"id_token","scope":"openid profile","response_mode":"form_post","nonce":"637006678539275329.ZTU0MDBmOWUtZWYwOS00M2U3LTlhMTgtNzEyNmMxZjI3YjVmY2M0ZGVmYTMtMGZhYy00MjJhLTkzNGMtNGM3Yjk3ZmQ2NGZh","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9MyX_G6IfhH2ZYub2qV3RIvSLE8sRNxuZzi7oZCHfvL2zujd26PlsT_76S5Z8H8vE-Hv9oSMJSO1TxxAqOZYyR3MSI2pIOWAB1fcLAt4CaHBihHFDooserr4RSfCRFqwOLaDhMXHj1O2SRAt_I43yf0kMZELJNw2OcejLAmSIkNRiuRjCfHdX8-Ou7auZ69K1eDh5hYOx4cPNcf6wzR9-Y67Y7_wdOlTOWAZ_kujR8WmJyXRJtsMVsjQXtkL8y5DiOVXnqB4a94_dE16CukX10iYtsXEFGPu0MPecGEVSLAlA","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-06 08:57:47.857 +03:00 [ERR] Request validation failed
2019-08-06 08:57:47.858 +03:00 [INF] {"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":null,"AllowedRedirectUris":["http://localhost:5002/signin-oidc"],"SubjectId":"anonymous","ResponseType":null,"ResponseMode":null,"GrantType":null,"RequestedScopes":"","State":null,"UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"mvc","redirect_uri":"http://localhost:57002/signin-oidc","response_type":"id_token","scope":"openid profile","response_mode":"form_post","nonce":"637006678539275329.ZTU0MDBmOWUtZWYwOS00M2U3LTlhMTgtNzEyNmMxZjI3YjVmY2M0ZGVmYTMtMGZhYy00MjJhLTkzNGMtNGM3Yjk3ZmQ2NGZh","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9MyX_G6IfhH2ZYub2qV3RIvSLE8sRNxuZzi7oZCHfvL2zujd26PlsT_76S5Z8H8vE-Hv9oSMJSO1TxxAqOZYyR3MSI2pIOWAB1fcLAt4CaHBihHFDooserr4RSfCRFqwOLaDhMXHj1O2SRAt_I43yf0kMZELJNw2OcejLAmSIkNRiuRjCfHdX8-Ou7auZ69K1eDh5hYOx4cPNcf6wzR9-Y67Y7_wdOlTOWAZ_kujR8WmJyXRJtsMVsjQXtkL8y5DiOVXnqB4a94_dE16CukX10iYtsXEFGPu0MPecGEVSLAlA","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-06 08:59:00.161 +03:00 [INF] Starting IdentityServer4 version 2.5.0.0
2019-08-06 08:59:00.264 +03:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2019-08-06 08:59:00.323 +03:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2019-08-06 08:59:00.328 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for authentication
2019-08-06 08:59:00.333 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-in
2019-08-06 08:59:00.338 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-out
2019-08-06 08:59:00.341 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for challenge
2019-08-06 08:59:00.348 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for forbid
2019-08-06 08:59:19.006 +03:00 [DBG] Login Url: /Account/Login
2019-08-06 08:59:19.010 +03:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-08-06 08:59:19.011 +03:00 [DBG] Logout Url: /Account/Logout
2019-08-06 08:59:19.011 +03:00 [DBG] ConsentUrl Url: /consent
2019-08-06 08:59:19.011 +03:00 [DBG] Consent Return Url Parameter: returnUrl
2019-08-06 08:59:19.012 +03:00 [DBG] Error Url: /home/error
2019-08-06 08:59:19.012 +03:00 [DBG] Error Id Parameter: errorId
2019-08-06 08:59:19.084 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-06 08:59:19.097 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-06 08:59:19.141 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-06 08:59:19.152 +03:00 [DBG] Start discovery request
2019-08-06 08:59:19.392 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-06 08:59:19.403 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-06 08:59:19.411 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-06 08:59:19.419 +03:00 [DBG] Start key discovery request
2019-08-06 08:59:19.651 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-08-06 08:59:19.702 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-08-06 08:59:19.709 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-08-06 08:59:19.716 +03:00 [DBG] Start authorize request
2019-08-06 08:59:19.733 +03:00 [DBG] No user present in authorize request
2019-08-06 08:59:19.745 +03:00 [DBG] Start authorize request protocol validation
2019-08-06 08:59:24.125 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-06 08:59:37.612 +03:00 [ERR] Invalid scope: profile
2019-08-06 08:59:37.621 +03:00 [ERR] Request validation failed
2019-08-06 08:59:37.647 +03:00 [INF] {"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/signin-oidc","AllowedRedirectUris":["http://localhost:5002/signin-oidc"],"SubjectId":"anonymous","ResponseType":"id_token","ResponseMode":"form_post","GrantType":"implicit","RequestedScopes":"openid profile","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9P3lvvJRSMP1z5ii_VXqKI5I2Y1AC8xQKsdrnn2pjRt2ZUIekocNLcZVHstdwIUasS1IYIqcL_ErK6CWgm_CeNqO5rNsem-QCLw1qiu4csp0aCcdY9Rz_WAGeJ4BlFL6kqGL9lcI_d5Iv-4YFaatAk8ohuX4j6Y39ssV6y_soddCFovWIQRLjSbxrLdRmk1zaAq9HxrKzMUUVh6HXCMgovJSUEmrdosHrjGDTn91BJ_SoEQ3t8xnQ-AJzsNclnwCTHSuiih23zxNGiAAJjp88czoUTXGAlwShexGTutJqc5NQ","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/signin-oidc","response_type":"id_token","scope":"openid profile","response_mode":"form_post","nonce":"637006679594783484.NmVlYzNhYjYtOTdjOS00ZWUzLWJiYzMtN2U5NWVkMzQ5ZjJmNmE2MzM5MTYtMmNlYy00NmRmLThiMTEtZGMzYTYyNzMxNDY0","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9P3lvvJRSMP1z5ii_VXqKI5I2Y1AC8xQKsdrnn2pjRt2ZUIekocNLcZVHstdwIUasS1IYIqcL_ErK6CWgm_CeNqO5rNsem-QCLw1qiu4csp0aCcdY9Rz_WAGeJ4BlFL6kqGL9lcI_d5Iv-4YFaatAk8ohuX4j6Y39ssV6y_soddCFovWIQRLjSbxrLdRmk1zaAq9HxrKzMUUVh6HXCMgovJSUEmrdosHrjGDTn91BJ_SoEQ3t8xnQ-AJzsNclnwCTHSuiih23zxNGiAAJjp88czoUTXGAlwShexGTutJqc5NQ","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-06 09:02:49.119 +03:00 [INF] Starting IdentityServer4 version 2.5.0.0
2019-08-06 09:02:49.178 +03:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2019-08-06 09:02:49.192 +03:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2019-08-06 09:02:49.192 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for authentication
2019-08-06 09:02:49.193 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-in
2019-08-06 09:02:49.193 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-out
2019-08-06 09:02:49.194 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for challenge
2019-08-06 09:02:49.194 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for forbid
2019-08-06 09:02:51.767 +03:00 [DBG] Login Url: /Account/Login
2019-08-06 09:02:51.770 +03:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-08-06 09:02:51.771 +03:00 [DBG] Logout Url: /Account/Logout
2019-08-06 09:02:51.771 +03:00 [DBG] ConsentUrl Url: /consent
2019-08-06 09:02:51.772 +03:00 [DBG] Consent Return Url Parameter: returnUrl
2019-08-06 09:02:51.772 +03:00 [DBG] Error Url: /home/error
2019-08-06 09:02:51.772 +03:00 [DBG] Error Id Parameter: errorId
2019-08-06 09:02:51.824 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-08-06 09:02:51.862 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-08-06 09:02:51.869 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-08-06 09:02:51.878 +03:00 [DBG] Start authorize request
2019-08-06 09:02:51.904 +03:00 [DBG] No user present in authorize request
2019-08-06 09:02:51.925 +03:00 [DBG] Start authorize request protocol validation
2019-08-06 09:03:06.714 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-06 09:03:22.434 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-06 09:03:22.460 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/signin-oidc","AllowedRedirectUris":["http://localhost:5002/signin-oidc"],"SubjectId":"anonymous","ResponseType":"id_token","ResponseMode":"form_post","GrantType":"implicit","RequestedScopes":"openid profile","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9MYTWrrEaDLIYbFsiZNtES-_y8s4Apr40sxSWkBeBAtxRPFORY47ECz2burNgYDB4de8pNTyUOnXxTT5M81TVFi3zkWVxR5S9Q7pJC4PfFd_37TLlkYO7eQz3hWWzzqYIEkM3Dfkq79I_poZqVNtEMdL5vFvqWessv_qXug6_oG0VfL7H8v-syPq584TXk6E4jR8gfj7i-QRqAW90RJwpHa-r6xj_LbRFgkIDEA_kFMc-wMNLmabix-DvVaOlWB2VQtf-H_XuuwU2SzsYDzkQ54-n6OXQx7OVFgeHKoCTBgxQ","UiLocales":null,"Nonce":"637006681715391001.MmI2OTE3ZGEtNGFiNy00NDQ0LTg5ZTAtOWU0OTdjN2ZhOTdiMDBhZmIwMzItZDRlNS00OWQ1LThmNGItNGNiOWYwYjhiZjll","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/signin-oidc","response_type":"id_token","scope":"openid profile","response_mode":"form_post","nonce":"637006681715391001.MmI2OTE3ZGEtNGFiNy00NDQ0LTg5ZTAtOWU0OTdjN2ZhOTdiMDBhZmIwMzItZDRlNS00OWQ1LThmNGItNGNiOWYwYjhiZjll","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9MYTWrrEaDLIYbFsiZNtES-_y8s4Apr40sxSWkBeBAtxRPFORY47ECz2burNgYDB4de8pNTyUOnXxTT5M81TVFi3zkWVxR5S9Q7pJC4PfFd_37TLlkYO7eQz3hWWzzqYIEkM3Dfkq79I_poZqVNtEMdL5vFvqWessv_qXug6_oG0VfL7H8v-syPq584TXk6E4jR8gfj7i-QRqAW90RJwpHa-r6xj_LbRFgkIDEA_kFMc-wMNLmabix-DvVaOlWB2VQtf-H_XuuwU2SzsYDzkQ54-n6OXQx7OVFgeHKoCTBgxQ","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-06 09:03:22.533 +03:00 [INF] Showing login: User is not authenticated
2019-08-06 09:04:48.641 +03:00 [INF] Starting IdentityServer4 version 2.5.0.0
2019-08-06 09:04:48.710 +03:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2019-08-06 09:04:48.723 +03:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2019-08-06 09:04:48.723 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for authentication
2019-08-06 09:04:48.724 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-in
2019-08-06 09:04:48.724 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-out
2019-08-06 09:04:48.724 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for challenge
2019-08-06 09:04:48.725 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for forbid
2019-08-06 09:14:14.120 +03:00 [INF] Starting IdentityServer4 version 2.5.0.0
2019-08-06 09:15:33.641 +03:00 [INF] Starting IdentityServer4 version 2.5.0.0
2019-08-06 09:15:33.705 +03:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2019-08-06 09:15:33.718 +03:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2019-08-06 09:15:33.719 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for authentication
2019-08-06 09:15:33.719 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-in
2019-08-06 09:15:33.720 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-out
2019-08-06 09:15:33.720 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for challenge
2019-08-06 09:15:33.720 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for forbid
2019-08-06 09:15:36.439 +03:00 [DBG] Login Url: /account/login
2019-08-06 09:15:36.443 +03:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-08-06 09:15:36.444 +03:00 [DBG] Logout Url: /Account/Logout
2019-08-06 09:15:36.444 +03:00 [DBG] ConsentUrl Url: /consent
2019-08-06 09:15:36.444 +03:00 [DBG] Consent Return Url Parameter: returnUrl
2019-08-06 09:15:36.445 +03:00 [DBG] Error Url: /home/error
2019-08-06 09:15:36.445 +03:00 [DBG] Error Id Parameter: errorId
2019-08-06 09:15:36.506 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-08-06 09:15:36.548 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-08-06 09:15:36.553 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-08-06 09:15:36.563 +03:00 [DBG] Start authorize request
2019-08-06 09:15:36.589 +03:00 [DBG] No user present in authorize request
2019-08-06 09:15:36.613 +03:00 [DBG] Start authorize request protocol validation
2019-08-06 09:15:40.841 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-06 09:15:45.366 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-06 09:15:45.392 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/signin-oidc","AllowedRedirectUris":["http://localhost:5002/signin-oidc"],"SubjectId":"anonymous","ResponseType":"id_token","ResponseMode":"form_post","GrantType":"implicit","RequestedScopes":"openid profile","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9OTrl86uVQhXrEcVvJT8blNk9VZUmoSEKoH6HReL9E2C0Mh8hr0HFv1lCWjq_sLNNJ2kJgoTkqMC4AUpC-1HsqllZaQFp3c-bCs4cl6tfMfu36nhI7m4NGxHZHvi-kdf8h9SbAKum_J-C4TkB7IBoLDnr4keWAXTIsuycp6MBKCyN7XvDjYtU8MYDHM8nayDpngRNhsgsr7WzpTLugNP9aH5Fg4V_Izsh4Uj8KTdRr7cBjdL_NF6MIutpkqE013wtPxwg9F9d_AJaDj60MGC2g2EOoe0nZ9h0bTv0piLHrhvw","UiLocales":null,"Nonce":"637006689361812796.ZGRkN2UyODUtMGU5OC00MGMzLWI4OTItM2JmYWVlM2Q5MDBhNTc5NDZlODYtM2U0OC00NmMwLTljNGMtNGVlZWJiZmNmMjc2","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/signin-oidc","response_type":"id_token","scope":"openid profile","response_mode":"form_post","nonce":"637006689361812796.ZGRkN2UyODUtMGU5OC00MGMzLWI4OTItM2JmYWVlM2Q5MDBhNTc5NDZlODYtM2U0OC00NmMwLTljNGMtNGVlZWJiZmNmMjc2","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9OTrl86uVQhXrEcVvJT8blNk9VZUmoSEKoH6HReL9E2C0Mh8hr0HFv1lCWjq_sLNNJ2kJgoTkqMC4AUpC-1HsqllZaQFp3c-bCs4cl6tfMfu36nhI7m4NGxHZHvi-kdf8h9SbAKum_J-C4TkB7IBoLDnr4keWAXTIsuycp6MBKCyN7XvDjYtU8MYDHM8nayDpngRNhsgsr7WzpTLugNP9aH5Fg4V_Izsh4Uj8KTdRr7cBjdL_NF6MIutpkqE013wtPxwg9F9d_AJaDj60MGC2g2EOoe0nZ9h0bTv0piLHrhvw","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-06 09:15:45.463 +03:00 [INF] Showing login: User is not authenticated
2019-08-06 09:16:35.168 +03:00 [DBG] Start authorize request protocol validation
2019-08-06 09:16:45.856 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-06 09:16:52.707 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-06 09:18:17.058 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-06 09:19:21.800 +03:00 [DBG] CORS request made for path: /account/login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-08-06 09:19:32.441 +03:00 [DBG] Start authorize request protocol validation
2019-08-06 09:19:43.084 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-06 09:19:50.562 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-06 09:20:59.473 +03:00 [DBG] Start authorize request protocol validation
2019-08-06 09:21:00.591 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-06 09:21:03.457 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-06 09:21:07.694 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-06 09:27:56.732 +03:00 [INF] Starting IdentityServer4 version 2.5.0.0
2019-08-06 09:27:56.793 +03:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2019-08-06 09:27:56.808 +03:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2019-08-06 09:27:56.808 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for authentication
2019-08-06 09:27:56.809 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-in
2019-08-06 09:27:56.809 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-out
2019-08-06 09:27:56.810 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for challenge
2019-08-06 09:27:56.810 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for forbid
2019-08-06 09:28:00.736 +03:00 [DBG] CORS request made for path: /account/login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-08-06 09:28:00.762 +03:00 [DBG] Login Url: /account/login
2019-08-06 09:28:00.762 +03:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-08-06 09:28:00.763 +03:00 [DBG] Logout Url: /Account/Logout
2019-08-06 09:28:00.763 +03:00 [DBG] ConsentUrl Url: /consent
2019-08-06 09:28:00.763 +03:00 [DBG] Consent Return Url Parameter: returnUrl
2019-08-06 09:28:00.764 +03:00 [DBG] Error Url: /home/error
2019-08-06 09:28:00.765 +03:00 [DBG] Error Id Parameter: errorId
2019-08-06 09:28:01.213 +03:00 [DBG] Start authorize request protocol validation
2019-08-06 09:28:01.244 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-06 09:28:01.324 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-06 09:28:43.352 +03:00 [DBG] Augmenting SignInContext
2019-08-06 09:28:43.357 +03:00 [DBG] Adding idp claim with value: local
2019-08-06 09:28:43.358 +03:00 [DBG] Adding amr claim with value: pwd
2019-08-06 09:28:43.377 +03:00 [INF] AuthenticationScheme: idsrv signed in.
2019-08-06 09:28:56.941 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-06 09:29:22.471 +03:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-08-06 09:29:22.489 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-08-06 09:29:22.493 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-08-06 09:29:22.509 +03:00 [DBG] Start authorize callback request
2019-08-06 09:29:22.527 +03:00 [DBG] User in authorize request: 1
2019-08-06 09:29:22.528 +03:00 [DBG] Start authorize request protocol validation
2019-08-06 09:29:22.532 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-06 09:29:22.537 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-06 09:29:22.568 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/signin-oidc","AllowedRedirectUris":["http://localhost:5002/signin-oidc"],"SubjectId":"1","ResponseType":"id_token","ResponseMode":"form_post","GrantType":"implicit","RequestedScopes":"openid profile","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9OTrl86uVQhXrEcVvJT8blNk9VZUmoSEKoH6HReL9E2C0Mh8hr0HFv1lCWjq_sLNNJ2kJgoTkqMC4AUpC-1HsqllZaQFp3c-bCs4cl6tfMfu36nhI7m4NGxHZHvi-kdf8h9SbAKum_J-C4TkB7IBoLDnr4keWAXTIsuycp6MBKCyN7XvDjYtU8MYDHM8nayDpngRNhsgsr7WzpTLugNP9aH5Fg4V_Izsh4Uj8KTdRr7cBjdL_NF6MIutpkqE013wtPxwg9F9d_AJaDj60MGC2g2EOoe0nZ9h0bTv0piLHrhvw","UiLocales":null,"Nonce":"637006689361812796.ZGRkN2UyODUtMGU5OC00MGMzLWI4OTItM2JmYWVlM2Q5MDBhNTc5NDZlODYtM2U0OC00NmMwLTljNGMtNGVlZWJiZmNmMjc2","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"baf63867f322c5af2c392bdf07ae6679","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/signin-oidc","response_type":"id_token","scope":"openid profile","response_mode":"form_post","nonce":"637006689361812796.ZGRkN2UyODUtMGU5OC00MGMzLWI4OTItM2JmYWVlM2Q5MDBhNTc5NDZlODYtM2U0OC00NmMwLTljNGMtNGVlZWJiZmNmMjc2","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9OTrl86uVQhXrEcVvJT8blNk9VZUmoSEKoH6HReL9E2C0Mh8hr0HFv1lCWjq_sLNNJ2kJgoTkqMC4AUpC-1HsqllZaQFp3c-bCs4cl6tfMfu36nhI7m4NGxHZHvi-kdf8h9SbAKum_J-C4TkB7IBoLDnr4keWAXTIsuycp6MBKCyN7XvDjYtU8MYDHM8nayDpngRNhsgsr7WzpTLugNP9aH5Fg4V_Izsh4Uj8KTdRr7cBjdL_NF6MIutpkqE013wtPxwg9F9d_AJaDj60MGC2g2EOoe0nZ9h0bTv0piLHrhvw","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-06 09:29:22.664 +03:00 [DBG] user_consent grant with value: mvc|1 not found in store.
2019-08-06 09:29:22.667 +03:00 [DBG] Found no prior consent from consent store, consent is required
2019-08-06 09:29:22.668 +03:00 [INF] Showing consent: User has not yet consented
2019-08-06 09:29:22.749 +03:00 [DBG] Start authorize request protocol validation
2019-08-06 09:29:22.750 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-06 09:29:22.756 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-06 09:29:22.761 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-06 09:30:22.846 +03:00 [DBG] CORS request made for path: /consent from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-08-06 09:30:34.678 +03:00 [DBG] Start authorize request protocol validation
2019-08-06 09:30:34.678 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-06 09:30:34.686 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-06 09:30:44.142 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-06 09:30:47.075 +03:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-08-06 09:30:47.080 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-08-06 09:30:47.084 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-08-06 09:30:47.088 +03:00 [DBG] Start authorize callback request
2019-08-06 09:30:47.097 +03:00 [DBG] User in authorize request: 1
2019-08-06 09:30:47.097 +03:00 [DBG] Start authorize request protocol validation
2019-08-06 09:30:47.099 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-06 09:30:47.106 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-06 09:30:47.110 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/signin-oidc","AllowedRedirectUris":["http://localhost:5002/signin-oidc"],"SubjectId":"1","ResponseType":"id_token","ResponseMode":"form_post","GrantType":"implicit","RequestedScopes":"openid profile","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9OTrl86uVQhXrEcVvJT8blNk9VZUmoSEKoH6HReL9E2C0Mh8hr0HFv1lCWjq_sLNNJ2kJgoTkqMC4AUpC-1HsqllZaQFp3c-bCs4cl6tfMfu36nhI7m4NGxHZHvi-kdf8h9SbAKum_J-C4TkB7IBoLDnr4keWAXTIsuycp6MBKCyN7XvDjYtU8MYDHM8nayDpngRNhsgsr7WzpTLugNP9aH5Fg4V_Izsh4Uj8KTdRr7cBjdL_NF6MIutpkqE013wtPxwg9F9d_AJaDj60MGC2g2EOoe0nZ9h0bTv0piLHrhvw","UiLocales":null,"Nonce":"637006689361812796.ZGRkN2UyODUtMGU5OC00MGMzLWI4OTItM2JmYWVlM2Q5MDBhNTc5NDZlODYtM2U0OC00NmMwLTljNGMtNGVlZWJiZmNmMjc2","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"baf63867f322c5af2c392bdf07ae6679","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/signin-oidc","response_type":"id_token","scope":"openid profile","response_mode":"form_post","nonce":"637006689361812796.ZGRkN2UyODUtMGU5OC00MGMzLWI4OTItM2JmYWVlM2Q5MDBhNTc5NDZlODYtM2U0OC00NmMwLTljNGMtNGVlZWJiZmNmMjc2","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9OTrl86uVQhXrEcVvJT8blNk9VZUmoSEKoH6HReL9E2C0Mh8hr0HFv1lCWjq_sLNNJ2kJgoTkqMC4AUpC-1HsqllZaQFp3c-bCs4cl6tfMfu36nhI7m4NGxHZHvi-kdf8h9SbAKum_J-C4TkB7IBoLDnr4keWAXTIsuycp6MBKCyN7XvDjYtU8MYDHM8nayDpngRNhsgsr7WzpTLugNP9aH5Fg4V_Izsh4Uj8KTdRr7cBjdL_NF6MIutpkqE013wtPxwg9F9d_AJaDj60MGC2g2EOoe0nZ9h0bTv0piLHrhvw","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-06 09:30:47.164 +03:00 [DBG] user_consent grant with value: mvc|1 not found in store.
2019-08-06 09:30:47.170 +03:00 [DBG] Found no prior consent from consent store, consent is required
2019-08-06 09:30:47.181 +03:00 [INF] User consented to scopes: ["openid","profile","test_identity"]
2019-08-06 09:30:47.185 +03:00 [DBG] User indicated to remember consent for scopes: ["openid","profile"]
2019-08-06 09:30:47.191 +03:00 [DBG] Client allows remembering consent, and consent given. Updating consent store for subject: 1
2019-08-06 09:30:47.214 +03:00 [DBG] Creating Implicit Flow response.
2019-08-06 09:30:47.230 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-06 09:30:47.364 +03:00 [DBG] Authorize endpoint response
{"SubjectId":"1","ClientId":"mvc","RedirectUri":"http://localhost:5002/signin-oidc","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9OTrl86uVQhXrEcVvJT8blNk9VZUmoSEKoH6HReL9E2C0Mh8hr0HFv1lCWjq_sLNNJ2kJgoTkqMC4AUpC-1HsqllZaQFp3c-bCs4cl6tfMfu36nhI7m4NGxHZHvi-kdf8h9SbAKum_J-C4TkB7IBoLDnr4keWAXTIsuycp6MBKCyN7XvDjYtU8MYDHM8nayDpngRNhsgsr7WzpTLugNP9aH5Fg4V_Izsh4Uj8KTdRr7cBjdL_NF6MIutpkqE013wtPxwg9F9d_AJaDj60MGC2g2EOoe0nZ9h0bTv0piLHrhvw","Scope":"openid profile","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-08-06 09:30:47.399 +03:00 [DBG] Augmenting SignInContext
2019-08-06 09:30:47.400 +03:00 [INF] AuthenticationScheme: idsrv signed in.
2019-08-06 09:32:42.344 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-08-06 09:32:42.362 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-08-06 09:32:42.381 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-08-06 09:32:42.393 +03:00 [DBG] Start authorize request
2019-08-06 09:32:42.399 +03:00 [DBG] User in authorize request: 1
2019-08-06 09:32:42.400 +03:00 [DBG] Start authorize request protocol validation
2019-08-06 09:32:42.404 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-06 09:32:42.415 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-06 09:32:42.418 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/signin-oidc","AllowedRedirectUris":["http://localhost:5002/signin-oidc"],"SubjectId":"1","ResponseType":"id_token","ResponseMode":"form_post","GrantType":"implicit","RequestedScopes":"openid profile","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9PCvUg6nctiE1P7mdqSmDv3G4asH9hibPuSXtU4ndB1N_ZUn-39UqT_jq08iDG5ZXBw5j_0II_aQFvKEOM740Yq_FgLAOfWi2cGWC4z5CQcWcS_hv4MnzGJ_Hl-4z3TmK0KEiWFTpgkDaYt9wKVY3Wqqfkn_pVgdvv0H-IL0mng1kynGlPGF8TGV_oScrymuGTTJx97wz-0xvHnZB1-Uzm6ftLr47Vrgm5KCtvrP_ovPTxZNVgoO2AJv_04B4-3JseyHTI6EFykwUxEWWCBjp-3wVwEqqw_5_iT2ReYbi1BPA","UiLocales":null,"Nonce":"637006699623228207.ZTFjM2U5YWEtYjFlNy00OTRmLThmM2EtZmNlYWUyNTBiODlkYmVmNTFhYWMtOWMyNi00ZDE1LWJmNTMtZTIzNzlmNDAxZjE4","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"baf63867f322c5af2c392bdf07ae6679","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/signin-oidc","response_type":"id_token","scope":"openid profile","response_mode":"form_post","nonce":"637006699623228207.ZTFjM2U5YWEtYjFlNy00OTRmLThmM2EtZmNlYWUyNTBiODlkYmVmNTFhYWMtOWMyNi00ZDE1LWJmNTMtZTIzNzlmNDAxZjE4","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9PCvUg6nctiE1P7mdqSmDv3G4asH9hibPuSXtU4ndB1N_ZUn-39UqT_jq08iDG5ZXBw5j_0II_aQFvKEOM740Yq_FgLAOfWi2cGWC4z5CQcWcS_hv4MnzGJ_Hl-4z3TmK0KEiWFTpgkDaYt9wKVY3Wqqfkn_pVgdvv0H-IL0mng1kynGlPGF8TGV_oScrymuGTTJx97wz-0xvHnZB1-Uzm6ftLr47Vrgm5KCtvrP_ovPTxZNVgoO2AJv_04B4-3JseyHTI6EFykwUxEWWCBjp-3wVwEqqw_5_iT2ReYbi1BPA","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-06 09:32:42.457 +03:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-08-06 09:32:42.458 +03:00 [DBG] Creating Implicit Flow response.
2019-08-06 09:32:42.459 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-06 09:32:42.472 +03:00 [DBG] Authorize endpoint response
{"SubjectId":"1","ClientId":"mvc","RedirectUri":"http://localhost:5002/signin-oidc","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9PCvUg6nctiE1P7mdqSmDv3G4asH9hibPuSXtU4ndB1N_ZUn-39UqT_jq08iDG5ZXBw5j_0II_aQFvKEOM740Yq_FgLAOfWi2cGWC4z5CQcWcS_hv4MnzGJ_Hl-4z3TmK0KEiWFTpgkDaYt9wKVY3Wqqfkn_pVgdvv0H-IL0mng1kynGlPGF8TGV_oScrymuGTTJx97wz-0xvHnZB1-Uzm6ftLr47Vrgm5KCtvrP_ovPTxZNVgoO2AJv_04B4-3JseyHTI6EFykwUxEWWCBjp-3wVwEqqw_5_iT2ReYbi1BPA","Scope":"openid profile","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-08-06 09:35:05.740 +03:00 [INF] Starting IdentityServer4 version 2.5.0.0
2019-08-06 09:35:05.804 +03:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2019-08-06 09:35:05.820 +03:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2019-08-06 09:35:05.820 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for authentication
2019-08-06 09:35:05.820 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-in
2019-08-06 09:35:05.821 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-out
2019-08-06 09:35:05.821 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for challenge
2019-08-06 09:35:05.821 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for forbid
2019-08-06 09:45:26.891 +03:00 [INF] Starting IdentityServer4 version 2.5.0.0
2019-08-06 09:45:26.960 +03:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2019-08-06 09:45:26.975 +03:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2019-08-06 09:45:26.975 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for authentication
2019-08-06 09:45:26.976 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-in
2019-08-06 09:45:26.976 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-out
2019-08-06 09:45:26.976 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for challenge
2019-08-06 09:45:26.977 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for forbid
2019-08-06 09:46:08.040 +03:00 [DBG] Login Url: /account/login
2019-08-06 09:46:08.044 +03:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-08-06 09:46:08.045 +03:00 [DBG] Logout Url: /Account/Logout
2019-08-06 09:46:08.046 +03:00 [DBG] ConsentUrl Url: /consent
2019-08-06 09:46:08.046 +03:00 [DBG] Consent Return Url Parameter: returnUrl
2019-08-06 09:46:08.047 +03:00 [DBG] Error Url: /home/error
2019-08-06 09:46:08.047 +03:00 [DBG] Error Id Parameter: errorId
2019-08-06 09:46:08.109 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-06 09:46:08.119 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-06 09:46:08.120 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-06 09:46:08.130 +03:00 [DBG] Start discovery request
2019-08-06 09:46:08.352 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-06 09:46:08.384 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-06 09:46:08.386 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-06 09:46:08.392 +03:00 [DBG] Start key discovery request
2019-08-06 09:46:08.480 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-08-06 09:46:08.516 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-08-06 09:46:08.520 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-08-06 09:46:08.530 +03:00 [DBG] Start authorize request
2019-08-06 09:46:08.548 +03:00 [DBG] No user present in authorize request
2019-08-06 09:46:08.559 +03:00 [DBG] Start authorize request protocol validation
2019-08-06 09:46:08.591 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-06 09:46:08.647 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-06 09:46:08.675 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/signin-oidc","AllowedRedirectUris":["http://localhost:5002/signin-oidc"],"SubjectId":"anonymous","ResponseType":"id_token","ResponseMode":"form_post","GrantType":"implicit","RequestedScopes":"openid profile","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9NCikv90Zk5_HKn4cSK-8LTCio9XPvNhhp3Mkw_TdquoBUUbnCgmSfjQ-UYVWAxPwV_cHbWmdjP17gLi3lwyePDVsZv_vR0-yXJ5YgJfnST8NRwpnzJa0y9qpskU6xUInnjrxCuIVOEiOET2RuC-b2f_T4FDrxPjx_39Uh8ijh5vx6a1KspofT6EfeJx5tAKClnZ2B5zTKmaa9sSYG_JhvRDtQZnQVCCbXUa5kYXnHT4yh1AzDyowBlrnA0pnCGrnXYfg1KGLUM6xE1Gx9Jd5DEJf250uCOxbhgEM5PpIVVW5hxsEGRnezB2y9wYy0JVZI","UiLocales":null,"Nonce":"637006707684408796.MDdkNGVkYTMtYTBiNC00NzFhLWJmMWQtMjgyZmVkZmI4OGE5ODNhMmYzNzMtOTkwZS00NjdmLTk0YzMtZGI4Nzk0MmMwYjFh","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/signin-oidc","response_type":"id_token","scope":"openid profile","response_mode":"form_post","nonce":"637006707684408796.MDdkNGVkYTMtYTBiNC00NzFhLWJmMWQtMjgyZmVkZmI4OGE5ODNhMmYzNzMtOTkwZS00NjdmLTk0YzMtZGI4Nzk0MmMwYjFh","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9NCikv90Zk5_HKn4cSK-8LTCio9XPvNhhp3Mkw_TdquoBUUbnCgmSfjQ-UYVWAxPwV_cHbWmdjP17gLi3lwyePDVsZv_vR0-yXJ5YgJfnST8NRwpnzJa0y9qpskU6xUInnjrxCuIVOEiOET2RuC-b2f_T4FDrxPjx_39Uh8ijh5vx6a1KspofT6EfeJx5tAKClnZ2B5zTKmaa9sSYG_JhvRDtQZnQVCCbXUa5kYXnHT4yh1AzDyowBlrnA0pnCGrnXYfg1KGLUM6xE1Gx9Jd5DEJf250uCOxbhgEM5PpIVVW5hxsEGRnezB2y9wYy0JVZI","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-06 09:46:08.747 +03:00 [INF] Showing login: User is not authenticated
2019-08-06 09:46:09.014 +03:00 [DBG] Start authorize request protocol validation
2019-08-06 09:46:09.014 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-06 09:46:09.021 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-06 09:46:09.026 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-06 09:46:21.952 +03:00 [DBG] CORS request made for path: /account/login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-08-06 09:46:22.010 +03:00 [DBG] Start authorize request protocol validation
2019-08-06 09:46:22.011 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-06 09:46:22.015 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-06 09:46:29.408 +03:00 [DBG] Augmenting SignInContext
2019-08-06 09:46:29.412 +03:00 [DBG] Adding idp claim with value: local
2019-08-06 09:46:29.412 +03:00 [DBG] Adding amr claim with value: pwd
2019-08-06 09:46:29.429 +03:00 [INF] AuthenticationScheme: idsrv signed in.
2019-08-06 09:46:29.435 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-06 09:46:29.452 +03:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-08-06 09:46:29.457 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-08-06 09:46:29.461 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-08-06 09:46:29.475 +03:00 [DBG] Start authorize callback request
2019-08-06 09:46:29.488 +03:00 [DBG] User in authorize request: 1
2019-08-06 09:46:29.489 +03:00 [DBG] Start authorize request protocol validation
2019-08-06 09:46:29.491 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-06 09:46:29.506 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-06 09:46:29.511 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/signin-oidc","AllowedRedirectUris":["http://localhost:5002/signin-oidc"],"SubjectId":"1","ResponseType":"id_token","ResponseMode":"form_post","GrantType":"implicit","RequestedScopes":"openid profile","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9NCikv90Zk5_HKn4cSK-8LTCio9XPvNhhp3Mkw_TdquoBUUbnCgmSfjQ-UYVWAxPwV_cHbWmdjP17gLi3lwyePDVsZv_vR0-yXJ5YgJfnST8NRwpnzJa0y9qpskU6xUInnjrxCuIVOEiOET2RuC-b2f_T4FDrxPjx_39Uh8ijh5vx6a1KspofT6EfeJx5tAKClnZ2B5zTKmaa9sSYG_JhvRDtQZnQVCCbXUa5kYXnHT4yh1AzDyowBlrnA0pnCGrnXYfg1KGLUM6xE1Gx9Jd5DEJf250uCOxbhgEM5PpIVVW5hxsEGRnezB2y9wYy0JVZI","UiLocales":null,"Nonce":"637006707684408796.MDdkNGVkYTMtYTBiNC00NzFhLWJmMWQtMjgyZmVkZmI4OGE5ODNhMmYzNzMtOTkwZS00NjdmLTk0YzMtZGI4Nzk0MmMwYjFh","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"dc8a9b35bb767eebacfdfceca5da786d","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/signin-oidc","response_type":"id_token","scope":"openid profile","response_mode":"form_post","nonce":"637006707684408796.MDdkNGVkYTMtYTBiNC00NzFhLWJmMWQtMjgyZmVkZmI4OGE5ODNhMmYzNzMtOTkwZS00NjdmLTk0YzMtZGI4Nzk0MmMwYjFh","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9NCikv90Zk5_HKn4cSK-8LTCio9XPvNhhp3Mkw_TdquoBUUbnCgmSfjQ-UYVWAxPwV_cHbWmdjP17gLi3lwyePDVsZv_vR0-yXJ5YgJfnST8NRwpnzJa0y9qpskU6xUInnjrxCuIVOEiOET2RuC-b2f_T4FDrxPjx_39Uh8ijh5vx6a1KspofT6EfeJx5tAKClnZ2B5zTKmaa9sSYG_JhvRDtQZnQVCCbXUa5kYXnHT4yh1AzDyowBlrnA0pnCGrnXYfg1KGLUM6xE1Gx9Jd5DEJf250uCOxbhgEM5PpIVVW5hxsEGRnezB2y9wYy0JVZI","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-06 09:46:29.567 +03:00 [DBG] user_consent grant with value: mvc|1 not found in store.
2019-08-06 09:46:29.572 +03:00 [DBG] Found no prior consent from consent store, consent is required
2019-08-06 09:46:29.575 +03:00 [INF] Showing consent: User has not yet consented
2019-08-06 09:46:29.635 +03:00 [DBG] Start authorize request protocol validation
2019-08-06 09:46:29.641 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-06 09:46:29.653 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-06 09:46:29.663 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-06 09:46:38.176 +03:00 [DBG] CORS request made for path: /consent from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-08-06 09:46:40.870 +03:00 [DBG] Start authorize request protocol validation
2019-08-06 09:46:40.871 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-06 09:46:40.879 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-06 09:46:40.902 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-06 09:46:40.915 +03:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-08-06 09:46:40.922 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-08-06 09:46:40.929 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-08-06 09:46:40.939 +03:00 [DBG] Start authorize callback request
2019-08-06 09:46:40.960 +03:00 [DBG] User in authorize request: 1
2019-08-06 09:46:40.963 +03:00 [DBG] Start authorize request protocol validation
2019-08-06 09:46:40.965 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-06 09:46:40.984 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-06 09:46:40.994 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/signin-oidc","AllowedRedirectUris":["http://localhost:5002/signin-oidc"],"SubjectId":"1","ResponseType":"id_token","ResponseMode":"form_post","GrantType":"implicit","RequestedScopes":"openid profile","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9NCikv90Zk5_HKn4cSK-8LTCio9XPvNhhp3Mkw_TdquoBUUbnCgmSfjQ-UYVWAxPwV_cHbWmdjP17gLi3lwyePDVsZv_vR0-yXJ5YgJfnST8NRwpnzJa0y9qpskU6xUInnjrxCuIVOEiOET2RuC-b2f_T4FDrxPjx_39Uh8ijh5vx6a1KspofT6EfeJx5tAKClnZ2B5zTKmaa9sSYG_JhvRDtQZnQVCCbXUa5kYXnHT4yh1AzDyowBlrnA0pnCGrnXYfg1KGLUM6xE1Gx9Jd5DEJf250uCOxbhgEM5PpIVVW5hxsEGRnezB2y9wYy0JVZI","UiLocales":null,"Nonce":"637006707684408796.MDdkNGVkYTMtYTBiNC00NzFhLWJmMWQtMjgyZmVkZmI4OGE5ODNhMmYzNzMtOTkwZS00NjdmLTk0YzMtZGI4Nzk0MmMwYjFh","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"dc8a9b35bb767eebacfdfceca5da786d","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/signin-oidc","response_type":"id_token","scope":"openid profile","response_mode":"form_post","nonce":"637006707684408796.MDdkNGVkYTMtYTBiNC00NzFhLWJmMWQtMjgyZmVkZmI4OGE5ODNhMmYzNzMtOTkwZS00NjdmLTk0YzMtZGI4Nzk0MmMwYjFh","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9NCikv90Zk5_HKn4cSK-8LTCio9XPvNhhp3Mkw_TdquoBUUbnCgmSfjQ-UYVWAxPwV_cHbWmdjP17gLi3lwyePDVsZv_vR0-yXJ5YgJfnST8NRwpnzJa0y9qpskU6xUInnjrxCuIVOEiOET2RuC-b2f_T4FDrxPjx_39Uh8ijh5vx6a1KspofT6EfeJx5tAKClnZ2B5zTKmaa9sSYG_JhvRDtQZnQVCCbXUa5kYXnHT4yh1AzDyowBlrnA0pnCGrnXYfg1KGLUM6xE1Gx9Jd5DEJf250uCOxbhgEM5PpIVVW5hxsEGRnezB2y9wYy0JVZI","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-06 09:46:41.027 +03:00 [DBG] user_consent grant with value: mvc|1 not found in store.
2019-08-06 09:46:41.028 +03:00 [DBG] Found no prior consent from consent store, consent is required
2019-08-06 09:46:41.041 +03:00 [INF] User consented to scopes: ["openid","profile","test_identity"]
2019-08-06 09:46:41.044 +03:00 [DBG] User indicated to remember consent for scopes: ["openid","profile"]
2019-08-06 09:46:41.054 +03:00 [DBG] Client allows remembering consent, and consent given. Updating consent store for subject: 1
2019-08-06 09:46:41.078 +03:00 [DBG] Creating Implicit Flow response.
2019-08-06 09:46:41.097 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-06 09:46:41.219 +03:00 [DBG] Authorize endpoint response
{"SubjectId":"1","ClientId":"mvc","RedirectUri":"http://localhost:5002/signin-oidc","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9NCikv90Zk5_HKn4cSK-8LTCio9XPvNhhp3Mkw_TdquoBUUbnCgmSfjQ-UYVWAxPwV_cHbWmdjP17gLi3lwyePDVsZv_vR0-yXJ5YgJfnST8NRwpnzJa0y9qpskU6xUInnjrxCuIVOEiOET2RuC-b2f_T4FDrxPjx_39Uh8ijh5vx6a1KspofT6EfeJx5tAKClnZ2B5zTKmaa9sSYG_JhvRDtQZnQVCCbXUa5kYXnHT4yh1AzDyowBlrnA0pnCGrnXYfg1KGLUM6xE1Gx9Jd5DEJf250uCOxbhgEM5PpIVVW5hxsEGRnezB2y9wYy0JVZI","Scope":"openid profile","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-08-06 09:46:41.256 +03:00 [DBG] Augmenting SignInContext
2019-08-06 09:46:41.257 +03:00 [INF] AuthenticationScheme: idsrv signed in.
2019-08-06 09:54:29.155 +03:00 [INF] Starting IdentityServer4 version 2.5.0.0
2019-08-06 09:54:29.225 +03:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2019-08-06 09:54:29.242 +03:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2019-08-06 09:54:29.243 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for authentication
2019-08-06 09:54:29.244 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-in
2019-08-06 09:54:29.244 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-out
2019-08-06 09:54:29.246 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for challenge
2019-08-06 09:54:29.247 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for forbid
2019-08-06 10:01:58.615 +03:00 [DBG] Login Url: /account/login
2019-08-06 10:01:58.618 +03:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-08-06 10:01:58.619 +03:00 [DBG] Logout Url: /Account/Logout
2019-08-06 10:01:58.619 +03:00 [DBG] ConsentUrl Url: /consent
2019-08-06 10:01:58.620 +03:00 [DBG] Consent Return Url Parameter: returnUrl
2019-08-06 10:01:58.620 +03:00 [DBG] Error Url: /home/error
2019-08-06 10:01:58.620 +03:00 [DBG] Error Id Parameter: errorId
2019-08-06 10:01:58.672 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-08-06 10:01:58.708 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-08-06 10:01:58.711 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-08-06 10:01:58.722 +03:00 [DBG] Start authorize request
2019-08-06 10:01:58.754 +03:00 [DBG] No user present in authorize request
2019-08-06 10:01:58.779 +03:00 [DBG] Start authorize request protocol validation
2019-08-06 10:01:58.812 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-06 10:01:58.885 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-06 10:01:58.911 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/signin-oidc","AllowedRedirectUris":["http://localhost:5002/signin-oidc"],"SubjectId":"anonymous","ResponseType":"id_token","ResponseMode":"form_post","GrantType":"implicit","RequestedScopes":"openid profile","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9MgQtzD9AYv3dYAMUwPfb7rAJfQp7yFTMGyledqd1ySBx-TT19DjUK0J1cvx8dkgI5ubu9AIsr6OTmL-5oz5yeBUjw_6mwjJf0lE6M74CUDxjDMUfQh8OMbzATqplxzimFqTqjSLhYBPG09O6rM2XpWI8AuRjia8A_gcLnkbcjpEzXwEjxwh_An_vW7txARinfZcpO--q4zTdTTdzRjz8hWsJ6WW5vLn7zu72wjw4uXc9HeMw2bFCf1hK4Abkr9Rf22cvDQ6DuDqQJ6mG5aFx55WXGx9WivzYWP8iGSr6KaGnteycwivRNewXmcD04ZOtE","UiLocales":null,"Nonce":"637006717183873271.YTdkNDI4ZmYtNDYyYS00MzY2LTk0MDYtYjBlZjBkZDZlMDg2ZDUxNjgxNDctNjY1Mi00MWFmLWJjMjgtMzA4YjQ0MjQyYjgw","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/signin-oidc","response_type":"id_token","scope":"openid profile","response_mode":"form_post","nonce":"637006717183873271.YTdkNDI4ZmYtNDYyYS00MzY2LTk0MDYtYjBlZjBkZDZlMDg2ZDUxNjgxNDctNjY1Mi00MWFmLWJjMjgtMzA4YjQ0MjQyYjgw","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9MgQtzD9AYv3dYAMUwPfb7rAJfQp7yFTMGyledqd1ySBx-TT19DjUK0J1cvx8dkgI5ubu9AIsr6OTmL-5oz5yeBUjw_6mwjJf0lE6M74CUDxjDMUfQh8OMbzATqplxzimFqTqjSLhYBPG09O6rM2XpWI8AuRjia8A_gcLnkbcjpEzXwEjxwh_An_vW7txARinfZcpO--q4zTdTTdzRjz8hWsJ6WW5vLn7zu72wjw4uXc9HeMw2bFCf1hK4Abkr9Rf22cvDQ6DuDqQJ6mG5aFx55WXGx9WivzYWP8iGSr6KaGnteycwivRNewXmcD04ZOtE","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-06 10:01:58.993 +03:00 [INF] Showing login: User is not authenticated
2019-08-06 10:01:59.329 +03:00 [DBG] Start authorize request protocol validation
2019-08-06 10:01:59.329 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-06 10:01:59.336 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-06 10:01:59.341 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-06 10:02:02.079 +03:00 [DBG] CORS request made for path: /account/login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-08-06 10:02:02.147 +03:00 [DBG] Start authorize request protocol validation
2019-08-06 10:02:02.148 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-06 10:02:02.155 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-06 10:02:02.190 +03:00 [DBG] Augmenting SignInContext
2019-08-06 10:02:02.195 +03:00 [DBG] Adding idp claim with value: local
2019-08-06 10:02:02.196 +03:00 [DBG] Adding amr claim with value: pwd
2019-08-06 10:02:02.213 +03:00 [INF] AuthenticationScheme: idsrv signed in.
2019-08-06 10:02:02.218 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-06 10:02:02.231 +03:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-08-06 10:02:02.233 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-08-06 10:02:02.239 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-08-06 10:02:02.250 +03:00 [DBG] Start authorize callback request
2019-08-06 10:02:02.259 +03:00 [DBG] User in authorize request: 1
2019-08-06 10:02:02.261 +03:00 [DBG] Start authorize request protocol validation
2019-08-06 10:02:02.263 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-06 10:02:02.267 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-06 10:02:02.270 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/signin-oidc","AllowedRedirectUris":["http://localhost:5002/signin-oidc"],"SubjectId":"1","ResponseType":"id_token","ResponseMode":"form_post","GrantType":"implicit","RequestedScopes":"openid profile","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9MgQtzD9AYv3dYAMUwPfb7rAJfQp7yFTMGyledqd1ySBx-TT19DjUK0J1cvx8dkgI5ubu9AIsr6OTmL-5oz5yeBUjw_6mwjJf0lE6M74CUDxjDMUfQh8OMbzATqplxzimFqTqjSLhYBPG09O6rM2XpWI8AuRjia8A_gcLnkbcjpEzXwEjxwh_An_vW7txARinfZcpO--q4zTdTTdzRjz8hWsJ6WW5vLn7zu72wjw4uXc9HeMw2bFCf1hK4Abkr9Rf22cvDQ6DuDqQJ6mG5aFx55WXGx9WivzYWP8iGSr6KaGnteycwivRNewXmcD04ZOtE","UiLocales":null,"Nonce":"637006717183873271.YTdkNDI4ZmYtNDYyYS00MzY2LTk0MDYtYjBlZjBkZDZlMDg2ZDUxNjgxNDctNjY1Mi00MWFmLWJjMjgtMzA4YjQ0MjQyYjgw","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"4de0525e3a8b9cbd3b031d3d4210b5c1","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/signin-oidc","response_type":"id_token","scope":"openid profile","response_mode":"form_post","nonce":"637006717183873271.YTdkNDI4ZmYtNDYyYS00MzY2LTk0MDYtYjBlZjBkZDZlMDg2ZDUxNjgxNDctNjY1Mi00MWFmLWJjMjgtMzA4YjQ0MjQyYjgw","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9MgQtzD9AYv3dYAMUwPfb7rAJfQp7yFTMGyledqd1ySBx-TT19DjUK0J1cvx8dkgI5ubu9AIsr6OTmL-5oz5yeBUjw_6mwjJf0lE6M74CUDxjDMUfQh8OMbzATqplxzimFqTqjSLhYBPG09O6rM2XpWI8AuRjia8A_gcLnkbcjpEzXwEjxwh_An_vW7txARinfZcpO--q4zTdTTdzRjz8hWsJ6WW5vLn7zu72wjw4uXc9HeMw2bFCf1hK4Abkr9Rf22cvDQ6DuDqQJ6mG5aFx55WXGx9WivzYWP8iGSr6KaGnteycwivRNewXmcD04ZOtE","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-06 10:02:02.315 +03:00 [DBG] user_consent grant with value: mvc|1 not found in store.
2019-08-06 10:02:02.320 +03:00 [DBG] Found no prior consent from consent store, consent is required
2019-08-06 10:02:02.323 +03:00 [INF] Showing consent: User has not yet consented
2019-08-06 10:02:02.365 +03:00 [DBG] Start authorize request protocol validation
2019-08-06 10:02:02.367 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-06 10:02:02.372 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-06 10:02:02.376 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-06 10:02:05.479 +03:00 [DBG] CORS request made for path: /consent from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-08-06 10:02:05.516 +03:00 [DBG] Start authorize request protocol validation
2019-08-06 10:02:05.517 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-06 10:02:05.523 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-06 10:02:05.556 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-06 10:02:05.571 +03:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-08-06 10:02:05.575 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-08-06 10:02:05.578 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-08-06 10:02:05.580 +03:00 [DBG] Start authorize callback request
2019-08-06 10:02:05.590 +03:00 [DBG] User in authorize request: 1
2019-08-06 10:02:05.591 +03:00 [DBG] Start authorize request protocol validation
2019-08-06 10:02:05.592 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-06 10:02:05.599 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-06 10:02:05.601 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/signin-oidc","AllowedRedirectUris":["http://localhost:5002/signin-oidc"],"SubjectId":"1","ResponseType":"id_token","ResponseMode":"form_post","GrantType":"implicit","RequestedScopes":"openid profile","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9MgQtzD9AYv3dYAMUwPfb7rAJfQp7yFTMGyledqd1ySBx-TT19DjUK0J1cvx8dkgI5ubu9AIsr6OTmL-5oz5yeBUjw_6mwjJf0lE6M74CUDxjDMUfQh8OMbzATqplxzimFqTqjSLhYBPG09O6rM2XpWI8AuRjia8A_gcLnkbcjpEzXwEjxwh_An_vW7txARinfZcpO--q4zTdTTdzRjz8hWsJ6WW5vLn7zu72wjw4uXc9HeMw2bFCf1hK4Abkr9Rf22cvDQ6DuDqQJ6mG5aFx55WXGx9WivzYWP8iGSr6KaGnteycwivRNewXmcD04ZOtE","UiLocales":null,"Nonce":"637006717183873271.YTdkNDI4ZmYtNDYyYS00MzY2LTk0MDYtYjBlZjBkZDZlMDg2ZDUxNjgxNDctNjY1Mi00MWFmLWJjMjgtMzA4YjQ0MjQyYjgw","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"4de0525e3a8b9cbd3b031d3d4210b5c1","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/signin-oidc","response_type":"id_token","scope":"openid profile","response_mode":"form_post","nonce":"637006717183873271.YTdkNDI4ZmYtNDYyYS00MzY2LTk0MDYtYjBlZjBkZDZlMDg2ZDUxNjgxNDctNjY1Mi00MWFmLWJjMjgtMzA4YjQ0MjQyYjgw","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9MgQtzD9AYv3dYAMUwPfb7rAJfQp7yFTMGyledqd1ySBx-TT19DjUK0J1cvx8dkgI5ubu9AIsr6OTmL-5oz5yeBUjw_6mwjJf0lE6M74CUDxjDMUfQh8OMbzATqplxzimFqTqjSLhYBPG09O6rM2XpWI8AuRjia8A_gcLnkbcjpEzXwEjxwh_An_vW7txARinfZcpO--q4zTdTTdzRjz8hWsJ6WW5vLn7zu72wjw4uXc9HeMw2bFCf1hK4Abkr9Rf22cvDQ6DuDqQJ6mG5aFx55WXGx9WivzYWP8iGSr6KaGnteycwivRNewXmcD04ZOtE","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-06 10:02:05.626 +03:00 [DBG] user_consent grant with value: mvc|1 not found in store.
2019-08-06 10:02:05.628 +03:00 [DBG] Found no prior consent from consent store, consent is required
2019-08-06 10:02:05.637 +03:00 [INF] User consented to scopes: ["openid","profile","test_identity"]
2019-08-06 10:02:05.641 +03:00 [DBG] User indicated to remember consent for scopes: ["openid","profile"]
2019-08-06 10:02:05.647 +03:00 [DBG] Client allows remembering consent, and consent given. Updating consent store for subject: 1
2019-08-06 10:02:05.668 +03:00 [DBG] Creating Implicit Flow response.
2019-08-06 10:02:05.683 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-06 10:02:05.814 +03:00 [DBG] Authorize endpoint response
{"SubjectId":"1","ClientId":"mvc","RedirectUri":"http://localhost:5002/signin-oidc","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9MgQtzD9AYv3dYAMUwPfb7rAJfQp7yFTMGyledqd1ySBx-TT19DjUK0J1cvx8dkgI5ubu9AIsr6OTmL-5oz5yeBUjw_6mwjJf0lE6M74CUDxjDMUfQh8OMbzATqplxzimFqTqjSLhYBPG09O6rM2XpWI8AuRjia8A_gcLnkbcjpEzXwEjxwh_An_vW7txARinfZcpO--q4zTdTTdzRjz8hWsJ6WW5vLn7zu72wjw4uXc9HeMw2bFCf1hK4Abkr9Rf22cvDQ6DuDqQJ6mG5aFx55WXGx9WivzYWP8iGSr6KaGnteycwivRNewXmcD04ZOtE","Scope":"openid profile","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-08-06 10:02:05.848 +03:00 [DBG] Augmenting SignInContext
2019-08-06 10:02:05.849 +03:00 [INF] AuthenticationScheme: idsrv signed in.
2019-08-06 10:02:09.961 +03:00 [DBG] Start authorize request protocol validation
2019-08-06 10:02:09.962 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-06 10:02:09.966 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-06 10:02:09.970 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-06 10:02:18.352 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-08-06 10:02:18.365 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-08-06 10:02:18.399 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-08-06 10:02:18.434 +03:00 [DBG] Start authorize request
2019-08-06 10:02:18.446 +03:00 [DBG] No user present in authorize request
2019-08-06 10:02:18.461 +03:00 [DBG] Start authorize request protocol validation
2019-08-06 10:02:18.464 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-06 10:02:18.469 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-06 10:02:18.471 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/signin-oidc","AllowedRedirectUris":["http://localhost:5002/signin-oidc"],"SubjectId":"anonymous","ResponseType":"id_token","ResponseMode":"form_post","GrantType":"implicit","RequestedScopes":"openid profile","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9NZ3nVS422vFohC3sx0K9A_Sr137IJs50wMA85-i8lTTi3V5t_-Hq7SjQLbYYPn1Ypj328Lpgqrw57Jyxtn98jALNk0lZa4JAK24JwEfuHzruhu1snSBrA0u9226eiDccMIjQZuqLNlVhZxJe9-8DhSqlswAihAzmOWfCwdmsKKh6OGLE3IyI2-Nw7p4-_hnBjSeNrviHZCzccTCYVopJ4C72XYcBUYZ6dhPDJOM5cyKpTn0zgWOredK85QFgTf9FB6c-WhIX4PO5CsLVvPU6jYQO9tEClkCQv9P8PGyVKPZQ","UiLocales":null,"Nonce":"637006717383400971.ZWFmYWY4NjctMTM5My00ZDQ1LTgzYTktYzg1ODY3Y2FiNzQ0YzBmM2MzNzctMTJiOS00M2I5LTk5MGMtNjdhOGY4MmVhZWVh","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/signin-oidc","response_type":"id_token","scope":"openid profile","response_mode":"form_post","nonce":"637006717383400971.ZWFmYWY4NjctMTM5My00ZDQ1LTgzYTktYzg1ODY3Y2FiNzQ0YzBmM2MzNzctMTJiOS00M2I5LTk5MGMtNjdhOGY4MmVhZWVh","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9NZ3nVS422vFohC3sx0K9A_Sr137IJs50wMA85-i8lTTi3V5t_-Hq7SjQLbYYPn1Ypj328Lpgqrw57Jyxtn98jALNk0lZa4JAK24JwEfuHzruhu1snSBrA0u9226eiDccMIjQZuqLNlVhZxJe9-8DhSqlswAihAzmOWfCwdmsKKh6OGLE3IyI2-Nw7p4-_hnBjSeNrviHZCzccTCYVopJ4C72XYcBUYZ6dhPDJOM5cyKpTn0zgWOredK85QFgTf9FB6c-WhIX4PO5CsLVvPU6jYQO9tEClkCQv9P8PGyVKPZQ","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-06 10:02:18.496 +03:00 [INF] Showing login: User is not authenticated
2019-08-06 10:02:18.511 +03:00 [DBG] Start authorize request protocol validation
2019-08-06 10:02:18.513 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-06 10:02:18.519 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-06 10:02:18.525 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-06 10:02:21.006 +03:00 [DBG] CORS request made for path: /account/login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-08-06 10:02:21.016 +03:00 [DBG] Start authorize request protocol validation
2019-08-06 10:02:21.018 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-06 10:02:21.023 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-06 10:02:21.026 +03:00 [DBG] Augmenting SignInContext
2019-08-06 10:02:21.026 +03:00 [DBG] Adding idp claim with value: local
2019-08-06 10:02:21.028 +03:00 [DBG] Adding amr claim with value: pwd
2019-08-06 10:02:21.029 +03:00 [INF] AuthenticationScheme: idsrv signed in.
2019-08-06 10:02:21.040 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-06 10:02:21.063 +03:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-08-06 10:02:21.066 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-08-06 10:02:21.077 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-08-06 10:02:21.087 +03:00 [DBG] Start authorize callback request
2019-08-06 10:02:21.091 +03:00 [DBG] User in authorize request: 1
2019-08-06 10:02:21.093 +03:00 [DBG] Start authorize request protocol validation
2019-08-06 10:02:21.099 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-06 10:02:21.105 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-06 10:02:21.107 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/signin-oidc","AllowedRedirectUris":["http://localhost:5002/signin-oidc"],"SubjectId":"1","ResponseType":"id_token","ResponseMode":"form_post","GrantType":"implicit","RequestedScopes":"openid profile","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9NZ3nVS422vFohC3sx0K9A_Sr137IJs50wMA85-i8lTTi3V5t_-Hq7SjQLbYYPn1Ypj328Lpgqrw57Jyxtn98jALNk0lZa4JAK24JwEfuHzruhu1snSBrA0u9226eiDccMIjQZuqLNlVhZxJe9-8DhSqlswAihAzmOWfCwdmsKKh6OGLE3IyI2-Nw7p4-_hnBjSeNrviHZCzccTCYVopJ4C72XYcBUYZ6dhPDJOM5cyKpTn0zgWOredK85QFgTf9FB6c-WhIX4PO5CsLVvPU6jYQO9tEClkCQv9P8PGyVKPZQ","UiLocales":null,"Nonce":"637006717383400971.ZWFmYWY4NjctMTM5My00ZDQ1LTgzYTktYzg1ODY3Y2FiNzQ0YzBmM2MzNzctMTJiOS00M2I5LTk5MGMtNjdhOGY4MmVhZWVh","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"dc95b928aab1413c951c5f1fdc33df83","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/signin-oidc","response_type":"id_token","scope":"openid profile","response_mode":"form_post","nonce":"637006717383400971.ZWFmYWY4NjctMTM5My00ZDQ1LTgzYTktYzg1ODY3Y2FiNzQ0YzBmM2MzNzctMTJiOS00M2I5LTk5MGMtNjdhOGY4MmVhZWVh","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9NZ3nVS422vFohC3sx0K9A_Sr137IJs50wMA85-i8lTTi3V5t_-Hq7SjQLbYYPn1Ypj328Lpgqrw57Jyxtn98jALNk0lZa4JAK24JwEfuHzruhu1snSBrA0u9226eiDccMIjQZuqLNlVhZxJe9-8DhSqlswAihAzmOWfCwdmsKKh6OGLE3IyI2-Nw7p4-_hnBjSeNrviHZCzccTCYVopJ4C72XYcBUYZ6dhPDJOM5cyKpTn0zgWOredK85QFgTf9FB6c-WhIX4PO5CsLVvPU6jYQO9tEClkCQv9P8PGyVKPZQ","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-06 10:02:21.138 +03:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-08-06 10:02:21.140 +03:00 [DBG] Creating Implicit Flow response.
2019-08-06 10:02:21.142 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-06 10:02:21.148 +03:00 [DBG] Authorize endpoint response
{"SubjectId":"1","ClientId":"mvc","RedirectUri":"http://localhost:5002/signin-oidc","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9NZ3nVS422vFohC3sx0K9A_Sr137IJs50wMA85-i8lTTi3V5t_-Hq7SjQLbYYPn1Ypj328Lpgqrw57Jyxtn98jALNk0lZa4JAK24JwEfuHzruhu1snSBrA0u9226eiDccMIjQZuqLNlVhZxJe9-8DhSqlswAihAzmOWfCwdmsKKh6OGLE3IyI2-Nw7p4-_hnBjSeNrviHZCzccTCYVopJ4C72XYcBUYZ6dhPDJOM5cyKpTn0zgWOredK85QFgTf9FB6c-WhIX4PO5CsLVvPU6jYQO9tEClkCQv9P8PGyVKPZQ","Scope":"openid profile","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-08-06 10:02:21.155 +03:00 [DBG] Augmenting SignInContext
2019-08-06 10:02:21.157 +03:00 [INF] AuthenticationScheme: idsrv signed in.
2019-08-06 10:22:07.083 +03:00 [INF] Starting IdentityServer4 version 2.5.0.0
2019-08-06 10:22:07.161 +03:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2019-08-06 10:22:07.176 +03:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2019-08-06 10:22:07.176 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for authentication
2019-08-06 10:22:07.177 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-in
2019-08-06 10:22:07.177 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-out
2019-08-06 10:22:07.178 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for challenge
2019-08-06 10:22:07.178 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for forbid
2019-08-06 10:24:36.585 +03:00 [INF] Starting IdentityServer4 version 2.5.0.0
2019-08-06 10:24:36.636 +03:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2019-08-06 10:24:36.650 +03:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2019-08-06 10:24:36.651 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for authentication
2019-08-06 10:24:36.653 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-in
2019-08-06 10:24:36.654 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-out
2019-08-06 10:24:36.654 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for challenge
2019-08-06 10:24:36.658 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for forbid
2019-08-06 10:27:45.855 +03:00 [INF] Starting IdentityServer4 version 2.5.0.0
2019-08-06 10:27:45.923 +03:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2019-08-06 10:27:45.941 +03:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2019-08-06 10:27:45.942 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for authentication
2019-08-06 10:27:45.942 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-in
2019-08-06 10:27:45.943 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-out
2019-08-06 10:27:45.943 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for challenge
2019-08-06 10:27:45.943 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for forbid
2019-08-06 10:31:18.470 +03:00 [INF] Starting IdentityServer4 version 2.5.0.0
2019-08-06 10:31:18.546 +03:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2019-08-06 10:31:18.559 +03:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2019-08-06 10:31:18.560 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for authentication
2019-08-06 10:31:18.560 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-in
2019-08-06 10:31:18.561 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-out
2019-08-06 10:31:18.561 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for challenge
2019-08-06 10:31:18.562 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for forbid
2019-08-06 10:33:28.692 +03:00 [INF] Starting IdentityServer4 version 2.5.0.0
2019-08-06 10:33:28.752 +03:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2019-08-06 10:33:28.764 +03:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2019-08-06 10:33:28.765 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for authentication
2019-08-06 10:33:28.765 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-in
2019-08-06 10:33:28.765 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-out
2019-08-06 10:33:28.766 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for challenge
2019-08-06 10:33:28.766 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for forbid
2019-08-06 10:33:30.675 +03:00 [DBG] Login Url: /account/login
2019-08-06 10:33:30.678 +03:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-08-06 10:33:30.679 +03:00 [DBG] Logout Url: /Account/Logout
2019-08-06 10:33:30.680 +03:00 [DBG] ConsentUrl Url: /consent
2019-08-06 10:33:30.680 +03:00 [DBG] Consent Return Url Parameter: returnUrl
2019-08-06 10:33:30.681 +03:00 [DBG] Error Url: /home/error
2019-08-06 10:33:30.681 +03:00 [DBG] Error Id Parameter: errorId
2019-08-06 10:33:30.748 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-06 10:33:30.755 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-06 10:33:30.756 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-06 10:33:30.763 +03:00 [DBG] Start discovery request
2019-08-06 10:33:30.970 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-06 10:33:30.978 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-06 10:33:30.984 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-06 10:33:30.996 +03:00 [DBG] Start key discovery request
2019-08-06 10:33:31.122 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-08-06 10:33:31.190 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-08-06 10:33:31.193 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-08-06 10:33:31.202 +03:00 [DBG] Start authorize request
2019-08-06 10:33:31.221 +03:00 [DBG] No user present in authorize request
2019-08-06 10:33:31.231 +03:00 [DBG] Start authorize request protocol validation
2019-08-06 10:33:31.266 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-06 10:33:31.327 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-06 10:33:31.362 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/signin-oidc","AllowedRedirectUris":["http://localhost:5002/signin-oidc"],"SubjectId":"anonymous","ResponseType":"id_token","ResponseMode":"form_post","GrantType":"implicit","RequestedScopes":"openid profile","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9OlQnF32-eVBu1uaGWahWooRgvaJMLBLmo_zxb8iHMv8lPEcpEkntjYFVNlMdaJzeJUG0OwyGS6iwz9e7pgNj2wVY_YwoxNc6CYTPqIViBoew29GMkJbhtbNVm076YvpxRpeIvU7ojC9AJe9MdJHR--eXkgqgrLdCs4Y6Qo20QY-t9hudwVBPFhuq68K2W8fdCd21NhbAf7J0LGB0eWhBYZHqiuPlXcF8MGjM8xvbct1t97gKRPQjSvurVdQBwfvtHU6L2g11hI3PVLw0LWrPo28MrkzWOqd9gOFfeqwDH8r7TdGBNBw2zPeXNY05DNmHk","UiLocales":null,"Nonce":"637006736110475571.ODNhNjY5ZjgtZWJlNS00ZDIxLTg5ZDUtOGI4MjE2OGFjNDE5ZDgyMDk1NGQtYTI4NS00MmZkLWEzYjAtMGFhZmNiZDY3NTBh","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/signin-oidc","response_type":"id_token","scope":"openid profile","response_mode":"form_post","nonce":"637006736110475571.ODNhNjY5ZjgtZWJlNS00ZDIxLTg5ZDUtOGI4MjE2OGFjNDE5ZDgyMDk1NGQtYTI4NS00MmZkLWEzYjAtMGFhZmNiZDY3NTBh","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9OlQnF32-eVBu1uaGWahWooRgvaJMLBLmo_zxb8iHMv8lPEcpEkntjYFVNlMdaJzeJUG0OwyGS6iwz9e7pgNj2wVY_YwoxNc6CYTPqIViBoew29GMkJbhtbNVm076YvpxRpeIvU7ojC9AJe9MdJHR--eXkgqgrLdCs4Y6Qo20QY-t9hudwVBPFhuq68K2W8fdCd21NhbAf7J0LGB0eWhBYZHqiuPlXcF8MGjM8xvbct1t97gKRPQjSvurVdQBwfvtHU6L2g11hI3PVLw0LWrPo28MrkzWOqd9gOFfeqwDH8r7TdGBNBw2zPeXNY05DNmHk","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-06 10:33:31.462 +03:00 [INF] Showing login: User is not authenticated
2019-08-06 10:33:31.750 +03:00 [DBG] Start authorize request protocol validation
2019-08-06 10:33:31.752 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-06 10:33:31.756 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-06 10:33:31.761 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-06 10:33:35.398 +03:00 [DBG] CORS request made for path: /account/login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-08-06 10:33:35.462 +03:00 [DBG] Start authorize request protocol validation
2019-08-06 10:33:35.463 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-06 10:33:35.469 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-06 10:33:35.504 +03:00 [DBG] Augmenting SignInContext
2019-08-06 10:33:35.509 +03:00 [DBG] Adding idp claim with value: local
2019-08-06 10:33:35.509 +03:00 [DBG] Adding amr claim with value: pwd
2019-08-06 10:33:35.527 +03:00 [INF] AuthenticationScheme: idsrv signed in.
2019-08-06 10:33:35.532 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-06 10:33:35.547 +03:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-08-06 10:33:35.550 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-08-06 10:33:35.556 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-08-06 10:33:35.572 +03:00 [DBG] Start authorize callback request
2019-08-06 10:33:35.585 +03:00 [DBG] User in authorize request: 1
2019-08-06 10:33:35.585 +03:00 [DBG] Start authorize request protocol validation
2019-08-06 10:33:35.587 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-06 10:33:35.597 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-06 10:33:35.600 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/signin-oidc","AllowedRedirectUris":["http://localhost:5002/signin-oidc"],"SubjectId":"1","ResponseType":"id_token","ResponseMode":"form_post","GrantType":"implicit","RequestedScopes":"openid profile","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9OlQnF32-eVBu1uaGWahWooRgvaJMLBLmo_zxb8iHMv8lPEcpEkntjYFVNlMdaJzeJUG0OwyGS6iwz9e7pgNj2wVY_YwoxNc6CYTPqIViBoew29GMkJbhtbNVm076YvpxRpeIvU7ojC9AJe9MdJHR--eXkgqgrLdCs4Y6Qo20QY-t9hudwVBPFhuq68K2W8fdCd21NhbAf7J0LGB0eWhBYZHqiuPlXcF8MGjM8xvbct1t97gKRPQjSvurVdQBwfvtHU6L2g11hI3PVLw0LWrPo28MrkzWOqd9gOFfeqwDH8r7TdGBNBw2zPeXNY05DNmHk","UiLocales":null,"Nonce":"637006736110475571.ODNhNjY5ZjgtZWJlNS00ZDIxLTg5ZDUtOGI4MjE2OGFjNDE5ZDgyMDk1NGQtYTI4NS00MmZkLWEzYjAtMGFhZmNiZDY3NTBh","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"c3cf03990e41b68fe75f4821cb82b37c","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/signin-oidc","response_type":"id_token","scope":"openid profile","response_mode":"form_post","nonce":"637006736110475571.ODNhNjY5ZjgtZWJlNS00ZDIxLTg5ZDUtOGI4MjE2OGFjNDE5ZDgyMDk1NGQtYTI4NS00MmZkLWEzYjAtMGFhZmNiZDY3NTBh","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9OlQnF32-eVBu1uaGWahWooRgvaJMLBLmo_zxb8iHMv8lPEcpEkntjYFVNlMdaJzeJUG0OwyGS6iwz9e7pgNj2wVY_YwoxNc6CYTPqIViBoew29GMkJbhtbNVm076YvpxRpeIvU7ojC9AJe9MdJHR--eXkgqgrLdCs4Y6Qo20QY-t9hudwVBPFhuq68K2W8fdCd21NhbAf7J0LGB0eWhBYZHqiuPlXcF8MGjM8xvbct1t97gKRPQjSvurVdQBwfvtHU6L2g11hI3PVLw0LWrPo28MrkzWOqd9gOFfeqwDH8r7TdGBNBw2zPeXNY05DNmHk","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-06 10:33:35.652 +03:00 [DBG] user_consent grant with value: mvc|1 not found in store.
2019-08-06 10:33:35.656 +03:00 [DBG] Found no prior consent from consent store, consent is required
2019-08-06 10:33:35.659 +03:00 [INF] Showing consent: User has not yet consented
2019-08-06 10:33:35.695 +03:00 [DBG] Start authorize request protocol validation
2019-08-06 10:33:35.695 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-06 10:33:35.701 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-06 10:33:35.703 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-06 10:33:37.972 +03:00 [DBG] CORS request made for path: /consent from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-08-06 10:33:38.001 +03:00 [DBG] Start authorize request protocol validation
2019-08-06 10:33:38.002 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-06 10:33:38.006 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-06 10:33:38.028 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-06 10:33:38.040 +03:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-08-06 10:33:38.044 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-08-06 10:33:38.048 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-08-06 10:33:38.054 +03:00 [DBG] Start authorize callback request
2019-08-06 10:33:38.063 +03:00 [DBG] User in authorize request: 1
2019-08-06 10:33:38.063 +03:00 [DBG] Start authorize request protocol validation
2019-08-06 10:33:38.065 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-06 10:33:38.070 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-06 10:33:38.072 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/signin-oidc","AllowedRedirectUris":["http://localhost:5002/signin-oidc"],"SubjectId":"1","ResponseType":"id_token","ResponseMode":"form_post","GrantType":"implicit","RequestedScopes":"openid profile","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9OlQnF32-eVBu1uaGWahWooRgvaJMLBLmo_zxb8iHMv8lPEcpEkntjYFVNlMdaJzeJUG0OwyGS6iwz9e7pgNj2wVY_YwoxNc6CYTPqIViBoew29GMkJbhtbNVm076YvpxRpeIvU7ojC9AJe9MdJHR--eXkgqgrLdCs4Y6Qo20QY-t9hudwVBPFhuq68K2W8fdCd21NhbAf7J0LGB0eWhBYZHqiuPlXcF8MGjM8xvbct1t97gKRPQjSvurVdQBwfvtHU6L2g11hI3PVLw0LWrPo28MrkzWOqd9gOFfeqwDH8r7TdGBNBw2zPeXNY05DNmHk","UiLocales":null,"Nonce":"637006736110475571.ODNhNjY5ZjgtZWJlNS00ZDIxLTg5ZDUtOGI4MjE2OGFjNDE5ZDgyMDk1NGQtYTI4NS00MmZkLWEzYjAtMGFhZmNiZDY3NTBh","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"c3cf03990e41b68fe75f4821cb82b37c","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/signin-oidc","response_type":"id_token","scope":"openid profile","response_mode":"form_post","nonce":"637006736110475571.ODNhNjY5ZjgtZWJlNS00ZDIxLTg5ZDUtOGI4MjE2OGFjNDE5ZDgyMDk1NGQtYTI4NS00MmZkLWEzYjAtMGFhZmNiZDY3NTBh","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9OlQnF32-eVBu1uaGWahWooRgvaJMLBLmo_zxb8iHMv8lPEcpEkntjYFVNlMdaJzeJUG0OwyGS6iwz9e7pgNj2wVY_YwoxNc6CYTPqIViBoew29GMkJbhtbNVm076YvpxRpeIvU7ojC9AJe9MdJHR--eXkgqgrLdCs4Y6Qo20QY-t9hudwVBPFhuq68K2W8fdCd21NhbAf7J0LGB0eWhBYZHqiuPlXcF8MGjM8xvbct1t97gKRPQjSvurVdQBwfvtHU6L2g11hI3PVLw0LWrPo28MrkzWOqd9gOFfeqwDH8r7TdGBNBw2zPeXNY05DNmHk","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-06 10:33:38.114 +03:00 [DBG] user_consent grant with value: mvc|1 not found in store.
2019-08-06 10:33:38.118 +03:00 [DBG] Found no prior consent from consent store, consent is required
2019-08-06 10:33:38.127 +03:00 [INF] User consented to scopes: ["openid","profile","test_identity"]
2019-08-06 10:33:38.130 +03:00 [DBG] User indicated to remember consent for scopes: ["openid","profile"]
2019-08-06 10:33:38.140 +03:00 [DBG] Client allows remembering consent, and consent given. Updating consent store for subject: 1
2019-08-06 10:33:38.163 +03:00 [DBG] Creating Implicit Flow response.
2019-08-06 10:33:38.177 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-06 10:33:38.300 +03:00 [DBG] Authorize endpoint response
{"SubjectId":"1","ClientId":"mvc","RedirectUri":"http://localhost:5002/signin-oidc","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9OlQnF32-eVBu1uaGWahWooRgvaJMLBLmo_zxb8iHMv8lPEcpEkntjYFVNlMdaJzeJUG0OwyGS6iwz9e7pgNj2wVY_YwoxNc6CYTPqIViBoew29GMkJbhtbNVm076YvpxRpeIvU7ojC9AJe9MdJHR--eXkgqgrLdCs4Y6Qo20QY-t9hudwVBPFhuq68K2W8fdCd21NhbAf7J0LGB0eWhBYZHqiuPlXcF8MGjM8xvbct1t97gKRPQjSvurVdQBwfvtHU6L2g11hI3PVLw0LWrPo28MrkzWOqd9gOFfeqwDH8r7TdGBNBw2zPeXNY05DNmHk","Scope":"openid profile","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-08-06 10:33:38.344 +03:00 [DBG] Augmenting SignInContext
2019-08-06 10:33:38.345 +03:00 [INF] AuthenticationScheme: idsrv signed in.
2019-08-06 10:36:39.324 +03:00 [INF] Starting IdentityServer4 version 2.5.0.0
2019-08-06 10:36:39.385 +03:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2019-08-06 10:36:39.398 +03:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2019-08-06 10:36:39.399 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for authentication
2019-08-06 10:36:39.399 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-in
2019-08-06 10:36:39.400 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-out
2019-08-06 10:36:39.400 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for challenge
2019-08-06 10:36:39.401 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for forbid
2019-08-06 10:36:41.095 +03:00 [DBG] Login Url: /account/login
2019-08-06 10:36:41.098 +03:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-08-06 10:36:41.099 +03:00 [DBG] Logout Url: /Account/Logout
2019-08-06 10:36:41.099 +03:00 [DBG] ConsentUrl Url: /consent
2019-08-06 10:36:41.100 +03:00 [DBG] Consent Return Url Parameter: returnUrl
2019-08-06 10:36:41.100 +03:00 [DBG] Error Url: /home/error
2019-08-06 10:36:41.100 +03:00 [DBG] Error Id Parameter: errorId
2019-08-06 10:36:41.165 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-06 10:36:41.174 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-06 10:36:41.176 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-06 10:36:41.186 +03:00 [DBG] Start discovery request
2019-08-06 10:36:41.387 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-06 10:36:41.392 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-06 10:36:41.396 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-06 10:36:41.403 +03:00 [DBG] Start key discovery request
2019-08-06 10:36:41.509 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-08-06 10:36:41.549 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-08-06 10:36:41.553 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-08-06 10:36:41.566 +03:00 [DBG] Start authorize request
2019-08-06 10:36:41.583 +03:00 [DBG] No user present in authorize request
2019-08-06 10:36:41.592 +03:00 [DBG] Start authorize request protocol validation
2019-08-06 10:36:41.625 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-06 10:36:41.647 +03:00 [DBG] Checking for PKCE parameters
2019-08-06 10:36:41.650 +03:00 [DBG] No PKCE used.
2019-08-06 10:36:41.675 +03:00 [ERR] Invalid scope: api1
2019-08-06 10:36:41.679 +03:00 [ERR] Request validation failed
2019-08-06 10:36:41.702 +03:00 [INF] {"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/signin-oidc","AllowedRedirectUris":["http://localhost:5002/signin-oidc"],"SubjectId":"anonymous","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile api1 afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9P1M0AG_dLphKjTDz-43f4w9kDjkoeewzsDncY_hI_yZf61IMl4CWwqscA066nJS462shta6Hg7Pt8QH03Qi_9qNlfrW_u4D9A0m8nRZeIuS9o4e3-0brNFcLil0hRmwOJvZsBcCcFs6X9hWoA3PeSey0CMZR4lABD_UvceGlsXQcbf62kzjMB9qFaJ83W8Jct0HQpMCr6ACm8Exq6eE1JwMHu9-oJ5-5s85lkGhwJoCKOQ5dguXmGMY4yjAd22vtU0CLwQAOrMMdvhAXjA9m86cYzYemLpmVp1B9DZ2CELDw","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile api1 afcpayroll","response_mode":"form_post","nonce":"637006738014538063.ODA5MDNjMmItZGMzOC00NDM4LWE0Y2QtMzhlMjFhOGExMjY2ZDE3YjQzMWEtZGRjOS00Yzg0LWE5YTAtNTkzY2E2ZmQyYWVi","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9P1M0AG_dLphKjTDz-43f4w9kDjkoeewzsDncY_hI_yZf61IMl4CWwqscA066nJS462shta6Hg7Pt8QH03Qi_9qNlfrW_u4D9A0m8nRZeIuS9o4e3-0brNFcLil0hRmwOJvZsBcCcFs6X9hWoA3PeSey0CMZR4lABD_UvceGlsXQcbf62kzjMB9qFaJ83W8Jct0HQpMCr6ACm8Exq6eE1JwMHu9-oJ5-5s85lkGhwJoCKOQ5dguXmGMY4yjAd22vtU0CLwQAOrMMdvhAXjA9m86cYzYemLpmVp1B9DZ2CELDw","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-06 10:36:52.628 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-08-06 10:36:52.653 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-08-06 10:36:52.695 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-08-06 10:36:52.727 +03:00 [DBG] Start authorize request
2019-08-06 10:36:52.738 +03:00 [DBG] No user present in authorize request
2019-08-06 10:36:52.742 +03:00 [DBG] Start authorize request protocol validation
2019-08-06 10:36:52.752 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-06 10:36:52.763 +03:00 [DBG] Checking for PKCE parameters
2019-08-06 10:36:52.764 +03:00 [DBG] No PKCE used.
2019-08-06 10:36:52.768 +03:00 [ERR] Invalid scope: api1
2019-08-06 10:36:52.770 +03:00 [ERR] Request validation failed
2019-08-06 10:36:52.772 +03:00 [INF] {"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/signin-oidc","AllowedRedirectUris":["http://localhost:5002/signin-oidc"],"SubjectId":"anonymous","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile api1 afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9PRWdtbU7eBgZJeG_aochzId353788UviBwZkgbwqoNm_NoH6AgSb_FE3Kff-SH697tRsfBmGdaf-iFvWO96NB_8LWYGm8Vjb3fSiC7iQP-fKCIvylGM0x2ifF-HiT9C3nx825C7bZAfIN1-ivPiOTRYP4BN-xyK3G-FwIpWD6L76mYXGO682c4RBuGuJcRgGplgf6_JjpuqVQkSUgDWQ9vc7_wwb_xdB3i309f8bCtgyzdzFfpMaqHHgdcUyLOSmPjX6MdWQe4vh-_sa4y99l5yOGoyn7oHXf2A0SjBl_WLQ","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile api1 afcpayroll","response_mode":"form_post","nonce":"637006738125992219.NzRlYzZhYWMtYzJkYS00NjY2LWE3NWQtYzdhY2Y1MWU5Mjg2MzJhMjliYWQtYTEwYy00MjYxLWFjYzgtOGM4Zjg3NGI2YjRh","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9PRWdtbU7eBgZJeG_aochzId353788UviBwZkgbwqoNm_NoH6AgSb_FE3Kff-SH697tRsfBmGdaf-iFvWO96NB_8LWYGm8Vjb3fSiC7iQP-fKCIvylGM0x2ifF-HiT9C3nx825C7bZAfIN1-ivPiOTRYP4BN-xyK3G-FwIpWD6L76mYXGO682c4RBuGuJcRgGplgf6_JjpuqVQkSUgDWQ9vc7_wwb_xdB3i309f8bCtgyzdzFfpMaqHHgdcUyLOSmPjX6MdWQe4vh-_sa4y99l5yOGoyn7oHXf2A0SjBl_WLQ","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-06 10:37:23.267 +03:00 [INF] Starting IdentityServer4 version 2.5.0.0
2019-08-06 10:37:23.330 +03:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2019-08-06 10:37:23.343 +03:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2019-08-06 10:37:23.344 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for authentication
2019-08-06 10:37:23.345 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-in
2019-08-06 10:37:23.345 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-out
2019-08-06 10:37:23.345 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for challenge
2019-08-06 10:37:23.346 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for forbid
2019-08-06 10:37:26.966 +03:00 [DBG] Login Url: /account/login
2019-08-06 10:37:26.970 +03:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-08-06 10:37:26.971 +03:00 [DBG] Logout Url: /Account/Logout
2019-08-06 10:37:26.971 +03:00 [DBG] ConsentUrl Url: /consent
2019-08-06 10:37:26.971 +03:00 [DBG] Consent Return Url Parameter: returnUrl
2019-08-06 10:37:26.972 +03:00 [DBG] Error Url: /home/error
2019-08-06 10:37:26.972 +03:00 [DBG] Error Id Parameter: errorId
2019-08-06 10:37:27.028 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-06 10:37:27.035 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-06 10:37:27.037 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-06 10:37:27.046 +03:00 [DBG] Start discovery request
2019-08-06 10:37:27.244 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-06 10:37:27.254 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-06 10:37:27.258 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-06 10:37:27.268 +03:00 [DBG] Start key discovery request
2019-08-06 10:37:27.378 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-08-06 10:37:27.410 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-08-06 10:37:27.413 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-08-06 10:37:27.424 +03:00 [DBG] Start authorize request
2019-08-06 10:37:27.446 +03:00 [DBG] No user present in authorize request
2019-08-06 10:37:27.457 +03:00 [DBG] Start authorize request protocol validation
2019-08-06 10:37:27.492 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-06 10:37:27.515 +03:00 [DBG] Checking for PKCE parameters
2019-08-06 10:37:27.517 +03:00 [DBG] No PKCE used.
2019-08-06 10:37:27.570 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-06 10:37:27.618 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/signin-oidc","AllowedRedirectUris":["http://localhost:5002/signin-oidc"],"SubjectId":"anonymous","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9MI8-pr_v8T49fWVRIiLLNwQt2jtdCCWGs5wn9eW4aYGc0AVpkUv3ntXjEpUqJCJKuzapPNEeEZN26SBhfoh8n7yTrHiRAENFM-fSlkjtuhUkHNXrBHRnY_68AdnUdVWF9Aq_rC2AxbC3uiMjr3XSGIHViPcIhFBOxXGw3poCej7XnO02rt3U5JWT5vdKWop4SoKdzE7R52-21YscQ7i9STMKXB_cyg7c9zXKvVoHBcXW4QdO3iPe0f11oyJBGrMzttv2htjsufMfEeIZA0Z-xPDQFqfqIosOaI_jvQZbUwig","UiLocales":null,"Nonce":"637006738473164691.NDU1YTU2YmUtNGI4ZC00ODAxLTgxMDQtMzUzNDZhNTBjNTU4NmJkNjFjMTMtNTVmOS00MmQ1LWFmODctNmUzNWNkMTVhNzYw","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637006738473164691.NDU1YTU2YmUtNGI4ZC00ODAxLTgxMDQtMzUzNDZhNTBjNTU4NmJkNjFjMTMtNTVmOS00MmQ1LWFmODctNmUzNWNkMTVhNzYw","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9MI8-pr_v8T49fWVRIiLLNwQt2jtdCCWGs5wn9eW4aYGc0AVpkUv3ntXjEpUqJCJKuzapPNEeEZN26SBhfoh8n7yTrHiRAENFM-fSlkjtuhUkHNXrBHRnY_68AdnUdVWF9Aq_rC2AxbC3uiMjr3XSGIHViPcIhFBOxXGw3poCej7XnO02rt3U5JWT5vdKWop4SoKdzE7R52-21YscQ7i9STMKXB_cyg7c9zXKvVoHBcXW4QdO3iPe0f11oyJBGrMzttv2htjsufMfEeIZA0Z-xPDQFqfqIosOaI_jvQZbUwig","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-06 10:37:27.694 +03:00 [INF] Showing login: User is not authenticated
2019-08-06 10:37:27.963 +03:00 [DBG] Start authorize request protocol validation
2019-08-06 10:37:27.964 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-06 10:37:27.970 +03:00 [DBG] Checking for PKCE parameters
2019-08-06 10:37:27.971 +03:00 [DBG] No PKCE used.
2019-08-06 10:37:27.972 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-06 10:37:27.978 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-06 10:37:30.718 +03:00 [DBG] CORS request made for path: /account/login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-08-06 10:37:30.793 +03:00 [DBG] Start authorize request protocol validation
2019-08-06 10:37:30.794 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-06 10:37:30.800 +03:00 [DBG] Checking for PKCE parameters
2019-08-06 10:37:30.801 +03:00 [DBG] No PKCE used.
2019-08-06 10:37:30.803 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-06 10:37:30.844 +03:00 [DBG] Augmenting SignInContext
2019-08-06 10:37:30.850 +03:00 [DBG] Adding idp claim with value: local
2019-08-06 10:37:30.850 +03:00 [DBG] Adding amr claim with value: pwd
2019-08-06 10:37:30.869 +03:00 [INF] AuthenticationScheme: idsrv signed in.
2019-08-06 10:37:30.877 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-06 10:37:30.890 +03:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-08-06 10:37:30.893 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-08-06 10:37:30.898 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-08-06 10:37:30.911 +03:00 [DBG] Start authorize callback request
2019-08-06 10:37:30.917 +03:00 [DBG] User in authorize request: 1
2019-08-06 10:37:30.918 +03:00 [DBG] Start authorize request protocol validation
2019-08-06 10:37:30.919 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-06 10:37:30.921 +03:00 [DBG] Checking for PKCE parameters
2019-08-06 10:37:30.923 +03:00 [DBG] No PKCE used.
2019-08-06 10:37:30.925 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-06 10:37:30.934 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/signin-oidc","AllowedRedirectUris":["http://localhost:5002/signin-oidc"],"SubjectId":"1","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9MI8-pr_v8T49fWVRIiLLNwQt2jtdCCWGs5wn9eW4aYGc0AVpkUv3ntXjEpUqJCJKuzapPNEeEZN26SBhfoh8n7yTrHiRAENFM-fSlkjtuhUkHNXrBHRnY_68AdnUdVWF9Aq_rC2AxbC3uiMjr3XSGIHViPcIhFBOxXGw3poCej7XnO02rt3U5JWT5vdKWop4SoKdzE7R52-21YscQ7i9STMKXB_cyg7c9zXKvVoHBcXW4QdO3iPe0f11oyJBGrMzttv2htjsufMfEeIZA0Z-xPDQFqfqIosOaI_jvQZbUwig","UiLocales":null,"Nonce":"637006738473164691.NDU1YTU2YmUtNGI4ZC00ODAxLTgxMDQtMzUzNDZhNTBjNTU4NmJkNjFjMTMtNTVmOS00MmQ1LWFmODctNmUzNWNkMTVhNzYw","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"60e01d773ef03e50e1942da621f64b49","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637006738473164691.NDU1YTU2YmUtNGI4ZC00ODAxLTgxMDQtMzUzNDZhNTBjNTU4NmJkNjFjMTMtNTVmOS00MmQ1LWFmODctNmUzNWNkMTVhNzYw","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9MI8-pr_v8T49fWVRIiLLNwQt2jtdCCWGs5wn9eW4aYGc0AVpkUv3ntXjEpUqJCJKuzapPNEeEZN26SBhfoh8n7yTrHiRAENFM-fSlkjtuhUkHNXrBHRnY_68AdnUdVWF9Aq_rC2AxbC3uiMjr3XSGIHViPcIhFBOxXGw3poCej7XnO02rt3U5JWT5vdKWop4SoKdzE7R52-21YscQ7i9STMKXB_cyg7c9zXKvVoHBcXW4QdO3iPe0f11oyJBGrMzttv2htjsufMfEeIZA0Z-xPDQFqfqIosOaI_jvQZbUwig","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-06 10:37:30.976 +03:00 [DBG] Scopes contains offline_access, consent is required
2019-08-06 10:37:30.977 +03:00 [INF] Showing consent: User has not yet consented
2019-08-06 10:37:31.014 +03:00 [DBG] Start authorize request protocol validation
2019-08-06 10:37:31.015 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-06 10:37:31.020 +03:00 [DBG] Checking for PKCE parameters
2019-08-06 10:37:31.021 +03:00 [DBG] No PKCE used.
2019-08-06 10:37:31.022 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-06 10:37:31.025 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-06 10:37:42.531 +03:00 [DBG] CORS request made for path: /consent from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-08-06 10:37:42.565 +03:00 [DBG] Start authorize request protocol validation
2019-08-06 10:37:42.565 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-06 10:37:42.570 +03:00 [DBG] Checking for PKCE parameters
2019-08-06 10:37:42.571 +03:00 [DBG] No PKCE used.
2019-08-06 10:37:42.573 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-06 10:37:42.595 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-06 10:37:42.610 +03:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-08-06 10:37:42.612 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-08-06 10:37:42.616 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-08-06 10:37:42.622 +03:00 [DBG] Start authorize callback request
2019-08-06 10:37:42.627 +03:00 [DBG] User in authorize request: 1
2019-08-06 10:37:42.629 +03:00 [DBG] Start authorize request protocol validation
2019-08-06 10:37:42.630 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-06 10:37:42.634 +03:00 [DBG] Checking for PKCE parameters
2019-08-06 10:37:42.635 +03:00 [DBG] No PKCE used.
2019-08-06 10:37:42.636 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-06 10:37:42.644 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/signin-oidc","AllowedRedirectUris":["http://localhost:5002/signin-oidc"],"SubjectId":"1","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9MI8-pr_v8T49fWVRIiLLNwQt2jtdCCWGs5wn9eW4aYGc0AVpkUv3ntXjEpUqJCJKuzapPNEeEZN26SBhfoh8n7yTrHiRAENFM-fSlkjtuhUkHNXrBHRnY_68AdnUdVWF9Aq_rC2AxbC3uiMjr3XSGIHViPcIhFBOxXGw3poCej7XnO02rt3U5JWT5vdKWop4SoKdzE7R52-21YscQ7i9STMKXB_cyg7c9zXKvVoHBcXW4QdO3iPe0f11oyJBGrMzttv2htjsufMfEeIZA0Z-xPDQFqfqIosOaI_jvQZbUwig","UiLocales":null,"Nonce":"637006738473164691.NDU1YTU2YmUtNGI4ZC00ODAxLTgxMDQtMzUzNDZhNTBjNTU4NmJkNjFjMTMtNTVmOS00MmQ1LWFmODctNmUzNWNkMTVhNzYw","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"60e01d773ef03e50e1942da621f64b49","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637006738473164691.NDU1YTU2YmUtNGI4ZC00ODAxLTgxMDQtMzUzNDZhNTBjNTU4NmJkNjFjMTMtNTVmOS00MmQ1LWFmODctNmUzNWNkMTVhNzYw","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9MI8-pr_v8T49fWVRIiLLNwQt2jtdCCWGs5wn9eW4aYGc0AVpkUv3ntXjEpUqJCJKuzapPNEeEZN26SBhfoh8n7yTrHiRAENFM-fSlkjtuhUkHNXrBHRnY_68AdnUdVWF9Aq_rC2AxbC3uiMjr3XSGIHViPcIhFBOxXGw3poCej7XnO02rt3U5JWT5vdKWop4SoKdzE7R52-21YscQ7i9STMKXB_cyg7c9zXKvVoHBcXW4QdO3iPe0f11oyJBGrMzttv2htjsufMfEeIZA0Z-xPDQFqfqIosOaI_jvQZbUwig","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-06 10:37:42.677 +03:00 [DBG] Scopes contains offline_access, consent is required
2019-08-06 10:37:42.691 +03:00 [INF] User consented to scopes: ["openid","profile","test_identity","afcpayroll","offline_access"]
2019-08-06 10:37:42.695 +03:00 [DBG] User indicated to remember consent for scopes: ["openid","profile","afcpayroll","offline_access"]
2019-08-06 10:37:42.702 +03:00 [DBG] Client allows remembering consent, and consent given. Updating consent store for subject: 1
2019-08-06 10:37:42.734 +03:00 [DBG] Creating Hybrid Flow response.
2019-08-06 10:37:42.763 +03:00 [DBG] Creating Implicit Flow response.
2019-08-06 10:37:42.775 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-06 10:37:42.781 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-06 10:37:42.896 +03:00 [DBG] Authorize endpoint response
{"SubjectId":"1","ClientId":"mvc","RedirectUri":"http://localhost:5002/signin-oidc","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9MI8-pr_v8T49fWVRIiLLNwQt2jtdCCWGs5wn9eW4aYGc0AVpkUv3ntXjEpUqJCJKuzapPNEeEZN26SBhfoh8n7yTrHiRAENFM-fSlkjtuhUkHNXrBHRnY_68AdnUdVWF9Aq_rC2AxbC3uiMjr3XSGIHViPcIhFBOxXGw3poCej7XnO02rt3U5JWT5vdKWop4SoKdzE7R52-21YscQ7i9STMKXB_cyg7c9zXKvVoHBcXW4QdO3iPe0f11oyJBGrMzttv2htjsufMfEeIZA0Z-xPDQFqfqIosOaI_jvQZbUwig","Scope":"openid profile afcpayroll offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-08-06 10:37:42.929 +03:00 [DBG] Augmenting SignInContext
2019-08-06 10:37:42.930 +03:00 [INF] AuthenticationScheme: idsrv signed in.
2019-08-06 10:37:43.208 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-06 10:37:43.218 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-06 10:37:43.222 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-06 10:37:43.236 +03:00 [DBG] Start token request.
2019-08-06 10:37:43.245 +03:00 [DBG] Start client validation
2019-08-06 10:37:43.254 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-06 10:37:43.260 +03:00 [DBG] Start parsing for secret in post body
2019-08-06 10:37:43.261 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-06 10:37:43.264 +03:00 [DBG] Secret id found: mvc
2019-08-06 10:37:43.267 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-06 10:37:43.289 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-06 10:37:43.289 +03:00 [DBG] Client validation success
2019-08-06 10:37:43.300 +03:00 [DBG] Start token request validation
2019-08-06 10:37:43.317 +03:00 [DBG] Start validation of authorization code token request
2019-08-06 10:37:43.339 +03:00 [DBG] Validation of authorization code token request success
2019-08-06 10:37:43.343 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"23817d39ac86652d8c2d29f5f6ca5575570adb016cd64ce718969e50dd076681","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"mvc","client_secret":"***REDACTED***","code":"23817d39ac86652d8c2d29f5f6ca5575570adb016cd64ce718969e50dd076681","grant_type":"authorization_code","redirect_uri":"http://localhost:5002/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-08-06 10:37:43.370 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-06 10:37:43.386 +03:00 [DBG] Getting claims for access token for client: mvc
2019-08-06 10:37:43.387 +03:00 [DBG] Getting claims for access token for subject: 1
2019-08-06 10:37:43.406 +03:00 [DBG] Creating refresh token
2019-08-06 10:37:43.406 +03:00 [DBG] Setting an absolute lifetime: 2592000
2019-08-06 10:37:43.426 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-06 10:37:43.428 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-06 10:37:43.434 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-06 10:37:43.443 +03:00 [DBG] Token request success.
2019-08-06 10:37:43.461 +03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-08-06 10:37:43.466 +03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-08-06 10:37:43.471 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-08-06 10:37:43.487 +03:00 [DBG] Start userinfo request
2019-08-06 10:37:43.493 +03:00 [DBG] Bearer token found in header
2019-08-06 10:37:43.591 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-06 10:37:43.598 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-06 10:37:43.600 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-08-06 10:37:43.607 +03:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1565077063,"exp":1565080663,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","afcpayroll"],"client_id":"mvc","sub":"1","auth_time":1565077050,"idp":"local","name":"alice","email":"alice@email.com","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-08-06 10:37:43.629 +03:00 [DBG] Creating userinfo response
2019-08-06 10:37:43.634 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-06 10:37:43.642 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-06 10:37:43.647 +03:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-06 10:37:43.649 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-06 10:37:43.654 +03:00 [INF] Profile service returned the following claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-06 10:37:43.656 +03:00 [DBG] End userinfo request
2019-08-06 10:43:29.040 +03:00 [INF] Starting IdentityServer4 version 2.5.0.0
2019-08-06 10:43:29.102 +03:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2019-08-06 10:43:29.116 +03:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2019-08-06 10:43:29.116 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for authentication
2019-08-06 10:43:29.117 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-in
2019-08-06 10:43:29.117 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-out
2019-08-06 10:43:29.117 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for challenge
2019-08-06 10:43:29.118 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for forbid
2019-08-06 10:43:29.920 +03:00 [DBG] Login Url: /account/login
2019-08-06 10:43:29.923 +03:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-08-06 10:43:29.924 +03:00 [DBG] Logout Url: /Account/Logout
2019-08-06 10:43:29.924 +03:00 [DBG] ConsentUrl Url: /consent
2019-08-06 10:43:29.924 +03:00 [DBG] Consent Return Url Parameter: returnUrl
2019-08-06 10:43:29.925 +03:00 [DBG] Error Url: /home/error
2019-08-06 10:43:29.925 +03:00 [DBG] Error Id Parameter: errorId
2019-08-06 10:43:29.979 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-08-06 10:43:30.015 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-08-06 10:43:30.020 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-08-06 10:43:30.029 +03:00 [DBG] Start authorize request
2019-08-06 10:43:30.069 +03:00 [DBG] No user present in authorize request
2019-08-06 10:43:30.092 +03:00 [DBG] Start authorize request protocol validation
2019-08-06 10:43:30.128 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-06 10:43:30.148 +03:00 [DBG] Checking for PKCE parameters
2019-08-06 10:43:30.151 +03:00 [DBG] No PKCE used.
2019-08-06 10:43:30.215 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-06 10:43:30.248 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/signin-oidc","AllowedRedirectUris":["http://localhost:5002/signin-oidc"],"SubjectId":"anonymous","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9NoqsVyB6tmzjKpLFR6JrPSJeHTk9XK8n6k9-_rjbHjZH_fABdBOCSFOkot9OEhuW05xK4PW4wlyutULUSD7FOmHBHm2k0o3sSliYinGMx-py58KQ5NyrrCYDmv_E-zKwVIm8854xq-xdLCENmXotrCF_g_yExkIEt-qgRvnLKveWsOlPcq1mSmdbVfFgwy5DvyOJVMa_ggtvagSIdOFZXeipJQQ_lZfQjHopzv6CeQTtEurkdHhXN8wIB7BN_dc3i9E3S89Ts4JBiptBpOdeuYuFK1yvY76MOJFIX0J69iSA","UiLocales":null,"Nonce":"637006742071502714.NmQwYTFjOWItNWE3Yi00MGZlLTgzMDQtZWNiZDEwNWE4ZjU2NTI0N2E4YzMtOTU1NS00NzlmLWIwYzktMWZjOTlkOTdiNzFj","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637006742071502714.NmQwYTFjOWItNWE3Yi00MGZlLTgzMDQtZWNiZDEwNWE4ZjU2NTI0N2E4YzMtOTU1NS00NzlmLWIwYzktMWZjOTlkOTdiNzFj","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9NoqsVyB6tmzjKpLFR6JrPSJeHTk9XK8n6k9-_rjbHjZH_fABdBOCSFOkot9OEhuW05xK4PW4wlyutULUSD7FOmHBHm2k0o3sSliYinGMx-py58KQ5NyrrCYDmv_E-zKwVIm8854xq-xdLCENmXotrCF_g_yExkIEt-qgRvnLKveWsOlPcq1mSmdbVfFgwy5DvyOJVMa_ggtvagSIdOFZXeipJQQ_lZfQjHopzv6CeQTtEurkdHhXN8wIB7BN_dc3i9E3S89Ts4JBiptBpOdeuYuFK1yvY76MOJFIX0J69iSA","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-06 10:43:30.339 +03:00 [INF] Showing login: User is not authenticated
2019-08-06 10:43:30.686 +03:00 [DBG] Start authorize request protocol validation
2019-08-06 10:43:30.687 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-06 10:43:30.693 +03:00 [DBG] Checking for PKCE parameters
2019-08-06 10:43:30.694 +03:00 [DBG] No PKCE used.
2019-08-06 10:43:30.698 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-06 10:43:30.706 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-06 10:43:33.776 +03:00 [DBG] CORS request made for path: /account/login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-08-06 10:43:33.856 +03:00 [DBG] Start authorize request protocol validation
2019-08-06 10:43:33.857 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-06 10:43:33.865 +03:00 [DBG] Checking for PKCE parameters
2019-08-06 10:43:33.867 +03:00 [DBG] No PKCE used.
2019-08-06 10:43:33.869 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-06 10:43:33.908 +03:00 [DBG] Augmenting SignInContext
2019-08-06 10:43:33.913 +03:00 [DBG] Adding idp claim with value: local
2019-08-06 10:43:33.913 +03:00 [DBG] Adding amr claim with value: pwd
2019-08-06 10:43:33.931 +03:00 [INF] AuthenticationScheme: idsrv signed in.
2019-08-06 10:43:33.936 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-06 10:43:33.950 +03:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-08-06 10:43:33.953 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-08-06 10:43:33.956 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-08-06 10:43:33.974 +03:00 [DBG] Start authorize callback request
2019-08-06 10:43:33.982 +03:00 [DBG] User in authorize request: 1
2019-08-06 10:43:33.983 +03:00 [DBG] Start authorize request protocol validation
2019-08-06 10:43:33.984 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-06 10:43:33.990 +03:00 [DBG] Checking for PKCE parameters
2019-08-06 10:43:33.991 +03:00 [DBG] No PKCE used.
2019-08-06 10:43:33.994 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-06 10:43:33.996 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/signin-oidc","AllowedRedirectUris":["http://localhost:5002/signin-oidc"],"SubjectId":"1","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9NoqsVyB6tmzjKpLFR6JrPSJeHTk9XK8n6k9-_rjbHjZH_fABdBOCSFOkot9OEhuW05xK4PW4wlyutULUSD7FOmHBHm2k0o3sSliYinGMx-py58KQ5NyrrCYDmv_E-zKwVIm8854xq-xdLCENmXotrCF_g_yExkIEt-qgRvnLKveWsOlPcq1mSmdbVfFgwy5DvyOJVMa_ggtvagSIdOFZXeipJQQ_lZfQjHopzv6CeQTtEurkdHhXN8wIB7BN_dc3i9E3S89Ts4JBiptBpOdeuYuFK1yvY76MOJFIX0J69iSA","UiLocales":null,"Nonce":"637006742071502714.NmQwYTFjOWItNWE3Yi00MGZlLTgzMDQtZWNiZDEwNWE4ZjU2NTI0N2E4YzMtOTU1NS00NzlmLWIwYzktMWZjOTlkOTdiNzFj","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"acf6ddc498c45f2d2961e27aff258dda","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637006742071502714.NmQwYTFjOWItNWE3Yi00MGZlLTgzMDQtZWNiZDEwNWE4ZjU2NTI0N2E4YzMtOTU1NS00NzlmLWIwYzktMWZjOTlkOTdiNzFj","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9NoqsVyB6tmzjKpLFR6JrPSJeHTk9XK8n6k9-_rjbHjZH_fABdBOCSFOkot9OEhuW05xK4PW4wlyutULUSD7FOmHBHm2k0o3sSliYinGMx-py58KQ5NyrrCYDmv_E-zKwVIm8854xq-xdLCENmXotrCF_g_yExkIEt-qgRvnLKveWsOlPcq1mSmdbVfFgwy5DvyOJVMa_ggtvagSIdOFZXeipJQQ_lZfQjHopzv6CeQTtEurkdHhXN8wIB7BN_dc3i9E3S89Ts4JBiptBpOdeuYuFK1yvY76MOJFIX0J69iSA","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-06 10:43:34.054 +03:00 [DBG] Client is configured to not require consent, no consent is required
2019-08-06 10:43:34.066 +03:00 [DBG] Creating Hybrid Flow response.
2019-08-06 10:43:34.116 +03:00 [DBG] Creating Implicit Flow response.
2019-08-06 10:43:34.131 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-06 10:43:34.138 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-06 10:43:34.261 +03:00 [DBG] Authorize endpoint response
{"SubjectId":"1","ClientId":"mvc","RedirectUri":"http://localhost:5002/signin-oidc","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9NoqsVyB6tmzjKpLFR6JrPSJeHTk9XK8n6k9-_rjbHjZH_fABdBOCSFOkot9OEhuW05xK4PW4wlyutULUSD7FOmHBHm2k0o3sSliYinGMx-py58KQ5NyrrCYDmv_E-zKwVIm8854xq-xdLCENmXotrCF_g_yExkIEt-qgRvnLKveWsOlPcq1mSmdbVfFgwy5DvyOJVMa_ggtvagSIdOFZXeipJQQ_lZfQjHopzv6CeQTtEurkdHhXN8wIB7BN_dc3i9E3S89Ts4JBiptBpOdeuYuFK1yvY76MOJFIX0J69iSA","Scope":"openid profile afcpayroll offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-08-06 10:43:34.304 +03:00 [DBG] Augmenting SignInContext
2019-08-06 10:43:34.305 +03:00 [INF] AuthenticationScheme: idsrv signed in.
2019-08-06 10:43:34.550 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-06 10:43:34.566 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-06 10:43:34.568 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-06 10:43:34.588 +03:00 [DBG] Start token request.
2019-08-06 10:43:34.598 +03:00 [DBG] Start client validation
2019-08-06 10:43:34.608 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-06 10:43:34.613 +03:00 [DBG] Start parsing for secret in post body
2019-08-06 10:43:34.614 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-06 10:43:34.615 +03:00 [DBG] Secret id found: mvc
2019-08-06 10:43:34.619 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-06 10:43:34.637 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-06 10:43:34.638 +03:00 [DBG] Client validation success
2019-08-06 10:43:34.650 +03:00 [DBG] Start token request validation
2019-08-06 10:43:34.666 +03:00 [DBG] Start validation of authorization code token request
2019-08-06 10:43:34.693 +03:00 [DBG] Validation of authorization code token request success
2019-08-06 10:43:34.701 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"ad8aa88bef00bed65e990c8118c99fad6fdc03f894b82e14aaf217220fb0439b","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"mvc","client_secret":"***REDACTED***","code":"ad8aa88bef00bed65e990c8118c99fad6fdc03f894b82e14aaf217220fb0439b","grant_type":"authorization_code","redirect_uri":"http://localhost:5002/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-08-06 10:43:34.742 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-06 10:43:34.766 +03:00 [DBG] Getting claims for access token for client: mvc
2019-08-06 10:43:34.769 +03:00 [DBG] Getting claims for access token for subject: 1
2019-08-06 10:43:34.791 +03:00 [DBG] Creating refresh token
2019-08-06 10:43:34.793 +03:00 [DBG] Setting an absolute lifetime: 2592000
2019-08-06 10:43:34.823 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-06 10:43:34.827 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-06 10:43:34.831 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-06 10:43:34.841 +03:00 [DBG] Token request success.
2019-08-06 10:43:34.858 +03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-08-06 10:43:34.864 +03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-08-06 10:43:34.873 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-08-06 10:43:34.894 +03:00 [DBG] Start userinfo request
2019-08-06 10:43:34.903 +03:00 [DBG] Bearer token found in header
2019-08-06 10:43:34.999 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-06 10:43:35.009 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-06 10:43:35.016 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-08-06 10:43:35.021 +03:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1565077414,"exp":1565081014,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","afcpayroll"],"client_id":"mvc","sub":"1","auth_time":1565077413,"idp":"local","name":"alice","email":"alice@email.com","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-08-06 10:43:35.045 +03:00 [DBG] Creating userinfo response
2019-08-06 10:43:35.052 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-06 10:43:35.059 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-06 10:43:35.065 +03:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-06 10:43:35.068 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-06 10:43:35.073 +03:00 [INF] Profile service returned the following claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-06 10:43:35.077 +03:00 [DBG] End userinfo request
2019-08-06 10:59:34.318 +03:00 [INF] Starting IdentityServer4 version 2.5.0.0
2019-08-06 10:59:34.380 +03:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2019-08-06 10:59:34.393 +03:00 [INF] Using the default authentication scheme MyCookie for IdentityServer
2019-08-06 10:59:34.393 +03:00 [DBG] Using MyCookie as default ASP.NET Core scheme for authentication
2019-08-06 10:59:34.394 +03:00 [DBG] Using MyCookie as default ASP.NET Core scheme for sign-in
2019-08-06 10:59:34.394 +03:00 [DBG] Using MyCookie as default ASP.NET Core scheme for sign-out
2019-08-06 10:59:34.395 +03:00 [DBG] Using MyCookie as default ASP.NET Core scheme for challenge
2019-08-06 10:59:34.395 +03:00 [DBG] Using MyCookie as default ASP.NET Core scheme for forbid
2019-08-06 10:59:36.765 +03:00 [DBG] Login Url: /account/login
2019-08-06 10:59:36.768 +03:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-08-06 10:59:36.768 +03:00 [DBG] Logout Url: /Account/Logout
2019-08-06 10:59:36.769 +03:00 [DBG] ConsentUrl Url: /consent
2019-08-06 10:59:36.769 +03:00 [DBG] Consent Return Url Parameter: returnUrl
2019-08-06 10:59:36.769 +03:00 [DBG] Error Url: /home/error
2019-08-06 10:59:36.770 +03:00 [DBG] Error Id Parameter: errorId
2019-08-06 10:59:36.826 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-08-06 10:59:36.865 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-08-06 10:59:36.868 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-08-06 10:59:36.882 +03:00 [DBG] Start authorize request
2019-08-06 10:59:36.909 +03:00 [DBG] No user present in authorize request
2019-08-06 10:59:36.927 +03:00 [DBG] Start authorize request protocol validation
2019-08-06 10:59:36.961 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-06 10:59:36.982 +03:00 [DBG] Checking for PKCE parameters
2019-08-06 10:59:36.985 +03:00 [DBG] No PKCE used.
2019-08-06 10:59:37.051 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-06 10:59:37.081 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/signin-oidc","AllowedRedirectUris":["http://localhost:5002/signin-oidc"],"SubjectId":"anonymous","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9N-yS_9e7aP8rRLMaRIB7CDSDehzOL0fVtQbHGEEJboKmSSz632OtcB7IgqQzHUvN8Ov6iY5Nqrw7kRa1G2thkhb7p9wJL3lZ8_BvH1fgzIIt_zha0bpnfWAzNTR0Ld4TAtM_3gzomahpuVI-A8dHkmpEREi4juKkr4RIUE9ybbc4mJd9PFEMeTF007Man9M43kQ07-j-pB4-T-JJSHCOVZd4LFqnexi7vItaKYEr2EbqA-9qHdA6s7T68v4yzVHpwSOfM0eFHpC2h5HqQ96pboKXmTp0LWictKjYp-bu3tfw","UiLocales":null,"Nonce":"637006751765472551.MWJhZTU1MmItMDc5NC00MjYwLThiN2UtN2Y0ODQ5ZjdiZDZlMTA0ODhmMzgtYWRkYS00ZTJlLWI3NDctODEwZTc0N2UxOGI4","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637006751765472551.MWJhZTU1MmItMDc5NC00MjYwLThiN2UtN2Y0ODQ5ZjdiZDZlMTA0ODhmMzgtYWRkYS00ZTJlLWI3NDctODEwZTc0N2UxOGI4","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9N-yS_9e7aP8rRLMaRIB7CDSDehzOL0fVtQbHGEEJboKmSSz632OtcB7IgqQzHUvN8Ov6iY5Nqrw7kRa1G2thkhb7p9wJL3lZ8_BvH1fgzIIt_zha0bpnfWAzNTR0Ld4TAtM_3gzomahpuVI-A8dHkmpEREi4juKkr4RIUE9ybbc4mJd9PFEMeTF007Man9M43kQ07-j-pB4-T-JJSHCOVZd4LFqnexi7vItaKYEr2EbqA-9qHdA6s7T68v4yzVHpwSOfM0eFHpC2h5HqQ96pboKXmTp0LWictKjYp-bu3tfw","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-06 10:59:37.150 +03:00 [INF] Showing login: User is not authenticated
2019-08-06 10:59:37.462 +03:00 [DBG] Start authorize request protocol validation
2019-08-06 10:59:37.463 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-06 10:59:37.470 +03:00 [DBG] Checking for PKCE parameters
2019-08-06 10:59:37.471 +03:00 [DBG] No PKCE used.
2019-08-06 10:59:37.472 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-06 10:59:37.480 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-06 10:59:40.022 +03:00 [DBG] CORS request made for path: /account/login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-08-06 10:59:40.084 +03:00 [DBG] Start authorize request protocol validation
2019-08-06 10:59:40.085 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-06 10:59:40.090 +03:00 [DBG] Checking for PKCE parameters
2019-08-06 10:59:40.091 +03:00 [DBG] No PKCE used.
2019-08-06 10:59:40.094 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-06 10:59:40.140 +03:00 [DBG] Augmenting SignInContext
2019-08-06 10:59:40.146 +03:00 [DBG] Adding idp claim with value: local
2019-08-06 10:59:40.146 +03:00 [DBG] Adding amr claim with value: pwd
2019-08-06 10:59:40.166 +03:00 [INF] AuthenticationScheme: MyCookie signed in.
2019-08-06 10:59:40.170 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-06 10:59:40.187 +03:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-08-06 10:59:40.191 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-08-06 10:59:40.197 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-08-06 10:59:40.212 +03:00 [DBG] Start authorize callback request
2019-08-06 10:59:40.237 +03:00 [DBG] User in authorize request: 1
2019-08-06 10:59:40.237 +03:00 [DBG] Start authorize request protocol validation
2019-08-06 10:59:40.239 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-06 10:59:40.247 +03:00 [DBG] Checking for PKCE parameters
2019-08-06 10:59:40.248 +03:00 [DBG] No PKCE used.
2019-08-06 10:59:40.249 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-06 10:59:40.254 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/signin-oidc","AllowedRedirectUris":["http://localhost:5002/signin-oidc"],"SubjectId":"1","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9N-yS_9e7aP8rRLMaRIB7CDSDehzOL0fVtQbHGEEJboKmSSz632OtcB7IgqQzHUvN8Ov6iY5Nqrw7kRa1G2thkhb7p9wJL3lZ8_BvH1fgzIIt_zha0bpnfWAzNTR0Ld4TAtM_3gzomahpuVI-A8dHkmpEREi4juKkr4RIUE9ybbc4mJd9PFEMeTF007Man9M43kQ07-j-pB4-T-JJSHCOVZd4LFqnexi7vItaKYEr2EbqA-9qHdA6s7T68v4yzVHpwSOfM0eFHpC2h5HqQ96pboKXmTp0LWictKjYp-bu3tfw","UiLocales":null,"Nonce":"637006751765472551.MWJhZTU1MmItMDc5NC00MjYwLThiN2UtN2Y0ODQ5ZjdiZDZlMTA0ODhmMzgtYWRkYS00ZTJlLWI3NDctODEwZTc0N2UxOGI4","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"3b8762d38dd4ce9cad09c17593255af7","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637006751765472551.MWJhZTU1MmItMDc5NC00MjYwLThiN2UtN2Y0ODQ5ZjdiZDZlMTA0ODhmMzgtYWRkYS00ZTJlLWI3NDctODEwZTc0N2UxOGI4","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9N-yS_9e7aP8rRLMaRIB7CDSDehzOL0fVtQbHGEEJboKmSSz632OtcB7IgqQzHUvN8Ov6iY5Nqrw7kRa1G2thkhb7p9wJL3lZ8_BvH1fgzIIt_zha0bpnfWAzNTR0Ld4TAtM_3gzomahpuVI-A8dHkmpEREi4juKkr4RIUE9ybbc4mJd9PFEMeTF007Man9M43kQ07-j-pB4-T-JJSHCOVZd4LFqnexi7vItaKYEr2EbqA-9qHdA6s7T68v4yzVHpwSOfM0eFHpC2h5HqQ96pboKXmTp0LWictKjYp-bu3tfw","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-06 10:59:40.297 +03:00 [DBG] Client is configured to not require consent, no consent is required
2019-08-06 10:59:40.309 +03:00 [DBG] Creating Hybrid Flow response.
2019-08-06 10:59:40.353 +03:00 [DBG] Creating Implicit Flow response.
2019-08-06 10:59:40.367 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-06 10:59:40.371 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-06 10:59:40.495 +03:00 [DBG] Authorize endpoint response
{"SubjectId":"1","ClientId":"mvc","RedirectUri":"http://localhost:5002/signin-oidc","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9N-yS_9e7aP8rRLMaRIB7CDSDehzOL0fVtQbHGEEJboKmSSz632OtcB7IgqQzHUvN8Ov6iY5Nqrw7kRa1G2thkhb7p9wJL3lZ8_BvH1fgzIIt_zha0bpnfWAzNTR0Ld4TAtM_3gzomahpuVI-A8dHkmpEREi4juKkr4RIUE9ybbc4mJd9PFEMeTF007Man9M43kQ07-j-pB4-T-JJSHCOVZd4LFqnexi7vItaKYEr2EbqA-9qHdA6s7T68v4yzVHpwSOfM0eFHpC2h5HqQ96pboKXmTp0LWictKjYp-bu3tfw","Scope":"openid profile afcpayroll offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-08-06 10:59:40.529 +03:00 [DBG] Augmenting SignInContext
2019-08-06 10:59:40.530 +03:00 [INF] AuthenticationScheme: MyCookie signed in.
2019-08-06 10:59:40.768 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-06 10:59:40.783 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-06 10:59:40.785 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-06 10:59:40.801 +03:00 [DBG] Start token request.
2019-08-06 10:59:40.814 +03:00 [DBG] Start client validation
2019-08-06 10:59:40.827 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-06 10:59:40.834 +03:00 [DBG] Start parsing for secret in post body
2019-08-06 10:59:40.835 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-06 10:59:40.836 +03:00 [DBG] Secret id found: mvc
2019-08-06 10:59:40.839 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-06 10:59:40.857 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-06 10:59:40.857 +03:00 [DBG] Client validation success
2019-08-06 10:59:40.869 +03:00 [DBG] Start token request validation
2019-08-06 10:59:40.888 +03:00 [DBG] Start validation of authorization code token request
2019-08-06 10:59:40.909 +03:00 [DBG] Validation of authorization code token request success
2019-08-06 10:59:40.914 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"1676ba15f4617f985f501cccb341f035fb7e6b4e78113f03a37195472416445d","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"mvc","client_secret":"***REDACTED***","code":"1676ba15f4617f985f501cccb341f035fb7e6b4e78113f03a37195472416445d","grant_type":"authorization_code","redirect_uri":"http://localhost:5002/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-08-06 10:59:40.949 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-06 10:59:40.974 +03:00 [DBG] Getting claims for access token for client: mvc
2019-08-06 10:59:40.977 +03:00 [DBG] Getting claims for access token for subject: 1
2019-08-06 10:59:40.995 +03:00 [DBG] Creating refresh token
2019-08-06 10:59:40.995 +03:00 [DBG] Setting an absolute lifetime: 2592000
2019-08-06 10:59:41.015 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-06 10:59:41.018 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-06 10:59:41.023 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-06 10:59:41.041 +03:00 [DBG] Token request success.
2019-08-06 10:59:41.062 +03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-08-06 10:59:41.067 +03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-08-06 10:59:41.069 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-08-06 10:59:41.081 +03:00 [DBG] Start userinfo request
2019-08-06 10:59:41.088 +03:00 [DBG] Bearer token found in header
2019-08-06 10:59:41.178 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-06 10:59:41.186 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-06 10:59:41.189 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-08-06 10:59:41.192 +03:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1565078380,"exp":1565081980,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","afcpayroll"],"client_id":"mvc","sub":"1","auth_time":1565078380,"idp":"local","name":"alice","email":"alice@email.com","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-08-06 10:59:41.216 +03:00 [DBG] Creating userinfo response
2019-08-06 10:59:41.221 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-06 10:59:41.228 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-06 10:59:41.234 +03:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-06 10:59:41.235 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-06 10:59:41.241 +03:00 [INF] Profile service returned the following claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-06 10:59:41.244 +03:00 [DBG] End userinfo request
2019-08-06 11:13:05.156 +03:00 [INF] Starting IdentityServer4 version 2.5.0.0
2019-08-06 11:13:05.230 +03:00 [INF] Using the default authentication scheme MyCookie for IdentityServer
2019-08-06 11:13:05.231 +03:00 [DBG] Using MyCookie as default ASP.NET Core scheme for authentication
2019-08-06 11:13:05.231 +03:00 [DBG] Using MyCookie as default ASP.NET Core scheme for sign-in
2019-08-06 11:13:05.232 +03:00 [DBG] Using MyCookie as default ASP.NET Core scheme for sign-out
2019-08-06 11:13:05.232 +03:00 [DBG] Using MyCookie as default ASP.NET Core scheme for challenge
2019-08-06 11:13:05.233 +03:00 [DBG] Using MyCookie as default ASP.NET Core scheme for forbid
2019-08-06 11:13:06.642 +03:00 [DBG] Login Url: /account/login
2019-08-06 11:13:06.647 +03:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-08-06 11:13:06.648 +03:00 [DBG] Logout Url: /Account/Logout
2019-08-06 11:13:06.648 +03:00 [DBG] ConsentUrl Url: /consent
2019-08-06 11:13:06.649 +03:00 [DBG] Consent Return Url Parameter: returnUrl
2019-08-06 11:13:06.650 +03:00 [DBG] Error Url: /home/error
2019-08-06 11:13:06.650 +03:00 [DBG] Error Id Parameter: errorId
2019-08-06 11:13:06.703 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-08-06 11:13:06.738 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-08-06 11:13:06.742 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-08-06 11:13:06.752 +03:00 [DBG] Start authorize request
2019-08-06 11:13:06.782 +03:00 [DBG] No user present in authorize request
2019-08-06 11:13:06.806 +03:00 [DBG] Start authorize request protocol validation
2019-08-06 11:13:06.843 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-06 11:13:06.866 +03:00 [DBG] Checking for PKCE parameters
2019-08-06 11:13:06.869 +03:00 [DBG] No PKCE used.
2019-08-06 11:13:06.943 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-06 11:13:06.984 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/signin-oidc","AllowedRedirectUris":["http://localhost:5002/signin-oidc"],"SubjectId":"anonymous","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9M6c7pPPN_7S3LpOFxok6MlQPSYJ40bz-Dr9_LliEsGqBSYhswQnTu1rNO2UkPH4x6jY1yA6AqbMNf6BGNdCaP04CRExa8j9VaAGteVIY0OgH0ZA2nzbRMtoG4Ux0brPN0pgGjQMEMIz_qoIyh0Y199NiPMYhTKiLAgglNrd_8a0i11enNSDAOgVReFOM03irinHumlJ-MKkRFNLA51gEKfTZrp-0auQ6BJwYpfig7LnVylVDuwtyMelfB5NPLq_MQdLvjspcgR843vUWKxfryAXFCPl_2bDudd94K71uicsw","UiLocales":null,"Nonce":"637006759864092054.MWZiNzM0YzAtZDQ1MC00MzE4LWI3OGUtMTg3OThjMmQ4NzUxNzM0YjgyZWItMmIzMS00MjczLWFhODAtYWZmMjhmNjVkZGIw","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637006759864092054.MWZiNzM0YzAtZDQ1MC00MzE4LWI3OGUtMTg3OThjMmQ4NzUxNzM0YjgyZWItMmIzMS00MjczLWFhODAtYWZmMjhmNjVkZGIw","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9M6c7pPPN_7S3LpOFxok6MlQPSYJ40bz-Dr9_LliEsGqBSYhswQnTu1rNO2UkPH4x6jY1yA6AqbMNf6BGNdCaP04CRExa8j9VaAGteVIY0OgH0ZA2nzbRMtoG4Ux0brPN0pgGjQMEMIz_qoIyh0Y199NiPMYhTKiLAgglNrd_8a0i11enNSDAOgVReFOM03irinHumlJ-MKkRFNLA51gEKfTZrp-0auQ6BJwYpfig7LnVylVDuwtyMelfB5NPLq_MQdLvjspcgR843vUWKxfryAXFCPl_2bDudd94K71uicsw","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-06 11:13:07.059 +03:00 [INF] Showing login: User is not authenticated
2019-08-06 11:13:07.412 +03:00 [DBG] Start authorize request protocol validation
2019-08-06 11:13:07.413 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-06 11:13:07.420 +03:00 [DBG] Checking for PKCE parameters
2019-08-06 11:13:07.421 +03:00 [DBG] No PKCE used.
2019-08-06 11:13:07.422 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-06 11:13:07.427 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-06 11:13:10.062 +03:00 [DBG] CORS request made for path: /account/login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-08-06 11:13:10.124 +03:00 [DBG] Start authorize request protocol validation
2019-08-06 11:13:10.125 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-06 11:13:10.130 +03:00 [DBG] Checking for PKCE parameters
2019-08-06 11:13:10.133 +03:00 [DBG] No PKCE used.
2019-08-06 11:13:10.135 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-06 11:13:10.176 +03:00 [DBG] Augmenting SignInContext
2019-08-06 11:13:10.182 +03:00 [DBG] Adding idp claim with value: local
2019-08-06 11:13:10.183 +03:00 [DBG] Adding amr claim with value: pwd
2019-08-06 11:13:10.204 +03:00 [INF] AuthenticationScheme: MyCookie signed in.
2019-08-06 11:13:10.212 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-06 11:13:10.225 +03:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-08-06 11:13:10.232 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-08-06 11:13:10.234 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-08-06 11:13:10.248 +03:00 [DBG] Start authorize callback request
2019-08-06 11:13:10.257 +03:00 [DBG] User in authorize request: 1
2019-08-06 11:13:10.257 +03:00 [DBG] Start authorize request protocol validation
2019-08-06 11:13:10.259 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-06 11:13:10.262 +03:00 [DBG] Checking for PKCE parameters
2019-08-06 11:13:10.267 +03:00 [DBG] No PKCE used.
2019-08-06 11:13:10.271 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-06 11:13:10.273 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/signin-oidc","AllowedRedirectUris":["http://localhost:5002/signin-oidc"],"SubjectId":"1","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9M6c7pPPN_7S3LpOFxok6MlQPSYJ40bz-Dr9_LliEsGqBSYhswQnTu1rNO2UkPH4x6jY1yA6AqbMNf6BGNdCaP04CRExa8j9VaAGteVIY0OgH0ZA2nzbRMtoG4Ux0brPN0pgGjQMEMIz_qoIyh0Y199NiPMYhTKiLAgglNrd_8a0i11enNSDAOgVReFOM03irinHumlJ-MKkRFNLA51gEKfTZrp-0auQ6BJwYpfig7LnVylVDuwtyMelfB5NPLq_MQdLvjspcgR843vUWKxfryAXFCPl_2bDudd94K71uicsw","UiLocales":null,"Nonce":"637006759864092054.MWZiNzM0YzAtZDQ1MC00MzE4LWI3OGUtMTg3OThjMmQ4NzUxNzM0YjgyZWItMmIzMS00MjczLWFhODAtYWZmMjhmNjVkZGIw","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"0a8cdb40c260661a31259e84572ac5f8","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637006759864092054.MWZiNzM0YzAtZDQ1MC00MzE4LWI3OGUtMTg3OThjMmQ4NzUxNzM0YjgyZWItMmIzMS00MjczLWFhODAtYWZmMjhmNjVkZGIw","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9M6c7pPPN_7S3LpOFxok6MlQPSYJ40bz-Dr9_LliEsGqBSYhswQnTu1rNO2UkPH4x6jY1yA6AqbMNf6BGNdCaP04CRExa8j9VaAGteVIY0OgH0ZA2nzbRMtoG4Ux0brPN0pgGjQMEMIz_qoIyh0Y199NiPMYhTKiLAgglNrd_8a0i11enNSDAOgVReFOM03irinHumlJ-MKkRFNLA51gEKfTZrp-0auQ6BJwYpfig7LnVylVDuwtyMelfB5NPLq_MQdLvjspcgR843vUWKxfryAXFCPl_2bDudd94K71uicsw","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-06 11:13:10.313 +03:00 [DBG] Client is configured to not require consent, no consent is required
2019-08-06 11:13:10.324 +03:00 [DBG] Creating Hybrid Flow response.
2019-08-06 11:13:34.155 +03:00 [DBG] Creating Implicit Flow response.
2019-08-06 11:13:34.174 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-06 11:13:34.178 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-06 11:13:34.302 +03:00 [DBG] Authorize endpoint response
{"SubjectId":"1","ClientId":"mvc","RedirectUri":"http://localhost:5002/signin-oidc","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9M6c7pPPN_7S3LpOFxok6MlQPSYJ40bz-Dr9_LliEsGqBSYhswQnTu1rNO2UkPH4x6jY1yA6AqbMNf6BGNdCaP04CRExa8j9VaAGteVIY0OgH0ZA2nzbRMtoG4Ux0brPN0pgGjQMEMIz_qoIyh0Y199NiPMYhTKiLAgglNrd_8a0i11enNSDAOgVReFOM03irinHumlJ-MKkRFNLA51gEKfTZrp-0auQ6BJwYpfig7LnVylVDuwtyMelfB5NPLq_MQdLvjspcgR843vUWKxfryAXFCPl_2bDudd94K71uicsw","Scope":"openid profile afcpayroll offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-08-06 11:13:34.338 +03:00 [DBG] Augmenting SignInContext
2019-08-06 11:13:34.339 +03:00 [INF] AuthenticationScheme: MyCookie signed in.
2019-08-06 11:13:34.562 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-06 11:13:34.588 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-06 11:13:34.592 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-06 11:13:34.610 +03:00 [DBG] Start token request.
2019-08-06 11:13:34.625 +03:00 [DBG] Start client validation
2019-08-06 11:13:34.634 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-06 11:13:34.642 +03:00 [DBG] Start parsing for secret in post body
2019-08-06 11:13:34.643 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-06 11:13:34.643 +03:00 [DBG] Secret id found: mvc
2019-08-06 11:13:34.647 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-06 11:13:34.663 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-06 11:13:34.663 +03:00 [DBG] Client validation success
2019-08-06 11:13:34.679 +03:00 [DBG] Start token request validation
2019-08-06 11:13:34.697 +03:00 [DBG] Start validation of authorization code token request
2019-08-06 11:14:30.796 +03:00 [DBG] Validation of authorization code token request success
2019-08-06 11:14:30.805 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"92dc247c3816aabc1f061fe59a36701b04f696631f88f7ba9505b2271af0156b","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"mvc","client_secret":"***REDACTED***","code":"92dc247c3816aabc1f061fe59a36701b04f696631f88f7ba9505b2271af0156b","grant_type":"authorization_code","redirect_uri":"http://localhost:5002/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-08-06 11:14:30.839 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-06 11:14:30.859 +03:00 [DBG] Getting claims for access token for client: mvc
2019-08-06 11:14:30.862 +03:00 [DBG] Getting claims for access token for subject: 1
2019-08-06 11:14:30.886 +03:00 [DBG] Creating refresh token
2019-08-06 11:14:30.887 +03:00 [DBG] Setting an absolute lifetime: 2592000
2019-08-06 11:14:40.036 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-06 11:14:40.044 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-06 11:14:40.047 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-06 11:14:40.087 +03:00 [DBG] Token request success.
2019-08-06 11:14:57.139 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-08-06 11:14:57.160 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-08-06 11:14:57.176 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-08-06 11:14:57.182 +03:00 [DBG] Start authorize request
2019-08-06 11:14:57.199 +03:00 [DBG] No user present in authorize request
2019-08-06 11:14:57.203 +03:00 [DBG] Start authorize request protocol validation
2019-08-06 11:14:57.207 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-06 11:14:57.218 +03:00 [DBG] Checking for PKCE parameters
2019-08-06 11:14:57.227 +03:00 [DBG] No PKCE used.
2019-08-06 11:14:57.230 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-06 11:14:57.239 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/signin-oidc","AllowedRedirectUris":["http://localhost:5002/signin-oidc"],"SubjectId":"anonymous","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9NonAXfuEf-dQOqJiryN1LvpX0EwoOTop5fuZ988oEI9BVGDJn20bBBqqvrx46Ycxns-41zl1M3BuFRehL76AYOaBuJHuT7yRfrrV4JF5V-HjKj5vdgPMI6skr8Z7ZFI06tGGNyUQ0Rtf6IZIulNQ2GBXgzbhLEe9ScihJxy4RbtyrEbzFPxFL3IpuJ0zAdcaARVHuwI-IhW9aQckvIwgpU5LFfMvBE7Gi8OEOgUQDaRV1zlpkK4riylPqHzZA-8jB70ClFtNwlznr-Lb7EsQVnQYLvR0AjNoC3H1MPq5a1UA","UiLocales":null,"Nonce":"637006760971079643.MmM0MjEyYzktMDZkZi00MmRkLTk3YjAtNjUwY2VlOWM3NjhkOTllNTJkYzUtOTZlYS00ODAwLTg1NjEtZGY5MWU2MTMwYzQy","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637006760971079643.MmM0MjEyYzktMDZkZi00MmRkLTk3YjAtNjUwY2VlOWM3NjhkOTllNTJkYzUtOTZlYS00ODAwLTg1NjEtZGY5MWU2MTMwYzQy","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9NonAXfuEf-dQOqJiryN1LvpX0EwoOTop5fuZ988oEI9BVGDJn20bBBqqvrx46Ycxns-41zl1M3BuFRehL76AYOaBuJHuT7yRfrrV4JF5V-HjKj5vdgPMI6skr8Z7ZFI06tGGNyUQ0Rtf6IZIulNQ2GBXgzbhLEe9ScihJxy4RbtyrEbzFPxFL3IpuJ0zAdcaARVHuwI-IhW9aQckvIwgpU5LFfMvBE7Gi8OEOgUQDaRV1zlpkK4riylPqHzZA-8jB70ClFtNwlznr-Lb7EsQVnQYLvR0AjNoC3H1MPq5a1UA","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-06 11:14:57.274 +03:00 [INF] Showing login: User is not authenticated
2019-08-06 11:14:57.285 +03:00 [DBG] Start authorize request protocol validation
2019-08-06 11:14:57.286 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-06 11:14:57.291 +03:00 [DBG] Checking for PKCE parameters
2019-08-06 11:14:57.306 +03:00 [DBG] No PKCE used.
2019-08-06 11:14:57.311 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-06 11:14:57.313 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-06 11:15:05.585 +03:00 [DBG] CORS request made for path: /account/login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-08-06 11:15:05.590 +03:00 [DBG] Start authorize request protocol validation
2019-08-06 11:15:05.592 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-06 11:15:05.596 +03:00 [DBG] Checking for PKCE parameters
2019-08-06 11:15:05.603 +03:00 [DBG] No PKCE used.
2019-08-06 11:15:05.609 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-06 11:15:05.613 +03:00 [DBG] Augmenting SignInContext
2019-08-06 11:15:05.615 +03:00 [DBG] Adding idp claim with value: local
2019-08-06 11:15:05.616 +03:00 [DBG] Adding amr claim with value: pwd
2019-08-06 11:15:05.619 +03:00 [INF] AuthenticationScheme: MyCookie signed in.
2019-08-06 11:15:05.626 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-06 11:15:05.642 +03:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-08-06 11:15:05.645 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-08-06 11:15:05.652 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-08-06 11:15:05.654 +03:00 [DBG] Start authorize callback request
2019-08-06 11:15:05.655 +03:00 [DBG] User in authorize request: 1
2019-08-06 11:15:05.659 +03:00 [DBG] Start authorize request protocol validation
2019-08-06 11:15:05.661 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-06 11:15:05.663 +03:00 [DBG] Checking for PKCE parameters
2019-08-06 11:15:05.668 +03:00 [DBG] No PKCE used.
2019-08-06 11:15:05.672 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-06 11:15:05.675 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/signin-oidc","AllowedRedirectUris":["http://localhost:5002/signin-oidc"],"SubjectId":"1","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9NonAXfuEf-dQOqJiryN1LvpX0EwoOTop5fuZ988oEI9BVGDJn20bBBqqvrx46Ycxns-41zl1M3BuFRehL76AYOaBuJHuT7yRfrrV4JF5V-HjKj5vdgPMI6skr8Z7ZFI06tGGNyUQ0Rtf6IZIulNQ2GBXgzbhLEe9ScihJxy4RbtyrEbzFPxFL3IpuJ0zAdcaARVHuwI-IhW9aQckvIwgpU5LFfMvBE7Gi8OEOgUQDaRV1zlpkK4riylPqHzZA-8jB70ClFtNwlznr-Lb7EsQVnQYLvR0AjNoC3H1MPq5a1UA","UiLocales":null,"Nonce":"637006760971079643.MmM0MjEyYzktMDZkZi00MmRkLTk3YjAtNjUwY2VlOWM3NjhkOTllNTJkYzUtOTZlYS00ODAwLTg1NjEtZGY5MWU2MTMwYzQy","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"38a0134625d8f92a3974232256e331b2","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637006760971079643.MmM0MjEyYzktMDZkZi00MmRkLTk3YjAtNjUwY2VlOWM3NjhkOTllNTJkYzUtOTZlYS00ODAwLTg1NjEtZGY5MWU2MTMwYzQy","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9NonAXfuEf-dQOqJiryN1LvpX0EwoOTop5fuZ988oEI9BVGDJn20bBBqqvrx46Ycxns-41zl1M3BuFRehL76AYOaBuJHuT7yRfrrV4JF5V-HjKj5vdgPMI6skr8Z7ZFI06tGGNyUQ0Rtf6IZIulNQ2GBXgzbhLEe9ScihJxy4RbtyrEbzFPxFL3IpuJ0zAdcaARVHuwI-IhW9aQckvIwgpU5LFfMvBE7Gi8OEOgUQDaRV1zlpkK4riylPqHzZA-8jB70ClFtNwlznr-Lb7EsQVnQYLvR0AjNoC3H1MPq5a1UA","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-06 11:15:05.733 +03:00 [DBG] Client is configured to not require consent, no consent is required
2019-08-06 11:15:05.734 +03:00 [DBG] Creating Hybrid Flow response.
2019-08-06 11:15:05.735 +03:00 [DBG] Creating Implicit Flow response.
2019-08-06 11:15:05.743 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-06 11:15:05.746 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-06 11:15:05.757 +03:00 [DBG] Authorize endpoint response
{"SubjectId":"1","ClientId":"mvc","RedirectUri":"http://localhost:5002/signin-oidc","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9NonAXfuEf-dQOqJiryN1LvpX0EwoOTop5fuZ988oEI9BVGDJn20bBBqqvrx46Ycxns-41zl1M3BuFRehL76AYOaBuJHuT7yRfrrV4JF5V-HjKj5vdgPMI6skr8Z7ZFI06tGGNyUQ0Rtf6IZIulNQ2GBXgzbhLEe9ScihJxy4RbtyrEbzFPxFL3IpuJ0zAdcaARVHuwI-IhW9aQckvIwgpU5LFfMvBE7Gi8OEOgUQDaRV1zlpkK4riylPqHzZA-8jB70ClFtNwlznr-Lb7EsQVnQYLvR0AjNoC3H1MPq5a1UA","Scope":"openid profile afcpayroll offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-08-06 11:15:05.772 +03:00 [DBG] Augmenting SignInContext
2019-08-06 11:15:05.773 +03:00 [INF] AuthenticationScheme: MyCookie signed in.
2019-08-06 11:15:06.037 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-06 11:15:06.041 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-06 11:15:06.052 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-06 11:15:06.058 +03:00 [DBG] Start token request.
2019-08-06 11:15:06.059 +03:00 [DBG] Start client validation
2019-08-06 11:15:06.060 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-06 11:15:06.061 +03:00 [DBG] Start parsing for secret in post body
2019-08-06 11:15:06.062 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-06 11:15:06.068 +03:00 [DBG] Secret id found: mvc
2019-08-06 11:15:06.071 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-06 11:15:06.073 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-06 11:15:06.074 +03:00 [DBG] Client validation success
2019-08-06 11:15:06.075 +03:00 [DBG] Start token request validation
2019-08-06 11:15:06.080 +03:00 [DBG] Start validation of authorization code token request
2019-08-06 11:15:06.085 +03:00 [DBG] Validation of authorization code token request success
2019-08-06 11:15:06.087 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"e994b000b2c52a25eb5f3052ed375a61bf30f206f608d6c808a9af8631c9506b","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"mvc","client_secret":"***REDACTED***","code":"e994b000b2c52a25eb5f3052ed375a61bf30f206f608d6c808a9af8631c9506b","grant_type":"authorization_code","redirect_uri":"http://localhost:5002/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-08-06 11:15:06.100 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-06 11:15:06.108 +03:00 [DBG] Getting claims for access token for client: mvc
2019-08-06 11:15:06.109 +03:00 [DBG] Getting claims for access token for subject: 1
2019-08-06 11:15:06.114 +03:00 [DBG] Creating refresh token
2019-08-06 11:15:06.117 +03:00 [DBG] Setting an absolute lifetime: 2592000
2019-08-06 11:15:06.119 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-06 11:15:06.122 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-06 11:15:06.124 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-06 11:15:06.129 +03:00 [DBG] Token request success.
2019-08-06 11:15:06.134 +03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-08-06 11:15:06.138 +03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-08-06 11:15:06.141 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-08-06 11:15:06.164 +03:00 [DBG] Start userinfo request
2019-08-06 11:15:06.171 +03:00 [DBG] Bearer token found in header
2019-08-06 11:15:06.272 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-06 11:15:06.279 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-06 11:15:06.283 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-08-06 11:15:06.289 +03:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1565079306,"exp":1565082906,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","afcpayroll"],"client_id":"mvc","sub":"1","auth_time":1565079305,"idp":"local","name":"alice","email":"alice@email.com","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-08-06 11:15:06.311 +03:00 [DBG] Creating userinfo response
2019-08-06 11:15:06.320 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-06 11:15:06.325 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-06 11:15:06.332 +03:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-06 11:15:06.335 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-06 11:15:06.339 +03:00 [INF] Profile service returned the following claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-06 11:15:06.345 +03:00 [DBG] End userinfo request
2019-08-06 11:15:41.780 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-06 11:43:19.869 +03:00 [INF] Starting IdentityServer4 version 2.5.0.0
2019-08-06 11:43:19.997 +03:00 [INF] Using the default authentication scheme MyCookie for IdentityServer
2019-08-06 11:43:19.998 +03:00 [DBG] Using MyCookie as default ASP.NET Core scheme for authentication
2019-08-06 11:43:19.999 +03:00 [DBG] Using MyCookie as default ASP.NET Core scheme for sign-in
2019-08-06 11:43:19.999 +03:00 [DBG] Using MyCookie as default ASP.NET Core scheme for sign-out
2019-08-06 11:43:20.000 +03:00 [DBG] Using MyCookie as default ASP.NET Core scheme for challenge
2019-08-06 11:43:20.000 +03:00 [DBG] Using MyCookie as default ASP.NET Core scheme for forbid
2019-08-06 11:43:28.162 +03:00 [DBG] Login Url: /account/login
2019-08-06 11:43:28.167 +03:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-08-06 11:43:28.168 +03:00 [DBG] Logout Url: /Account/Logout
2019-08-06 11:43:28.169 +03:00 [DBG] ConsentUrl Url: /consent
2019-08-06 11:43:28.169 +03:00 [DBG] Consent Return Url Parameter: returnUrl
2019-08-06 11:43:28.170 +03:00 [DBG] Error Url: /home/error
2019-08-06 11:43:28.170 +03:00 [DBG] Error Id Parameter: errorId
2019-08-06 11:43:28.229 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-06 11:43:28.235 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-06 11:43:28.237 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-06 11:43:28.244 +03:00 [DBG] Start discovery request
2019-08-06 11:43:28.456 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-06 11:43:28.464 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-06 11:43:28.466 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-06 11:43:28.473 +03:00 [DBG] Start key discovery request
2019-08-06 11:43:28.579 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-08-06 11:43:28.615 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-08-06 11:43:28.619 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-08-06 11:43:28.628 +03:00 [DBG] Start authorize request
2019-08-06 11:43:28.645 +03:00 [DBG] No user present in authorize request
2019-08-06 11:43:28.653 +03:00 [DBG] Start authorize request protocol validation
2019-08-06 11:43:28.688 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-06 11:43:28.716 +03:00 [DBG] Checking for PKCE parameters
2019-08-06 11:43:28.720 +03:00 [DBG] No PKCE used.
2019-08-06 11:43:28.777 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-06 11:43:28.807 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/signin-oidc","AllowedRedirectUris":["http://localhost:5002/signin-oidc"],"SubjectId":"anonymous","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9OZlubnLvP5Q-QyjY-lgp10Gp44l3_8F2Y3FG5OTzr2IMk6Qc2fkVpuXe4Btg7FOQhw8LLkGRz_s3xyhnLG5oiZ-Wr-Fdtsc7CYUyULe0rss43y6OLgCX5OJk0MSSDQ0j84_U1hKLi5qHyDz7KunSllbfKu7AcNl8nL_QdUePsDnsyvQKE1MyePD3WcTvfh9TsfcA6y4gS7Hht4JakLmWBg_SAsuMmRT4nE2L-Lm1PMtfo2OeHceJQ87yYFvTyeG0FcNbLovzeO9XAXBOXED6F-X81SyhaTRAImNus4kdI5Hw","UiLocales":null,"Nonce":"637006778085241434.MzczNTc0OTctYjJlNy00OGNlLWEwOGItZDI1YjBjYTQ4YjBmODUzNDY3YTAtYzU5MC00ZTRiLTlhMzktNmVjZjgwNzk1OTBh","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637006778085241434.MzczNTc0OTctYjJlNy00OGNlLWEwOGItZDI1YjBjYTQ4YjBmODUzNDY3YTAtYzU5MC00ZTRiLTlhMzktNmVjZjgwNzk1OTBh","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9OZlubnLvP5Q-QyjY-lgp10Gp44l3_8F2Y3FG5OTzr2IMk6Qc2fkVpuXe4Btg7FOQhw8LLkGRz_s3xyhnLG5oiZ-Wr-Fdtsc7CYUyULe0rss43y6OLgCX5OJk0MSSDQ0j84_U1hKLi5qHyDz7KunSllbfKu7AcNl8nL_QdUePsDnsyvQKE1MyePD3WcTvfh9TsfcA6y4gS7Hht4JakLmWBg_SAsuMmRT4nE2L-Lm1PMtfo2OeHceJQ87yYFvTyeG0FcNbLovzeO9XAXBOXED6F-X81SyhaTRAImNus4kdI5Hw","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-06 11:43:28.885 +03:00 [INF] Showing login: User is not authenticated
2019-08-06 11:43:29.169 +03:00 [DBG] Start authorize request protocol validation
2019-08-06 11:43:29.170 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-06 11:43:29.176 +03:00 [DBG] Checking for PKCE parameters
2019-08-06 11:43:29.177 +03:00 [DBG] No PKCE used.
2019-08-06 11:43:29.178 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-06 11:43:29.186 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-06 11:43:31.623 +03:00 [DBG] CORS request made for path: /account/login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-08-06 11:43:31.695 +03:00 [DBG] Start authorize request protocol validation
2019-08-06 11:43:31.699 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-06 11:43:31.705 +03:00 [DBG] Checking for PKCE parameters
2019-08-06 11:43:31.706 +03:00 [DBG] No PKCE used.
2019-08-06 11:43:31.708 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-06 11:43:31.745 +03:00 [DBG] Augmenting SignInContext
2019-08-06 11:43:31.750 +03:00 [DBG] Adding idp claim with value: local
2019-08-06 11:43:31.750 +03:00 [DBG] Adding amr claim with value: pwd
2019-08-06 11:43:31.768 +03:00 [INF] AuthenticationScheme: MyCookie signed in.
2019-08-06 11:43:31.773 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-06 11:43:31.788 +03:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-08-06 11:43:31.792 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-08-06 11:43:31.797 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-08-06 11:43:31.813 +03:00 [DBG] Start authorize callback request
2019-08-06 11:43:31.820 +03:00 [DBG] User in authorize request: 1
2019-08-06 11:43:31.821 +03:00 [DBG] Start authorize request protocol validation
2019-08-06 11:43:31.822 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-06 11:43:31.829 +03:00 [DBG] Checking for PKCE parameters
2019-08-06 11:43:31.830 +03:00 [DBG] No PKCE used.
2019-08-06 11:43:31.834 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-06 11:43:31.837 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/signin-oidc","AllowedRedirectUris":["http://localhost:5002/signin-oidc"],"SubjectId":"1","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9OZlubnLvP5Q-QyjY-lgp10Gp44l3_8F2Y3FG5OTzr2IMk6Qc2fkVpuXe4Btg7FOQhw8LLkGRz_s3xyhnLG5oiZ-Wr-Fdtsc7CYUyULe0rss43y6OLgCX5OJk0MSSDQ0j84_U1hKLi5qHyDz7KunSllbfKu7AcNl8nL_QdUePsDnsyvQKE1MyePD3WcTvfh9TsfcA6y4gS7Hht4JakLmWBg_SAsuMmRT4nE2L-Lm1PMtfo2OeHceJQ87yYFvTyeG0FcNbLovzeO9XAXBOXED6F-X81SyhaTRAImNus4kdI5Hw","UiLocales":null,"Nonce":"637006778085241434.MzczNTc0OTctYjJlNy00OGNlLWEwOGItZDI1YjBjYTQ4YjBmODUzNDY3YTAtYzU5MC00ZTRiLTlhMzktNmVjZjgwNzk1OTBh","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"12db34dd63afce5fccf896432a9f5548","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637006778085241434.MzczNTc0OTctYjJlNy00OGNlLWEwOGItZDI1YjBjYTQ4YjBmODUzNDY3YTAtYzU5MC00ZTRiLTlhMzktNmVjZjgwNzk1OTBh","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9OZlubnLvP5Q-QyjY-lgp10Gp44l3_8F2Y3FG5OTzr2IMk6Qc2fkVpuXe4Btg7FOQhw8LLkGRz_s3xyhnLG5oiZ-Wr-Fdtsc7CYUyULe0rss43y6OLgCX5OJk0MSSDQ0j84_U1hKLi5qHyDz7KunSllbfKu7AcNl8nL_QdUePsDnsyvQKE1MyePD3WcTvfh9TsfcA6y4gS7Hht4JakLmWBg_SAsuMmRT4nE2L-Lm1PMtfo2OeHceJQ87yYFvTyeG0FcNbLovzeO9XAXBOXED6F-X81SyhaTRAImNus4kdI5Hw","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-06 11:43:31.881 +03:00 [DBG] Client is configured to not require consent, no consent is required
2019-08-06 11:43:31.891 +03:00 [DBG] Creating Hybrid Flow response.
2019-08-06 11:43:34.475 +03:00 [DBG] Creating Implicit Flow response.
2019-08-06 11:43:34.489 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-06 11:43:34.496 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-06 11:43:34.626 +03:00 [DBG] Authorize endpoint response
{"SubjectId":"1","ClientId":"mvc","RedirectUri":"http://localhost:5002/signin-oidc","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9OZlubnLvP5Q-QyjY-lgp10Gp44l3_8F2Y3FG5OTzr2IMk6Qc2fkVpuXe4Btg7FOQhw8LLkGRz_s3xyhnLG5oiZ-Wr-Fdtsc7CYUyULe0rss43y6OLgCX5OJk0MSSDQ0j84_U1hKLi5qHyDz7KunSllbfKu7AcNl8nL_QdUePsDnsyvQKE1MyePD3WcTvfh9TsfcA6y4gS7Hht4JakLmWBg_SAsuMmRT4nE2L-Lm1PMtfo2OeHceJQ87yYFvTyeG0FcNbLovzeO9XAXBOXED6F-X81SyhaTRAImNus4kdI5Hw","Scope":"openid profile afcpayroll offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-08-06 11:43:34.658 +03:00 [DBG] Augmenting SignInContext
2019-08-06 11:43:34.659 +03:00 [INF] AuthenticationScheme: MyCookie signed in.
2019-08-06 11:43:35.015 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-06 11:43:35.026 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-06 11:43:35.029 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-06 11:43:35.045 +03:00 [DBG] Start token request.
2019-08-06 11:43:35.056 +03:00 [DBG] Start client validation
2019-08-06 11:43:35.067 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-06 11:43:35.075 +03:00 [DBG] Start parsing for secret in post body
2019-08-06 11:43:35.076 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-06 11:43:35.077 +03:00 [DBG] Secret id found: mvc
2019-08-06 11:43:35.079 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-06 11:43:35.104 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-06 11:43:35.104 +03:00 [DBG] Client validation success
2019-08-06 11:43:35.122 +03:00 [DBG] Start token request validation
2019-08-06 11:43:35.143 +03:00 [DBG] Start validation of authorization code token request
2019-08-06 11:43:40.400 +03:00 [DBG] Validation of authorization code token request success
2019-08-06 11:43:40.409 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"bc3964ad654501a2c639fbc7209f47203b2b37e00dffadf7fac1892c21b36918","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"mvc","client_secret":"***REDACTED***","code":"bc3964ad654501a2c639fbc7209f47203b2b37e00dffadf7fac1892c21b36918","grant_type":"authorization_code","redirect_uri":"http://localhost:5002/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-08-06 11:43:40.443 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-06 11:43:40.462 +03:00 [DBG] Getting claims for access token for client: mvc
2019-08-06 11:43:40.463 +03:00 [DBG] Getting claims for access token for subject: 1
2019-08-06 11:43:40.480 +03:00 [DBG] Creating refresh token
2019-08-06 11:43:40.481 +03:00 [DBG] Setting an absolute lifetime: 2592000
2019-08-06 11:43:41.294 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-06 11:43:41.299 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-06 11:43:41.305 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-06 11:43:41.317 +03:00 [DBG] Token request success.
2019-08-06 11:43:41.334 +03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-08-06 11:43:41.338 +03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-08-06 11:43:41.341 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-08-06 11:43:41.356 +03:00 [DBG] Start userinfo request
2019-08-06 11:43:41.363 +03:00 [DBG] Bearer token found in header
2019-08-06 11:43:41.453 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-06 11:43:41.460 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-06 11:43:41.463 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-08-06 11:43:41.466 +03:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1565081020,"exp":1565084620,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","afcpayroll"],"client_id":"mvc","sub":"1","auth_time":1565081011,"idp":"local","name":"alice","email":"alice@email.com","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-08-06 11:43:41.489 +03:00 [DBG] Creating userinfo response
2019-08-06 11:43:41.496 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-06 11:43:41.506 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-06 11:43:41.513 +03:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-06 11:43:41.517 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-06 11:43:41.520 +03:00 [INF] Profile service returned the following claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-06 11:43:41.525 +03:00 [DBG] End userinfo request
2019-08-06 11:43:52.938 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-08-06 11:43:52.960 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-08-06 11:43:52.982 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-08-06 11:43:53.020 +03:00 [DBG] Start authorize request
2019-08-06 11:43:53.042 +03:00 [DBG] User in authorize request: 1
2019-08-06 11:43:53.049 +03:00 [DBG] Start authorize request protocol validation
2019-08-06 11:43:53.058 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-06 11:43:53.062 +03:00 [DBG] Checking for PKCE parameters
2019-08-06 11:43:53.064 +03:00 [DBG] No PKCE used.
2019-08-06 11:43:53.065 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-06 11:43:53.066 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/signin-oidc","AllowedRedirectUris":["http://localhost:5002/signin-oidc"],"SubjectId":"1","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9MZVETN8qXGSxLX6B1MTSbiILo1e4VIOHVvHLoDT08WWxzng0KvqsKJRtY1VRuRw7HutlnHy4gE37uoau3NEMv5evdkj5UX04RTHA5DJLMILrhnSxqx3eixMTf3v98cmerZ7YVxp-yRfbDuyNZP0fLm6elztdI3I6XinpomujdeeaqYaNJiFDoOgHQlC4AD73GiTMObpypa1QIr436dOsst3WNS84uzQSGQzHHkPqvHwfiLTm-pxb1JQv8qEgxvILY44Dkw1GglsBs0P-fS2_xlhhOgKmtiuDzcj5f55xSngw","UiLocales":null,"Nonce":"637006778329244562.ODA3NmI0NGQtOGI5YS00ZmM0LWExYTItMmJkNTczMDVjMmZhYjA0ZmRiOTEtY2MzOS00NTA1LWJiZTUtNGVmOTYwNWMxM2M2","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"12db34dd63afce5fccf896432a9f5548","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637006778329244562.ODA3NmI0NGQtOGI5YS00ZmM0LWExYTItMmJkNTczMDVjMmZhYjA0ZmRiOTEtY2MzOS00NTA1LWJiZTUtNGVmOTYwNWMxM2M2","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9MZVETN8qXGSxLX6B1MTSbiILo1e4VIOHVvHLoDT08WWxzng0KvqsKJRtY1VRuRw7HutlnHy4gE37uoau3NEMv5evdkj5UX04RTHA5DJLMILrhnSxqx3eixMTf3v98cmerZ7YVxp-yRfbDuyNZP0fLm6elztdI3I6XinpomujdeeaqYaNJiFDoOgHQlC4AD73GiTMObpypa1QIr436dOsst3WNS84uzQSGQzHHkPqvHwfiLTm-pxb1JQv8qEgxvILY44Dkw1GglsBs0P-fS2_xlhhOgKmtiuDzcj5f55xSngw","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-06 11:43:53.106 +03:00 [DBG] Client is configured to not require consent, no consent is required
2019-08-06 11:43:53.107 +03:00 [DBG] Creating Hybrid Flow response.
2019-08-06 11:43:57.150 +03:00 [DBG] Creating Implicit Flow response.
2019-08-06 11:43:57.152 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-06 11:43:57.158 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-06 11:43:57.164 +03:00 [DBG] Authorize endpoint response
{"SubjectId":"1","ClientId":"mvc","RedirectUri":"http://localhost:5002/signin-oidc","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9MZVETN8qXGSxLX6B1MTSbiILo1e4VIOHVvHLoDT08WWxzng0KvqsKJRtY1VRuRw7HutlnHy4gE37uoau3NEMv5evdkj5UX04RTHA5DJLMILrhnSxqx3eixMTf3v98cmerZ7YVxp-yRfbDuyNZP0fLm6elztdI3I6XinpomujdeeaqYaNJiFDoOgHQlC4AD73GiTMObpypa1QIr436dOsst3WNS84uzQSGQzHHkPqvHwfiLTm-pxb1JQv8qEgxvILY44Dkw1GglsBs0P-fS2_xlhhOgKmtiuDzcj5f55xSngw","Scope":"openid profile afcpayroll offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-08-06 11:43:57.461 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-06 11:43:57.466 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-06 11:43:57.476 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-06 11:43:57.478 +03:00 [DBG] Start token request.
2019-08-06 11:43:57.479 +03:00 [DBG] Start client validation
2019-08-06 11:43:57.481 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-06 11:43:57.485 +03:00 [DBG] Start parsing for secret in post body
2019-08-06 11:43:57.490 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-06 11:43:57.491 +03:00 [DBG] Secret id found: mvc
2019-08-06 11:43:57.494 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-06 11:43:57.501 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-06 11:43:57.502 +03:00 [DBG] Client validation success
2019-08-06 11:43:57.505 +03:00 [DBG] Start token request validation
2019-08-06 11:43:57.507 +03:00 [DBG] Start validation of authorization code token request
2019-08-06 11:43:57.508 +03:00 [DBG] Validation of authorization code token request success
2019-08-06 11:43:57.509 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"867569dccc67e008ed5d2d356e73baf5c7ced362b3a52d8a7bacf607eb0db7e5","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"mvc","client_secret":"***REDACTED***","code":"867569dccc67e008ed5d2d356e73baf5c7ced362b3a52d8a7bacf607eb0db7e5","grant_type":"authorization_code","redirect_uri":"http://localhost:5002/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-08-06 11:43:57.524 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-06 11:43:57.530 +03:00 [DBG] Getting claims for access token for client: mvc
2019-08-06 11:43:57.531 +03:00 [DBG] Getting claims for access token for subject: 1
2019-08-06 11:43:57.537 +03:00 [DBG] Creating refresh token
2019-08-06 11:43:57.539 +03:00 [DBG] Setting an absolute lifetime: 2592000
2019-08-06 11:43:57.541 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-06 11:43:57.545 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-06 11:43:57.552 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-06 11:43:57.560 +03:00 [DBG] Token request success.
2019-08-06 11:43:57.573 +03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-08-06 11:43:57.576 +03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-08-06 11:43:57.582 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-08-06 11:43:57.586 +03:00 [DBG] Start userinfo request
2019-08-06 11:43:57.588 +03:00 [DBG] Bearer token found in header
2019-08-06 11:43:57.591 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-06 11:43:57.649 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-06 11:43:57.655 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-08-06 11:43:57.657 +03:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1565081037,"exp":1565084637,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","afcpayroll"],"client_id":"mvc","sub":"1","auth_time":1565081011,"idp":"local","name":"alice","email":"alice@email.com","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-08-06 11:43:57.676 +03:00 [DBG] Creating userinfo response
2019-08-06 11:43:57.681 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-06 11:43:57.684 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-06 11:43:57.692 +03:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-06 11:43:57.700 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-06 11:43:57.704 +03:00 [INF] Profile service returned the following claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-06 11:43:57.706 +03:00 [DBG] End userinfo request
2019-08-06 11:44:03.937 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-08-06 11:44:03.960 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-08-06 11:44:03.983 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-08-06 11:44:04.023 +03:00 [DBG] Start authorize request
2019-08-06 11:44:04.048 +03:00 [DBG] User in authorize request: 1
2019-08-06 11:44:04.052 +03:00 [DBG] Start authorize request protocol validation
2019-08-06 11:44:04.060 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-06 11:44:04.064 +03:00 [DBG] Checking for PKCE parameters
2019-08-06 11:44:04.071 +03:00 [DBG] No PKCE used.
2019-08-06 11:44:04.075 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-06 11:44:04.079 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/signin-oidc","AllowedRedirectUris":["http://localhost:5002/signin-oidc"],"SubjectId":"1","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9NtjJNH3BZrXVGV5JX-8d_Af7IGp_MFUrsxI1nC0ehH8e55gsZDWwkeoFTrgcGBh3kOH5WRO0gcpR2NyDWO_oEBAi2-fUnCzImMjtc7Vdwcu0WkENxPzS4-SEdNRqnMkiqrFySOgh7Hk3lp5XYr7SlmNBC-SZhcsc3xcKuWOyGNTCBC8I-y5EZeegSJb0E4h4A7GY0vmseWd9xxaSzGd-ejM60ekeX--3eTdWR7Ox7bKJNrko2C4kt7dqq024p1zJmQVWFOfa-ZCeFHvJfsHWyDiTlE_y7zaC-MtnHumplWzg","UiLocales":null,"Nonce":"637006778439209278.MTQ5ZGRjYzYtNDZiNS00NTI1LWJjOWMtZjY1YjU4ZGRhZDk4ZTA3YTA2YjYtOGM4NS00Y2VmLTgxYmYtZGY1MGE2MmM0MmRh","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"12db34dd63afce5fccf896432a9f5548","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637006778439209278.MTQ5ZGRjYzYtNDZiNS00NTI1LWJjOWMtZjY1YjU4ZGRhZDk4ZTA3YTA2YjYtOGM4NS00Y2VmLTgxYmYtZGY1MGE2MmM0MmRh","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9NtjJNH3BZrXVGV5JX-8d_Af7IGp_MFUrsxI1nC0ehH8e55gsZDWwkeoFTrgcGBh3kOH5WRO0gcpR2NyDWO_oEBAi2-fUnCzImMjtc7Vdwcu0WkENxPzS4-SEdNRqnMkiqrFySOgh7Hk3lp5XYr7SlmNBC-SZhcsc3xcKuWOyGNTCBC8I-y5EZeegSJb0E4h4A7GY0vmseWd9xxaSzGd-ejM60ekeX--3eTdWR7Ox7bKJNrko2C4kt7dqq024p1zJmQVWFOfa-ZCeFHvJfsHWyDiTlE_y7zaC-MtnHumplWzg","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-06 11:44:04.107 +03:00 [DBG] Client is configured to not require consent, no consent is required
2019-08-06 11:44:04.108 +03:00 [DBG] Creating Hybrid Flow response.
2019-08-06 11:44:04.109 +03:00 [DBG] Creating Implicit Flow response.
2019-08-06 11:44:04.116 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-06 11:44:04.120 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-06 11:44:04.126 +03:00 [DBG] Authorize endpoint response
{"SubjectId":"1","ClientId":"mvc","RedirectUri":"http://localhost:5002/signin-oidc","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9NtjJNH3BZrXVGV5JX-8d_Af7IGp_MFUrsxI1nC0ehH8e55gsZDWwkeoFTrgcGBh3kOH5WRO0gcpR2NyDWO_oEBAi2-fUnCzImMjtc7Vdwcu0WkENxPzS4-SEdNRqnMkiqrFySOgh7Hk3lp5XYr7SlmNBC-SZhcsc3xcKuWOyGNTCBC8I-y5EZeegSJb0E4h4A7GY0vmseWd9xxaSzGd-ejM60ekeX--3eTdWR7Ox7bKJNrko2C4kt7dqq024p1zJmQVWFOfa-ZCeFHvJfsHWyDiTlE_y7zaC-MtnHumplWzg","Scope":"openid profile afcpayroll offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-08-06 11:44:04.366 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-06 11:44:04.369 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-06 11:44:04.374 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-06 11:44:04.385 +03:00 [DBG] Start token request.
2019-08-06 11:44:04.388 +03:00 [DBG] Start client validation
2019-08-06 11:44:04.389 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-06 11:44:04.390 +03:00 [DBG] Start parsing for secret in post body
2019-08-06 11:44:04.393 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-06 11:44:04.398 +03:00 [DBG] Secret id found: mvc
2019-08-06 11:44:04.398 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-06 11:44:04.404 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-06 11:44:04.405 +03:00 [DBG] Client validation success
2019-08-06 11:44:04.410 +03:00 [DBG] Start token request validation
2019-08-06 11:44:04.411 +03:00 [DBG] Start validation of authorization code token request
2019-08-06 11:44:04.415 +03:00 [DBG] Validation of authorization code token request success
2019-08-06 11:44:04.416 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"fd3e036c586abf919b3ef4d333ad590d2e86186adc3718222a32a53e9d268a34","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"mvc","client_secret":"***REDACTED***","code":"fd3e036c586abf919b3ef4d333ad590d2e86186adc3718222a32a53e9d268a34","grant_type":"authorization_code","redirect_uri":"http://localhost:5002/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-08-06 11:44:04.429 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-06 11:44:04.433 +03:00 [DBG] Getting claims for access token for client: mvc
2019-08-06 11:44:04.437 +03:00 [DBG] Getting claims for access token for subject: 1
2019-08-06 11:44:04.442 +03:00 [DBG] Creating refresh token
2019-08-06 11:44:04.442 +03:00 [DBG] Setting an absolute lifetime: 2592000
2019-08-06 11:44:04.444 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-06 11:44:04.453 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-06 11:44:04.456 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-06 11:44:04.461 +03:00 [DBG] Token request success.
2019-08-06 11:44:04.472 +03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-08-06 11:44:04.474 +03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-08-06 11:44:04.478 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-08-06 11:44:04.480 +03:00 [DBG] Start userinfo request
2019-08-06 11:44:04.481 +03:00 [DBG] Bearer token found in header
2019-08-06 11:44:04.488 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-06 11:44:04.490 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-06 11:44:04.492 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-08-06 11:44:04.493 +03:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1565081044,"exp":1565084644,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","afcpayroll"],"client_id":"mvc","sub":"1","auth_time":1565081011,"idp":"local","name":"alice","email":"alice@email.com","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-08-06 11:44:04.512 +03:00 [DBG] Creating userinfo response
2019-08-06 11:44:04.514 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-06 11:44:04.516 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-06 11:44:04.518 +03:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-06 11:44:04.520 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-06 11:44:04.527 +03:00 [INF] Profile service returned the following claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-06 11:44:04.529 +03:00 [DBG] End userinfo request
2019-08-06 11:44:28.163 +03:00 [INF] Starting IdentityServer4 version 2.5.0.0
2019-08-06 11:44:28.241 +03:00 [INF] Using the default authentication scheme MyCookie for IdentityServer
2019-08-06 11:44:28.243 +03:00 [DBG] Using MyCookie as default ASP.NET Core scheme for authentication
2019-08-06 11:44:28.243 +03:00 [DBG] Using MyCookie as default ASP.NET Core scheme for sign-in
2019-08-06 11:44:28.244 +03:00 [DBG] Using MyCookie as default ASP.NET Core scheme for sign-out
2019-08-06 11:44:28.244 +03:00 [DBG] Using MyCookie as default ASP.NET Core scheme for challenge
2019-08-06 11:44:28.245 +03:00 [DBG] Using MyCookie as default ASP.NET Core scheme for forbid
2019-08-06 11:44:35.509 +03:00 [DBG] Login Url: /account/login
2019-08-06 11:44:35.512 +03:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-08-06 11:44:35.513 +03:00 [DBG] Logout Url: /Account/Logout
2019-08-06 11:44:35.514 +03:00 [DBG] ConsentUrl Url: /consent
2019-08-06 11:44:35.514 +03:00 [DBG] Consent Return Url Parameter: returnUrl
2019-08-06 11:44:35.514 +03:00 [DBG] Error Url: /home/error
2019-08-06 11:44:35.514 +03:00 [DBG] Error Id Parameter: errorId
2019-08-06 11:44:35.565 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-06 11:44:35.571 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-06 11:44:35.572 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-06 11:44:35.579 +03:00 [DBG] Start discovery request
2019-08-06 11:44:35.792 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-06 11:44:35.805 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-06 11:44:35.808 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-06 11:44:35.815 +03:00 [DBG] Start key discovery request
2019-08-06 11:44:35.924 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-06 11:44:35.939 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-06 11:44:35.940 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-06 11:44:35.958 +03:00 [DBG] Start token request.
2019-08-06 11:44:35.973 +03:00 [DBG] Start client validation
2019-08-06 11:44:35.987 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-06 11:44:35.994 +03:00 [DBG] Start parsing for secret in post body
2019-08-06 11:44:36.028 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-06 11:44:36.029 +03:00 [DBG] Secret id found: mvc
2019-08-06 11:44:36.071 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-06 11:44:36.093 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-06 11:44:36.093 +03:00 [DBG] Client validation success
2019-08-06 11:44:36.112 +03:00 [DBG] Start token request validation
2019-08-06 11:44:36.130 +03:00 [DBG] Start validation of authorization code token request
2019-08-06 11:44:36.139 +03:00 [DBG] authorization_code grant with value: fd3e036c586abf919b3ef4d333ad590d2e86186adc3718222a32a53e9d268a34 not found in store.
2019-08-06 11:44:36.158 +03:00 [ERR] Invalid authorization code{"code":"fd3e036c586abf919b3ef4d333ad590d2e86186adc3718222a32a53e9d268a34"}, details: {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"fd3e036c586abf919b3ef4d333ad590d2e86186adc3718222a32a53e9d268a34","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"mvc","client_secret":"***REDACTED***","code":"fd3e036c586abf919b3ef4d333ad590d2e86186adc3718222a32a53e9d268a34","grant_type":"authorization_code","redirect_uri":"http://localhost:5002/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-08-06 11:44:38.943 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-08-06 11:44:38.987 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-08-06 11:44:39.013 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-08-06 11:44:39.021 +03:00 [DBG] Start authorize request
2019-08-06 11:44:39.034 +03:00 [DBG] User in authorize request: 1
2019-08-06 11:44:39.043 +03:00 [DBG] Start authorize request protocol validation
2019-08-06 11:44:39.050 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-06 11:44:39.096 +03:00 [DBG] Checking for PKCE parameters
2019-08-06 11:44:39.102 +03:00 [DBG] No PKCE used.
2019-08-06 11:44:39.153 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-06 11:44:39.165 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/signin-oidc","AllowedRedirectUris":["http://localhost:5002/signin-oidc"],"SubjectId":"1","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9OJSbszLn3FZ2dFCxrXzwyEaJlhleaZBVnGlz35yWRyZZb78bj5osOcUupeqSTchM35ThqBMfEL8_U9XBCkGsvDaOV_EUD41lu4twzymH4hCNMlu5OogH5ybt0fQvH4hJ3TCb334JYMBDZavO5idcAviN7WiPQz_voOJQwe6LnDKf3_3QMRmBjz2pDW7f9Y94JyXUMNwF8kPuPyu68rroYaT4m1LUcUZjApa9niX7HIlTxCpHQ3L4qJ7eBd7oa6lg9Y4I_HIZn4DVBQ53IFrw2kKEDAhK6MRDzGpPTzdTXyZA","UiLocales":null,"Nonce":"637006778789220739.NzNhZGE0OGMtZGJiZC00YTViLWI0MmItMzhkOWMzYzY3ZDQ4MzUzMDczZGQtNGU3My00ZDRhLWFkMmItNWQzYTQxMWVlMzQ2","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"12db34dd63afce5fccf896432a9f5548","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637006778789220739.NzNhZGE0OGMtZGJiZC00YTViLWI0MmItMzhkOWMzYzY3ZDQ4MzUzMDczZGQtNGU3My00ZDRhLWFkMmItNWQzYTQxMWVlMzQ2","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9OJSbszLn3FZ2dFCxrXzwyEaJlhleaZBVnGlz35yWRyZZb78bj5osOcUupeqSTchM35ThqBMfEL8_U9XBCkGsvDaOV_EUD41lu4twzymH4hCNMlu5OogH5ybt0fQvH4hJ3TCb334JYMBDZavO5idcAviN7WiPQz_voOJQwe6LnDKf3_3QMRmBjz2pDW7f9Y94JyXUMNwF8kPuPyu68rroYaT4m1LUcUZjApa9niX7HIlTxCpHQ3L4qJ7eBd7oa6lg9Y4I_HIZn4DVBQ53IFrw2kKEDAhK6MRDzGpPTzdTXyZA","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-06 11:44:39.239 +03:00 [DBG] Client is configured to not require consent, no consent is required
2019-08-06 11:44:39.250 +03:00 [DBG] Creating Hybrid Flow response.
2019-08-06 11:44:39.292 +03:00 [DBG] Creating Implicit Flow response.
2019-08-06 11:44:39.308 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-06 11:44:39.313 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-06 11:44:39.437 +03:00 [DBG] Authorize endpoint response
{"SubjectId":"1","ClientId":"mvc","RedirectUri":"http://localhost:5002/signin-oidc","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9OJSbszLn3FZ2dFCxrXzwyEaJlhleaZBVnGlz35yWRyZZb78bj5osOcUupeqSTchM35ThqBMfEL8_U9XBCkGsvDaOV_EUD41lu4twzymH4hCNMlu5OogH5ybt0fQvH4hJ3TCb334JYMBDZavO5idcAviN7WiPQz_voOJQwe6LnDKf3_3QMRmBjz2pDW7f9Y94JyXUMNwF8kPuPyu68rroYaT4m1LUcUZjApa9niX7HIlTxCpHQ3L4qJ7eBd7oa6lg9Y4I_HIZn4DVBQ53IFrw2kKEDAhK6MRDzGpPTzdTXyZA","Scope":"openid profile afcpayroll offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-08-06 11:44:39.725 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-06 11:44:39.728 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-06 11:44:39.734 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-06 11:44:39.737 +03:00 [DBG] Start token request.
2019-08-06 11:44:39.741 +03:00 [DBG] Start client validation
2019-08-06 11:44:39.743 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-06 11:44:39.747 +03:00 [DBG] Start parsing for secret in post body
2019-08-06 11:44:39.752 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-06 11:44:39.752 +03:00 [DBG] Secret id found: mvc
2019-08-06 11:44:39.755 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-06 11:44:39.757 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-06 11:44:39.758 +03:00 [DBG] Client validation success
2019-08-06 11:44:39.759 +03:00 [DBG] Start token request validation
2019-08-06 11:44:39.760 +03:00 [DBG] Start validation of authorization code token request
2019-08-06 11:44:39.783 +03:00 [DBG] Validation of authorization code token request success
2019-08-06 11:44:39.784 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"96461c475088a0f229463e4d613ffbabe809c2552b58eac0a1ef1390f9635ac2","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"mvc","client_secret":"***REDACTED***","code":"96461c475088a0f229463e4d613ffbabe809c2552b58eac0a1ef1390f9635ac2","grant_type":"authorization_code","redirect_uri":"http://localhost:5002/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-08-06 11:44:39.824 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-06 11:44:39.848 +03:00 [DBG] Getting claims for access token for client: mvc
2019-08-06 11:44:39.850 +03:00 [DBG] Getting claims for access token for subject: 1
2019-08-06 11:44:39.868 +03:00 [DBG] Creating refresh token
2019-08-06 11:44:39.868 +03:00 [DBG] Setting an absolute lifetime: 2592000
2019-08-06 11:44:39.886 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-06 11:44:39.887 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-06 11:44:39.889 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-06 11:44:39.902 +03:00 [DBG] Token request success.
2019-08-06 11:44:39.917 +03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-08-06 11:44:39.920 +03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-08-06 11:44:39.922 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-08-06 11:44:39.934 +03:00 [DBG] Start userinfo request
2019-08-06 11:44:39.939 +03:00 [DBG] Bearer token found in header
2019-08-06 11:44:40.029 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-06 11:44:40.037 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-06 11:44:40.041 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-08-06 11:44:40.046 +03:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1565081079,"exp":1565084679,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","afcpayroll"],"client_id":"mvc","sub":"1","auth_time":1565081011,"idp":"local","name":"alice","email":"alice@email.com","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-08-06 11:44:40.072 +03:00 [DBG] Creating userinfo response
2019-08-06 11:44:40.078 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-06 11:44:40.084 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-06 11:44:40.091 +03:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-06 11:44:40.093 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-06 11:44:40.095 +03:00 [INF] Profile service returned the following claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-06 11:44:40.100 +03:00 [DBG] End userinfo request
2019-08-06 11:44:40.256 +03:00 [INF] MyCookie was not authenticated. Failure message: Unprotect ticket failed
2019-08-06 11:44:40.261 +03:00 [INF] MyCookie was not authenticated. Failure message: Unprotect ticket failed
2019-08-06 11:44:40.265 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-08-06 11:44:40.267 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-08-06 11:44:40.273 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-08-06 11:44:40.275 +03:00 [DBG] Start authorize request
2019-08-06 11:44:40.280 +03:00 [INF] MyCookie was not authenticated. Failure message: Unprotect ticket failed
2019-08-06 11:44:40.286 +03:00 [DBG] No user present in authorize request
2019-08-06 11:44:40.290 +03:00 [DBG] Start authorize request protocol validation
2019-08-06 11:44:40.292 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-06 11:44:40.293 +03:00 [DBG] Checking for PKCE parameters
2019-08-06 11:44:40.299 +03:00 [DBG] No PKCE used.
2019-08-06 11:44:40.306 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-06 11:44:40.310 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/signin-oidc","AllowedRedirectUris":["http://localhost:5002/signin-oidc"],"SubjectId":"anonymous","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9PrNHUo91VvmviHh4T16jlbBiy7LOc8X93yiPzt1lfC929oNuKMA9fAkz8VddvZi44mSFX9Oeb_tEtU-oNUt0buCEzvL-Gd1jtaTlRf5p8WqnNZtXApj9NtNEcWYah5wJOYQ5b8_95uO09qjjBkqjSliOlDdIul0jKxcQapQCms5zW3BIhWk5R5bV5OHwVNHFj6xrQvE4hqDnOBZA8jNq3ydx6LnuoLn8ZHDsNByAi7yWA7WXQqXIiKQ-m7-VyGuRmLRT-n-SHh-3jHTGh74lQ9H81TfuIpMgJQVM2yUvBkdA","UiLocales":null,"Nonce":"637006778801380933.NmY2ZDg3OGUtMWNjMi00MDkyLTkyZmItZDc5NTcwNTRjMDY3NDEyNzA0ODctNjE3Yy00MTBkLWIyMzYtMGYyMjA0YzM5YmZk","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637006778801380933.NmY2ZDg3OGUtMWNjMi00MDkyLTkyZmItZDc5NTcwNTRjMDY3NDEyNzA0ODctNjE3Yy00MTBkLWIyMzYtMGYyMjA0YzM5YmZk","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9PrNHUo91VvmviHh4T16jlbBiy7LOc8X93yiPzt1lfC929oNuKMA9fAkz8VddvZi44mSFX9Oeb_tEtU-oNUt0buCEzvL-Gd1jtaTlRf5p8WqnNZtXApj9NtNEcWYah5wJOYQ5b8_95uO09qjjBkqjSliOlDdIul0jKxcQapQCms5zW3BIhWk5R5bV5OHwVNHFj6xrQvE4hqDnOBZA8jNq3ydx6LnuoLn8ZHDsNByAi7yWA7WXQqXIiKQ-m7-VyGuRmLRT-n-SHh-3jHTGh74lQ9H81TfuIpMgJQVM2yUvBkdA","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-06 11:44:40.335 +03:00 [INF] Showing login: User is not authenticated
2019-08-06 11:44:40.398 +03:00 [INF] MyCookie was not authenticated. Failure message: Unprotect ticket failed
2019-08-06 11:44:40.401 +03:00 [INF] MyCookie was not authenticated. Failure message: Unprotect ticket failed
2019-08-06 11:44:40.683 +03:00 [INF] MyCookie was not authenticated. Failure message: Unprotect ticket failed
2019-08-06 11:44:40.686 +03:00 [DBG] Start authorize request protocol validation
2019-08-06 11:44:40.687 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-06 11:44:40.691 +03:00 [DBG] Checking for PKCE parameters
2019-08-06 11:44:40.696 +03:00 [DBG] No PKCE used.
2019-08-06 11:44:40.700 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-06 11:44:40.707 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-06 11:44:42.958 +03:00 [DBG] CORS request made for path: /account/login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-08-06 11:44:43.026 +03:00 [INF] MyCookie was not authenticated. Failure message: Unprotect ticket failed
2019-08-06 11:44:43.032 +03:00 [INF] MyCookie was not authenticated. Failure message: Unprotect ticket failed
2019-08-06 11:44:43.078 +03:00 [INF] MyCookie was not authenticated. Failure message: Unprotect ticket failed
2019-08-06 11:44:43.096 +03:00 [DBG] Start authorize request protocol validation
2019-08-06 11:44:43.099 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-06 11:44:43.101 +03:00 [DBG] Checking for PKCE parameters
2019-08-06 11:44:43.102 +03:00 [DBG] No PKCE used.
2019-08-06 11:44:43.107 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-06 11:44:43.140 +03:00 [DBG] Augmenting SignInContext
2019-08-06 11:44:43.160 +03:00 [DBG] Adding idp claim with value: local
2019-08-06 11:44:43.160 +03:00 [DBG] Adding amr claim with value: pwd
2019-08-06 11:44:43.167 +03:00 [INF] MyCookie was not authenticated. Failure message: Unprotect ticket failed
2019-08-06 11:44:43.176 +03:00 [INF] AuthenticationScheme: MyCookie signed in.
2019-08-06 11:44:43.182 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-06 11:44:43.199 +03:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-08-06 11:44:43.203 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-08-06 11:44:43.206 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-08-06 11:44:43.223 +03:00 [DBG] Start authorize callback request
2019-08-06 11:44:43.234 +03:00 [DBG] User in authorize request: 1
2019-08-06 11:44:43.235 +03:00 [DBG] Start authorize request protocol validation
2019-08-06 11:44:43.238 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-06 11:44:43.242 +03:00 [DBG] Checking for PKCE parameters
2019-08-06 11:44:43.243 +03:00 [DBG] No PKCE used.
2019-08-06 11:44:43.245 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-06 11:44:43.248 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/signin-oidc","AllowedRedirectUris":["http://localhost:5002/signin-oidc"],"SubjectId":"1","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9PrNHUo91VvmviHh4T16jlbBiy7LOc8X93yiPzt1lfC929oNuKMA9fAkz8VddvZi44mSFX9Oeb_tEtU-oNUt0buCEzvL-Gd1jtaTlRf5p8WqnNZtXApj9NtNEcWYah5wJOYQ5b8_95uO09qjjBkqjSliOlDdIul0jKxcQapQCms5zW3BIhWk5R5bV5OHwVNHFj6xrQvE4hqDnOBZA8jNq3ydx6LnuoLn8ZHDsNByAi7yWA7WXQqXIiKQ-m7-VyGuRmLRT-n-SHh-3jHTGh74lQ9H81TfuIpMgJQVM2yUvBkdA","UiLocales":null,"Nonce":"637006778801380933.NmY2ZDg3OGUtMWNjMi00MDkyLTkyZmItZDc5NTcwNTRjMDY3NDEyNzA0ODctNjE3Yy00MTBkLWIyMzYtMGYyMjA0YzM5YmZk","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"00c73a34c2f515ef639b358727270baa","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637006778801380933.NmY2ZDg3OGUtMWNjMi00MDkyLTkyZmItZDc5NTcwNTRjMDY3NDEyNzA0ODctNjE3Yy00MTBkLWIyMzYtMGYyMjA0YzM5YmZk","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9PrNHUo91VvmviHh4T16jlbBiy7LOc8X93yiPzt1lfC929oNuKMA9fAkz8VddvZi44mSFX9Oeb_tEtU-oNUt0buCEzvL-Gd1jtaTlRf5p8WqnNZtXApj9NtNEcWYah5wJOYQ5b8_95uO09qjjBkqjSliOlDdIul0jKxcQapQCms5zW3BIhWk5R5bV5OHwVNHFj6xrQvE4hqDnOBZA8jNq3ydx6LnuoLn8ZHDsNByAi7yWA7WXQqXIiKQ-m7-VyGuRmLRT-n-SHh-3jHTGh74lQ9H81TfuIpMgJQVM2yUvBkdA","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-06 11:44:43.281 +03:00 [DBG] Client is configured to not require consent, no consent is required
2019-08-06 11:44:43.281 +03:00 [DBG] Creating Hybrid Flow response.
2019-08-06 11:44:43.283 +03:00 [DBG] Creating Implicit Flow response.
2019-08-06 11:44:43.284 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-06 11:44:43.286 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-06 11:44:43.298 +03:00 [DBG] Authorize endpoint response
{"SubjectId":"1","ClientId":"mvc","RedirectUri":"http://localhost:5002/signin-oidc","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9PrNHUo91VvmviHh4T16jlbBiy7LOc8X93yiPzt1lfC929oNuKMA9fAkz8VddvZi44mSFX9Oeb_tEtU-oNUt0buCEzvL-Gd1jtaTlRf5p8WqnNZtXApj9NtNEcWYah5wJOYQ5b8_95uO09qjjBkqjSliOlDdIul0jKxcQapQCms5zW3BIhWk5R5bV5OHwVNHFj6xrQvE4hqDnOBZA8jNq3ydx6LnuoLn8ZHDsNByAi7yWA7WXQqXIiKQ-m7-VyGuRmLRT-n-SHh-3jHTGh74lQ9H81TfuIpMgJQVM2yUvBkdA","Scope":"openid profile afcpayroll offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-08-06 11:44:43.314 +03:00 [DBG] Augmenting SignInContext
2019-08-06 11:44:43.315 +03:00 [INF] AuthenticationScheme: MyCookie signed in.
2019-08-06 11:44:43.541 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-06 11:44:43.546 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-06 11:44:43.549 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-06 11:44:43.551 +03:00 [DBG] Start token request.
2019-08-06 11:44:43.552 +03:00 [DBG] Start client validation
2019-08-06 11:44:43.554 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-06 11:44:43.559 +03:00 [DBG] Start parsing for secret in post body
2019-08-06 11:44:43.561 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-06 11:44:43.561 +03:00 [DBG] Secret id found: mvc
2019-08-06 11:44:43.563 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-06 11:44:43.565 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-06 11:44:43.566 +03:00 [DBG] Client validation success
2019-08-06 11:44:43.567 +03:00 [DBG] Start token request validation
2019-08-06 11:44:43.574 +03:00 [DBG] Start validation of authorization code token request
2019-08-06 11:44:43.576 +03:00 [DBG] Validation of authorization code token request success
2019-08-06 11:44:43.577 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"0ddf905302763a3b72550ac7e1104dfe06f98ab341c1f25504819d9690df8676","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"mvc","client_secret":"***REDACTED***","code":"0ddf905302763a3b72550ac7e1104dfe06f98ab341c1f25504819d9690df8676","grant_type":"authorization_code","redirect_uri":"http://localhost:5002/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-08-06 11:44:43.590 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-06 11:44:43.591 +03:00 [DBG] Getting claims for access token for client: mvc
2019-08-06 11:44:43.592 +03:00 [DBG] Getting claims for access token for subject: 1
2019-08-06 11:44:43.599 +03:00 [DBG] Creating refresh token
2019-08-06 11:44:43.600 +03:00 [DBG] Setting an absolute lifetime: 2592000
2019-08-06 11:44:43.604 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-06 11:44:43.606 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-06 11:44:43.607 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-06 11:44:43.619 +03:00 [DBG] Token request success.
2019-08-06 11:44:43.626 +03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-08-06 11:44:43.632 +03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-08-06 11:44:43.636 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-08-06 11:44:43.640 +03:00 [DBG] Start userinfo request
2019-08-06 11:44:43.641 +03:00 [DBG] Bearer token found in header
2019-08-06 11:44:43.648 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-06 11:44:43.650 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-06 11:44:43.654 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-08-06 11:44:43.659 +03:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1565081083,"exp":1565084683,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","afcpayroll"],"client_id":"mvc","sub":"1","auth_time":1565081083,"idp":"local","name":"alice","email":"alice@email.com","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-08-06 11:44:43.676 +03:00 [DBG] Creating userinfo response
2019-08-06 11:44:43.686 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-06 11:44:43.689 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-06 11:44:43.692 +03:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-06 11:44:43.698 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-06 11:44:43.702 +03:00 [INF] Profile service returned the following claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-06 11:44:43.704 +03:00 [DBG] End userinfo request
2019-08-06 11:44:43.783 +03:00 [INF] MyCookie was not authenticated. Failure message: Unprotect ticket failed
2019-08-06 11:44:43.785 +03:00 [INF] MyCookie was not authenticated. Failure message: Unprotect ticket failed
2019-08-06 11:44:43.789 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-08-06 11:44:43.791 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-08-06 11:44:43.793 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-08-06 11:44:43.799 +03:00 [DBG] Start authorize request
2019-08-06 11:44:43.802 +03:00 [INF] MyCookie was not authenticated. Failure message: Unprotect ticket failed
2019-08-06 11:44:43.804 +03:00 [DBG] No user present in authorize request
2019-08-06 11:44:43.805 +03:00 [DBG] Start authorize request protocol validation
2019-08-06 11:44:43.806 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-06 11:44:43.813 +03:00 [DBG] Checking for PKCE parameters
2019-08-06 11:44:43.815 +03:00 [DBG] No PKCE used.
2019-08-06 11:44:43.816 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-06 11:44:43.820 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/signin-oidc","AllowedRedirectUris":["http://localhost:5002/signin-oidc"],"SubjectId":"anonymous","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9NsHF6j_RNMHrVEfBzvrHSciMJhE0z3Iiycm5llE-DZEVRvxciTWSYmSgqlhC2w4cTHuU7YvZOgKAgQXCFNL-qKwzmTw-j5ZdSud7VQ3QTAWK06dnF7MIeqxaLi8BB3aL5ag--V72exDtYrJLIwfqoWfs_9LCmLfCqwWfjkynNuR6ZB67V22tZGRlMgo6nZhikTGSxjVuX5ncwUnJP7ykzk5UA4-AIgUcCaJHO4vKDGEPmMX5p4h4sFooFCgTG_hWpke1NPWpETZOmjrx6WsCWHihn48XRWyqbUCK_GZzrUKQ","UiLocales":null,"Nonce":"637006778837260831.MGYyNGMzNGMtZmVkZS00ZTAwLWE5ODgtMTJhMjA5OTBhMjZiMjc4MTRmYTktZTVmYi00MTIyLWI5MzItMGJjZWY1NDYzZDky","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637006778837260831.MGYyNGMzNGMtZmVkZS00ZTAwLWE5ODgtMTJhMjA5OTBhMjZiMjc4MTRmYTktZTVmYi00MTIyLWI5MzItMGJjZWY1NDYzZDky","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9NsHF6j_RNMHrVEfBzvrHSciMJhE0z3Iiycm5llE-DZEVRvxciTWSYmSgqlhC2w4cTHuU7YvZOgKAgQXCFNL-qKwzmTw-j5ZdSud7VQ3QTAWK06dnF7MIeqxaLi8BB3aL5ag--V72exDtYrJLIwfqoWfs_9LCmLfCqwWfjkynNuR6ZB67V22tZGRlMgo6nZhikTGSxjVuX5ncwUnJP7ykzk5UA4-AIgUcCaJHO4vKDGEPmMX5p4h4sFooFCgTG_hWpke1NPWpETZOmjrx6WsCWHihn48XRWyqbUCK_GZzrUKQ","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-06 11:44:43.854 +03:00 [INF] Showing login: User is not authenticated
2019-08-06 11:44:43.910 +03:00 [INF] MyCookie was not authenticated. Failure message: Unprotect ticket failed
2019-08-06 11:44:43.913 +03:00 [INF] MyCookie was not authenticated. Failure message: Unprotect ticket failed
2019-08-06 11:44:43.917 +03:00 [INF] MyCookie was not authenticated. Failure message: Unprotect ticket failed
2019-08-06 11:44:43.919 +03:00 [DBG] Start authorize request protocol validation
2019-08-06 11:44:43.920 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-06 11:44:43.927 +03:00 [DBG] Checking for PKCE parameters
2019-08-06 11:44:43.929 +03:00 [DBG] No PKCE used.
2019-08-06 11:44:43.930 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-06 11:44:43.934 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-06 11:44:59.447 +03:00 [DBG] CORS request made for path: /account/login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-08-06 11:44:59.502 +03:00 [INF] MyCookie was not authenticated. Failure message: Unprotect ticket failed
2019-08-06 11:44:59.505 +03:00 [INF] MyCookie was not authenticated. Failure message: Unprotect ticket failed
2019-08-06 11:44:59.511 +03:00 [INF] MyCookie was not authenticated. Failure message: Unprotect ticket failed
2019-08-06 11:44:59.514 +03:00 [DBG] Start authorize request protocol validation
2019-08-06 11:44:59.517 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-06 11:44:59.521 +03:00 [DBG] Checking for PKCE parameters
2019-08-06 11:44:59.522 +03:00 [DBG] No PKCE used.
2019-08-06 11:44:59.523 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-06 11:44:59.525 +03:00 [DBG] Augmenting SignInContext
2019-08-06 11:44:59.530 +03:00 [DBG] Adding idp claim with value: local
2019-08-06 11:44:59.532 +03:00 [DBG] Adding amr claim with value: pwd
2019-08-06 11:44:59.535 +03:00 [INF] MyCookie was not authenticated. Failure message: Unprotect ticket failed
2019-08-06 11:44:59.537 +03:00 [INF] AuthenticationScheme: MyCookie signed in.
2019-08-06 11:44:59.545 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-06 11:44:59.565 +03:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-08-06 11:44:59.576 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-08-06 11:44:59.580 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-08-06 11:44:59.590 +03:00 [DBG] Start authorize callback request
2019-08-06 11:44:59.599 +03:00 [DBG] User in authorize request: 1
2019-08-06 11:44:59.603 +03:00 [DBG] Start authorize request protocol validation
2019-08-06 11:44:59.605 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-06 11:44:59.608 +03:00 [DBG] Checking for PKCE parameters
2019-08-06 11:44:59.613 +03:00 [DBG] No PKCE used.
2019-08-06 11:44:59.622 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-06 11:44:59.633 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/signin-oidc","AllowedRedirectUris":["http://localhost:5002/signin-oidc"],"SubjectId":"1","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9NsHF6j_RNMHrVEfBzvrHSciMJhE0z3Iiycm5llE-DZEVRvxciTWSYmSgqlhC2w4cTHuU7YvZOgKAgQXCFNL-qKwzmTw-j5ZdSud7VQ3QTAWK06dnF7MIeqxaLi8BB3aL5ag--V72exDtYrJLIwfqoWfs_9LCmLfCqwWfjkynNuR6ZB67V22tZGRlMgo6nZhikTGSxjVuX5ncwUnJP7ykzk5UA4-AIgUcCaJHO4vKDGEPmMX5p4h4sFooFCgTG_hWpke1NPWpETZOmjrx6WsCWHihn48XRWyqbUCK_GZzrUKQ","UiLocales":null,"Nonce":"637006778837260831.MGYyNGMzNGMtZmVkZS00ZTAwLWE5ODgtMTJhMjA5OTBhMjZiMjc4MTRmYTktZTVmYi00MTIyLWI5MzItMGJjZWY1NDYzZDky","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"6d5f281c1e3a79f68389d8ace439ba59","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637006778837260831.MGYyNGMzNGMtZmVkZS00ZTAwLWE5ODgtMTJhMjA5OTBhMjZiMjc4MTRmYTktZTVmYi00MTIyLWI5MzItMGJjZWY1NDYzZDky","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9NsHF6j_RNMHrVEfBzvrHSciMJhE0z3Iiycm5llE-DZEVRvxciTWSYmSgqlhC2w4cTHuU7YvZOgKAgQXCFNL-qKwzmTw-j5ZdSud7VQ3QTAWK06dnF7MIeqxaLi8BB3aL5ag--V72exDtYrJLIwfqoWfs_9LCmLfCqwWfjkynNuR6ZB67V22tZGRlMgo6nZhikTGSxjVuX5ncwUnJP7ykzk5UA4-AIgUcCaJHO4vKDGEPmMX5p4h4sFooFCgTG_hWpke1NPWpETZOmjrx6WsCWHihn48XRWyqbUCK_GZzrUKQ","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-06 11:44:59.659 +03:00 [DBG] Client is configured to not require consent, no consent is required
2019-08-06 11:44:59.664 +03:00 [DBG] Creating Hybrid Flow response.
2019-08-06 11:44:59.666 +03:00 [DBG] Creating Implicit Flow response.
2019-08-06 11:44:59.667 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-06 11:44:59.669 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-06 11:44:59.675 +03:00 [DBG] Authorize endpoint response
{"SubjectId":"1","ClientId":"mvc","RedirectUri":"http://localhost:5002/signin-oidc","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9NsHF6j_RNMHrVEfBzvrHSciMJhE0z3Iiycm5llE-DZEVRvxciTWSYmSgqlhC2w4cTHuU7YvZOgKAgQXCFNL-qKwzmTw-j5ZdSud7VQ3QTAWK06dnF7MIeqxaLi8BB3aL5ag--V72exDtYrJLIwfqoWfs_9LCmLfCqwWfjkynNuR6ZB67V22tZGRlMgo6nZhikTGSxjVuX5ncwUnJP7ykzk5UA4-AIgUcCaJHO4vKDGEPmMX5p4h4sFooFCgTG_hWpke1NPWpETZOmjrx6WsCWHihn48XRWyqbUCK_GZzrUKQ","Scope":"openid profile afcpayroll offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-08-06 11:44:59.684 +03:00 [DBG] Augmenting SignInContext
2019-08-06 11:44:59.685 +03:00 [INF] AuthenticationScheme: MyCookie signed in.
2019-08-06 11:44:59.909 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-06 11:44:59.914 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-06 11:44:59.918 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-06 11:44:59.924 +03:00 [DBG] Start token request.
2019-08-06 11:44:59.933 +03:00 [DBG] Start client validation
2019-08-06 11:44:59.934 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-06 11:44:59.935 +03:00 [DBG] Start parsing for secret in post body
2019-08-06 11:44:59.941 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-06 11:44:59.941 +03:00 [DBG] Secret id found: mvc
2019-08-06 11:44:59.943 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-06 11:44:59.956 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-06 11:44:59.957 +03:00 [DBG] Client validation success
2019-08-06 11:44:59.961 +03:00 [DBG] Start token request validation
2019-08-06 11:44:59.963 +03:00 [DBG] Start validation of authorization code token request
2019-08-06 11:44:59.967 +03:00 [DBG] Validation of authorization code token request success
2019-08-06 11:44:59.971 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"b6b00fb7abadf2803200c19dfc799d0da785beadc8513df70b499a402b9bef21","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"mvc","client_secret":"***REDACTED***","code":"b6b00fb7abadf2803200c19dfc799d0da785beadc8513df70b499a402b9bef21","grant_type":"authorization_code","redirect_uri":"http://localhost:5002/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-08-06 11:44:59.985 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-06 11:44:59.989 +03:00 [DBG] Getting claims for access token for client: mvc
2019-08-06 11:44:59.990 +03:00 [DBG] Getting claims for access token for subject: 1
2019-08-06 11:44:59.994 +03:00 [DBG] Creating refresh token
2019-08-06 11:44:59.997 +03:00 [DBG] Setting an absolute lifetime: 2592000
2019-08-06 11:44:59.998 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-06 11:45:00.003 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-06 11:45:00.004 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-06 11:45:00.019 +03:00 [DBG] Token request success.
2019-08-06 11:45:00.052 +03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-08-06 11:45:00.055 +03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-08-06 11:45:00.058 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-08-06 11:45:00.063 +03:00 [DBG] Start userinfo request
2019-08-06 11:45:00.067 +03:00 [DBG] Bearer token found in header
2019-08-06 11:45:00.074 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-06 11:45:00.075 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-06 11:45:00.082 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-08-06 11:45:00.084 +03:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1565081099,"exp":1565084699,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","afcpayroll"],"client_id":"mvc","sub":"1","auth_time":1565081099,"idp":"local","name":"alice","email":"alice@email.com","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-08-06 11:45:00.105 +03:00 [DBG] Creating userinfo response
2019-08-06 11:45:00.106 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-06 11:45:00.108 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-06 11:45:00.108 +03:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-06 11:45:00.109 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-06 11:45:00.109 +03:00 [INF] Profile service returned the following claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-06 11:45:00.110 +03:00 [DBG] End userinfo request
2019-08-06 11:45:00.187 +03:00 [INF] MyCookie was not authenticated. Failure message: Unprotect ticket failed
2019-08-06 11:45:00.190 +03:00 [INF] MyCookie was not authenticated. Failure message: Unprotect ticket failed
2019-08-06 11:45:00.190 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-08-06 11:45:00.191 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-08-06 11:45:00.192 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-08-06 11:45:00.192 +03:00 [DBG] Start authorize request
2019-08-06 11:45:00.193 +03:00 [INF] MyCookie was not authenticated. Failure message: Unprotect ticket failed
2019-08-06 11:45:00.193 +03:00 [DBG] No user present in authorize request
2019-08-06 11:45:00.193 +03:00 [DBG] Start authorize request protocol validation
2019-08-06 11:45:00.194 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-06 11:45:00.195 +03:00 [DBG] Checking for PKCE parameters
2019-08-06 11:45:00.197 +03:00 [DBG] No PKCE used.
2019-08-06 11:45:00.198 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-06 11:45:00.208 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/signin-oidc","AllowedRedirectUris":["http://localhost:5002/signin-oidc"],"SubjectId":"anonymous","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9OVW8UFeQp-1fH1x1XbzhkR_LCDzMKt10XW2uZHc9aDJVnfrSvGxewdkaKKimkrcZE-kXrw26B0hfusttdJTOa4zCYtCTSJf4MZwpkrQVCjsMQHm3025bHQgYZ3UOvaVAhaXUzozOPstRVfMWBSiGAG_rlD5bxf81FkU6C_Je3NvXGwg3ucDac9-gQ_uV1EElE_iM5-cZbHUxvVNhBBWCruGB5z6WNBmpc_RJCOZaAdCXDX4eJLtJSKOu6i8DQgPnvZZ4_ulDO1b5f-uiWjMr6BPJ0DFOKnRxWp8EIA7frTxQ","UiLocales":null,"Nonce":"637006779001226493.Mzc1ODk1ZjQtM2Q3YS00YjZhLWE4YzMtMGM2MWFiNDM0YzY0Y2QxNDY5OWMtODRhOS00NGQ1LTg5MjYtZTc0NzlmMjczNzAy","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637006779001226493.Mzc1ODk1ZjQtM2Q3YS00YjZhLWE4YzMtMGM2MWFiNDM0YzY0Y2QxNDY5OWMtODRhOS00NGQ1LTg5MjYtZTc0NzlmMjczNzAy","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9OVW8UFeQp-1fH1x1XbzhkR_LCDzMKt10XW2uZHc9aDJVnfrSvGxewdkaKKimkrcZE-kXrw26B0hfusttdJTOa4zCYtCTSJf4MZwpkrQVCjsMQHm3025bHQgYZ3UOvaVAhaXUzozOPstRVfMWBSiGAG_rlD5bxf81FkU6C_Je3NvXGwg3ucDac9-gQ_uV1EElE_iM5-cZbHUxvVNhBBWCruGB5z6WNBmpc_RJCOZaAdCXDX4eJLtJSKOu6i8DQgPnvZZ4_ulDO1b5f-uiWjMr6BPJ0DFOKnRxWp8EIA7frTxQ","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-06 11:45:00.217 +03:00 [INF] Showing login: User is not authenticated
2019-08-06 11:45:00.292 +03:00 [INF] MyCookie was not authenticated. Failure message: Unprotect ticket failed
2019-08-06 11:45:00.294 +03:00 [INF] MyCookie was not authenticated. Failure message: Unprotect ticket failed
2019-08-06 11:45:00.295 +03:00 [INF] MyCookie was not authenticated. Failure message: Unprotect ticket failed
2019-08-06 11:45:00.295 +03:00 [DBG] Start authorize request protocol validation
2019-08-06 11:45:00.296 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-06 11:45:00.296 +03:00 [DBG] Checking for PKCE parameters
2019-08-06 11:45:00.297 +03:00 [DBG] No PKCE used.
2019-08-06 11:45:00.297 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-06 11:45:00.298 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-06 11:45:25.976 +03:00 [INF] Starting IdentityServer4 version 2.5.0.0
2019-08-06 11:45:26.056 +03:00 [INF] Using the default authentication scheme MyCookie for IdentityServer
2019-08-06 11:45:26.057 +03:00 [DBG] Using MyCookie as default ASP.NET Core scheme for authentication
2019-08-06 11:45:26.058 +03:00 [DBG] Using MyCookie as default ASP.NET Core scheme for sign-in
2019-08-06 11:45:26.058 +03:00 [DBG] Using MyCookie as default ASP.NET Core scheme for sign-out
2019-08-06 11:45:26.059 +03:00 [DBG] Using MyCookie as default ASP.NET Core scheme for challenge
2019-08-06 11:45:26.059 +03:00 [DBG] Using MyCookie as default ASP.NET Core scheme for forbid
2019-08-06 11:45:38.330 +03:00 [DBG] Login Url: /account/login
2019-08-06 11:45:38.336 +03:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-08-06 11:45:38.337 +03:00 [DBG] Logout Url: /Account/Logout
2019-08-06 11:45:38.337 +03:00 [DBG] ConsentUrl Url: /consent
2019-08-06 11:45:38.337 +03:00 [DBG] Consent Return Url Parameter: returnUrl
2019-08-06 11:45:38.338 +03:00 [DBG] Error Url: /home/error
2019-08-06 11:45:38.338 +03:00 [DBG] Error Id Parameter: errorId
2019-08-06 11:45:38.395 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-06 11:45:38.401 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-06 11:45:38.402 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-06 11:45:38.409 +03:00 [DBG] Start discovery request
2019-08-06 11:45:38.607 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-06 11:45:38.620 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-06 11:45:38.622 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-06 11:45:38.632 +03:00 [DBG] Start key discovery request
2019-08-06 11:45:38.722 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-08-06 11:45:38.759 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-08-06 11:45:38.766 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-08-06 11:45:38.776 +03:00 [DBG] Start authorize request
2019-08-06 11:45:38.791 +03:00 [DBG] No user present in authorize request
2019-08-06 11:45:38.802 +03:00 [DBG] Start authorize request protocol validation
2019-08-06 11:45:38.836 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-06 11:45:38.857 +03:00 [DBG] Checking for PKCE parameters
2019-08-06 11:45:38.860 +03:00 [DBG] No PKCE used.
2019-08-06 11:45:38.905 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-06 11:45:38.933 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/signin-oidc","AllowedRedirectUris":["http://localhost:5002/signin-oidc"],"SubjectId":"anonymous","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9NAj4X5U5yCQypSNPoRovHlc_EsL0f8B6GuMlXlF7GJSr-cd0lueqEwKA5k0pDhT7y1Z8J-hSI6U3eAVrZZV-jgyCvq8EVBYl9ptrQbdG3p1JwTHkKX66DET_PPW02nddjN_F6g9yniK-81Jwej9Pv94T6AzyZwVJh_BiWwQDn2nOt-Ux2KZSkz4bsYbJYRE2B7XkcTx1h-U6xqF9KxdSe5UlLfRL2m-iKbcOjGDoRJLTdWxvlPotD3NximpsQ3e1vT1DjNH85Vb3aaIaxlklV6yvE1pFK8qNCMI7QEhGnVxw","UiLocales":null,"Nonce":"637006779386817559.ZWZmZTdkYmUtYTFmZC00ZTU2LTg2NzQtZTk5Yjg0YjhiM2NkYWY0NjkzMDgtZDhiYS00NGYyLWE4ZDUtYTI5YmJkZDFjMWFm","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637006779386817559.ZWZmZTdkYmUtYTFmZC00ZTU2LTg2NzQtZTk5Yjg0YjhiM2NkYWY0NjkzMDgtZDhiYS00NGYyLWE4ZDUtYTI5YmJkZDFjMWFm","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9NAj4X5U5yCQypSNPoRovHlc_EsL0f8B6GuMlXlF7GJSr-cd0lueqEwKA5k0pDhT7y1Z8J-hSI6U3eAVrZZV-jgyCvq8EVBYl9ptrQbdG3p1JwTHkKX66DET_PPW02nddjN_F6g9yniK-81Jwej9Pv94T6AzyZwVJh_BiWwQDn2nOt-Ux2KZSkz4bsYbJYRE2B7XkcTx1h-U6xqF9KxdSe5UlLfRL2m-iKbcOjGDoRJLTdWxvlPotD3NximpsQ3e1vT1DjNH85Vb3aaIaxlklV6yvE1pFK8qNCMI7QEhGnVxw","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-06 11:45:39.010 +03:00 [INF] Showing login: User is not authenticated
2019-08-06 11:45:39.293 +03:00 [DBG] Start authorize request protocol validation
2019-08-06 11:45:39.294 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-06 11:45:39.300 +03:00 [DBG] Checking for PKCE parameters
2019-08-06 11:45:39.301 +03:00 [DBG] No PKCE used.
2019-08-06 11:45:39.302 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-06 11:45:39.310 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-06 11:45:41.492 +03:00 [DBG] CORS request made for path: /account/login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-08-06 11:45:41.555 +03:00 [DBG] Start authorize request protocol validation
2019-08-06 11:45:41.556 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-06 11:45:41.563 +03:00 [DBG] Checking for PKCE parameters
2019-08-06 11:45:41.563 +03:00 [DBG] No PKCE used.
2019-08-06 11:45:41.565 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-06 11:45:41.597 +03:00 [DBG] Augmenting SignInContext
2019-08-06 11:45:41.603 +03:00 [DBG] Adding idp claim with value: local
2019-08-06 11:45:41.603 +03:00 [DBG] Adding amr claim with value: pwd
2019-08-06 11:45:41.622 +03:00 [INF] AuthenticationScheme: MyCookie signed in.
2019-08-06 11:45:41.627 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-06 11:45:41.642 +03:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-08-06 11:45:41.646 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-08-06 11:45:41.650 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-08-06 11:45:41.663 +03:00 [DBG] Start authorize callback request
2019-08-06 11:45:41.669 +03:00 [DBG] User in authorize request: 1
2019-08-06 11:45:41.670 +03:00 [DBG] Start authorize request protocol validation
2019-08-06 11:45:41.671 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-06 11:45:41.675 +03:00 [DBG] Checking for PKCE parameters
2019-08-06 11:45:41.676 +03:00 [DBG] No PKCE used.
2019-08-06 11:45:41.683 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-06 11:45:41.687 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/signin-oidc","AllowedRedirectUris":["http://localhost:5002/signin-oidc"],"SubjectId":"1","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9NAj4X5U5yCQypSNPoRovHlc_EsL0f8B6GuMlXlF7GJSr-cd0lueqEwKA5k0pDhT7y1Z8J-hSI6U3eAVrZZV-jgyCvq8EVBYl9ptrQbdG3p1JwTHkKX66DET_PPW02nddjN_F6g9yniK-81Jwej9Pv94T6AzyZwVJh_BiWwQDn2nOt-Ux2KZSkz4bsYbJYRE2B7XkcTx1h-U6xqF9KxdSe5UlLfRL2m-iKbcOjGDoRJLTdWxvlPotD3NximpsQ3e1vT1DjNH85Vb3aaIaxlklV6yvE1pFK8qNCMI7QEhGnVxw","UiLocales":null,"Nonce":"637006779386817559.ZWZmZTdkYmUtYTFmZC00ZTU2LTg2NzQtZTk5Yjg0YjhiM2NkYWY0NjkzMDgtZDhiYS00NGYyLWE4ZDUtYTI5YmJkZDFjMWFm","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"811d6acd44f5ae920ef67f6f65ae85a1","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637006779386817559.ZWZmZTdkYmUtYTFmZC00ZTU2LTg2NzQtZTk5Yjg0YjhiM2NkYWY0NjkzMDgtZDhiYS00NGYyLWE4ZDUtYTI5YmJkZDFjMWFm","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9NAj4X5U5yCQypSNPoRovHlc_EsL0f8B6GuMlXlF7GJSr-cd0lueqEwKA5k0pDhT7y1Z8J-hSI6U3eAVrZZV-jgyCvq8EVBYl9ptrQbdG3p1JwTHkKX66DET_PPW02nddjN_F6g9yniK-81Jwej9Pv94T6AzyZwVJh_BiWwQDn2nOt-Ux2KZSkz4bsYbJYRE2B7XkcTx1h-U6xqF9KxdSe5UlLfRL2m-iKbcOjGDoRJLTdWxvlPotD3NximpsQ3e1vT1DjNH85Vb3aaIaxlklV6yvE1pFK8qNCMI7QEhGnVxw","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-06 11:45:41.728 +03:00 [DBG] Client is configured to not require consent, no consent is required
2019-08-06 11:45:41.736 +03:00 [DBG] Creating Hybrid Flow response.
2019-08-06 11:45:41.771 +03:00 [DBG] Creating Implicit Flow response.
2019-08-06 11:45:41.785 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-06 11:45:41.789 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-06 11:45:41.903 +03:00 [DBG] Authorize endpoint response
{"SubjectId":"1","ClientId":"mvc","RedirectUri":"http://localhost:5002/signin-oidc","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9NAj4X5U5yCQypSNPoRovHlc_EsL0f8B6GuMlXlF7GJSr-cd0lueqEwKA5k0pDhT7y1Z8J-hSI6U3eAVrZZV-jgyCvq8EVBYl9ptrQbdG3p1JwTHkKX66DET_PPW02nddjN_F6g9yniK-81Jwej9Pv94T6AzyZwVJh_BiWwQDn2nOt-Ux2KZSkz4bsYbJYRE2B7XkcTx1h-U6xqF9KxdSe5UlLfRL2m-iKbcOjGDoRJLTdWxvlPotD3NximpsQ3e1vT1DjNH85Vb3aaIaxlklV6yvE1pFK8qNCMI7QEhGnVxw","Scope":"openid profile afcpayroll offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-08-06 11:45:41.936 +03:00 [DBG] Augmenting SignInContext
2019-08-06 11:45:41.937 +03:00 [INF] AuthenticationScheme: MyCookie signed in.
2019-08-06 11:45:42.220 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-06 11:45:42.230 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-06 11:45:42.233 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-06 11:45:42.251 +03:00 [DBG] Start token request.
2019-08-06 11:45:42.263 +03:00 [DBG] Start client validation
2019-08-06 11:45:42.271 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-06 11:45:42.282 +03:00 [DBG] Start parsing for secret in post body
2019-08-06 11:45:42.283 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-06 11:45:42.284 +03:00 [DBG] Secret id found: mvc
2019-08-06 11:45:42.287 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-06 11:45:42.306 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-06 11:45:42.306 +03:00 [DBG] Client validation success
2019-08-06 11:45:42.317 +03:00 [DBG] Start token request validation
2019-08-06 11:45:42.332 +03:00 [DBG] Start validation of authorization code token request
2019-08-06 11:45:42.355 +03:00 [DBG] Validation of authorization code token request success
2019-08-06 11:45:42.359 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"656f6d13252ebef7b03e06daaa34cebdb0dcc0e6a8f0c2b67b179f5a939a328c","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"mvc","client_secret":"***REDACTED***","code":"656f6d13252ebef7b03e06daaa34cebdb0dcc0e6a8f0c2b67b179f5a939a328c","grant_type":"authorization_code","redirect_uri":"http://localhost:5002/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-08-06 11:45:42.389 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-06 11:45:42.408 +03:00 [DBG] Getting claims for access token for client: mvc
2019-08-06 11:45:42.410 +03:00 [DBG] Getting claims for access token for subject: 1
2019-08-06 11:45:42.428 +03:00 [DBG] Creating refresh token
2019-08-06 11:45:42.428 +03:00 [DBG] Setting an absolute lifetime: 2592000
2019-08-06 11:45:42.447 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-06 11:45:42.451 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-06 11:45:42.455 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-06 11:45:42.468 +03:00 [DBG] Token request success.
2019-08-06 11:45:42.487 +03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-08-06 11:45:42.493 +03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-08-06 11:45:42.496 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-08-06 11:45:42.507 +03:00 [DBG] Start userinfo request
2019-08-06 11:45:42.513 +03:00 [DBG] Bearer token found in header
2019-08-06 11:45:42.602 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-06 11:45:42.610 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-06 11:45:42.613 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-08-06 11:45:42.618 +03:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1565081142,"exp":1565084742,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","afcpayroll"],"client_id":"mvc","sub":"1","auth_time":1565081141,"idp":"local","name":"alice","email":"alice@email.com","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-08-06 11:45:42.638 +03:00 [DBG] Creating userinfo response
2019-08-06 11:45:42.643 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-06 11:45:42.650 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-06 11:45:42.655 +03:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-06 11:45:42.657 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-06 11:45:42.664 +03:00 [INF] Profile service returned the following claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-06 11:45:42.666 +03:00 [DBG] End userinfo request
2019-08-06 13:40:16.224 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-06 13:40:16.233 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-06 13:40:16.238 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-06 13:40:16.241 +03:00 [DBG] Start discovery request
2019-08-06 13:40:16.253 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-06 13:40:16.259 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-06 13:40:16.261 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-06 13:40:16.264 +03:00 [DBG] Start key discovery request
2019-08-06 15:47:14.825 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-06 15:47:14.831 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-06 15:47:14.832 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-06 15:47:14.833 +03:00 [DBG] Start discovery request
2019-08-06 15:47:14.987 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-06 15:47:14.992 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-06 15:47:14.995 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-06 15:47:14.997 +03:00 [DBG] Start key discovery request
2019-08-06 15:47:15.479 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-06 15:47:15.492 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-06 15:47:15.495 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-06 15:47:15.506 +03:00 [DBG] Start token request.
2019-08-06 15:47:15.507 +03:00 [DBG] Start client validation
2019-08-06 15:47:15.508 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-06 15:47:15.510 +03:00 [DBG] Start parsing for secret in post body
2019-08-06 15:47:15.519 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-06 15:47:15.520 +03:00 [DBG] Secret id found: ro.client
2019-08-06 15:47:15.526 +03:00 [DBG] client configuration validation for client ro.client succeeded.
2019-08-06 15:47:15.530 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-06 15:47:15.531 +03:00 [DBG] Client validation success
2019-08-06 15:47:15.533 +03:00 [DBG] Start token request validation
2019-08-06 15:47:15.573 +03:00 [DBG] Start resource owner password token request validation
2019-08-06 15:47:15.583 +03:00 [DBG] Resource owner password token request validation success.
2019-08-06 15:47:15.584 +03:00 [INF] Token request validation success, {"ClientId":"ro.client","ClientName":null,"GrantType":"password","Scopes":"afcpayroll openid test_identity","AuthorizationCode":null,"RefreshToken":null,"UserName":"alice","AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"password","username":"alice","password":"***REDACTED***","scope":"afcpayroll test_identity openid","client_id":"ro.client","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2019-08-06 15:47:15.603 +03:00 [DBG] Getting claims for access token for client: ro.client
2019-08-06 15:47:15.603 +03:00 [DBG] Getting claims for access token for subject: 1
2019-08-06 15:47:15.612 +03:00 [DBG] Token request success.
2019-08-06 15:47:15.660 +03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-08-06 15:47:15.665 +03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-08-06 15:47:15.669 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-08-06 15:47:15.672 +03:00 [DBG] Start userinfo request
2019-08-06 15:47:15.679 +03:00 [DBG] Bearer token found in header
2019-08-06 15:47:15.685 +03:00 [DBG] client configuration validation for client ro.client succeeded.
2019-08-06 15:47:15.687 +03:00 [DBG] client configuration validation for client ro.client succeeded.
2019-08-06 15:47:15.691 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-08-06 15:47:15.693 +03:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1565095635,"exp":1565099235,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","afcpayroll"],"client_id":"ro.client","sub":"1","auth_time":1565095635,"idp":"local","name":"alice","email":"alice@email.com","scope":["openid","test_identity","afcpayroll"],"amr":"Bearer"},"$type":"TokenValidationLog"}
2019-08-06 15:47:15.709 +03:00 [DBG] Creating userinfo response
2019-08-06 15:47:15.713 +03:00 [DBG] Scopes in access token: openid test_identity afcpayroll
2019-08-06 15:47:15.717 +03:00 [DBG] Scopes in access token: openid test_identity afcpayroll
2019-08-06 15:47:15.719 +03:00 [DBG] Requested claim types: sub phone sex
2019-08-06 15:47:15.721 +03:00 [DBG] Scopes in access token: openid test_identity afcpayroll
2019-08-06 15:47:15.727 +03:00 [INF] Profile service returned the following claim types: sub phone sex
2019-08-06 15:47:15.731 +03:00 [DBG] End userinfo request
2019-08-07 09:56:00.485 +03:00 [INF] Starting IdentityServer4 version 2.5.0.0
2019-08-07 09:56:00.556 +03:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2019-08-07 09:56:00.558 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for authentication
2019-08-07 09:56:00.558 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-in
2019-08-07 09:56:00.558 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-out
2019-08-07 09:56:00.559 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for challenge
2019-08-07 09:56:00.560 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for forbid
2019-08-07 09:56:02.450 +03:00 [DBG] Login Url: /account/login
2019-08-07 09:56:02.453 +03:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-08-07 09:56:02.454 +03:00 [DBG] Logout Url: /Account/Logout
2019-08-07 09:56:02.455 +03:00 [DBG] ConsentUrl Url: /consent
2019-08-07 09:56:02.455 +03:00 [DBG] Consent Return Url Parameter: returnUrl
2019-08-07 09:56:02.455 +03:00 [DBG] Error Url: /home/error
2019-08-07 09:56:02.456 +03:00 [DBG] Error Id Parameter: errorId
2019-08-07 09:56:02.511 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-07 09:56:02.516 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-07 09:56:02.521 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-07 09:56:02.533 +03:00 [DBG] Start discovery request
2019-08-07 09:56:02.736 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-07 09:56:02.743 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-07 09:56:02.745 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-07 09:56:02.755 +03:00 [DBG] Start key discovery request
2019-08-07 09:56:02.862 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-08-07 09:56:02.900 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-08-07 09:56:02.904 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-08-07 09:56:02.912 +03:00 [DBG] Start authorize request
2019-08-07 09:56:02.928 +03:00 [DBG] No user present in authorize request
2019-08-07 09:56:02.939 +03:00 [DBG] Start authorize request protocol validation
2019-08-07 09:56:02.976 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-07 09:56:02.997 +03:00 [DBG] Checking for PKCE parameters
2019-08-07 09:56:02.999 +03:00 [DBG] No PKCE used.
2019-08-07 09:56:03.048 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-07 09:56:03.076 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/signin-oidc","AllowedRedirectUris":["http://localhost:5002/signin-oidc"],"SubjectId":"anonymous","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9OuhCk_5wHqJhamF-57CjfRi2cKEaQVZLo7A3V1mTcT-XmxkTezvzjYl4MjFKOmTYpuP4x-Wa5M_hOKyR0iYLj1KH_cq29_JxCW42EbTAw1vGl6-lLBNYKSS07v2eVHI4ZBDsR7JVF6MXSD5ZEkBC385ivauvlFL9SrmhRXACtEgFP-DqGPSlGYace1qdQBoELSJbsPnw5GnGZnRHh2xs7WbJGc1QmHyzIxBdcAiRTRfvAlzSvjrqhmMaBF4WZPZAnbrKkBJ2yuILALF19OE9m6npQ_rcFAsl8BnvOQiKqeNg","UiLocales":null,"Nonce":"637007577628082222.ZTMxMjczYzItNGQzYy00MWQ4LTk2ZjItNmVlZGU3MDNlY2NhMGFjMmRiNTktYzczOC00YWMyLWI1ZGEtYTVkZTdhMTU1YWZl","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637007577628082222.ZTMxMjczYzItNGQzYy00MWQ4LTk2ZjItNmVlZGU3MDNlY2NhMGFjMmRiNTktYzczOC00YWMyLWI1ZGEtYTVkZTdhMTU1YWZl","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9OuhCk_5wHqJhamF-57CjfRi2cKEaQVZLo7A3V1mTcT-XmxkTezvzjYl4MjFKOmTYpuP4x-Wa5M_hOKyR0iYLj1KH_cq29_JxCW42EbTAw1vGl6-lLBNYKSS07v2eVHI4ZBDsR7JVF6MXSD5ZEkBC385ivauvlFL9SrmhRXACtEgFP-DqGPSlGYace1qdQBoELSJbsPnw5GnGZnRHh2xs7WbJGc1QmHyzIxBdcAiRTRfvAlzSvjrqhmMaBF4WZPZAnbrKkBJ2yuILALF19OE9m6npQ_rcFAsl8BnvOQiKqeNg","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-07 09:56:03.147 +03:00 [INF] Showing login: User is not authenticated
2019-08-07 09:56:03.455 +03:00 [DBG] Start authorize request protocol validation
2019-08-07 09:56:03.456 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-07 09:56:03.462 +03:00 [DBG] Checking for PKCE parameters
2019-08-07 09:56:03.463 +03:00 [DBG] No PKCE used.
2019-08-07 09:56:03.464 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-07 09:56:03.471 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-07 09:56:06.609 +03:00 [DBG] CORS request made for path: /account/login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-08-07 09:56:06.664 +03:00 [DBG] Start authorize request protocol validation
2019-08-07 09:56:06.665 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-07 09:56:06.671 +03:00 [DBG] Checking for PKCE parameters
2019-08-07 09:56:06.672 +03:00 [DBG] No PKCE used.
2019-08-07 09:56:06.674 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-07 09:56:06.707 +03:00 [DBG] Augmenting SignInContext
2019-08-07 09:56:06.711 +03:00 [DBG] Adding idp claim with value: local
2019-08-07 09:56:06.712 +03:00 [DBG] Adding amr claim with value: pwd
2019-08-07 09:56:06.730 +03:00 [INF] AuthenticationScheme: idsrv signed in.
2019-08-07 09:56:06.737 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-07 09:56:06.752 +03:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-08-07 09:56:06.757 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-08-07 09:56:06.760 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-08-07 09:56:06.778 +03:00 [DBG] Start authorize callback request
2019-08-07 09:56:06.786 +03:00 [DBG] User in authorize request: 1
2019-08-07 09:56:06.787 +03:00 [DBG] Start authorize request protocol validation
2019-08-07 09:56:06.790 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-07 09:56:06.793 +03:00 [DBG] Checking for PKCE parameters
2019-08-07 09:56:06.795 +03:00 [DBG] No PKCE used.
2019-08-07 09:56:06.797 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-07 09:56:06.817 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/signin-oidc","AllowedRedirectUris":["http://localhost:5002/signin-oidc"],"SubjectId":"1","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9OuhCk_5wHqJhamF-57CjfRi2cKEaQVZLo7A3V1mTcT-XmxkTezvzjYl4MjFKOmTYpuP4x-Wa5M_hOKyR0iYLj1KH_cq29_JxCW42EbTAw1vGl6-lLBNYKSS07v2eVHI4ZBDsR7JVF6MXSD5ZEkBC385ivauvlFL9SrmhRXACtEgFP-DqGPSlGYace1qdQBoELSJbsPnw5GnGZnRHh2xs7WbJGc1QmHyzIxBdcAiRTRfvAlzSvjrqhmMaBF4WZPZAnbrKkBJ2yuILALF19OE9m6npQ_rcFAsl8BnvOQiKqeNg","UiLocales":null,"Nonce":"637007577628082222.ZTMxMjczYzItNGQzYy00MWQ4LTk2ZjItNmVlZGU3MDNlY2NhMGFjMmRiNTktYzczOC00YWMyLWI1ZGEtYTVkZTdhMTU1YWZl","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"5b32588f3a22f8e748aa41fa0de5742f","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637007577628082222.ZTMxMjczYzItNGQzYy00MWQ4LTk2ZjItNmVlZGU3MDNlY2NhMGFjMmRiNTktYzczOC00YWMyLWI1ZGEtYTVkZTdhMTU1YWZl","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9OuhCk_5wHqJhamF-57CjfRi2cKEaQVZLo7A3V1mTcT-XmxkTezvzjYl4MjFKOmTYpuP4x-Wa5M_hOKyR0iYLj1KH_cq29_JxCW42EbTAw1vGl6-lLBNYKSS07v2eVHI4ZBDsR7JVF6MXSD5ZEkBC385ivauvlFL9SrmhRXACtEgFP-DqGPSlGYace1qdQBoELSJbsPnw5GnGZnRHh2xs7WbJGc1QmHyzIxBdcAiRTRfvAlzSvjrqhmMaBF4WZPZAnbrKkBJ2yuILALF19OE9m6npQ_rcFAsl8BnvOQiKqeNg","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-07 09:56:06.862 +03:00 [DBG] Client is configured to not require consent, no consent is required
2019-08-07 09:56:06.871 +03:00 [DBG] Creating Hybrid Flow response.
2019-08-07 09:56:06.907 +03:00 [DBG] Creating Implicit Flow response.
2019-08-07 09:56:06.921 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-07 09:56:06.925 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-07 09:56:07.046 +03:00 [DBG] Authorize endpoint response
{"SubjectId":"1","ClientId":"mvc","RedirectUri":"http://localhost:5002/signin-oidc","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9OuhCk_5wHqJhamF-57CjfRi2cKEaQVZLo7A3V1mTcT-XmxkTezvzjYl4MjFKOmTYpuP4x-Wa5M_hOKyR0iYLj1KH_cq29_JxCW42EbTAw1vGl6-lLBNYKSS07v2eVHI4ZBDsR7JVF6MXSD5ZEkBC385ivauvlFL9SrmhRXACtEgFP-DqGPSlGYace1qdQBoELSJbsPnw5GnGZnRHh2xs7WbJGc1QmHyzIxBdcAiRTRfvAlzSvjrqhmMaBF4WZPZAnbrKkBJ2yuILALF19OE9m6npQ_rcFAsl8BnvOQiKqeNg","Scope":"openid profile afcpayroll offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-08-07 09:56:07.081 +03:00 [DBG] Augmenting SignInContext
2019-08-07 09:56:07.082 +03:00 [INF] AuthenticationScheme: idsrv signed in.
2019-08-07 09:56:07.356 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-07 09:56:07.366 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-07 09:56:07.369 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-07 09:56:07.388 +03:00 [DBG] Start token request.
2019-08-07 09:56:07.396 +03:00 [DBG] Start client validation
2019-08-07 09:56:07.404 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-07 09:56:07.415 +03:00 [DBG] Start parsing for secret in post body
2019-08-07 09:56:07.416 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-07 09:56:07.419 +03:00 [DBG] Secret id found: mvc
2019-08-07 09:56:07.423 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-07 09:56:07.439 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-07 09:56:07.439 +03:00 [DBG] Client validation success
2019-08-07 09:56:07.449 +03:00 [DBG] Start token request validation
2019-08-07 09:56:07.463 +03:00 [DBG] Start validation of authorization code token request
2019-08-07 09:56:07.484 +03:00 [DBG] Validation of authorization code token request success
2019-08-07 09:56:07.489 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"5814e079b25c1bb1de1ec89414b42f799926a5e4b09b05ea8f4e42bfbfff5c8d","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"mvc","client_secret":"***REDACTED***","code":"5814e079b25c1bb1de1ec89414b42f799926a5e4b09b05ea8f4e42bfbfff5c8d","grant_type":"authorization_code","redirect_uri":"http://localhost:5002/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-08-07 09:56:07.515 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-07 09:56:07.533 +03:00 [DBG] Getting claims for access token for client: mvc
2019-08-07 09:56:07.534 +03:00 [DBG] Getting claims for access token for subject: 1
2019-08-07 09:56:07.551 +03:00 [DBG] Creating refresh token
2019-08-07 09:56:07.551 +03:00 [DBG] Setting an absolute lifetime: 2592000
2019-08-07 09:56:07.571 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-07 09:56:07.574 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-07 09:56:07.578 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-07 09:56:07.589 +03:00 [DBG] Token request success.
2019-08-07 09:56:07.608 +03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-08-07 09:56:07.613 +03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-08-07 09:56:07.615 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-08-07 09:56:07.626 +03:00 [DBG] Start userinfo request
2019-08-07 09:56:07.631 +03:00 [DBG] Bearer token found in header
2019-08-07 09:56:07.715 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-07 09:56:07.723 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-07 09:56:07.725 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-08-07 09:56:07.731 +03:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1565160967,"exp":1565164567,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","afcpayroll"],"client_id":"mvc","sub":"1","auth_time":1565160966,"idp":"local","name":"alice","email":"alice@email.com","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-08-07 09:56:07.755 +03:00 [DBG] Creating userinfo response
2019-08-07 09:56:07.761 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-07 09:56:07.766 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-07 09:56:07.773 +03:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-07 09:56:07.774 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-07 09:56:07.783 +03:00 [INF] Profile service returned the following claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-07 09:56:07.787 +03:00 [DBG] End userinfo request
2019-08-07 09:58:10.479 +03:00 [INF] Starting IdentityServer4 version 2.5.0.0
2019-08-07 09:58:10.554 +03:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2019-08-07 09:58:10.555 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for authentication
2019-08-07 09:58:10.556 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-in
2019-08-07 09:58:10.556 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-out
2019-08-07 09:58:10.556 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for challenge
2019-08-07 09:58:10.557 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for forbid
2019-08-07 09:58:18.150 +03:00 [DBG] Login Url: /account/login
2019-08-07 09:58:18.155 +03:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-08-07 09:58:18.156 +03:00 [DBG] Logout Url: /Account/Logout
2019-08-07 09:58:18.156 +03:00 [DBG] ConsentUrl Url: /consent
2019-08-07 09:58:18.156 +03:00 [DBG] Consent Return Url Parameter: returnUrl
2019-08-07 09:58:18.157 +03:00 [DBG] Error Url: /home/error
2019-08-07 09:58:18.157 +03:00 [DBG] Error Id Parameter: errorId
2019-08-07 09:58:18.209 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-07 09:58:18.214 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-07 09:58:18.216 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-07 09:58:18.227 +03:00 [DBG] Start discovery request
2019-08-07 09:58:18.433 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-07 09:58:18.444 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-07 09:58:18.445 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-07 09:58:18.456 +03:00 [DBG] Start key discovery request
2019-08-07 09:58:18.562 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-08-07 09:58:18.596 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-08-07 09:58:18.600 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-08-07 09:58:18.615 +03:00 [DBG] Start authorize request
2019-08-07 09:58:18.631 +03:00 [DBG] No user present in authorize request
2019-08-07 09:58:18.640 +03:00 [DBG] Start authorize request protocol validation
2019-08-07 09:58:18.672 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-07 09:58:18.694 +03:00 [DBG] Checking for PKCE parameters
2019-08-07 09:58:18.696 +03:00 [DBG] No PKCE used.
2019-08-07 09:58:18.742 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-07 09:58:18.769 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/signin-oidc","AllowedRedirectUris":["http://localhost:5002/signin-oidc"],"SubjectId":"anonymous","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9N8JZwOkSkBHSZr1st6rRzx4YVNT0O7SV2pvRb98sAuPpM6jfW7XnjNgjXjUitF16FeP5DXXVj0dFBR8BizWkeidItMtZmAAf8mYwDD6MLCb49Ej_TmMZX68wDO1eyoXBYH973QxPmgJtyDl2e5NIXbszskT7OesAD_rWFohI-sblcJ2Fht38KKIaSjflnNze6crzwg-l_7oqPcnu3vXJb5KzJK5BpqePJfd5yn_N6XeCU4p76ajmz58JDZxrcDk-tlHBsldYPiA6f5c9VdwiqZXY0Xr-L3qox0xVvHPx-yIA","UiLocales":null,"Nonce":"637007578985070101.ZDA2NjNjOTQtN2ZhOS00MDlhLWJjMDMtMWMxNzA4NWZiNDFkNGE5NWJmNmEtZjFkMS00ZDllLWIwMWMtMTVhM2MzMzliYzVm","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637007578985070101.ZDA2NjNjOTQtN2ZhOS00MDlhLWJjMDMtMWMxNzA4NWZiNDFkNGE5NWJmNmEtZjFkMS00ZDllLWIwMWMtMTVhM2MzMzliYzVm","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9N8JZwOkSkBHSZr1st6rRzx4YVNT0O7SV2pvRb98sAuPpM6jfW7XnjNgjXjUitF16FeP5DXXVj0dFBR8BizWkeidItMtZmAAf8mYwDD6MLCb49Ej_TmMZX68wDO1eyoXBYH973QxPmgJtyDl2e5NIXbszskT7OesAD_rWFohI-sblcJ2Fht38KKIaSjflnNze6crzwg-l_7oqPcnu3vXJb5KzJK5BpqePJfd5yn_N6XeCU4p76ajmz58JDZxrcDk-tlHBsldYPiA6f5c9VdwiqZXY0Xr-L3qox0xVvHPx-yIA","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-07 09:58:18.842 +03:00 [INF] Showing login: User is not authenticated
2019-08-07 09:58:19.126 +03:00 [DBG] Start authorize request protocol validation
2019-08-07 09:58:19.127 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-07 09:58:19.133 +03:00 [DBG] Checking for PKCE parameters
2019-08-07 09:58:19.134 +03:00 [DBG] No PKCE used.
2019-08-07 09:58:19.136 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-07 09:58:19.144 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-07 09:58:21.302 +03:00 [DBG] CORS request made for path: /account/login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-08-07 09:58:21.360 +03:00 [DBG] Start authorize request protocol validation
2019-08-07 09:58:21.360 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-07 09:58:21.367 +03:00 [DBG] Checking for PKCE parameters
2019-08-07 09:58:21.369 +03:00 [DBG] No PKCE used.
2019-08-07 09:58:21.371 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-07 09:58:21.411 +03:00 [DBG] Augmenting SignInContext
2019-08-07 09:58:21.416 +03:00 [DBG] Adding idp claim with value: local
2019-08-07 09:58:21.417 +03:00 [DBG] Adding amr claim with value: pwd
2019-08-07 09:58:21.434 +03:00 [INF] AuthenticationScheme: idsrv signed in.
2019-08-07 09:58:21.439 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-07 09:58:21.451 +03:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-08-07 09:58:21.454 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-08-07 09:58:21.460 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-08-07 09:58:21.474 +03:00 [DBG] Start authorize callback request
2019-08-07 09:58:21.480 +03:00 [DBG] User in authorize request: 1
2019-08-07 09:58:21.480 +03:00 [DBG] Start authorize request protocol validation
2019-08-07 09:58:21.483 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-07 09:58:21.486 +03:00 [DBG] Checking for PKCE parameters
2019-08-07 09:58:21.487 +03:00 [DBG] No PKCE used.
2019-08-07 09:58:21.488 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-07 09:58:21.495 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/signin-oidc","AllowedRedirectUris":["http://localhost:5002/signin-oidc"],"SubjectId":"1","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9N8JZwOkSkBHSZr1st6rRzx4YVNT0O7SV2pvRb98sAuPpM6jfW7XnjNgjXjUitF16FeP5DXXVj0dFBR8BizWkeidItMtZmAAf8mYwDD6MLCb49Ej_TmMZX68wDO1eyoXBYH973QxPmgJtyDl2e5NIXbszskT7OesAD_rWFohI-sblcJ2Fht38KKIaSjflnNze6crzwg-l_7oqPcnu3vXJb5KzJK5BpqePJfd5yn_N6XeCU4p76ajmz58JDZxrcDk-tlHBsldYPiA6f5c9VdwiqZXY0Xr-L3qox0xVvHPx-yIA","UiLocales":null,"Nonce":"637007578985070101.ZDA2NjNjOTQtN2ZhOS00MDlhLWJjMDMtMWMxNzA4NWZiNDFkNGE5NWJmNmEtZjFkMS00ZDllLWIwMWMtMTVhM2MzMzliYzVm","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"f134c6b2215dcb2d8c61bc668c53bdde","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637007578985070101.ZDA2NjNjOTQtN2ZhOS00MDlhLWJjMDMtMWMxNzA4NWZiNDFkNGE5NWJmNmEtZjFkMS00ZDllLWIwMWMtMTVhM2MzMzliYzVm","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9N8JZwOkSkBHSZr1st6rRzx4YVNT0O7SV2pvRb98sAuPpM6jfW7XnjNgjXjUitF16FeP5DXXVj0dFBR8BizWkeidItMtZmAAf8mYwDD6MLCb49Ej_TmMZX68wDO1eyoXBYH973QxPmgJtyDl2e5NIXbszskT7OesAD_rWFohI-sblcJ2Fht38KKIaSjflnNze6crzwg-l_7oqPcnu3vXJb5KzJK5BpqePJfd5yn_N6XeCU4p76ajmz58JDZxrcDk-tlHBsldYPiA6f5c9VdwiqZXY0Xr-L3qox0xVvHPx-yIA","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-07 09:58:21.560 +03:00 [DBG] Client is configured to not require consent, no consent is required
2019-08-07 09:58:21.569 +03:00 [DBG] Creating Hybrid Flow response.
2019-08-07 09:58:21.610 +03:00 [DBG] Creating Implicit Flow response.
2019-08-07 09:58:21.623 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-07 09:58:21.628 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-07 09:58:21.739 +03:00 [DBG] Authorize endpoint response
{"SubjectId":"1","ClientId":"mvc","RedirectUri":"http://localhost:5002/signin-oidc","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9N8JZwOkSkBHSZr1st6rRzx4YVNT0O7SV2pvRb98sAuPpM6jfW7XnjNgjXjUitF16FeP5DXXVj0dFBR8BizWkeidItMtZmAAf8mYwDD6MLCb49Ej_TmMZX68wDO1eyoXBYH973QxPmgJtyDl2e5NIXbszskT7OesAD_rWFohI-sblcJ2Fht38KKIaSjflnNze6crzwg-l_7oqPcnu3vXJb5KzJK5BpqePJfd5yn_N6XeCU4p76ajmz58JDZxrcDk-tlHBsldYPiA6f5c9VdwiqZXY0Xr-L3qox0xVvHPx-yIA","Scope":"openid profile afcpayroll offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-08-07 09:58:21.772 +03:00 [DBG] Augmenting SignInContext
2019-08-07 09:58:21.773 +03:00 [INF] AuthenticationScheme: idsrv signed in.
2019-08-07 09:58:22.063 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-07 09:58:22.073 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-07 09:58:22.076 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-07 09:58:22.090 +03:00 [DBG] Start token request.
2019-08-07 09:58:22.100 +03:00 [DBG] Start client validation
2019-08-07 09:58:22.110 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-07 09:58:22.116 +03:00 [DBG] Start parsing for secret in post body
2019-08-07 09:58:22.117 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-07 09:58:22.118 +03:00 [DBG] Secret id found: mvc
2019-08-07 09:58:22.121 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-07 09:58:22.135 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-07 09:58:22.135 +03:00 [DBG] Client validation success
2019-08-07 09:58:22.144 +03:00 [DBG] Start token request validation
2019-08-07 09:58:22.160 +03:00 [DBG] Start validation of authorization code token request
2019-08-07 09:58:22.186 +03:00 [DBG] Validation of authorization code token request success
2019-08-07 09:58:22.191 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"e2d8bf1f1525f2da81fe0edecbffafbeb9849bd0e14dd6b719b1b6bbac7a508f","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"mvc","client_secret":"***REDACTED***","code":"e2d8bf1f1525f2da81fe0edecbffafbeb9849bd0e14dd6b719b1b6bbac7a508f","grant_type":"authorization_code","redirect_uri":"http://localhost:5002/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-08-07 09:58:22.224 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-07 09:58:22.247 +03:00 [DBG] Getting claims for access token for client: mvc
2019-08-07 09:58:22.251 +03:00 [DBG] Getting claims for access token for subject: 1
2019-08-07 09:58:22.269 +03:00 [DBG] Creating refresh token
2019-08-07 09:58:22.269 +03:00 [DBG] Setting an absolute lifetime: 2592000
2019-08-07 09:58:22.288 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-07 09:58:22.289 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-07 09:58:22.296 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-07 09:58:22.307 +03:00 [DBG] Token request success.
2019-08-07 09:58:22.323 +03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-08-07 09:58:22.327 +03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-08-07 09:58:22.332 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-08-07 09:58:22.346 +03:00 [DBG] Start userinfo request
2019-08-07 09:58:22.352 +03:00 [DBG] Bearer token found in header
2019-08-07 09:58:22.437 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-07 09:58:22.450 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-07 09:58:22.454 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-08-07 09:58:22.457 +03:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1565161102,"exp":1565164702,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","afcpayroll"],"client_id":"mvc","sub":"1","auth_time":1565161101,"idp":"local","name":"alice","email":"alice@email.com","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-08-07 09:58:22.476 +03:00 [DBG] Creating userinfo response
2019-08-07 09:58:22.484 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-07 09:58:22.489 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-07 09:58:22.494 +03:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-07 09:58:22.496 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-07 09:58:22.502 +03:00 [INF] Profile service returned the following claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-07 09:58:22.504 +03:00 [DBG] End userinfo request
2019-08-07 10:01:23.487 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-08-07 10:01:23.492 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-08-07 10:01:23.495 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-08-07 10:01:23.497 +03:00 [DBG] Start authorize request
2019-08-07 10:01:23.498 +03:00 [DBG] No user present in authorize request
2019-08-07 10:01:23.498 +03:00 [DBG] Start authorize request protocol validation
2019-08-07 10:01:23.501 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-07 10:01:23.503 +03:00 [DBG] Checking for PKCE parameters
2019-08-07 10:01:23.503 +03:00 [DBG] No PKCE used.
2019-08-07 10:01:23.505 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-07 10:01:23.506 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/signin-oidc","AllowedRedirectUris":["http://localhost:5002/signin-oidc"],"SubjectId":"anonymous","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9MSHITFu60_LlAAq_BFq9nFu03rbnIaHZ_XJc322wjxb33Bm9y7wEpu7omc3Iziwfjb1lzcqk3rQTvS_detHVLKlXHUcAmL6gnJxdfWqpj7xZ5IYKy2CxAFPvDsmrLFIxrQNku6cmCKTYJHjJ5DR44GH2jKO7VRGZRcZzCyibxg2jgdvd0DOIapMVxGogdMnCzGSlYNwtHVZ7o9nOKV2uEHAAuOZfkCRAd8ky_mzoQq8clTAwU1BhKdq16ojmuzXfU69x7ViE-RLQKMhWuhYyJFudtPfjqbeuwR-lgmCkLdcA","UiLocales":null,"Nonce":"637007580834582901.NWM5MjcyMTUtMzFiMS00MjJlLWIwNTctZjFhMTFhZWYzNDc3NjJiMDkwYzYtN2Y3NC00YTc0LWE1Y2EtNTk0OGIyZTVjNmIz","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637007580834582901.NWM5MjcyMTUtMzFiMS00MjJlLWIwNTctZjFhMTFhZWYzNDc3NjJiMDkwYzYtN2Y3NC00YTc0LWE1Y2EtNTk0OGIyZTVjNmIz","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9MSHITFu60_LlAAq_BFq9nFu03rbnIaHZ_XJc322wjxb33Bm9y7wEpu7omc3Iziwfjb1lzcqk3rQTvS_detHVLKlXHUcAmL6gnJxdfWqpj7xZ5IYKy2CxAFPvDsmrLFIxrQNku6cmCKTYJHjJ5DR44GH2jKO7VRGZRcZzCyibxg2jgdvd0DOIapMVxGogdMnCzGSlYNwtHVZ7o9nOKV2uEHAAuOZfkCRAd8ky_mzoQq8clTAwU1BhKdq16ojmuzXfU69x7ViE-RLQKMhWuhYyJFudtPfjqbeuwR-lgmCkLdcA","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-07 10:01:23.520 +03:00 [INF] Showing login: User is not authenticated
2019-08-07 10:01:23.536 +03:00 [DBG] Start authorize request protocol validation
2019-08-07 10:01:23.537 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-07 10:01:23.538 +03:00 [DBG] Checking for PKCE parameters
2019-08-07 10:01:23.539 +03:00 [DBG] No PKCE used.
2019-08-07 10:01:23.540 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-07 10:01:23.541 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-07 10:03:46.095 +03:00 [INF] Starting IdentityServer4 version 2.5.0.0
2019-08-07 10:03:46.166 +03:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2019-08-07 10:03:46.167 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for authentication
2019-08-07 10:03:46.167 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-in
2019-08-07 10:03:46.167 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-out
2019-08-07 10:03:46.168 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for challenge
2019-08-07 10:03:46.168 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for forbid
2019-08-07 10:03:48.021 +03:00 [DBG] CORS request made for path: /account/login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-08-07 10:03:48.048 +03:00 [DBG] Login Url: /account/login
2019-08-07 10:03:48.049 +03:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-08-07 10:03:48.050 +03:00 [DBG] Logout Url: /Account/Logout
2019-08-07 10:03:48.050 +03:00 [DBG] ConsentUrl Url: /consent
2019-08-07 10:03:48.051 +03:00 [DBG] Consent Return Url Parameter: returnUrl
2019-08-07 10:03:48.051 +03:00 [DBG] Error Url: /home/error
2019-08-07 10:03:48.051 +03:00 [DBG] Error Id Parameter: errorId
2019-08-07 10:03:48.472 +03:00 [DBG] Start authorize request protocol validation
2019-08-07 10:03:48.509 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-07 10:03:48.531 +03:00 [DBG] Checking for PKCE parameters
2019-08-07 10:03:48.533 +03:00 [DBG] No PKCE used.
2019-08-07 10:03:48.602 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-07 10:03:48.639 +03:00 [DBG] Augmenting SignInContext
2019-08-07 10:03:48.646 +03:00 [DBG] Adding idp claim with value: local
2019-08-07 10:03:48.647 +03:00 [DBG] Adding amr claim with value: pwd
2019-08-07 10:03:48.666 +03:00 [INF] AuthenticationScheme: idsrv signed in.
2019-08-07 10:03:48.671 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-07 10:03:48.708 +03:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-08-07 10:03:48.728 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-08-07 10:03:48.733 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-08-07 10:03:48.749 +03:00 [DBG] Start authorize callback request
2019-08-07 10:03:48.763 +03:00 [DBG] User in authorize request: 1
2019-08-07 10:03:48.764 +03:00 [DBG] Start authorize request protocol validation
2019-08-07 10:03:48.769 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-07 10:03:48.779 +03:00 [DBG] Checking for PKCE parameters
2019-08-07 10:03:48.781 +03:00 [DBG] No PKCE used.
2019-08-07 10:03:48.787 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-07 10:03:48.817 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/signin-oidc","AllowedRedirectUris":["http://localhost:5002/signin-oidc"],"SubjectId":"1","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9MSHITFu60_LlAAq_BFq9nFu03rbnIaHZ_XJc322wjxb33Bm9y7wEpu7omc3Iziwfjb1lzcqk3rQTvS_detHVLKlXHUcAmL6gnJxdfWqpj7xZ5IYKy2CxAFPvDsmrLFIxrQNku6cmCKTYJHjJ5DR44GH2jKO7VRGZRcZzCyibxg2jgdvd0DOIapMVxGogdMnCzGSlYNwtHVZ7o9nOKV2uEHAAuOZfkCRAd8ky_mzoQq8clTAwU1BhKdq16ojmuzXfU69x7ViE-RLQKMhWuhYyJFudtPfjqbeuwR-lgmCkLdcA","UiLocales":null,"Nonce":"637007580834582901.NWM5MjcyMTUtMzFiMS00MjJlLWIwNTctZjFhMTFhZWYzNDc3NjJiMDkwYzYtN2Y3NC00YTc0LWE1Y2EtNTk0OGIyZTVjNmIz","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"6cb8f2e62a52a8884d10edfedf29536a","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637007580834582901.NWM5MjcyMTUtMzFiMS00MjJlLWIwNTctZjFhMTFhZWYzNDc3NjJiMDkwYzYtN2Y3NC00YTc0LWE1Y2EtNTk0OGIyZTVjNmIz","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9MSHITFu60_LlAAq_BFq9nFu03rbnIaHZ_XJc322wjxb33Bm9y7wEpu7omc3Iziwfjb1lzcqk3rQTvS_detHVLKlXHUcAmL6gnJxdfWqpj7xZ5IYKy2CxAFPvDsmrLFIxrQNku6cmCKTYJHjJ5DR44GH2jKO7VRGZRcZzCyibxg2jgdvd0DOIapMVxGogdMnCzGSlYNwtHVZ7o9nOKV2uEHAAuOZfkCRAd8ky_mzoQq8clTAwU1BhKdq16ojmuzXfU69x7ViE-RLQKMhWuhYyJFudtPfjqbeuwR-lgmCkLdcA","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-07 10:03:48.900 +03:00 [DBG] Client is configured to not require consent, no consent is required
2019-08-07 10:03:48.908 +03:00 [DBG] Creating Hybrid Flow response.
2019-08-07 10:03:48.949 +03:00 [DBG] Creating Implicit Flow response.
2019-08-07 10:03:48.963 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-07 10:03:48.968 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-07 10:03:49.088 +03:00 [DBG] Authorize endpoint response
{"SubjectId":"1","ClientId":"mvc","RedirectUri":"http://localhost:5002/signin-oidc","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9MSHITFu60_LlAAq_BFq9nFu03rbnIaHZ_XJc322wjxb33Bm9y7wEpu7omc3Iziwfjb1lzcqk3rQTvS_detHVLKlXHUcAmL6gnJxdfWqpj7xZ5IYKy2CxAFPvDsmrLFIxrQNku6cmCKTYJHjJ5DR44GH2jKO7VRGZRcZzCyibxg2jgdvd0DOIapMVxGogdMnCzGSlYNwtHVZ7o9nOKV2uEHAAuOZfkCRAd8ky_mzoQq8clTAwU1BhKdq16ojmuzXfU69x7ViE-RLQKMhWuhYyJFudtPfjqbeuwR-lgmCkLdcA","Scope":"openid profile afcpayroll offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-08-07 10:03:49.121 +03:00 [DBG] Augmenting SignInContext
2019-08-07 10:03:49.121 +03:00 [INF] AuthenticationScheme: idsrv signed in.
2019-08-07 10:03:49.391 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-07 10:03:49.408 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-07 10:03:49.411 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-07 10:03:49.430 +03:00 [DBG] Start token request.
2019-08-07 10:03:49.439 +03:00 [DBG] Start client validation
2019-08-07 10:03:49.447 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-07 10:03:49.457 +03:00 [DBG] Start parsing for secret in post body
2019-08-07 10:03:49.458 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-07 10:03:49.459 +03:00 [DBG] Secret id found: mvc
2019-08-07 10:03:49.461 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-07 10:03:49.479 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-07 10:03:49.480 +03:00 [DBG] Client validation success
2019-08-07 10:03:49.489 +03:00 [DBG] Start token request validation
2019-08-07 10:03:49.504 +03:00 [DBG] Start validation of authorization code token request
2019-08-07 10:03:49.522 +03:00 [DBG] Validation of authorization code token request success
2019-08-07 10:03:49.527 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"8c6dac96c3a6d7da77a4456879edbe04090ce1c2111c29a22e95905a477c7d6c","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"mvc","client_secret":"***REDACTED***","code":"8c6dac96c3a6d7da77a4456879edbe04090ce1c2111c29a22e95905a477c7d6c","grant_type":"authorization_code","redirect_uri":"http://localhost:5002/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-08-07 10:03:49.557 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-07 10:03:49.575 +03:00 [DBG] Getting claims for access token for client: mvc
2019-08-07 10:03:49.576 +03:00 [DBG] Getting claims for access token for subject: 1
2019-08-07 10:03:49.592 +03:00 [DBG] Creating refresh token
2019-08-07 10:03:49.593 +03:00 [DBG] Setting an absolute lifetime: 2592000
2019-08-07 10:03:49.613 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-07 10:03:49.616 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-07 10:03:49.620 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-07 10:03:49.631 +03:00 [DBG] Token request success.
2019-08-07 10:03:49.648 +03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-08-07 10:03:49.652 +03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-08-07 10:03:49.656 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-08-07 10:03:49.667 +03:00 [DBG] Start userinfo request
2019-08-07 10:03:49.672 +03:00 [DBG] Bearer token found in header
2019-08-07 10:03:49.756 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-07 10:03:49.763 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-07 10:03:49.767 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-08-07 10:03:49.774 +03:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1565161429,"exp":1565161489,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","afcpayroll"],"client_id":"mvc","sub":"1","auth_time":1565161428,"idp":"local","name":"alice","email":"alice@email.com","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-08-07 10:03:49.796 +03:00 [DBG] Creating userinfo response
2019-08-07 10:03:49.803 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-07 10:03:49.808 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-07 10:03:49.815 +03:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-07 10:03:49.816 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-07 10:03:49.823 +03:00 [INF] Profile service returned the following claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-07 10:03:49.827 +03:00 [DBG] End userinfo request
2019-08-07 10:04:26.751 +03:00 [INF] Starting IdentityServer4 version 2.5.0.0
2019-08-07 10:04:26.836 +03:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2019-08-07 10:04:26.847 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for authentication
2019-08-07 10:04:26.853 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-in
2019-08-07 10:04:26.854 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-out
2019-08-07 10:04:26.854 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for challenge
2019-08-07 10:04:26.855 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for forbid
2019-08-07 10:04:30.563 +03:00 [DBG] Login Url: /account/login
2019-08-07 10:04:30.566 +03:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-08-07 10:04:30.567 +03:00 [DBG] Logout Url: /Account/Logout
2019-08-07 10:04:30.568 +03:00 [DBG] ConsentUrl Url: /consent
2019-08-07 10:04:30.568 +03:00 [DBG] Consent Return Url Parameter: returnUrl
2019-08-07 10:04:30.568 +03:00 [DBG] Error Url: /home/error
2019-08-07 10:04:30.569 +03:00 [DBG] Error Id Parameter: errorId
2019-08-07 10:04:30.624 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-07 10:04:30.631 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-07 10:04:30.633 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-07 10:04:30.645 +03:00 [DBG] Start discovery request
2019-08-07 10:04:30.856 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-07 10:04:30.865 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-07 10:04:30.870 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-07 10:04:30.881 +03:00 [DBG] Start key discovery request
2019-08-07 10:04:30.999 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-08-07 10:04:31.035 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-08-07 10:04:31.038 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-08-07 10:04:31.051 +03:00 [DBG] Start authorize request
2019-08-07 10:04:31.067 +03:00 [DBG] No user present in authorize request
2019-08-07 10:04:31.075 +03:00 [DBG] Start authorize request protocol validation
2019-08-07 10:04:31.107 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-07 10:04:31.129 +03:00 [DBG] Checking for PKCE parameters
2019-08-07 10:04:31.131 +03:00 [DBG] No PKCE used.
2019-08-07 10:04:31.178 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-07 10:04:31.205 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/signin-oidc","AllowedRedirectUris":["http://localhost:5002/signin-oidc"],"SubjectId":"anonymous","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9MEAgZubxM7C5BFd4pTQZxn7EIhhRpfQA6ZuaLFLo7qdi0qfEHnxlGF6dpKWQGyLwGygSvNoOsIqYLdmxayESTJGLLtPJgQHFc-ObbgEg1QHI7Tp-Iw62cLI-BR2WlTUvqH5OYLwA4_75IPl4kg9bA6kIlcWwuhJjHSBhrZUq7nPV2nYKzHbwyR_hy9GD48bdsHfSnIXRMHyRUJhTbAsUb2cR3NfWfmm2kHDXvrwDdnnUfhJr1R7i7wO_NTCKCUnjJRl9TPRw3_8yf3NdeFrRUkrqmkq-T_-6_Fg6v7Z-vbtQ","UiLocales":null,"Nonce":"637007582709442112.M2IwZTNmZTgtMmQzNi00OTM3LTkwZDctYThlYTZjNTViZWY3MWY1ZGRiZjEtZTM1MS00M2E5LTk4NDctMmVlZDk2OGYwNThl","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637007582709442112.M2IwZTNmZTgtMmQzNi00OTM3LTkwZDctYThlYTZjNTViZWY3MWY1ZGRiZjEtZTM1MS00M2E5LTk4NDctMmVlZDk2OGYwNThl","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9MEAgZubxM7C5BFd4pTQZxn7EIhhRpfQA6ZuaLFLo7qdi0qfEHnxlGF6dpKWQGyLwGygSvNoOsIqYLdmxayESTJGLLtPJgQHFc-ObbgEg1QHI7Tp-Iw62cLI-BR2WlTUvqH5OYLwA4_75IPl4kg9bA6kIlcWwuhJjHSBhrZUq7nPV2nYKzHbwyR_hy9GD48bdsHfSnIXRMHyRUJhTbAsUb2cR3NfWfmm2kHDXvrwDdnnUfhJr1R7i7wO_NTCKCUnjJRl9TPRw3_8yf3NdeFrRUkrqmkq-T_-6_Fg6v7Z-vbtQ","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-07 10:04:31.281 +03:00 [INF] Showing login: User is not authenticated
2019-08-07 10:04:31.559 +03:00 [DBG] Start authorize request protocol validation
2019-08-07 10:04:31.561 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-07 10:04:31.566 +03:00 [DBG] Checking for PKCE parameters
2019-08-07 10:04:31.567 +03:00 [DBG] No PKCE used.
2019-08-07 10:04:31.568 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-07 10:04:31.574 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-07 10:04:34.159 +03:00 [DBG] CORS request made for path: /account/login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-08-07 10:04:34.225 +03:00 [DBG] Start authorize request protocol validation
2019-08-07 10:04:34.226 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-07 10:04:34.236 +03:00 [DBG] Checking for PKCE parameters
2019-08-07 10:04:34.237 +03:00 [DBG] No PKCE used.
2019-08-07 10:04:34.241 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-07 10:04:34.270 +03:00 [DBG] Augmenting SignInContext
2019-08-07 10:04:34.274 +03:00 [DBG] Adding idp claim with value: local
2019-08-07 10:04:34.275 +03:00 [DBG] Adding amr claim with value: pwd
2019-08-07 10:04:34.290 +03:00 [INF] AuthenticationScheme: idsrv signed in.
2019-08-07 10:04:34.296 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-07 10:04:34.310 +03:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-08-07 10:04:34.313 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-08-07 10:04:34.319 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-08-07 10:04:34.331 +03:00 [DBG] Start authorize callback request
2019-08-07 10:04:34.337 +03:00 [DBG] User in authorize request: 1
2019-08-07 10:04:34.339 +03:00 [DBG] Start authorize request protocol validation
2019-08-07 10:04:34.340 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-07 10:04:34.345 +03:00 [DBG] Checking for PKCE parameters
2019-08-07 10:04:34.346 +03:00 [DBG] No PKCE used.
2019-08-07 10:04:34.348 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-07 10:04:34.356 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/signin-oidc","AllowedRedirectUris":["http://localhost:5002/signin-oidc"],"SubjectId":"1","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9MEAgZubxM7C5BFd4pTQZxn7EIhhRpfQA6ZuaLFLo7qdi0qfEHnxlGF6dpKWQGyLwGygSvNoOsIqYLdmxayESTJGLLtPJgQHFc-ObbgEg1QHI7Tp-Iw62cLI-BR2WlTUvqH5OYLwA4_75IPl4kg9bA6kIlcWwuhJjHSBhrZUq7nPV2nYKzHbwyR_hy9GD48bdsHfSnIXRMHyRUJhTbAsUb2cR3NfWfmm2kHDXvrwDdnnUfhJr1R7i7wO_NTCKCUnjJRl9TPRw3_8yf3NdeFrRUkrqmkq-T_-6_Fg6v7Z-vbtQ","UiLocales":null,"Nonce":"637007582709442112.M2IwZTNmZTgtMmQzNi00OTM3LTkwZDctYThlYTZjNTViZWY3MWY1ZGRiZjEtZTM1MS00M2E5LTk4NDctMmVlZDk2OGYwNThl","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"c1cdc5553b08f6db3a919b5a61cde2a1","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637007582709442112.M2IwZTNmZTgtMmQzNi00OTM3LTkwZDctYThlYTZjNTViZWY3MWY1ZGRiZjEtZTM1MS00M2E5LTk4NDctMmVlZDk2OGYwNThl","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9MEAgZubxM7C5BFd4pTQZxn7EIhhRpfQA6ZuaLFLo7qdi0qfEHnxlGF6dpKWQGyLwGygSvNoOsIqYLdmxayESTJGLLtPJgQHFc-ObbgEg1QHI7Tp-Iw62cLI-BR2WlTUvqH5OYLwA4_75IPl4kg9bA6kIlcWwuhJjHSBhrZUq7nPV2nYKzHbwyR_hy9GD48bdsHfSnIXRMHyRUJhTbAsUb2cR3NfWfmm2kHDXvrwDdnnUfhJr1R7i7wO_NTCKCUnjJRl9TPRw3_8yf3NdeFrRUkrqmkq-T_-6_Fg6v7Z-vbtQ","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-07 10:04:34.402 +03:00 [DBG] Client is configured to not require consent, no consent is required
2019-08-07 10:04:34.413 +03:00 [DBG] Creating Hybrid Flow response.
2019-08-07 10:04:34.449 +03:00 [DBG] Creating Implicit Flow response.
2019-08-07 10:04:34.461 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-07 10:04:34.465 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-07 10:04:34.576 +03:00 [DBG] Authorize endpoint response
{"SubjectId":"1","ClientId":"mvc","RedirectUri":"http://localhost:5002/signin-oidc","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9MEAgZubxM7C5BFd4pTQZxn7EIhhRpfQA6ZuaLFLo7qdi0qfEHnxlGF6dpKWQGyLwGygSvNoOsIqYLdmxayESTJGLLtPJgQHFc-ObbgEg1QHI7Tp-Iw62cLI-BR2WlTUvqH5OYLwA4_75IPl4kg9bA6kIlcWwuhJjHSBhrZUq7nPV2nYKzHbwyR_hy9GD48bdsHfSnIXRMHyRUJhTbAsUb2cR3NfWfmm2kHDXvrwDdnnUfhJr1R7i7wO_NTCKCUnjJRl9TPRw3_8yf3NdeFrRUkrqmkq-T_-6_Fg6v7Z-vbtQ","Scope":"openid profile afcpayroll offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-08-07 10:04:34.610 +03:00 [DBG] Augmenting SignInContext
2019-08-07 10:04:34.613 +03:00 [INF] AuthenticationScheme: idsrv signed in.
2019-08-07 10:04:34.881 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-07 10:04:34.892 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-07 10:04:34.896 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-07 10:04:34.910 +03:00 [DBG] Start token request.
2019-08-07 10:04:34.919 +03:00 [DBG] Start client validation
2019-08-07 10:04:34.929 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-07 10:04:34.936 +03:00 [DBG] Start parsing for secret in post body
2019-08-07 10:04:34.937 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-07 10:04:34.940 +03:00 [DBG] Secret id found: mvc
2019-08-07 10:04:34.942 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-07 10:04:34.987 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-07 10:04:34.988 +03:00 [DBG] Client validation success
2019-08-07 10:04:34.999 +03:00 [DBG] Start token request validation
2019-08-07 10:04:35.016 +03:00 [DBG] Start validation of authorization code token request
2019-08-07 10:04:35.042 +03:00 [DBG] Validation of authorization code token request success
2019-08-07 10:04:35.050 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"45b8ab927a13373ba2e7cbd4b2ad95fd159ff9ff3f8ae7caabc880999d28f7df","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"mvc","client_secret":"***REDACTED***","code":"45b8ab927a13373ba2e7cbd4b2ad95fd159ff9ff3f8ae7caabc880999d28f7df","grant_type":"authorization_code","redirect_uri":"http://localhost:5002/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-08-07 10:04:35.085 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-07 10:04:35.104 +03:00 [DBG] Getting claims for access token for client: mvc
2019-08-07 10:04:35.105 +03:00 [DBG] Getting claims for access token for subject: 1
2019-08-07 10:04:35.124 +03:00 [DBG] Creating refresh token
2019-08-07 10:04:35.124 +03:00 [DBG] Setting an absolute lifetime: 2592000
2019-08-07 10:04:35.141 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-07 10:04:35.144 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-07 10:04:35.150 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-07 10:04:35.162 +03:00 [DBG] Token request success.
2019-08-07 10:04:35.181 +03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-08-07 10:04:35.186 +03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-08-07 10:04:35.191 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-08-07 10:04:35.202 +03:00 [DBG] Start userinfo request
2019-08-07 10:04:35.208 +03:00 [DBG] Bearer token found in header
2019-08-07 10:04:35.312 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-07 10:04:35.320 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-07 10:04:35.322 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-08-07 10:04:35.330 +03:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1565161475,"exp":1565161535,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","afcpayroll"],"client_id":"mvc","sub":"1","auth_time":1565161474,"idp":"local","name":"alice","email":"alice@email.com","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-08-07 10:04:35.351 +03:00 [DBG] Creating userinfo response
2019-08-07 10:04:35.357 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-07 10:04:35.364 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-07 10:04:35.369 +03:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-07 10:04:35.371 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-07 10:04:35.375 +03:00 [INF] Profile service returned the following claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-07 10:04:35.377 +03:00 [DBG] End userinfo request
2019-08-07 10:26:40.980 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-08-07 10:26:40.992 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-08-07 10:26:40.993 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-08-07 10:26:40.995 +03:00 [DBG] Start authorize request
2019-08-07 10:26:40.996 +03:00 [DBG] No user present in authorize request
2019-08-07 10:26:40.996 +03:00 [DBG] Start authorize request protocol validation
2019-08-07 10:26:40.997 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-07 10:26:40.998 +03:00 [DBG] Checking for PKCE parameters
2019-08-07 10:26:40.999 +03:00 [DBG] No PKCE used.
2019-08-07 10:26:41.000 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-07 10:26:41.003 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/signin-oidc","AllowedRedirectUris":["http://localhost:5002/signin-oidc"],"SubjectId":"anonymous","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9PGJUJbK7rC8rW-sPZpDLuvbbmVKuKlCQkcWUv7-9I24uF_aG9O-U-oRiFf2uO474n8Y1yXizkBsY_zu1BnaInbU4Cgu7pmmUBsyL5CNMFTDUh8ezkcv4s0bnN9rq0RRGypDPcboFL79fPTdH_z16GK7JrhZP67qG_tmXrkvA9AGL9Ptfg21bWiD8U6C3fTAiCoK0SXCQLT6-QG01KG09qIkQzCkHhgwCQ9IGPEyQzMQTEdtu3_HBFEMXUvSaKPqRySsacnbEF7r4k0UfwJM4OMQI1tjysNfh6FZk469NOKpg","UiLocales":null,"Nonce":"637007596009485641.ZDY5NDY3ZDctNmU2NS00ZWNiLWI0NDAtNmJkYWVlNTA3M2QyNDBiZDIzNjctOWZmZS00NGM3LTk2OWItOWVmYzg2OGQyNmJl","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637007596009485641.ZDY5NDY3ZDctNmU2NS00ZWNiLWI0NDAtNmJkYWVlNTA3M2QyNDBiZDIzNjctOWZmZS00NGM3LTk2OWItOWVmYzg2OGQyNmJl","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9PGJUJbK7rC8rW-sPZpDLuvbbmVKuKlCQkcWUv7-9I24uF_aG9O-U-oRiFf2uO474n8Y1yXizkBsY_zu1BnaInbU4Cgu7pmmUBsyL5CNMFTDUh8ezkcv4s0bnN9rq0RRGypDPcboFL79fPTdH_z16GK7JrhZP67qG_tmXrkvA9AGL9Ptfg21bWiD8U6C3fTAiCoK0SXCQLT6-QG01KG09qIkQzCkHhgwCQ9IGPEyQzMQTEdtu3_HBFEMXUvSaKPqRySsacnbEF7r4k0UfwJM4OMQI1tjysNfh6FZk469NOKpg","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-07 10:26:41.016 +03:00 [INF] Showing login: User is not authenticated
2019-08-07 10:26:41.024 +03:00 [DBG] Start authorize request protocol validation
2019-08-07 10:26:41.024 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-07 10:26:41.026 +03:00 [DBG] Checking for PKCE parameters
2019-08-07 10:26:41.026 +03:00 [DBG] No PKCE used.
2019-08-07 10:26:41.028 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-07 10:26:41.030 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-07 10:26:42.793 +03:00 [DBG] CORS request made for path: /account/login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-08-07 10:26:42.797 +03:00 [DBG] Start authorize request protocol validation
2019-08-07 10:26:42.797 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-07 10:26:42.801 +03:00 [DBG] Checking for PKCE parameters
2019-08-07 10:26:42.802 +03:00 [DBG] No PKCE used.
2019-08-07 10:26:42.803 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-07 10:26:42.804 +03:00 [DBG] Augmenting SignInContext
2019-08-07 10:26:42.805 +03:00 [DBG] Adding idp claim with value: local
2019-08-07 10:26:42.805 +03:00 [DBG] Adding amr claim with value: pwd
2019-08-07 10:26:42.807 +03:00 [INF] AuthenticationScheme: idsrv signed in.
2019-08-07 10:26:42.809 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-07 10:26:42.820 +03:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-08-07 10:26:42.821 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-08-07 10:26:42.823 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-08-07 10:26:42.825 +03:00 [DBG] Start authorize callback request
2019-08-07 10:26:42.826 +03:00 [DBG] User in authorize request: 1
2019-08-07 10:26:42.826 +03:00 [DBG] Start authorize request protocol validation
2019-08-07 10:26:42.827 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-07 10:26:42.828 +03:00 [DBG] Checking for PKCE parameters
2019-08-07 10:26:42.829 +03:00 [DBG] No PKCE used.
2019-08-07 10:26:42.830 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-07 10:26:42.834 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/signin-oidc","AllowedRedirectUris":["http://localhost:5002/signin-oidc"],"SubjectId":"1","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9PGJUJbK7rC8rW-sPZpDLuvbbmVKuKlCQkcWUv7-9I24uF_aG9O-U-oRiFf2uO474n8Y1yXizkBsY_zu1BnaInbU4Cgu7pmmUBsyL5CNMFTDUh8ezkcv4s0bnN9rq0RRGypDPcboFL79fPTdH_z16GK7JrhZP67qG_tmXrkvA9AGL9Ptfg21bWiD8U6C3fTAiCoK0SXCQLT6-QG01KG09qIkQzCkHhgwCQ9IGPEyQzMQTEdtu3_HBFEMXUvSaKPqRySsacnbEF7r4k0UfwJM4OMQI1tjysNfh6FZk469NOKpg","UiLocales":null,"Nonce":"637007596009485641.ZDY5NDY3ZDctNmU2NS00ZWNiLWI0NDAtNmJkYWVlNTA3M2QyNDBiZDIzNjctOWZmZS00NGM3LTk2OWItOWVmYzg2OGQyNmJl","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"f2d5ade6fcadf17f07c84bd8f1dc3c96","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637007596009485641.ZDY5NDY3ZDctNmU2NS00ZWNiLWI0NDAtNmJkYWVlNTA3M2QyNDBiZDIzNjctOWZmZS00NGM3LTk2OWItOWVmYzg2OGQyNmJl","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9PGJUJbK7rC8rW-sPZpDLuvbbmVKuKlCQkcWUv7-9I24uF_aG9O-U-oRiFf2uO474n8Y1yXizkBsY_zu1BnaInbU4Cgu7pmmUBsyL5CNMFTDUh8ezkcv4s0bnN9rq0RRGypDPcboFL79fPTdH_z16GK7JrhZP67qG_tmXrkvA9AGL9Ptfg21bWiD8U6C3fTAiCoK0SXCQLT6-QG01KG09qIkQzCkHhgwCQ9IGPEyQzMQTEdtu3_HBFEMXUvSaKPqRySsacnbEF7r4k0UfwJM4OMQI1tjysNfh6FZk469NOKpg","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-07 10:26:42.850 +03:00 [DBG] Client is configured to not require consent, no consent is required
2019-08-07 10:26:42.851 +03:00 [DBG] Creating Hybrid Flow response.
2019-08-07 10:26:42.852 +03:00 [DBG] Creating Implicit Flow response.
2019-08-07 10:26:42.852 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-07 10:26:42.854 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-07 10:26:42.863 +03:00 [DBG] Authorize endpoint response
{"SubjectId":"1","ClientId":"mvc","RedirectUri":"http://localhost:5002/signin-oidc","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9PGJUJbK7rC8rW-sPZpDLuvbbmVKuKlCQkcWUv7-9I24uF_aG9O-U-oRiFf2uO474n8Y1yXizkBsY_zu1BnaInbU4Cgu7pmmUBsyL5CNMFTDUh8ezkcv4s0bnN9rq0RRGypDPcboFL79fPTdH_z16GK7JrhZP67qG_tmXrkvA9AGL9Ptfg21bWiD8U6C3fTAiCoK0SXCQLT6-QG01KG09qIkQzCkHhgwCQ9IGPEyQzMQTEdtu3_HBFEMXUvSaKPqRySsacnbEF7r4k0UfwJM4OMQI1tjysNfh6FZk469NOKpg","Scope":"openid profile afcpayroll offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-08-07 10:26:42.867 +03:00 [DBG] Augmenting SignInContext
2019-08-07 10:26:42.868 +03:00 [INF] AuthenticationScheme: idsrv signed in.
2019-08-07 10:26:43.087 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-07 10:26:43.089 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-07 10:26:43.090 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-07 10:26:43.091 +03:00 [DBG] Start token request.
2019-08-07 10:26:43.092 +03:00 [DBG] Start client validation
2019-08-07 10:26:43.096 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-07 10:26:43.096 +03:00 [DBG] Start parsing for secret in post body
2019-08-07 10:26:43.097 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-07 10:26:43.098 +03:00 [DBG] Secret id found: mvc
2019-08-07 10:26:43.099 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-07 10:26:43.100 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-07 10:26:43.101 +03:00 [DBG] Client validation success
2019-08-07 10:26:43.101 +03:00 [DBG] Start token request validation
2019-08-07 10:26:43.102 +03:00 [DBG] Start validation of authorization code token request
2019-08-07 10:26:43.103 +03:00 [DBG] Validation of authorization code token request success
2019-08-07 10:26:43.104 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"d154ff2fbdac7a245d6a63af60443f19c80d8db1b943db54b3f63fa3bde54265","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"mvc","client_secret":"***REDACTED***","code":"d154ff2fbdac7a245d6a63af60443f19c80d8db1b943db54b3f63fa3bde54265","grant_type":"authorization_code","redirect_uri":"http://localhost:5002/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-08-07 10:26:43.109 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-07 10:26:43.111 +03:00 [DBG] Getting claims for access token for client: mvc
2019-08-07 10:26:43.112 +03:00 [DBG] Getting claims for access token for subject: 1
2019-08-07 10:26:43.118 +03:00 [DBG] Creating refresh token
2019-08-07 10:26:43.119 +03:00 [DBG] Setting an absolute lifetime: 2592000
2019-08-07 10:26:43.122 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-07 10:26:43.123 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-07 10:26:43.124 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-07 10:26:43.130 +03:00 [DBG] Token request success.
2019-08-07 10:26:43.133 +03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-08-07 10:26:43.134 +03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-08-07 10:26:43.135 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-08-07 10:26:43.136 +03:00 [DBG] Start userinfo request
2019-08-07 10:26:43.137 +03:00 [DBG] Bearer token found in header
2019-08-07 10:26:43.142 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-07 10:26:43.144 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-07 10:26:43.146 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-08-07 10:26:43.147 +03:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1565162803,"exp":1565162863,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","afcpayroll"],"client_id":"mvc","sub":"1","auth_time":1565162802,"idp":"local","name":"alice","email":"alice@email.com","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-08-07 10:26:43.153 +03:00 [DBG] Creating userinfo response
2019-08-07 10:26:43.153 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-07 10:26:43.154 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-07 10:26:43.155 +03:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-07 10:26:43.156 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-07 10:26:43.157 +03:00 [INF] Profile service returned the following claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-07 10:26:43.158 +03:00 [DBG] End userinfo request
2019-08-07 10:30:04.618 +03:00 [INF] Starting IdentityServer4 version 2.5.0.0
2019-08-07 10:30:04.682 +03:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2019-08-07 10:30:04.685 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for authentication
2019-08-07 10:30:04.687 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-in
2019-08-07 10:30:04.694 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-out
2019-08-07 10:30:04.698 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for challenge
2019-08-07 10:30:04.705 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for forbid
2019-08-07 10:46:35.230 +03:00 [DBG] Login Url: /account/login
2019-08-07 10:46:35.232 +03:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-08-07 10:46:35.233 +03:00 [DBG] Logout Url: /Account/Logout
2019-08-07 10:46:35.234 +03:00 [DBG] ConsentUrl Url: /consent
2019-08-07 10:46:35.234 +03:00 [DBG] Consent Return Url Parameter: returnUrl
2019-08-07 10:46:35.235 +03:00 [DBG] Error Url: /home/error
2019-08-07 10:46:35.235 +03:00 [DBG] Error Id Parameter: errorId
2019-08-07 10:46:35.268 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-07 10:46:35.273 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-07 10:46:35.274 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-07 10:46:35.278 +03:00 [DBG] Start discovery request
2019-08-07 10:46:35.387 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-07 10:46:35.397 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-07 10:46:35.398 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-07 10:46:35.402 +03:00 [DBG] Start key discovery request
2019-08-07 10:46:39.195 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-07 10:46:39.207 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-07 10:46:39.210 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-07 10:46:39.219 +03:00 [DBG] Start token request.
2019-08-07 10:46:39.230 +03:00 [DBG] Start client validation
2019-08-07 10:46:39.243 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-07 10:46:39.251 +03:00 [DBG] Start parsing for secret in post body
2019-08-07 10:46:39.284 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-07 10:46:39.284 +03:00 [DBG] Secret id found: mvc
2019-08-07 10:46:39.309 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-07 10:46:39.320 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-07 10:46:39.320 +03:00 [DBG] Client validation success
2019-08-07 10:46:39.335 +03:00 [DBG] Start token request validation
2019-08-07 10:46:39.345 +03:00 [DBG] Start validation of refresh token request
2019-08-07 10:46:39.361 +03:00 [DBG] refresh_token grant with value: ee183840fe965ab574bd680de939f539230f7c063f3ed08f3c7e93b321802d9d not found in store.
2019-08-07 10:46:39.361 +03:00 [WRN] Invalid refresh token
2019-08-07 10:46:39.380 +03:00 [WRN] Refresh token validation failed. aborting, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"refresh_token","Scopes":null,"AuthorizationCode":null,"RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"refresh_token","refresh_token":"***REDACTED***","client_id":"mvc","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2019-08-07 10:47:42.533 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-07 10:47:42.535 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-07 10:47:42.538 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-07 10:47:42.539 +03:00 [DBG] Start discovery request
2019-08-07 10:47:42.578 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-07 10:47:42.579 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-07 10:47:42.582 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-07 10:47:42.583 +03:00 [DBG] Start key discovery request
2019-08-07 10:47:42.633 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-08-07 10:47:42.650 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-08-07 10:47:42.650 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-08-07 10:47:42.657 +03:00 [DBG] Start authorize request
2019-08-07 10:47:42.665 +03:00 [DBG] No user present in authorize request
2019-08-07 10:47:42.673 +03:00 [DBG] Start authorize request protocol validation
2019-08-07 10:47:42.678 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-07 10:47:42.698 +03:00 [DBG] Checking for PKCE parameters
2019-08-07 10:47:42.699 +03:00 [DBG] No PKCE used.
2019-08-07 10:47:42.740 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-07 10:47:42.746 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/signin-oidc","AllowedRedirectUris":["http://localhost:5002/signin-oidc"],"SubjectId":"anonymous","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9NiCJeFy9p07kD-x0ymNNCr7xpgYTEuQ27spNNU0DtKpRwlDYTjoWeCGN1gOc5QXtKUr6Wc1ooD9G2kJiClwwZYZ2tp930kY9SxAIry2pe-4I-dksO-eSlGpCVes4gz_cvMNm3CZm1dQONDvfHlwD1ibeS_X26dDz63VgEPM3ofh4Y6oAq3AlCtFCG7ms9YbbSxwds67afQHCzB7VR7Dq2aQTm1_3R9eJAZSucGP1X3uIKOVT97bXKsE8XNb-aiuBW2RtAlGoqoe3zjyvE0jmVK7WPEZAao1qMTycgI5dWh8g","UiLocales":null,"Nonce":"637007608626050397.NTdlZmEzOTYtNmQ0My00ODQ1LTg4YWItNzhkZGM2NTJiYmE0ZDAwNzFkZDYtZWNkOC00ZjJiLWFlNGYtNWVmNTVkYzY0NzRl","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637007608626050397.NTdlZmEzOTYtNmQ0My00ODQ1LTg4YWItNzhkZGM2NTJiYmE0ZDAwNzFkZDYtZWNkOC00ZjJiLWFlNGYtNWVmNTVkYzY0NzRl","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9NiCJeFy9p07kD-x0ymNNCr7xpgYTEuQ27spNNU0DtKpRwlDYTjoWeCGN1gOc5QXtKUr6Wc1ooD9G2kJiClwwZYZ2tp930kY9SxAIry2pe-4I-dksO-eSlGpCVes4gz_cvMNm3CZm1dQONDvfHlwD1ibeS_X26dDz63VgEPM3ofh4Y6oAq3AlCtFCG7ms9YbbSxwds67afQHCzB7VR7Dq2aQTm1_3R9eJAZSucGP1X3uIKOVT97bXKsE8XNb-aiuBW2RtAlGoqoe3zjyvE0jmVK7WPEZAao1qMTycgI5dWh8g","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-07 10:47:42.760 +03:00 [INF] Showing login: User is not authenticated
2019-08-07 10:47:42.949 +03:00 [DBG] Start authorize request protocol validation
2019-08-07 10:47:42.949 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-07 10:47:42.950 +03:00 [DBG] Checking for PKCE parameters
2019-08-07 10:47:42.950 +03:00 [DBG] No PKCE used.
2019-08-07 10:47:42.950 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-07 10:47:42.954 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-07 10:47:47.477 +03:00 [DBG] CORS request made for path: /account/login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-08-07 10:47:47.510 +03:00 [DBG] Start authorize request protocol validation
2019-08-07 10:47:47.511 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-07 10:47:47.511 +03:00 [DBG] Checking for PKCE parameters
2019-08-07 10:47:47.511 +03:00 [DBG] No PKCE used.
2019-08-07 10:47:47.512 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-07 10:47:47.534 +03:00 [DBG] Augmenting SignInContext
2019-08-07 10:47:47.539 +03:00 [DBG] Adding idp claim with value: local
2019-08-07 10:47:47.540 +03:00 [DBG] Adding amr claim with value: pwd
2019-08-07 10:47:47.550 +03:00 [INF] AuthenticationScheme: idsrv signed in.
2019-08-07 10:47:47.552 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-07 10:47:47.561 +03:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-08-07 10:47:47.563 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-08-07 10:47:47.563 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-08-07 10:47:47.571 +03:00 [DBG] Start authorize callback request
2019-08-07 10:47:47.576 +03:00 [DBG] User in authorize request: 1
2019-08-07 10:47:47.577 +03:00 [DBG] Start authorize request protocol validation
2019-08-07 10:47:47.577 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-07 10:47:47.577 +03:00 [DBG] Checking for PKCE parameters
2019-08-07 10:47:47.577 +03:00 [DBG] No PKCE used.
2019-08-07 10:47:47.578 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-07 10:47:47.578 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/signin-oidc","AllowedRedirectUris":["http://localhost:5002/signin-oidc"],"SubjectId":"1","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9NiCJeFy9p07kD-x0ymNNCr7xpgYTEuQ27spNNU0DtKpRwlDYTjoWeCGN1gOc5QXtKUr6Wc1ooD9G2kJiClwwZYZ2tp930kY9SxAIry2pe-4I-dksO-eSlGpCVes4gz_cvMNm3CZm1dQONDvfHlwD1ibeS_X26dDz63VgEPM3ofh4Y6oAq3AlCtFCG7ms9YbbSxwds67afQHCzB7VR7Dq2aQTm1_3R9eJAZSucGP1X3uIKOVT97bXKsE8XNb-aiuBW2RtAlGoqoe3zjyvE0jmVK7WPEZAao1qMTycgI5dWh8g","UiLocales":null,"Nonce":"637007608626050397.NTdlZmEzOTYtNmQ0My00ODQ1LTg4YWItNzhkZGM2NTJiYmE0ZDAwNzFkZDYtZWNkOC00ZjJiLWFlNGYtNWVmNTVkYzY0NzRl","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"f322642bcc574351c481f884513dedd4","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637007608626050397.NTdlZmEzOTYtNmQ0My00ODQ1LTg4YWItNzhkZGM2NTJiYmE0ZDAwNzFkZDYtZWNkOC00ZjJiLWFlNGYtNWVmNTVkYzY0NzRl","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9NiCJeFy9p07kD-x0ymNNCr7xpgYTEuQ27spNNU0DtKpRwlDYTjoWeCGN1gOc5QXtKUr6Wc1ooD9G2kJiClwwZYZ2tp930kY9SxAIry2pe-4I-dksO-eSlGpCVes4gz_cvMNm3CZm1dQONDvfHlwD1ibeS_X26dDz63VgEPM3ofh4Y6oAq3AlCtFCG7ms9YbbSxwds67afQHCzB7VR7Dq2aQTm1_3R9eJAZSucGP1X3uIKOVT97bXKsE8XNb-aiuBW2RtAlGoqoe3zjyvE0jmVK7WPEZAao1qMTycgI5dWh8g","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-07 10:47:47.593 +03:00 [DBG] Client is configured to not require consent, no consent is required
2019-08-07 10:47:47.599 +03:00 [DBG] Creating Hybrid Flow response.
2019-08-07 10:47:47.634 +03:00 [DBG] Creating Implicit Flow response.
2019-08-07 10:47:47.645 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-07 10:47:47.648 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-07 10:47:47.725 +03:00 [DBG] Authorize endpoint response
{"SubjectId":"1","ClientId":"mvc","RedirectUri":"http://localhost:5002/signin-oidc","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9NiCJeFy9p07kD-x0ymNNCr7xpgYTEuQ27spNNU0DtKpRwlDYTjoWeCGN1gOc5QXtKUr6Wc1ooD9G2kJiClwwZYZ2tp930kY9SxAIry2pe-4I-dksO-eSlGpCVes4gz_cvMNm3CZm1dQONDvfHlwD1ibeS_X26dDz63VgEPM3ofh4Y6oAq3AlCtFCG7ms9YbbSxwds67afQHCzB7VR7Dq2aQTm1_3R9eJAZSucGP1X3uIKOVT97bXKsE8XNb-aiuBW2RtAlGoqoe3zjyvE0jmVK7WPEZAao1qMTycgI5dWh8g","Scope":"openid profile afcpayroll offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-08-07 10:47:47.744 +03:00 [DBG] Augmenting SignInContext
2019-08-07 10:47:47.745 +03:00 [INF] AuthenticationScheme: idsrv signed in.
2019-08-07 10:47:50.582 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-07 10:47:50.583 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-07 10:47:50.584 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-07 10:47:50.584 +03:00 [DBG] Start token request.
2019-08-07 10:47:50.585 +03:00 [DBG] Start client validation
2019-08-07 10:47:50.585 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-07 10:47:50.586 +03:00 [DBG] Start parsing for secret in post body
2019-08-07 10:47:50.587 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-07 10:47:50.587 +03:00 [DBG] Secret id found: mvc
2019-08-07 10:47:50.588 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-07 10:47:50.589 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-07 10:47:50.589 +03:00 [DBG] Client validation success
2019-08-07 10:47:50.589 +03:00 [DBG] Start token request validation
2019-08-07 10:47:50.599 +03:00 [DBG] Start validation of authorization code token request
2019-08-07 10:47:50.612 +03:00 [DBG] Validation of authorization code token request success
2019-08-07 10:47:50.612 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"2398cf1a2b6be5f542157516dfbadedcb46f20573dab8c546d822e93fb38c1cd","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"mvc","client_secret":"***REDACTED***","code":"2398cf1a2b6be5f542157516dfbadedcb46f20573dab8c546d822e93fb38c1cd","grant_type":"authorization_code","redirect_uri":"http://localhost:5002/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-08-07 10:47:50.629 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-07 10:47:50.644 +03:00 [DBG] Getting claims for access token for client: mvc
2019-08-07 10:47:50.645 +03:00 [DBG] Getting claims for access token for subject: 1
2019-08-07 10:47:50.658 +03:00 [DBG] Creating refresh token
2019-08-07 10:47:50.659 +03:00 [DBG] Setting an absolute lifetime: 2592000
2019-08-07 10:47:50.672 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-07 10:47:50.673 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-07 10:47:50.673 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-07 10:47:50.680 +03:00 [DBG] Token request success.
2019-08-07 10:47:50.695 +03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-08-07 10:47:50.697 +03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-08-07 10:47:50.697 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-08-07 10:47:50.706 +03:00 [DBG] Start userinfo request
2019-08-07 10:47:50.710 +03:00 [DBG] Bearer token found in header
2019-08-07 10:47:50.789 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-07 10:47:50.793 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-07 10:47:50.795 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-08-07 10:47:50.796 +03:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1565164070,"exp":1565164130,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","afcpayroll"],"client_id":"mvc","sub":"1","auth_time":1565164067,"idp":"local","name":"alice","email":"alice@email.com","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-08-07 10:47:50.805 +03:00 [DBG] Creating userinfo response
2019-08-07 10:47:50.809 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-07 10:47:50.812 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-07 10:47:50.816 +03:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-07 10:47:50.817 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-07 10:47:50.817 +03:00 [INF] Profile service returned the following claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-07 10:47:50.818 +03:00 [DBG] End userinfo request
2019-08-07 10:49:47.091 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-07 10:49:47.094 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-07 10:49:47.094 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-07 10:49:47.095 +03:00 [DBG] Start discovery request
2019-08-07 10:49:47.107 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-07 10:49:47.108 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-07 10:49:47.108 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-07 10:49:47.109 +03:00 [DBG] Start key discovery request
2019-08-07 10:49:48.255 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-07 10:49:48.258 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-07 10:49:48.258 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-07 10:49:48.259 +03:00 [DBG] Start token request.
2019-08-07 10:49:48.259 +03:00 [DBG] Start client validation
2019-08-07 10:49:48.259 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-07 10:49:48.259 +03:00 [DBG] Start parsing for secret in post body
2019-08-07 10:49:48.260 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-07 10:49:48.260 +03:00 [DBG] Secret id found: mvc
2019-08-07 10:49:48.261 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-07 10:49:48.263 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-07 10:49:48.263 +03:00 [DBG] Client validation success
2019-08-07 10:49:48.263 +03:00 [DBG] Start token request validation
2019-08-07 10:49:48.264 +03:00 [DBG] Start validation of refresh token request
2019-08-07 10:49:48.285 +03:00 [DBG] Token validation success
{"ClientId":"mvc","ClientName":"MVC Client","ValidateLifetime":false,"AccessTokenType":null,"ExpectedScope":null,"TokenHandle":null,"JwtId":null,"Claims":{"sub":"1","client_id":"mvc","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"auth_time":1565164067,"idp":"local","amr":"pwd","name":"alice","email":"alice@email.com"},"$type":"TokenValidationLog"}
2019-08-07 10:49:48.292 +03:00 [DBG] Validation of refresh token request success
2019-08-07 10:49:48.292 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"refresh_token","Scopes":null,"AuthorizationCode":null,"RefreshToken":"faa23cd62bd47afdfa354f98114b42ff06b318912faa9c9cdc60e904cdefe4d6","UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"refresh_token","refresh_token":"***REDACTED***","client_id":"mvc","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2019-08-07 10:49:48.311 +03:00 [DBG] Updating refresh token
2019-08-07 10:49:48.311 +03:00 [DBG] Token usage is one-time only. Generating new handle
2019-08-07 10:49:48.312 +03:00 [DBG] Created refresh token in store
2019-08-07 10:49:48.320 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-07 10:49:48.321 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-07 10:49:48.325 +03:00 [DBG] Token request success.
2019-08-07 10:50:27.576 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-07 10:50:27.578 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-07 10:50:27.579 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-07 10:50:27.579 +03:00 [DBG] Start discovery request
2019-08-07 10:50:27.581 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-07 10:50:27.582 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-07 10:50:27.582 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-07 10:50:27.583 +03:00 [DBG] Start key discovery request
2019-08-07 10:50:27.586 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-07 10:50:27.589 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-07 10:50:27.589 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-07 10:50:27.590 +03:00 [DBG] Start token request.
2019-08-07 10:50:27.590 +03:00 [DBG] Start client validation
2019-08-07 10:50:27.590 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-07 10:50:27.590 +03:00 [DBG] Start parsing for secret in post body
2019-08-07 10:50:27.591 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-07 10:50:27.591 +03:00 [DBG] Secret id found: mvc
2019-08-07 10:50:27.591 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-07 10:50:27.592 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-07 10:50:27.592 +03:00 [DBG] Client validation success
2019-08-07 10:50:27.592 +03:00 [DBG] Start token request validation
2019-08-07 10:50:27.592 +03:00 [DBG] Start validation of refresh token request
2019-08-07 10:50:27.593 +03:00 [DBG] Token validation success
{"ClientId":"mvc","ClientName":"MVC Client","ValidateLifetime":false,"AccessTokenType":null,"ExpectedScope":null,"TokenHandle":null,"JwtId":null,"Claims":{"sub":"1","client_id":"mvc","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"auth_time":1565164067,"idp":"local","amr":"pwd","name":"alice","email":"alice@email.com"},"$type":"TokenValidationLog"}
2019-08-07 10:50:27.595 +03:00 [DBG] Validation of refresh token request success
2019-08-07 10:50:27.595 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"refresh_token","Scopes":null,"AuthorizationCode":null,"RefreshToken":"ad6447e6c7ed02c8ebb36e7653a1bd827d9e47b197ffe052186523d5e754986b","UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"refresh_token","refresh_token":"***REDACTED***","client_id":"mvc","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2019-08-07 10:50:27.600 +03:00 [DBG] Updating refresh token
2019-08-07 10:50:27.601 +03:00 [DBG] Token usage is one-time only. Generating new handle
2019-08-07 10:50:27.601 +03:00 [DBG] Created refresh token in store
2019-08-07 10:50:27.601 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-07 10:50:27.602 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-07 10:50:27.606 +03:00 [DBG] Token request success.
2019-08-07 10:51:02.295 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-07 10:51:02.296 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-07 10:51:02.296 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-07 10:51:02.297 +03:00 [DBG] Start discovery request
2019-08-07 10:51:02.299 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-07 10:51:02.302 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-07 10:51:02.303 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-07 10:51:02.304 +03:00 [DBG] Start key discovery request
2019-08-07 10:51:02.306 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-07 10:51:02.307 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-07 10:51:02.307 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-07 10:51:02.308 +03:00 [DBG] Start token request.
2019-08-07 10:51:02.308 +03:00 [DBG] Start client validation
2019-08-07 10:51:02.308 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-07 10:51:02.308 +03:00 [DBG] Start parsing for secret in post body
2019-08-07 10:51:02.310 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-07 10:51:02.310 +03:00 [DBG] Secret id found: mvc
2019-08-07 10:51:02.310 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-07 10:51:02.312 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-07 10:51:02.312 +03:00 [DBG] Client validation success
2019-08-07 10:51:02.312 +03:00 [DBG] Start token request validation
2019-08-07 10:51:02.312 +03:00 [DBG] Start validation of refresh token request
2019-08-07 10:51:02.313 +03:00 [DBG] Token validation success
{"ClientId":"mvc","ClientName":"MVC Client","ValidateLifetime":false,"AccessTokenType":null,"ExpectedScope":null,"TokenHandle":null,"JwtId":null,"Claims":{"sub":"1","client_id":"mvc","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"auth_time":1565164067,"idp":"local","amr":"pwd","name":"alice","email":"alice@email.com"},"$type":"TokenValidationLog"}
2019-08-07 10:51:02.315 +03:00 [DBG] Validation of refresh token request success
2019-08-07 10:51:02.315 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"refresh_token","Scopes":null,"AuthorizationCode":null,"RefreshToken":"588f2d0c7da8e85224dc14f98505a9aa65b8cad2aa35d710c26b7a780bd95227","UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"refresh_token","refresh_token":"***REDACTED***","client_id":"mvc","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2019-08-07 10:51:02.323 +03:00 [DBG] Updating refresh token
2019-08-07 10:51:02.323 +03:00 [DBG] Token usage is one-time only. Generating new handle
2019-08-07 10:51:02.324 +03:00 [DBG] Created refresh token in store
2019-08-07 10:51:02.325 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-07 10:51:02.325 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-07 10:51:02.329 +03:00 [DBG] Token request success.
2019-08-07 10:51:19.101 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-07 10:51:19.103 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-07 10:51:19.104 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-07 10:51:19.104 +03:00 [DBG] Start discovery request
2019-08-07 10:51:19.107 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-07 10:51:19.107 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-07 10:51:19.108 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-07 10:51:19.108 +03:00 [DBG] Start key discovery request
2019-08-07 10:51:19.110 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-07 10:51:19.111 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-07 10:51:19.112 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-07 10:51:19.112 +03:00 [DBG] Start token request.
2019-08-07 10:51:19.112 +03:00 [DBG] Start client validation
2019-08-07 10:51:19.113 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-07 10:51:19.113 +03:00 [DBG] Start parsing for secret in post body
2019-08-07 10:51:19.113 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-07 10:51:19.114 +03:00 [DBG] Secret id found: mvc
2019-08-07 10:51:19.114 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-07 10:51:19.114 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-07 10:51:19.115 +03:00 [DBG] Client validation success
2019-08-07 10:51:19.115 +03:00 [DBG] Start token request validation
2019-08-07 10:51:19.115 +03:00 [DBG] Start validation of refresh token request
2019-08-07 10:51:19.116 +03:00 [DBG] Token validation success
{"ClientId":"mvc","ClientName":"MVC Client","ValidateLifetime":false,"AccessTokenType":null,"ExpectedScope":null,"TokenHandle":null,"JwtId":null,"Claims":{"sub":"1","client_id":"mvc","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"auth_time":1565164067,"idp":"local","amr":"pwd","name":"alice","email":"alice@email.com"},"$type":"TokenValidationLog"}
2019-08-07 10:51:19.118 +03:00 [DBG] Validation of refresh token request success
2019-08-07 10:51:19.120 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"refresh_token","Scopes":null,"AuthorizationCode":null,"RefreshToken":"38425532f9d5391374e9d745af0ca736d816672c10155aaf7843e4cbb66ab7a6","UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"refresh_token","refresh_token":"***REDACTED***","client_id":"mvc","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2019-08-07 10:51:19.126 +03:00 [DBG] Updating refresh token
2019-08-07 10:51:19.128 +03:00 [DBG] Token usage is one-time only. Generating new handle
2019-08-07 10:51:19.130 +03:00 [DBG] Created refresh token in store
2019-08-07 10:51:19.130 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-07 10:51:19.131 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-07 10:51:19.135 +03:00 [DBG] Token request success.
2019-08-07 10:52:01.803 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-07 10:52:01.806 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-07 10:52:01.806 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-07 10:52:01.807 +03:00 [DBG] Start discovery request
2019-08-07 10:52:01.809 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-07 10:52:01.809 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-07 10:52:01.810 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-07 10:52:01.811 +03:00 [DBG] Start key discovery request
2019-08-07 10:52:01.813 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-07 10:52:01.814 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-07 10:52:01.814 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-07 10:52:01.816 +03:00 [DBG] Start token request.
2019-08-07 10:52:01.816 +03:00 [DBG] Start client validation
2019-08-07 10:52:01.817 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-07 10:52:01.817 +03:00 [DBG] Start parsing for secret in post body
2019-08-07 10:52:01.817 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-07 10:52:01.818 +03:00 [DBG] Secret id found: mvc
2019-08-07 10:52:01.818 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-07 10:52:01.819 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-07 10:52:01.819 +03:00 [DBG] Client validation success
2019-08-07 10:52:01.819 +03:00 [DBG] Start token request validation
2019-08-07 10:52:01.820 +03:00 [DBG] Start validation of refresh token request
2019-08-07 10:52:01.821 +03:00 [DBG] Token validation success
{"ClientId":"mvc","ClientName":"MVC Client","ValidateLifetime":false,"AccessTokenType":null,"ExpectedScope":null,"TokenHandle":null,"JwtId":null,"Claims":{"sub":"1","client_id":"mvc","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"auth_time":1565164067,"idp":"local","amr":"pwd","name":"alice","email":"alice@email.com"},"$type":"TokenValidationLog"}
2019-08-07 10:52:01.822 +03:00 [DBG] Validation of refresh token request success
2019-08-07 10:52:01.822 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"refresh_token","Scopes":null,"AuthorizationCode":null,"RefreshToken":"59ce4c38aaf048bd96f82c3ee05113ab036a6cccbfa5a5134ebc19d651f8a21a","UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"refresh_token","refresh_token":"***REDACTED***","client_id":"mvc","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2019-08-07 10:52:01.827 +03:00 [DBG] Updating refresh token
2019-08-07 10:52:01.828 +03:00 [DBG] Token usage is one-time only. Generating new handle
2019-08-07 10:52:01.828 +03:00 [DBG] Created refresh token in store
2019-08-07 10:52:01.829 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-07 10:52:01.829 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-07 10:52:01.833 +03:00 [DBG] Token request success.
2019-08-07 10:52:12.191 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-07 10:52:12.191 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-07 10:52:12.192 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-07 10:52:12.192 +03:00 [DBG] Start discovery request
2019-08-07 10:52:12.195 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-07 10:52:12.195 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-07 10:52:12.196 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-07 10:52:12.196 +03:00 [DBG] Start key discovery request
2019-08-07 10:52:12.198 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-07 10:52:12.199 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-07 10:52:12.199 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-07 10:52:12.200 +03:00 [DBG] Start token request.
2019-08-07 10:52:12.202 +03:00 [DBG] Start client validation
2019-08-07 10:52:12.203 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-07 10:52:12.204 +03:00 [DBG] Start parsing for secret in post body
2019-08-07 10:52:12.205 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-07 10:52:12.205 +03:00 [DBG] Secret id found: mvc
2019-08-07 10:52:12.205 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-07 10:52:12.206 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-07 10:52:12.206 +03:00 [DBG] Client validation success
2019-08-07 10:52:12.206 +03:00 [DBG] Start token request validation
2019-08-07 10:52:12.207 +03:00 [DBG] Start validation of refresh token request
2019-08-07 10:52:12.207 +03:00 [DBG] Token validation success
{"ClientId":"mvc","ClientName":"MVC Client","ValidateLifetime":false,"AccessTokenType":null,"ExpectedScope":null,"TokenHandle":null,"JwtId":null,"Claims":{"sub":"1","client_id":"mvc","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"auth_time":1565164067,"idp":"local","amr":"pwd","name":"alice","email":"alice@email.com"},"$type":"TokenValidationLog"}
2019-08-07 10:52:12.209 +03:00 [DBG] Validation of refresh token request success
2019-08-07 10:52:12.210 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"refresh_token","Scopes":null,"AuthorizationCode":null,"RefreshToken":"e1060bb04ddcbe8050a4bc0e5cd81bf868c2101285898648cbde2c2cb7653ebf","UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"refresh_token","refresh_token":"***REDACTED***","client_id":"mvc","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2019-08-07 10:52:12.215 +03:00 [DBG] Updating refresh token
2019-08-07 10:52:12.215 +03:00 [DBG] Token usage is one-time only. Generating new handle
2019-08-07 10:52:12.216 +03:00 [DBG] Created refresh token in store
2019-08-07 10:52:12.216 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-07 10:52:12.217 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-07 10:52:12.225 +03:00 [DBG] Token request success.
2019-08-07 10:52:57.828 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-07 10:52:57.831 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-07 10:52:57.838 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-07 10:52:57.838 +03:00 [DBG] Start discovery request
2019-08-07 10:52:57.842 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-07 10:52:57.842 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-07 10:52:57.843 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-07 10:52:57.843 +03:00 [DBG] Start key discovery request
2019-08-07 10:52:57.845 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-07 10:52:57.846 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-07 10:52:57.846 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-07 10:52:57.847 +03:00 [DBG] Start token request.
2019-08-07 10:52:57.847 +03:00 [DBG] Start client validation
2019-08-07 10:52:57.847 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-07 10:52:57.848 +03:00 [DBG] Start parsing for secret in post body
2019-08-07 10:52:57.848 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-07 10:52:57.848 +03:00 [DBG] Secret id found: mvc
2019-08-07 10:52:57.849 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-07 10:52:57.852 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-07 10:52:57.853 +03:00 [DBG] Client validation success
2019-08-07 10:52:57.853 +03:00 [DBG] Start token request validation
2019-08-07 10:52:57.854 +03:00 [DBG] Start validation of refresh token request
2019-08-07 10:52:57.855 +03:00 [DBG] Token validation success
{"ClientId":"mvc","ClientName":"MVC Client","ValidateLifetime":false,"AccessTokenType":null,"ExpectedScope":null,"TokenHandle":null,"JwtId":null,"Claims":{"sub":"1","client_id":"mvc","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"auth_time":1565164067,"idp":"local","amr":"pwd","name":"alice","email":"alice@email.com"},"$type":"TokenValidationLog"}
2019-08-07 10:52:57.857 +03:00 [DBG] Validation of refresh token request success
2019-08-07 10:52:57.858 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"refresh_token","Scopes":null,"AuthorizationCode":null,"RefreshToken":"2d59a4795b4cc54ce9c998daf9954d901165c64bc07e0d9d14a49164101fa206","UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"refresh_token","refresh_token":"***REDACTED***","client_id":"mvc","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2019-08-07 10:52:57.864 +03:00 [DBG] Updating refresh token
2019-08-07 10:52:57.864 +03:00 [DBG] Token usage is one-time only. Generating new handle
2019-08-07 10:52:57.864 +03:00 [DBG] Created refresh token in store
2019-08-07 10:52:57.865 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-07 10:52:57.865 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-07 10:52:57.874 +03:00 [DBG] Token request success.
2019-08-07 10:53:02.889 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-07 10:53:02.890 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-07 10:53:02.890 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-07 10:53:02.891 +03:00 [DBG] Start discovery request
2019-08-07 10:53:02.895 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-07 10:53:02.896 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-07 10:53:02.896 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-07 10:53:02.897 +03:00 [DBG] Start key discovery request
2019-08-07 10:53:02.914 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-07 10:53:02.915 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-07 10:53:02.921 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-07 10:53:02.924 +03:00 [DBG] Start token request.
2019-08-07 10:53:02.927 +03:00 [DBG] Start client validation
2019-08-07 10:53:02.929 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-07 10:53:02.931 +03:00 [DBG] Start parsing for secret in post body
2019-08-07 10:53:02.932 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-07 10:53:02.938 +03:00 [DBG] Secret id found: mvc
2019-08-07 10:53:02.940 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-07 10:53:02.942 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-07 10:53:02.942 +03:00 [DBG] Client validation success
2019-08-07 10:53:02.943 +03:00 [DBG] Start token request validation
2019-08-07 10:53:02.944 +03:00 [DBG] Start validation of refresh token request
2019-08-07 10:53:02.945 +03:00 [DBG] Token validation success
{"ClientId":"mvc","ClientName":"MVC Client","ValidateLifetime":false,"AccessTokenType":null,"ExpectedScope":null,"TokenHandle":null,"JwtId":null,"Claims":{"sub":"1","client_id":"mvc","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"auth_time":1565164067,"idp":"local","amr":"pwd","name":"alice","email":"alice@email.com"},"$type":"TokenValidationLog"}
2019-08-07 10:53:02.956 +03:00 [DBG] Validation of refresh token request success
2019-08-07 10:53:02.957 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"refresh_token","Scopes":null,"AuthorizationCode":null,"RefreshToken":"aeb7e6e5f9a7663f975178cb8ec78f9ad35e06c61d294ae807c485c33cf23b49","UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"refresh_token","refresh_token":"***REDACTED***","client_id":"mvc","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2019-08-07 10:53:02.962 +03:00 [DBG] Updating refresh token
2019-08-07 10:53:02.963 +03:00 [DBG] Token usage is one-time only. Generating new handle
2019-08-07 10:53:02.964 +03:00 [DBG] Created refresh token in store
2019-08-07 10:53:02.966 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-07 10:53:02.969 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-07 10:53:02.974 +03:00 [DBG] Token request success.
2019-08-07 10:53:22.699 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-07 10:53:22.703 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-07 10:53:22.703 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-07 10:53:22.704 +03:00 [DBG] Start discovery request
2019-08-07 10:53:22.706 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-07 10:53:22.707 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-07 10:53:22.707 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-07 10:53:22.708 +03:00 [DBG] Start key discovery request
2019-08-07 10:53:22.710 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-07 10:53:22.711 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-07 10:53:22.712 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-07 10:53:22.712 +03:00 [DBG] Start token request.
2019-08-07 10:53:22.712 +03:00 [DBG] Start client validation
2019-08-07 10:53:22.713 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-07 10:53:22.713 +03:00 [DBG] Start parsing for secret in post body
2019-08-07 10:53:22.713 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-07 10:53:22.713 +03:00 [DBG] Secret id found: mvc
2019-08-07 10:53:22.714 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-07 10:53:22.714 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-07 10:53:22.714 +03:00 [DBG] Client validation success
2019-08-07 10:53:22.714 +03:00 [DBG] Start token request validation
2019-08-07 10:53:22.715 +03:00 [DBG] Start validation of refresh token request
2019-08-07 10:53:22.715 +03:00 [DBG] Token validation success
{"ClientId":"mvc","ClientName":"MVC Client","ValidateLifetime":false,"AccessTokenType":null,"ExpectedScope":null,"TokenHandle":null,"JwtId":null,"Claims":{"sub":"1","client_id":"mvc","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"auth_time":1565164067,"idp":"local","amr":"pwd","name":"alice","email":"alice@email.com"},"$type":"TokenValidationLog"}
2019-08-07 10:53:22.723 +03:00 [DBG] Validation of refresh token request success
2019-08-07 10:53:22.724 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"refresh_token","Scopes":null,"AuthorizationCode":null,"RefreshToken":"33ac315235645e6a8fb3d5dd0a024283b49db21af67bee32fb789bb8705b5970","UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"refresh_token","refresh_token":"***REDACTED***","client_id":"mvc","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2019-08-07 10:53:22.729 +03:00 [DBG] Updating refresh token
2019-08-07 10:53:22.729 +03:00 [DBG] Token usage is one-time only. Generating new handle
2019-08-07 10:53:22.730 +03:00 [DBG] Created refresh token in store
2019-08-07 10:53:22.730 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-07 10:53:22.730 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-07 10:53:22.736 +03:00 [DBG] Token request success.
2019-08-07 10:53:25.379 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-07 10:53:25.380 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-07 10:53:25.380 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-07 10:53:25.381 +03:00 [DBG] Start discovery request
2019-08-07 10:53:25.385 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-07 10:53:25.387 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-07 10:53:25.388 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-07 10:53:25.388 +03:00 [DBG] Start key discovery request
2019-08-07 10:53:25.391 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-07 10:53:25.391 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-07 10:53:25.392 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-07 10:53:25.392 +03:00 [DBG] Start token request.
2019-08-07 10:53:25.392 +03:00 [DBG] Start client validation
2019-08-07 10:53:25.393 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-07 10:53:25.393 +03:00 [DBG] Start parsing for secret in post body
2019-08-07 10:53:25.393 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-07 10:53:25.393 +03:00 [DBG] Secret id found: mvc
2019-08-07 10:53:25.394 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-07 10:53:25.394 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-07 10:53:25.394 +03:00 [DBG] Client validation success
2019-08-07 10:53:25.394 +03:00 [DBG] Start token request validation
2019-08-07 10:53:25.395 +03:00 [DBG] Start validation of refresh token request
2019-08-07 10:53:25.395 +03:00 [DBG] Token validation success
{"ClientId":"mvc","ClientName":"MVC Client","ValidateLifetime":false,"AccessTokenType":null,"ExpectedScope":null,"TokenHandle":null,"JwtId":null,"Claims":{"sub":"1","client_id":"mvc","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"auth_time":1565164067,"idp":"local","amr":"pwd","name":"alice","email":"alice@email.com"},"$type":"TokenValidationLog"}
2019-08-07 10:53:25.397 +03:00 [DBG] Validation of refresh token request success
2019-08-07 10:53:25.397 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"refresh_token","Scopes":null,"AuthorizationCode":null,"RefreshToken":"97ac459b7ee9117184c4b166d042ed6b6a462280069ed70c65a615d40f779940","UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"refresh_token","refresh_token":"***REDACTED***","client_id":"mvc","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2019-08-07 10:53:25.403 +03:00 [DBG] Updating refresh token
2019-08-07 10:53:25.404 +03:00 [DBG] Token usage is one-time only. Generating new handle
2019-08-07 10:53:25.405 +03:00 [DBG] Created refresh token in store
2019-08-07 10:53:25.405 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-07 10:53:25.406 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-07 10:53:25.410 +03:00 [DBG] Token request success.
2019-08-07 10:53:27.030 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-07 10:53:27.036 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-07 10:53:27.037 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-07 10:53:27.037 +03:00 [DBG] Start discovery request
2019-08-07 10:53:27.040 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-07 10:53:27.040 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-07 10:53:27.041 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-07 10:53:27.041 +03:00 [DBG] Start key discovery request
2019-08-07 10:53:27.044 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-07 10:53:27.044 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-07 10:53:27.045 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-07 10:53:27.046 +03:00 [DBG] Start token request.
2019-08-07 10:53:27.046 +03:00 [DBG] Start client validation
2019-08-07 10:53:27.047 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-07 10:53:27.047 +03:00 [DBG] Start parsing for secret in post body
2019-08-07 10:53:27.047 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-07 10:53:27.047 +03:00 [DBG] Secret id found: mvc
2019-08-07 10:53:27.048 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-07 10:53:27.048 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-07 10:53:27.048 +03:00 [DBG] Client validation success
2019-08-07 10:53:27.048 +03:00 [DBG] Start token request validation
2019-08-07 10:53:27.049 +03:00 [DBG] Start validation of refresh token request
2019-08-07 10:53:27.049 +03:00 [DBG] Token validation success
{"ClientId":"mvc","ClientName":"MVC Client","ValidateLifetime":false,"AccessTokenType":null,"ExpectedScope":null,"TokenHandle":null,"JwtId":null,"Claims":{"sub":"1","client_id":"mvc","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"auth_time":1565164067,"idp":"local","amr":"pwd","name":"alice","email":"alice@email.com"},"$type":"TokenValidationLog"}
2019-08-07 10:53:27.055 +03:00 [DBG] Validation of refresh token request success
2019-08-07 10:53:27.055 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"refresh_token","Scopes":null,"AuthorizationCode":null,"RefreshToken":"fa0ad6bfa6b2d5d5fe54ee5eac090bf4ac584e86e5a108b540c1d7bd389c5dd1","UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"refresh_token","refresh_token":"***REDACTED***","client_id":"mvc","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2019-08-07 10:53:27.061 +03:00 [DBG] Updating refresh token
2019-08-07 10:53:27.061 +03:00 [DBG] Token usage is one-time only. Generating new handle
2019-08-07 10:53:27.062 +03:00 [DBG] Created refresh token in store
2019-08-07 10:53:27.062 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-07 10:53:27.062 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-07 10:53:27.067 +03:00 [DBG] Token request success.
2019-08-07 10:53:28.943 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-07 10:53:28.944 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-07 10:53:28.945 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-07 10:53:28.945 +03:00 [DBG] Start discovery request
2019-08-07 10:53:28.948 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-07 10:53:28.949 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-07 10:53:28.953 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-07 10:53:28.954 +03:00 [DBG] Start key discovery request
2019-08-07 10:53:28.956 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-07 10:53:28.957 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-07 10:53:28.958 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-07 10:53:28.958 +03:00 [DBG] Start token request.
2019-08-07 10:53:28.958 +03:00 [DBG] Start client validation
2019-08-07 10:53:28.959 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-07 10:53:28.959 +03:00 [DBG] Start parsing for secret in post body
2019-08-07 10:53:28.959 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-07 10:53:28.960 +03:00 [DBG] Secret id found: mvc
2019-08-07 10:53:28.960 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-07 10:53:28.961 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-07 10:53:28.961 +03:00 [DBG] Client validation success
2019-08-07 10:53:28.961 +03:00 [DBG] Start token request validation
2019-08-07 10:53:28.961 +03:00 [DBG] Start validation of refresh token request
2019-08-07 10:53:28.962 +03:00 [DBG] Token validation success
{"ClientId":"mvc","ClientName":"MVC Client","ValidateLifetime":false,"AccessTokenType":null,"ExpectedScope":null,"TokenHandle":null,"JwtId":null,"Claims":{"sub":"1","client_id":"mvc","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"auth_time":1565164067,"idp":"local","amr":"pwd","name":"alice","email":"alice@email.com"},"$type":"TokenValidationLog"}
2019-08-07 10:53:28.964 +03:00 [DBG] Validation of refresh token request success
2019-08-07 10:53:28.964 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"refresh_token","Scopes":null,"AuthorizationCode":null,"RefreshToken":"92c2d5c5daaec9cd5242c9375bb491703d3c60489d4a5e9f52775712fbadc81a","UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"refresh_token","refresh_token":"***REDACTED***","client_id":"mvc","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2019-08-07 10:53:28.971 +03:00 [DBG] Updating refresh token
2019-08-07 10:53:28.971 +03:00 [DBG] Token usage is one-time only. Generating new handle
2019-08-07 10:53:28.972 +03:00 [DBG] Created refresh token in store
2019-08-07 10:53:28.972 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-07 10:53:28.973 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-07 10:53:28.977 +03:00 [DBG] Token request success.
2019-08-07 10:54:21.708 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-07 10:54:21.715 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-07 10:54:21.725 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-07 10:54:21.728 +03:00 [DBG] Start discovery request
2019-08-07 10:54:21.771 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-07 10:54:21.774 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-07 10:54:21.774 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-07 10:54:21.775 +03:00 [DBG] Start key discovery request
2019-08-07 10:54:21.979 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-07 10:54:21.980 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-07 10:54:21.980 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-07 10:54:21.981 +03:00 [DBG] Start token request.
2019-08-07 10:54:21.981 +03:00 [DBG] Start client validation
2019-08-07 10:54:21.981 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-07 10:54:21.985 +03:00 [DBG] Start parsing for secret in post body
2019-08-07 10:54:21.988 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-07 10:54:21.989 +03:00 [DBG] Secret id found: mvc
2019-08-07 10:54:21.989 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-07 10:54:21.989 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-07 10:54:21.990 +03:00 [DBG] Client validation success
2019-08-07 10:54:21.990 +03:00 [DBG] Start token request validation
2019-08-07 10:54:21.992 +03:00 [DBG] Start validation of refresh token request
2019-08-07 10:54:21.994 +03:00 [DBG] Token validation success
{"ClientId":"mvc","ClientName":"MVC Client","ValidateLifetime":false,"AccessTokenType":null,"ExpectedScope":null,"TokenHandle":null,"JwtId":null,"Claims":{"sub":"1","client_id":"mvc","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"auth_time":1565164067,"idp":"local","amr":"pwd","name":"alice","email":"alice@email.com"},"$type":"TokenValidationLog"}
2019-08-07 10:54:22.003 +03:00 [DBG] Validation of refresh token request success
2019-08-07 10:54:22.003 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"refresh_token","Scopes":null,"AuthorizationCode":null,"RefreshToken":"43ef5f3c84c16b9a3dcb2ae8efa556282a9fd8751e34566e9bf2a9c89c114696","UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"refresh_token","refresh_token":"***REDACTED***","client_id":"mvc","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2019-08-07 10:54:22.010 +03:00 [DBG] Updating refresh token
2019-08-07 10:54:22.011 +03:00 [DBG] Token usage is one-time only. Generating new handle
2019-08-07 10:54:22.011 +03:00 [DBG] Created refresh token in store
2019-08-07 10:54:22.012 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-07 10:54:22.012 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-07 10:54:22.017 +03:00 [DBG] Token request success.
2019-08-07 10:55:07.984 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-07 10:55:07.986 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-07 10:55:07.987 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-07 10:55:07.988 +03:00 [DBG] Start discovery request
2019-08-07 10:55:08.039 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-07 10:55:08.041 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-07 10:55:08.045 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-07 10:55:08.046 +03:00 [DBG] Start key discovery request
2019-08-07 10:55:08.194 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-07 10:55:08.195 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-07 10:55:08.195 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-07 10:55:08.195 +03:00 [DBG] Start token request.
2019-08-07 10:55:08.196 +03:00 [DBG] Start client validation
2019-08-07 10:55:08.196 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-07 10:55:08.196 +03:00 [DBG] Start parsing for secret in post body
2019-08-07 10:55:08.196 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-07 10:55:08.199 +03:00 [DBG] Secret id found: mvc
2019-08-07 10:55:08.202 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-07 10:55:08.202 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-07 10:55:08.203 +03:00 [DBG] Client validation success
2019-08-07 10:55:08.203 +03:00 [DBG] Start token request validation
2019-08-07 10:55:08.203 +03:00 [DBG] Start validation of refresh token request
2019-08-07 10:55:08.204 +03:00 [DBG] refresh_token grant with value: 43ef5f3c84c16b9a3dcb2ae8efa556282a9fd8751e34566e9bf2a9c89c114696 not found in store.
2019-08-07 10:55:08.204 +03:00 [WRN] Invalid refresh token
2019-08-07 10:55:08.204 +03:00 [WRN] Refresh token validation failed. aborting, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"refresh_token","Scopes":null,"AuthorizationCode":null,"RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"refresh_token","refresh_token":"***REDACTED***","client_id":"mvc","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2019-08-07 10:55:18.907 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-07 10:55:18.908 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-07 10:55:18.910 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-07 10:55:18.911 +03:00 [DBG] Start discovery request
2019-08-07 10:55:18.913 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-07 10:55:18.914 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-07 10:55:18.914 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-07 10:55:18.915 +03:00 [DBG] Start key discovery request
2019-08-07 10:55:37.907 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-07 10:55:37.907 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-07 10:55:37.908 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-07 10:55:37.908 +03:00 [DBG] Start discovery request
2019-08-07 10:55:37.910 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-07 10:55:37.910 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-07 10:55:37.911 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-07 10:55:37.911 +03:00 [DBG] Start key discovery request
2019-08-07 10:55:58.672 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-07 10:55:58.673 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-07 10:55:58.674 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-07 10:55:58.674 +03:00 [DBG] Start discovery request
2019-08-07 10:55:58.717 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-07 10:55:58.718 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-07 10:55:58.718 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-07 10:55:58.718 +03:00 [DBG] Start key discovery request
2019-08-07 10:55:58.777 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-08-07 10:55:58.779 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-08-07 10:55:58.782 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-08-07 10:55:58.783 +03:00 [DBG] Start authorize request
2019-08-07 10:55:58.783 +03:00 [DBG] No user present in authorize request
2019-08-07 10:55:58.783 +03:00 [DBG] Start authorize request protocol validation
2019-08-07 10:55:58.784 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-07 10:55:58.784 +03:00 [DBG] Checking for PKCE parameters
2019-08-07 10:55:58.785 +03:00 [DBG] No PKCE used.
2019-08-07 10:55:58.786 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-07 10:55:58.786 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/signin-oidc","AllowedRedirectUris":["http://localhost:5002/signin-oidc"],"SubjectId":"anonymous","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9PMX7YjxYDLykkbrZvnmsqMjcrt3fKmH1JZFVLtmAde99kBCBCg_nDfRAtcvZxal8fW8-zaMhmY38SjdIfKroAUQ6apsINlIWmb8O2tAG6ohIzPFq1rIXbg7BdReXPGX6ChXTagckmH8yotjKdb6NdPeGNsiX9Slp5MMLxp16dBSiJzxnua2pBYwBvPjKSFhoGgktPWU_eWFoLtwCNCOPT2-HErVeXFXne6o66wP7Xq_8dvNCt6glVET9fvvVeEFMIgZ7bO2t21Et2WJB2MgticYgwRNBDwuv3EJHx4i4Y7WQ","UiLocales":null,"Nonce":"637007613587397269.YzA0NmY1YjQtOTFhOC00NjUzLWI5NjUtZDE0YTVmYTQxNDJlNDM0MzJhOTEtMTQ4OS00MDExLWE0ZTgtYjkxMmNjZjE4YWUx","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637007613587397269.YzA0NmY1YjQtOTFhOC00NjUzLWI5NjUtZDE0YTVmYTQxNDJlNDM0MzJhOTEtMTQ4OS00MDExLWE0ZTgtYjkxMmNjZjE4YWUx","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9PMX7YjxYDLykkbrZvnmsqMjcrt3fKmH1JZFVLtmAde99kBCBCg_nDfRAtcvZxal8fW8-zaMhmY38SjdIfKroAUQ6apsINlIWmb8O2tAG6ohIzPFq1rIXbg7BdReXPGX6ChXTagckmH8yotjKdb6NdPeGNsiX9Slp5MMLxp16dBSiJzxnua2pBYwBvPjKSFhoGgktPWU_eWFoLtwCNCOPT2-HErVeXFXne6o66wP7Xq_8dvNCt6glVET9fvvVeEFMIgZ7bO2t21Et2WJB2MgticYgwRNBDwuv3EJHx4i4Y7WQ","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-07 10:55:58.789 +03:00 [INF] Showing login: User is not authenticated
2019-08-07 10:55:58.798 +03:00 [DBG] Start authorize request protocol validation
2019-08-07 10:55:58.801 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-07 10:55:58.801 +03:00 [DBG] Checking for PKCE parameters
2019-08-07 10:55:58.802 +03:00 [DBG] No PKCE used.
2019-08-07 10:55:58.803 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-07 10:55:58.805 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-07 10:56:07.691 +03:00 [DBG] CORS request made for path: /account/login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-08-07 10:56:07.693 +03:00 [DBG] Start authorize request protocol validation
2019-08-07 10:56:07.693 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-07 10:56:07.694 +03:00 [DBG] Checking for PKCE parameters
2019-08-07 10:56:07.694 +03:00 [DBG] No PKCE used.
2019-08-07 10:56:07.695 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-07 10:56:07.698 +03:00 [DBG] Augmenting SignInContext
2019-08-07 10:56:07.699 +03:00 [DBG] Adding idp claim with value: local
2019-08-07 10:56:07.699 +03:00 [DBG] Adding amr claim with value: pwd
2019-08-07 10:56:07.700 +03:00 [INF] AuthenticationScheme: idsrv signed in.
2019-08-07 10:56:07.700 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-07 10:56:07.710 +03:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-08-07 10:56:07.711 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-08-07 10:56:07.712 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-08-07 10:56:07.714 +03:00 [DBG] Start authorize callback request
2019-08-07 10:56:07.715 +03:00 [DBG] User in authorize request: 1
2019-08-07 10:56:07.716 +03:00 [DBG] Start authorize request protocol validation
2019-08-07 10:56:07.716 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-07 10:56:07.717 +03:00 [DBG] Checking for PKCE parameters
2019-08-07 10:56:07.717 +03:00 [DBG] No PKCE used.
2019-08-07 10:56:07.717 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-07 10:56:07.718 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/signin-oidc","AllowedRedirectUris":["http://localhost:5002/signin-oidc"],"SubjectId":"1","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9PMX7YjxYDLykkbrZvnmsqMjcrt3fKmH1JZFVLtmAde99kBCBCg_nDfRAtcvZxal8fW8-zaMhmY38SjdIfKroAUQ6apsINlIWmb8O2tAG6ohIzPFq1rIXbg7BdReXPGX6ChXTagckmH8yotjKdb6NdPeGNsiX9Slp5MMLxp16dBSiJzxnua2pBYwBvPjKSFhoGgktPWU_eWFoLtwCNCOPT2-HErVeXFXne6o66wP7Xq_8dvNCt6glVET9fvvVeEFMIgZ7bO2t21Et2WJB2MgticYgwRNBDwuv3EJHx4i4Y7WQ","UiLocales":null,"Nonce":"637007613587397269.YzA0NmY1YjQtOTFhOC00NjUzLWI5NjUtZDE0YTVmYTQxNDJlNDM0MzJhOTEtMTQ4OS00MDExLWE0ZTgtYjkxMmNjZjE4YWUx","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"c217b84cb5db7739f7fabae4d6dab0df","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637007613587397269.YzA0NmY1YjQtOTFhOC00NjUzLWI5NjUtZDE0YTVmYTQxNDJlNDM0MzJhOTEtMTQ4OS00MDExLWE0ZTgtYjkxMmNjZjE4YWUx","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9PMX7YjxYDLykkbrZvnmsqMjcrt3fKmH1JZFVLtmAde99kBCBCg_nDfRAtcvZxal8fW8-zaMhmY38SjdIfKroAUQ6apsINlIWmb8O2tAG6ohIzPFq1rIXbg7BdReXPGX6ChXTagckmH8yotjKdb6NdPeGNsiX9Slp5MMLxp16dBSiJzxnua2pBYwBvPjKSFhoGgktPWU_eWFoLtwCNCOPT2-HErVeXFXne6o66wP7Xq_8dvNCt6glVET9fvvVeEFMIgZ7bO2t21Et2WJB2MgticYgwRNBDwuv3EJHx4i4Y7WQ","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-07 10:56:07.723 +03:00 [DBG] Client is configured to not require consent, no consent is required
2019-08-07 10:56:07.724 +03:00 [DBG] Creating Hybrid Flow response.
2019-08-07 10:56:07.724 +03:00 [DBG] Creating Implicit Flow response.
2019-08-07 10:56:07.725 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-07 10:56:07.725 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-07 10:56:07.730 +03:00 [DBG] Authorize endpoint response
{"SubjectId":"1","ClientId":"mvc","RedirectUri":"http://localhost:5002/signin-oidc","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9PMX7YjxYDLykkbrZvnmsqMjcrt3fKmH1JZFVLtmAde99kBCBCg_nDfRAtcvZxal8fW8-zaMhmY38SjdIfKroAUQ6apsINlIWmb8O2tAG6ohIzPFq1rIXbg7BdReXPGX6ChXTagckmH8yotjKdb6NdPeGNsiX9Slp5MMLxp16dBSiJzxnua2pBYwBvPjKSFhoGgktPWU_eWFoLtwCNCOPT2-HErVeXFXne6o66wP7Xq_8dvNCt6glVET9fvvVeEFMIgZ7bO2t21Et2WJB2MgticYgwRNBDwuv3EJHx4i4Y7WQ","Scope":"openid profile afcpayroll offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-08-07 10:56:07.735 +03:00 [DBG] Augmenting SignInContext
2019-08-07 10:56:07.736 +03:00 [INF] AuthenticationScheme: idsrv signed in.
2019-08-07 10:56:08.104 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-07 10:56:08.104 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-07 10:56:08.105 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-07 10:56:08.105 +03:00 [DBG] Start token request.
2019-08-07 10:56:08.105 +03:00 [DBG] Start client validation
2019-08-07 10:56:08.106 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-07 10:56:08.106 +03:00 [DBG] Start parsing for secret in post body
2019-08-07 10:56:08.106 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-07 10:56:08.106 +03:00 [DBG] Secret id found: mvc
2019-08-07 10:56:08.107 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-07 10:56:08.107 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-07 10:56:08.107 +03:00 [DBG] Client validation success
2019-08-07 10:56:08.107 +03:00 [DBG] Start token request validation
2019-08-07 10:56:08.108 +03:00 [DBG] Start validation of authorization code token request
2019-08-07 10:56:08.108 +03:00 [DBG] Validation of authorization code token request success
2019-08-07 10:56:08.108 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"88389b3d99dcee0707e918d13a77742b48a58b163a0d175d48352d96790f8899","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"mvc","client_secret":"***REDACTED***","code":"88389b3d99dcee0707e918d13a77742b48a58b163a0d175d48352d96790f8899","grant_type":"authorization_code","redirect_uri":"http://localhost:5002/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-08-07 10:56:08.110 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-07 10:56:08.111 +03:00 [DBG] Getting claims for access token for client: mvc
2019-08-07 10:56:08.111 +03:00 [DBG] Getting claims for access token for subject: 1
2019-08-07 10:56:08.115 +03:00 [DBG] Creating refresh token
2019-08-07 10:56:08.116 +03:00 [DBG] Setting an absolute lifetime: 2592000
2019-08-07 10:56:08.116 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-07 10:56:08.117 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-07 10:56:08.117 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-07 10:56:08.121 +03:00 [DBG] Token request success.
2019-08-07 10:56:08.135 +03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-08-07 10:56:08.136 +03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-08-07 10:56:08.136 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-08-07 10:56:08.137 +03:00 [DBG] Start userinfo request
2019-08-07 10:56:08.137 +03:00 [DBG] Bearer token found in header
2019-08-07 10:56:08.140 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-07 10:56:08.141 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-07 10:56:08.141 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-08-07 10:56:08.141 +03:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1565164568,"exp":1565164628,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","afcpayroll"],"client_id":"mvc","sub":"1","auth_time":1565164567,"idp":"local","name":"alice","email":"alice@email.com","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-08-07 10:56:08.144 +03:00 [DBG] Creating userinfo response
2019-08-07 10:56:08.144 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-07 10:56:08.144 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-07 10:56:08.145 +03:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-07 10:56:08.145 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-07 10:56:08.145 +03:00 [INF] Profile service returned the following claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-07 10:56:08.146 +03:00 [DBG] End userinfo request
2019-08-07 10:57:08.633 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-07 10:57:08.634 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-07 10:57:08.634 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-07 10:57:08.635 +03:00 [DBG] Start discovery request
2019-08-07 10:57:08.636 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-07 10:57:08.637 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-07 10:57:08.638 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-07 10:57:08.638 +03:00 [DBG] Start key discovery request
2019-08-07 10:57:08.641 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-07 10:57:08.642 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-07 10:57:08.642 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-07 10:57:08.645 +03:00 [DBG] Start token request.
2019-08-07 10:57:08.646 +03:00 [DBG] Start client validation
2019-08-07 10:57:08.647 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-07 10:57:08.648 +03:00 [DBG] Start parsing for secret in post body
2019-08-07 10:57:08.649 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-07 10:57:08.650 +03:00 [DBG] Secret id found: mvc
2019-08-07 10:57:08.650 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-07 10:57:08.651 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-07 10:57:08.651 +03:00 [DBG] Client validation success
2019-08-07 10:57:08.652 +03:00 [DBG] Start token request validation
2019-08-07 10:57:08.652 +03:00 [DBG] Start validation of refresh token request
2019-08-07 10:57:08.653 +03:00 [DBG] Token validation success
{"ClientId":"mvc","ClientName":"MVC Client","ValidateLifetime":false,"AccessTokenType":null,"ExpectedScope":null,"TokenHandle":null,"JwtId":null,"Claims":{"sub":"1","client_id":"mvc","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"auth_time":1565164567,"idp":"local","amr":"pwd","name":"alice","email":"alice@email.com"},"$type":"TokenValidationLog"}
2019-08-07 10:57:08.654 +03:00 [DBG] Validation of refresh token request success
2019-08-07 10:57:08.655 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"refresh_token","Scopes":null,"AuthorizationCode":null,"RefreshToken":"3d8de06459ea32d46298dd374e7235961abd1a4a81d89bd08648b31c4625da08","UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"refresh_token","refresh_token":"***REDACTED***","client_id":"mvc","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2019-08-07 10:57:08.662 +03:00 [DBG] Updating refresh token
2019-08-07 10:57:08.662 +03:00 [DBG] Token usage is one-time only. Generating new handle
2019-08-07 10:57:08.663 +03:00 [DBG] Created refresh token in store
2019-08-07 10:57:08.664 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-07 10:57:08.664 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-07 10:57:08.668 +03:00 [DBG] Token request success.
2019-08-07 12:54:04.511 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-07 12:54:04.519 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-07 12:54:04.532 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-07 12:54:04.533 +03:00 [DBG] Start discovery request
2019-08-07 12:54:04.540 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-07 12:54:04.558 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-07 12:54:04.563 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-07 12:54:04.564 +03:00 [DBG] Start key discovery request
2019-08-07 12:54:04.582 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-07 12:54:04.583 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-07 12:54:04.584 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-07 12:54:04.584 +03:00 [DBG] Start token request.
2019-08-07 12:54:04.585 +03:00 [DBG] Start client validation
2019-08-07 12:54:04.585 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-07 12:54:04.585 +03:00 [DBG] Start parsing for secret in post body
2019-08-07 12:54:04.586 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-07 12:54:04.594 +03:00 [DBG] Secret id found: mvc
2019-08-07 12:54:04.596 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-07 12:54:04.596 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-07 12:54:04.597 +03:00 [DBG] Client validation success
2019-08-07 12:54:04.597 +03:00 [DBG] Start token request validation
2019-08-07 12:54:04.597 +03:00 [DBG] Start validation of refresh token request
2019-08-07 12:54:04.599 +03:00 [DBG] Token validation success
{"ClientId":"mvc","ClientName":"MVC Client","ValidateLifetime":false,"AccessTokenType":null,"ExpectedScope":null,"TokenHandle":null,"JwtId":null,"Claims":{"sub":"1","client_id":"mvc","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"auth_time":1565164567,"idp":"local","amr":"pwd","name":"alice","email":"alice@email.com"},"$type":"TokenValidationLog"}
2019-08-07 12:54:04.602 +03:00 [DBG] Validation of refresh token request success
2019-08-07 12:54:04.603 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"refresh_token","Scopes":null,"AuthorizationCode":null,"RefreshToken":"a50d30dcfa47a32b642bfbc10a273d99e83faf0ddbc47ddf4fbdfad18d66cbf4","UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"refresh_token","refresh_token":"***REDACTED***","client_id":"mvc","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2019-08-07 12:54:04.613 +03:00 [DBG] Updating refresh token
2019-08-07 12:54:04.614 +03:00 [DBG] Token usage is one-time only. Generating new handle
2019-08-07 12:54:04.614 +03:00 [DBG] Created refresh token in store
2019-08-07 12:54:04.615 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-07 12:54:04.615 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-07 12:54:04.619 +03:00 [DBG] Token request success.
2019-08-07 12:54:07.672 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-07 12:54:07.675 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-07 12:54:07.677 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-07 12:54:07.677 +03:00 [DBG] Start discovery request
2019-08-07 12:54:07.681 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-07 12:54:07.690 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-07 12:54:07.707 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-07 12:54:07.708 +03:00 [DBG] Start key discovery request
2019-08-07 12:54:07.711 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-07 12:54:07.715 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-07 12:54:07.716 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-07 12:54:07.725 +03:00 [DBG] Start token request.
2019-08-07 12:54:07.729 +03:00 [DBG] Start client validation
2019-08-07 12:54:07.732 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-07 12:54:07.739 +03:00 [DBG] Start parsing for secret in post body
2019-08-07 12:54:07.748 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-07 12:54:07.767 +03:00 [DBG] Secret id found: mvc
2019-08-07 12:54:07.780 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-07 12:54:07.785 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-07 12:54:07.791 +03:00 [DBG] Client validation success
2019-08-07 12:54:07.805 +03:00 [DBG] Start token request validation
2019-08-07 12:54:07.813 +03:00 [DBG] Start validation of refresh token request
2019-08-07 12:54:07.826 +03:00 [DBG] Token validation success
{"ClientId":"mvc","ClientName":"MVC Client","ValidateLifetime":false,"AccessTokenType":null,"ExpectedScope":null,"TokenHandle":null,"JwtId":null,"Claims":{"sub":"1","client_id":"mvc","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"auth_time":1565164567,"idp":"local","amr":"pwd","name":"alice","email":"alice@email.com"},"$type":"TokenValidationLog"}
2019-08-07 12:54:07.893 +03:00 [DBG] Validation of refresh token request success
2019-08-07 12:54:07.895 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"refresh_token","Scopes":null,"AuthorizationCode":null,"RefreshToken":"1157c13093cb5df3cea1bccb656d88ba185aca02d7a06ff58943aa2afb845bc4","UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"refresh_token","refresh_token":"***REDACTED***","client_id":"mvc","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2019-08-07 12:54:07.913 +03:00 [DBG] Updating refresh token
2019-08-07 12:54:07.913 +03:00 [DBG] Token usage is one-time only. Generating new handle
2019-08-07 12:54:07.913 +03:00 [DBG] Created refresh token in store
2019-08-07 12:54:07.915 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-07 12:54:07.917 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-07 12:54:07.921 +03:00 [DBG] Token request success.
2019-08-07 14:19:40.140 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-07 14:19:40.163 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-07 14:19:40.163 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-07 14:19:40.164 +03:00 [DBG] Start discovery request
2019-08-07 14:19:40.166 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-07 14:19:40.167 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-07 14:19:40.167 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-07 14:19:40.167 +03:00 [DBG] Start key discovery request
2019-08-07 14:19:40.172 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-07 14:19:40.173 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-07 14:19:40.174 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-07 14:19:40.175 +03:00 [DBG] Start token request.
2019-08-07 14:19:40.175 +03:00 [DBG] Start client validation
2019-08-07 14:19:40.175 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-07 14:19:40.175 +03:00 [DBG] Start parsing for secret in post body
2019-08-07 14:19:40.176 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-07 14:19:40.176 +03:00 [DBG] Secret id found: mvc
2019-08-07 14:19:40.178 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-07 14:19:40.179 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-07 14:19:40.179 +03:00 [DBG] Client validation success
2019-08-07 14:19:40.180 +03:00 [DBG] Start token request validation
2019-08-07 14:19:40.180 +03:00 [DBG] Start validation of refresh token request
2019-08-07 14:19:40.181 +03:00 [DBG] Token validation success
{"ClientId":"mvc","ClientName":"MVC Client","ValidateLifetime":false,"AccessTokenType":null,"ExpectedScope":null,"TokenHandle":null,"JwtId":null,"Claims":{"sub":"1","client_id":"mvc","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"auth_time":1565164567,"idp":"local","amr":"pwd","name":"alice","email":"alice@email.com"},"$type":"TokenValidationLog"}
2019-08-07 14:19:40.183 +03:00 [DBG] Validation of refresh token request success
2019-08-07 14:19:40.183 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"refresh_token","Scopes":null,"AuthorizationCode":null,"RefreshToken":"8c3cfad01f3d4c322f5a550bfd42aa5af6adc566d0bb2e6b3bbd56ce7eca1a11","UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"refresh_token","refresh_token":"***REDACTED***","client_id":"mvc","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2019-08-07 14:19:40.189 +03:00 [DBG] Updating refresh token
2019-08-07 14:19:40.190 +03:00 [DBG] Token usage is one-time only. Generating new handle
2019-08-07 14:19:40.190 +03:00 [DBG] Created refresh token in store
2019-08-07 14:19:40.191 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-07 14:19:40.191 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-07 14:19:40.201 +03:00 [DBG] Token request success.
2019-08-07 14:19:40.315 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-07 14:19:40.316 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-07 14:19:40.316 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-07 14:19:40.316 +03:00 [DBG] Start discovery request
2019-08-07 14:19:40.377 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-07 14:19:40.392 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-07 14:19:40.402 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-07 14:19:40.405 +03:00 [DBG] Start key discovery request
2019-08-07 14:26:00.065 +03:00 [INF] Starting IdentityServer4 version 2.5.0.0
2019-08-07 14:26:00.149 +03:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2019-08-07 14:26:00.150 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for authentication
2019-08-07 14:26:00.151 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-in
2019-08-07 14:26:00.151 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-out
2019-08-07 14:26:00.152 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for challenge
2019-08-07 14:26:00.152 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for forbid
2019-08-07 14:26:22.153 +03:00 [DBG] Login Url: /account/login
2019-08-07 14:26:22.158 +03:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-08-07 14:26:22.159 +03:00 [DBG] Logout Url: /Account/Logout
2019-08-07 14:26:22.159 +03:00 [DBG] ConsentUrl Url: /consent
2019-08-07 14:26:22.160 +03:00 [DBG] Consent Return Url Parameter: returnUrl
2019-08-07 14:26:22.160 +03:00 [DBG] Error Url: /home/error
2019-08-07 14:26:22.160 +03:00 [DBG] Error Id Parameter: errorId
2019-08-07 14:26:22.242 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-07 14:26:22.276 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-07 14:26:22.278 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-07 14:26:22.294 +03:00 [DBG] Start discovery request
2019-08-07 14:26:22.474 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-07 14:26:22.486 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-07 14:26:22.489 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-07 14:26:22.497 +03:00 [DBG] Start key discovery request
2019-08-07 14:26:22.624 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-07 14:26:22.638 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-07 14:26:22.640 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-07 14:26:22.654 +03:00 [DBG] Start token request.
2019-08-07 14:26:22.666 +03:00 [DBG] Start client validation
2019-08-07 14:26:22.679 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-07 14:26:22.688 +03:00 [DBG] Start parsing for secret in post body
2019-08-07 14:26:22.746 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-07 14:26:22.747 +03:00 [DBG] Secret id found: mvc
2019-08-07 14:26:22.831 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-07 14:26:22.860 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-07 14:26:22.860 +03:00 [DBG] Client validation success
2019-08-07 14:26:22.883 +03:00 [DBG] Start token request validation
2019-08-07 14:26:22.896 +03:00 [DBG] Start validation of refresh token request
2019-08-07 14:26:33.443 +03:00 [DBG] refresh_token grant with value: c7864faa4b298f7e301181f77dbd7df7bf5cf328f1d45835941f58417f8907d0 not found in store.
2019-08-07 14:26:33.448 +03:00 [WRN] Invalid refresh token
2019-08-07 14:26:33.470 +03:00 [WRN] Refresh token validation failed. aborting, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"refresh_token","Scopes":null,"AuthorizationCode":null,"RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"refresh_token","refresh_token":"***REDACTED***","client_id":"mvc","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2019-08-07 14:26:37.017 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-07 14:26:37.024 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-07 14:26:37.034 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-07 14:26:37.046 +03:00 [DBG] Start discovery request
2019-08-07 14:26:37.052 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-07 14:26:37.058 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-07 14:26:37.064 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-07 14:26:37.067 +03:00 [DBG] Start key discovery request
2019-08-07 14:26:46.742 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-07 14:26:46.747 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-07 14:26:46.749 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-07 14:26:46.752 +03:00 [DBG] Start discovery request
2019-08-07 14:26:46.795 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-07 14:26:46.798 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-07 14:26:46.804 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-07 14:26:46.809 +03:00 [DBG] Start key discovery request
2019-08-07 14:26:46.862 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-08-07 14:26:46.897 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-08-07 14:26:46.902 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-08-07 14:26:46.921 +03:00 [DBG] Start authorize request
2019-08-07 14:26:46.934 +03:00 [DBG] No user present in authorize request
2019-08-07 14:26:46.942 +03:00 [DBG] Start authorize request protocol validation
2019-08-07 14:26:46.953 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-07 14:26:46.979 +03:00 [DBG] Checking for PKCE parameters
2019-08-07 14:26:46.982 +03:00 [DBG] No PKCE used.
2019-08-07 14:26:47.035 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-07 14:26:47.060 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/signin-oidc","AllowedRedirectUris":["http://localhost:5002/signin-oidc"],"SubjectId":"anonymous","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9NwX5JB3XUmLUUefmRPfulEbVSptL1Chkezba5NUQxQ3dN7-c219Wbu5eLyFf3u6EVKQtSEK4GlzfWlOk6RbpoOzs6aIKgxzeiFt8Bdsskf24GKmYg87ccm3VcCubgTCgBeERTrjhDWXiMgtJfUWZwN50rj1V89Tcunrh8TyT_h0fO8WtYD10gKCSP_Ep8BQ4JDXDJIdasX7ouYI_xmkLtx4PIaDqwmfaOuR57k9yIEY1aUJvi8UjJOmJ99lA9-PhqhPrqFLj07Ap24kIda5emTbUlQcew0dLO21IUZhXahqg","UiLocales":null,"Nonce":"637007740068320756.MDM5NWUwM2MtYTFhMC00ZGFmLWIxY2EtYjkyOTE0NzRjMWI5YmFmOWQ3YjEtODY2Yi00MTJiLTg2OTYtYzExNDJkNTNlZWU2","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637007740068320756.MDM5NWUwM2MtYTFhMC00ZGFmLWIxY2EtYjkyOTE0NzRjMWI5YmFmOWQ3YjEtODY2Yi00MTJiLTg2OTYtYzExNDJkNTNlZWU2","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9NwX5JB3XUmLUUefmRPfulEbVSptL1Chkezba5NUQxQ3dN7-c219Wbu5eLyFf3u6EVKQtSEK4GlzfWlOk6RbpoOzs6aIKgxzeiFt8Bdsskf24GKmYg87ccm3VcCubgTCgBeERTrjhDWXiMgtJfUWZwN50rj1V89Tcunrh8TyT_h0fO8WtYD10gKCSP_Ep8BQ4JDXDJIdasX7ouYI_xmkLtx4PIaDqwmfaOuR57k9yIEY1aUJvi8UjJOmJ99lA9-PhqhPrqFLj07Ap24kIda5emTbUlQcew0dLO21IUZhXahqg","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-07 14:26:47.103 +03:00 [INF] Showing login: User is not authenticated
2019-08-07 14:26:47.397 +03:00 [DBG] Start authorize request protocol validation
2019-08-07 14:26:47.398 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-07 14:26:47.404 +03:00 [DBG] Checking for PKCE parameters
2019-08-07 14:26:47.405 +03:00 [DBG] No PKCE used.
2019-08-07 14:26:47.406 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-07 14:26:47.417 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-07 14:26:49.905 +03:00 [DBG] CORS request made for path: /account/login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-08-07 14:26:49.946 +03:00 [DBG] Start authorize request protocol validation
2019-08-07 14:26:49.946 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-07 14:26:49.952 +03:00 [DBG] Checking for PKCE parameters
2019-08-07 14:26:49.953 +03:00 [DBG] No PKCE used.
2019-08-07 14:26:49.955 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-07 14:26:49.990 +03:00 [DBG] Augmenting SignInContext
2019-08-07 14:26:49.995 +03:00 [DBG] Adding idp claim with value: local
2019-08-07 14:26:49.996 +03:00 [DBG] Adding amr claim with value: pwd
2019-08-07 14:26:50.012 +03:00 [INF] AuthenticationScheme: idsrv signed in.
2019-08-07 14:26:50.016 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-07 14:26:50.031 +03:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-08-07 14:26:50.033 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-08-07 14:26:50.040 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-08-07 14:26:50.052 +03:00 [DBG] Start authorize callback request
2019-08-07 14:26:50.060 +03:00 [DBG] User in authorize request: 1
2019-08-07 14:26:50.060 +03:00 [DBG] Start authorize request protocol validation
2019-08-07 14:26:50.062 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-07 14:26:50.066 +03:00 [DBG] Checking for PKCE parameters
2019-08-07 14:26:50.069 +03:00 [DBG] No PKCE used.
2019-08-07 14:26:50.075 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-07 14:26:50.078 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/signin-oidc","AllowedRedirectUris":["http://localhost:5002/signin-oidc"],"SubjectId":"1","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9NwX5JB3XUmLUUefmRPfulEbVSptL1Chkezba5NUQxQ3dN7-c219Wbu5eLyFf3u6EVKQtSEK4GlzfWlOk6RbpoOzs6aIKgxzeiFt8Bdsskf24GKmYg87ccm3VcCubgTCgBeERTrjhDWXiMgtJfUWZwN50rj1V89Tcunrh8TyT_h0fO8WtYD10gKCSP_Ep8BQ4JDXDJIdasX7ouYI_xmkLtx4PIaDqwmfaOuR57k9yIEY1aUJvi8UjJOmJ99lA9-PhqhPrqFLj07Ap24kIda5emTbUlQcew0dLO21IUZhXahqg","UiLocales":null,"Nonce":"637007740068320756.MDM5NWUwM2MtYTFhMC00ZGFmLWIxY2EtYjkyOTE0NzRjMWI5YmFmOWQ3YjEtODY2Yi00MTJiLTg2OTYtYzExNDJkNTNlZWU2","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"5cddf80008e308f075e38ba9b25aa47f","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637007740068320756.MDM5NWUwM2MtYTFhMC00ZGFmLWIxY2EtYjkyOTE0NzRjMWI5YmFmOWQ3YjEtODY2Yi00MTJiLTg2OTYtYzExNDJkNTNlZWU2","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9NwX5JB3XUmLUUefmRPfulEbVSptL1Chkezba5NUQxQ3dN7-c219Wbu5eLyFf3u6EVKQtSEK4GlzfWlOk6RbpoOzs6aIKgxzeiFt8Bdsskf24GKmYg87ccm3VcCubgTCgBeERTrjhDWXiMgtJfUWZwN50rj1V89Tcunrh8TyT_h0fO8WtYD10gKCSP_Ep8BQ4JDXDJIdasX7ouYI_xmkLtx4PIaDqwmfaOuR57k9yIEY1aUJvi8UjJOmJ99lA9-PhqhPrqFLj07Ap24kIda5emTbUlQcew0dLO21IUZhXahqg","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-07 14:26:50.168 +03:00 [DBG] Client is configured to not require consent, no consent is required
2019-08-07 14:26:50.181 +03:00 [DBG] Creating Hybrid Flow response.
2019-08-07 14:26:51.305 +03:00 [DBG] Creating Implicit Flow response.
2019-08-07 14:26:51.318 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-07 14:26:51.323 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-07 14:26:51.445 +03:00 [DBG] Authorize endpoint response
{"SubjectId":"1","ClientId":"mvc","RedirectUri":"http://localhost:5002/signin-oidc","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9NwX5JB3XUmLUUefmRPfulEbVSptL1Chkezba5NUQxQ3dN7-c219Wbu5eLyFf3u6EVKQtSEK4GlzfWlOk6RbpoOzs6aIKgxzeiFt8Bdsskf24GKmYg87ccm3VcCubgTCgBeERTrjhDWXiMgtJfUWZwN50rj1V89Tcunrh8TyT_h0fO8WtYD10gKCSP_Ep8BQ4JDXDJIdasX7ouYI_xmkLtx4PIaDqwmfaOuR57k9yIEY1aUJvi8UjJOmJ99lA9-PhqhPrqFLj07Ap24kIda5emTbUlQcew0dLO21IUZhXahqg","Scope":"openid profile afcpayroll offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-08-07 14:26:51.476 +03:00 [DBG] Augmenting SignInContext
2019-08-07 14:26:51.477 +03:00 [INF] AuthenticationScheme: idsrv signed in.
2019-08-07 14:26:51.786 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-07 14:26:51.792 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-07 14:26:51.795 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-07 14:26:51.796 +03:00 [DBG] Start token request.
2019-08-07 14:26:51.801 +03:00 [DBG] Start client validation
2019-08-07 14:26:51.805 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-07 14:26:51.809 +03:00 [DBG] Start parsing for secret in post body
2019-08-07 14:26:51.813 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-07 14:26:51.814 +03:00 [DBG] Secret id found: mvc
2019-08-07 14:26:51.818 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-07 14:26:51.819 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-07 14:26:51.821 +03:00 [DBG] Client validation success
2019-08-07 14:26:51.826 +03:00 [DBG] Start token request validation
2019-08-07 14:26:51.841 +03:00 [DBG] Start validation of authorization code token request
2019-08-07 14:26:54.505 +03:00 [DBG] Validation of authorization code token request success
2019-08-07 14:26:54.507 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"c5016ce8466d12946efd5888d38ce7b64b2828505ae1ce3710a487bfe9e7f8e1","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"mvc","client_secret":"***REDACTED***","code":"c5016ce8466d12946efd5888d38ce7b64b2828505ae1ce3710a487bfe9e7f8e1","grant_type":"authorization_code","redirect_uri":"http://localhost:5002/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-08-07 14:26:54.541 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-07 14:26:54.560 +03:00 [DBG] Getting claims for access token for client: mvc
2019-08-07 14:26:54.561 +03:00 [DBG] Getting claims for access token for subject: 1
2019-08-07 14:26:54.579 +03:00 [DBG] Creating refresh token
2019-08-07 14:26:54.579 +03:00 [DBG] Setting an absolute lifetime: 2592000
2019-08-07 14:27:05.024 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-07 14:27:05.036 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-07 14:27:05.042 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-07 14:27:05.059 +03:00 [DBG] Token request success.
2019-08-07 14:27:05.081 +03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-08-07 14:27:05.087 +03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-08-07 14:27:05.092 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-08-07 14:27:05.106 +03:00 [DBG] Start userinfo request
2019-08-07 14:27:05.112 +03:00 [DBG] Bearer token found in header
2019-08-07 14:27:05.210 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-07 14:27:05.217 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-07 14:27:05.220 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-08-07 14:27:05.228 +03:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1565177214,"exp":1565177274,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","afcpayroll"],"client_id":"mvc","sub":"1","auth_time":1565177209,"idp":"local","name":"alice","email":"alice@email.com","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-08-07 14:27:05.259 +03:00 [DBG] Creating userinfo response
2019-08-07 14:27:05.280 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-07 14:27:05.311 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-07 14:27:05.320 +03:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-07 14:27:05.322 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-07 14:27:05.325 +03:00 [INF] Profile service returned the following claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-07 14:27:05.330 +03:00 [DBG] End userinfo request
2019-08-07 14:28:21.877 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-07 14:28:21.885 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-07 14:28:21.900 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-07 14:28:21.908 +03:00 [DBG] Start discovery request
2019-08-07 14:28:21.927 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-07 14:28:21.929 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-07 14:28:21.937 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-07 14:28:21.939 +03:00 [DBG] Start key discovery request
2019-08-07 14:28:21.948 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-07 14:28:21.951 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-07 14:28:21.953 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-07 14:28:21.961 +03:00 [DBG] Start token request.
2019-08-07 14:28:21.964 +03:00 [DBG] Start client validation
2019-08-07 14:28:21.965 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-07 14:28:21.969 +03:00 [DBG] Start parsing for secret in post body
2019-08-07 14:28:21.971 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-07 14:28:21.972 +03:00 [DBG] Secret id found: mvc
2019-08-07 14:28:21.976 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-07 14:28:21.982 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-07 14:28:21.984 +03:00 [DBG] Client validation success
2019-08-07 14:28:21.987 +03:00 [DBG] Start token request validation
2019-08-07 14:28:21.988 +03:00 [DBG] Start validation of refresh token request
2019-08-07 14:28:34.509 +03:00 [DBG] Token validation success
{"ClientId":"mvc","ClientName":"MVC Client","ValidateLifetime":false,"AccessTokenType":null,"ExpectedScope":null,"TokenHandle":null,"JwtId":null,"Claims":{"sub":"1","client_id":"mvc","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"auth_time":1565177209,"idp":"local","amr":"pwd","name":"alice","email":"alice@email.com"},"$type":"TokenValidationLog"}
2019-08-07 14:28:34.520 +03:00 [DBG] Validation of refresh token request success
2019-08-07 14:28:34.521 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"refresh_token","Scopes":null,"AuthorizationCode":null,"RefreshToken":"5780171e6838cb3a76f62fc4f52162b6530b924a4f24900efdc3c60f32948056","UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"refresh_token","refresh_token":"***REDACTED***","client_id":"mvc","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2019-08-07 14:28:34.560 +03:00 [DBG] Updating refresh token
2019-08-07 14:28:34.565 +03:00 [DBG] Token usage is one-time only. Generating new handle
2019-08-07 14:28:46.543 +03:00 [DBG] Created refresh token in store
2019-08-07 14:28:46.553 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-07 14:28:46.555 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-07 14:28:46.565 +03:00 [DBG] Token request success.
2019-08-07 14:29:06.053 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-08-07 14:29:06.059 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-08-07 14:29:06.073 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-08-07 14:29:06.078 +03:00 [DBG] Start authorize request
2019-08-07 14:29:06.087 +03:00 [DBG] No user present in authorize request
2019-08-07 14:29:06.090 +03:00 [DBG] Start authorize request protocol validation
2019-08-07 14:29:06.094 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-07 14:29:06.096 +03:00 [DBG] Checking for PKCE parameters
2019-08-07 14:29:06.097 +03:00 [DBG] No PKCE used.
2019-08-07 14:29:06.098 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-07 14:29:06.108 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/signin-oidc","AllowedRedirectUris":["http://localhost:5002/signin-oidc"],"SubjectId":"anonymous","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9MHjZ-SCCzkN_W4kTOmx0TkdoqobopBmI5rSxVIw8HRBw5f33rGCJ0LBIkREBWPkargW5z1ZSkT2HRzVL-l4_ybDcfcaICD5GXkxNVOQKBpIyNMs-Il3M-_7S8UMlV84M78j1gUTsguxUeBvOO5HG0wS7-8TUnsumk5ljCioijxRUGe1gX41CE4216Cihs7RpRxMEohUu3mUOG-mxIh72fUJeuxem2n8INmvU0N05o1sTPvOpFZwRQ3Sbot4KErbD9lG0QAVpZKZ3P4pchpEUdV83k19V4O41Gub9p-4rFnRg","UiLocales":null,"Nonce":"637007741460395654.OGY2NGZhODMtZDIxZi00OGE2LTkyOGMtYzVjNGMxOGQ5ZThiZTk2MGEzMmMtZmViOC00ZDY0LTg1ZGUtNGFlNDQzNjU2N2Vi","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637007741460395654.OGY2NGZhODMtZDIxZi00OGE2LTkyOGMtYzVjNGMxOGQ5ZThiZTk2MGEzMmMtZmViOC00ZDY0LTg1ZGUtNGFlNDQzNjU2N2Vi","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9MHjZ-SCCzkN_W4kTOmx0TkdoqobopBmI5rSxVIw8HRBw5f33rGCJ0LBIkREBWPkargW5z1ZSkT2HRzVL-l4_ybDcfcaICD5GXkxNVOQKBpIyNMs-Il3M-_7S8UMlV84M78j1gUTsguxUeBvOO5HG0wS7-8TUnsumk5ljCioijxRUGe1gX41CE4216Cihs7RpRxMEohUu3mUOG-mxIh72fUJeuxem2n8INmvU0N05o1sTPvOpFZwRQ3Sbot4KErbD9lG0QAVpZKZ3P4pchpEUdV83k19V4O41Gub9p-4rFnRg","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-07 14:29:06.136 +03:00 [INF] Showing login: User is not authenticated
2019-08-07 14:29:06.145 +03:00 [DBG] Start authorize request protocol validation
2019-08-07 14:29:06.146 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-07 14:29:06.148 +03:00 [DBG] Checking for PKCE parameters
2019-08-07 14:29:06.149 +03:00 [DBG] No PKCE used.
2019-08-07 14:29:06.154 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-07 14:29:06.156 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-07 14:29:08.200 +03:00 [DBG] CORS request made for path: /account/login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-08-07 14:29:08.206 +03:00 [DBG] Start authorize request protocol validation
2019-08-07 14:29:08.209 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-07 14:29:08.211 +03:00 [DBG] Checking for PKCE parameters
2019-08-07 14:29:08.216 +03:00 [DBG] No PKCE used.
2019-08-07 14:29:08.218 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-07 14:29:08.224 +03:00 [DBG] Augmenting SignInContext
2019-08-07 14:29:08.228 +03:00 [DBG] Adding idp claim with value: local
2019-08-07 14:29:08.231 +03:00 [DBG] Adding amr claim with value: pwd
2019-08-07 14:29:08.232 +03:00 [INF] AuthenticationScheme: idsrv signed in.
2019-08-07 14:29:08.235 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-07 14:29:08.255 +03:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-08-07 14:29:08.259 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-08-07 14:29:08.263 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-08-07 14:29:08.267 +03:00 [DBG] Start authorize callback request
2019-08-07 14:29:08.269 +03:00 [DBG] User in authorize request: 1
2019-08-07 14:29:08.270 +03:00 [DBG] Start authorize request protocol validation
2019-08-07 14:29:08.276 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-07 14:29:08.279 +03:00 [DBG] Checking for PKCE parameters
2019-08-07 14:29:08.280 +03:00 [DBG] No PKCE used.
2019-08-07 14:29:08.281 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-07 14:29:08.283 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/signin-oidc","AllowedRedirectUris":["http://localhost:5002/signin-oidc"],"SubjectId":"1","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9MHjZ-SCCzkN_W4kTOmx0TkdoqobopBmI5rSxVIw8HRBw5f33rGCJ0LBIkREBWPkargW5z1ZSkT2HRzVL-l4_ybDcfcaICD5GXkxNVOQKBpIyNMs-Il3M-_7S8UMlV84M78j1gUTsguxUeBvOO5HG0wS7-8TUnsumk5ljCioijxRUGe1gX41CE4216Cihs7RpRxMEohUu3mUOG-mxIh72fUJeuxem2n8INmvU0N05o1sTPvOpFZwRQ3Sbot4KErbD9lG0QAVpZKZ3P4pchpEUdV83k19V4O41Gub9p-4rFnRg","UiLocales":null,"Nonce":"637007741460395654.OGY2NGZhODMtZDIxZi00OGE2LTkyOGMtYzVjNGMxOGQ5ZThiZTk2MGEzMmMtZmViOC00ZDY0LTg1ZGUtNGFlNDQzNjU2N2Vi","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"520f5e46a72d2d9240c65bd614b85227","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637007741460395654.OGY2NGZhODMtZDIxZi00OGE2LTkyOGMtYzVjNGMxOGQ5ZThiZTk2MGEzMmMtZmViOC00ZDY0LTg1ZGUtNGFlNDQzNjU2N2Vi","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9MHjZ-SCCzkN_W4kTOmx0TkdoqobopBmI5rSxVIw8HRBw5f33rGCJ0LBIkREBWPkargW5z1ZSkT2HRzVL-l4_ybDcfcaICD5GXkxNVOQKBpIyNMs-Il3M-_7S8UMlV84M78j1gUTsguxUeBvOO5HG0wS7-8TUnsumk5ljCioijxRUGe1gX41CE4216Cihs7RpRxMEohUu3mUOG-mxIh72fUJeuxem2n8INmvU0N05o1sTPvOpFZwRQ3Sbot4KErbD9lG0QAVpZKZ3P4pchpEUdV83k19V4O41Gub9p-4rFnRg","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-07 14:29:08.318 +03:00 [DBG] Client is configured to not require consent, no consent is required
2019-08-07 14:29:08.321 +03:00 [DBG] Creating Hybrid Flow response.
2019-08-07 14:29:30.389 +03:00 [DBG] Creating Implicit Flow response.
2019-08-07 14:29:30.414 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-07 14:29:30.416 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-07 14:29:30.422 +03:00 [DBG] Authorize endpoint response
{"SubjectId":"1","ClientId":"mvc","RedirectUri":"http://localhost:5002/signin-oidc","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9MHjZ-SCCzkN_W4kTOmx0TkdoqobopBmI5rSxVIw8HRBw5f33rGCJ0LBIkREBWPkargW5z1ZSkT2HRzVL-l4_ybDcfcaICD5GXkxNVOQKBpIyNMs-Il3M-_7S8UMlV84M78j1gUTsguxUeBvOO5HG0wS7-8TUnsumk5ljCioijxRUGe1gX41CE4216Cihs7RpRxMEohUu3mUOG-mxIh72fUJeuxem2n8INmvU0N05o1sTPvOpFZwRQ3Sbot4KErbD9lG0QAVpZKZ3P4pchpEUdV83k19V4O41Gub9p-4rFnRg","Scope":"openid profile afcpayroll offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-08-07 14:29:30.433 +03:00 [DBG] Augmenting SignInContext
2019-08-07 14:29:30.439 +03:00 [INF] AuthenticationScheme: idsrv signed in.
2019-08-07 14:29:30.779 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-07 14:29:30.786 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-07 14:29:30.799 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-07 14:29:30.812 +03:00 [DBG] Start token request.
2019-08-07 14:29:30.815 +03:00 [DBG] Start client validation
2019-08-07 14:29:30.816 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-07 14:29:30.818 +03:00 [DBG] Start parsing for secret in post body
2019-08-07 14:29:30.826 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-07 14:29:30.831 +03:00 [DBG] Secret id found: mvc
2019-08-07 14:29:30.834 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-07 14:29:30.843 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-07 14:29:30.846 +03:00 [DBG] Client validation success
2019-08-07 14:29:30.848 +03:00 [DBG] Start token request validation
2019-08-07 14:29:30.850 +03:00 [DBG] Start validation of authorization code token request
2019-08-07 14:29:50.319 +03:00 [DBG] Validation of authorization code token request success
2019-08-07 14:29:50.320 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"50c301d375dac6099566f1be57a634690fca2725406d352114a127bfa2f61586","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"mvc","client_secret":"***REDACTED***","code":"50c301d375dac6099566f1be57a634690fca2725406d352114a127bfa2f61586","grant_type":"authorization_code","redirect_uri":"http://localhost:5002/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-08-07 14:29:50.356 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-07 14:29:50.363 +03:00 [DBG] Getting claims for access token for client: mvc
2019-08-07 14:29:50.364 +03:00 [DBG] Getting claims for access token for subject: 1
2019-08-07 14:29:57.600 +03:00 [DBG] Creating refresh token
2019-08-07 14:29:57.601 +03:00 [DBG] Setting an absolute lifetime: 2592000
2019-08-07 14:30:01.025 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-07 14:30:01.029 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-07 14:30:01.034 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-07 14:30:01.044 +03:00 [DBG] Token request success.
2019-08-07 14:30:01.048 +03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-08-07 14:30:01.050 +03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-08-07 14:30:01.056 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-08-07 14:30:01.058 +03:00 [DBG] Start userinfo request
2019-08-07 14:30:01.059 +03:00 [DBG] Bearer token found in header
2019-08-07 14:30:01.063 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-07 14:30:01.069 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-07 14:30:01.074 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-08-07 14:30:01.079 +03:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1565177397,"exp":1565177457,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","afcpayroll"],"client_id":"mvc","sub":"1","auth_time":1565177348,"idp":"local","name":"alice","email":"alice@email.com","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-08-07 14:30:01.096 +03:00 [DBG] Creating userinfo response
2019-08-07 14:30:01.099 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-07 14:30:01.106 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-07 14:30:01.109 +03:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-07 14:30:01.111 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-07 14:30:20.481 +03:00 [INF] Profile service returned the following claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-07 14:30:20.485 +03:00 [DBG] End userinfo request
2019-08-12 10:15:59.359 +03:00 [INF] Starting IdentityServer4 version 2.5.0.0
2019-08-12 10:15:59.473 +03:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2019-08-12 10:15:59.474 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for authentication
2019-08-12 10:15:59.474 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-in
2019-08-12 10:15:59.475 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-out
2019-08-12 10:15:59.475 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for challenge
2019-08-12 10:15:59.476 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for forbid
2019-08-12 10:16:35.633 +03:00 [DBG] Login Url: /account/login
2019-08-12 10:16:35.642 +03:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-08-12 10:16:35.642 +03:00 [DBG] Logout Url: /Account/Logout
2019-08-12 10:16:35.643 +03:00 [DBG] ConsentUrl Url: /consent
2019-08-12 10:16:35.643 +03:00 [DBG] Consent Return Url Parameter: returnUrl
2019-08-12 10:16:35.643 +03:00 [DBG] Error Url: /home/error
2019-08-12 10:16:35.643 +03:00 [DBG] Error Id Parameter: errorId
2019-08-12 10:16:35.727 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-12 10:16:35.735 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-12 10:16:35.738 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-12 10:16:35.747 +03:00 [DBG] Start discovery request
2019-08-12 10:16:36.077 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-12 10:16:36.161 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-12 10:16:36.163 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-12 10:16:36.173 +03:00 [DBG] Start key discovery request
2019-08-12 10:16:36.387 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-12 10:16:36.407 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-12 10:16:36.408 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-12 10:16:36.425 +03:00 [DBG] Start token request.
2019-08-12 10:16:36.441 +03:00 [DBG] Start client validation
2019-08-12 10:16:36.451 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-12 10:16:36.461 +03:00 [DBG] Start parsing for secret in post body
2019-08-12 10:16:36.504 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-12 10:16:36.505 +03:00 [DBG] Secret id found: mvc
2019-08-12 10:16:36.561 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-12 10:16:36.596 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-12 10:16:36.597 +03:00 [DBG] Client validation success
2019-08-12 10:16:36.652 +03:00 [DBG] Start token request validation
2019-08-12 10:16:36.676 +03:00 [DBG] Start validation of refresh token request
2019-08-12 10:16:46.765 +03:00 [DBG] refresh_token grant with value: bfcd6c0fd8bbb98b1bbbbd383992c6703cd3318e80b99d4e22e9c888ac89845f not found in store.
2019-08-12 10:16:46.767 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-12 10:16:46.769 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-12 10:16:46.770 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-12 10:16:46.775 +03:00 [DBG] Start discovery request
2019-08-12 10:16:46.777 +03:00 [WRN] Invalid refresh token
2019-08-12 10:16:46.786 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-12 10:16:46.788 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-12 10:16:46.789 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-12 10:16:46.790 +03:00 [DBG] Start key discovery request
2019-08-12 10:16:46.794 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-12 10:16:46.807 +03:00 [WRN] Refresh token validation failed. aborting, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"refresh_token","Scopes":null,"AuthorizationCode":null,"RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"refresh_token","refresh_token":"***REDACTED***","client_id":"mvc","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2019-08-12 10:16:46.808 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-12 10:16:46.815 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-12 10:16:46.816 +03:00 [DBG] Start token request.
2019-08-12 10:16:46.816 +03:00 [DBG] Start client validation
2019-08-12 10:16:46.816 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-12 10:16:46.817 +03:00 [DBG] Start parsing for secret in post body
2019-08-12 10:16:46.818 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-12 10:16:46.819 +03:00 [DBG] Secret id found: mvc
2019-08-12 10:16:46.820 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-12 10:16:46.822 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-12 10:16:46.823 +03:00 [DBG] Client validation success
2019-08-12 10:16:46.824 +03:00 [DBG] Start token request validation
2019-08-12 10:16:46.824 +03:00 [DBG] Start validation of refresh token request
2019-08-12 10:16:46.825 +03:00 [DBG] refresh_token grant with value: bfcd6c0fd8bbb98b1bbbbd383992c6703cd3318e80b99d4e22e9c888ac89845f not found in store.
2019-08-12 10:16:46.825 +03:00 [WRN] Invalid refresh token
2019-08-12 10:16:46.826 +03:00 [WRN] Refresh token validation failed. aborting, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"refresh_token","Scopes":null,"AuthorizationCode":null,"RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"refresh_token","refresh_token":"***REDACTED***","client_id":"mvc","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2019-08-12 10:16:57.067 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-12 10:16:57.071 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-12 10:16:57.074 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-12 10:16:57.075 +03:00 [DBG] Start discovery request
2019-08-12 10:16:57.083 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-12 10:16:57.085 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-12 10:16:57.086 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-12 10:16:57.087 +03:00 [DBG] Start key discovery request
2019-08-12 10:17:26.079 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-12 10:17:26.081 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-12 10:17:26.082 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-12 10:17:26.082 +03:00 [DBG] Start discovery request
2019-08-12 10:17:26.143 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-12 10:17:26.144 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-12 10:17:26.145 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-12 10:17:26.146 +03:00 [DBG] Start key discovery request
2019-08-12 10:17:26.228 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-08-12 10:17:26.273 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-08-12 10:17:26.274 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-08-12 10:17:26.280 +03:00 [DBG] Start authorize request
2019-08-12 10:17:26.291 +03:00 [DBG] No user present in authorize request
2019-08-12 10:17:26.299 +03:00 [DBG] Start authorize request protocol validation
2019-08-12 10:17:26.306 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-12 10:17:26.332 +03:00 [DBG] Checking for PKCE parameters
2019-08-12 10:17:26.335 +03:00 [DBG] No PKCE used.
2019-08-12 10:17:26.392 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-12 10:17:26.401 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/signin-oidc","AllowedRedirectUris":["http://localhost:5002/signin-oidc"],"SubjectId":"anonymous","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9MmXX4gmlm1L4VgO8OZ_kUZqbA6XiQy21lsbg5HwNCZMqj5nBhyFYSWQSLGW1WlTUxhp3e3Gv1rkYj-pquXRlMWk6hbkZVqx7gd8HpHhYSzJEoN93Z3IeHS2y9FqWndHl8xU01ZzmBk03lGO13Rjqb7O2CcmqJEhdMkhoVG0sD9HrMoidyLxaEKnP3xNp5vjnf2rd59HRpjrukrs_w2-d6W5tpJc-3-KWTo37cbIwa-zQOLyNqilmnx86YGl8v258UqZKEQDTdPspUWWYWMZcWxytEzjks3dNwlrI3vq1kDGw","UiLocales":null,"Nonce":"637011910461716323.NDQ1MmI2NDItYzkxMy00MjA4LTk4YWUtOGJjYWFlNzE5YTAzN2FkMTNkOWQtMTI1ZS00ZjA1LWIxMjYtZGNmYWExZjdmM2U4","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637011910461716323.NDQ1MmI2NDItYzkxMy00MjA4LTk4YWUtOGJjYWFlNzE5YTAzN2FkMTNkOWQtMTI1ZS00ZjA1LWIxMjYtZGNmYWExZjdmM2U4","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9MmXX4gmlm1L4VgO8OZ_kUZqbA6XiQy21lsbg5HwNCZMqj5nBhyFYSWQSLGW1WlTUxhp3e3Gv1rkYj-pquXRlMWk6hbkZVqx7gd8HpHhYSzJEoN93Z3IeHS2y9FqWndHl8xU01ZzmBk03lGO13Rjqb7O2CcmqJEhdMkhoVG0sD9HrMoidyLxaEKnP3xNp5vjnf2rd59HRpjrukrs_w2-d6W5tpJc-3-KWTo37cbIwa-zQOLyNqilmnx86YGl8v258UqZKEQDTdPspUWWYWMZcWxytEzjks3dNwlrI3vq1kDGw","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-12 10:17:26.423 +03:00 [INF] Showing login: User is not authenticated
2019-08-12 10:17:26.908 +03:00 [DBG] Start authorize request protocol validation
2019-08-12 10:17:26.908 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-12 10:17:26.910 +03:00 [DBG] Checking for PKCE parameters
2019-08-12 10:17:26.910 +03:00 [DBG] No PKCE used.
2019-08-12 10:17:26.911 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-12 10:17:26.918 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-12 10:19:42.887 +03:00 [DBG] CORS request made for path: /account/login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-08-12 10:19:42.931 +03:00 [DBG] Start authorize request protocol validation
2019-08-12 10:19:42.931 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-12 10:19:42.932 +03:00 [DBG] Checking for PKCE parameters
2019-08-12 10:19:42.933 +03:00 [DBG] No PKCE used.
2019-08-12 10:19:42.934 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-12 10:19:42.971 +03:00 [DBG] Augmenting SignInContext
2019-08-12 10:19:42.975 +03:00 [DBG] Adding idp claim with value: local
2019-08-12 10:19:42.975 +03:00 [DBG] Adding amr claim with value: pwd
2019-08-12 10:19:43.000 +03:00 [INF] AuthenticationScheme: idsrv signed in.
2019-08-12 10:19:43.004 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-12 10:19:43.019 +03:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-08-12 10:19:43.022 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-08-12 10:19:43.023 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-08-12 10:19:43.035 +03:00 [DBG] Start authorize callback request
2019-08-12 10:19:43.041 +03:00 [DBG] User in authorize request: 1
2019-08-12 10:19:43.041 +03:00 [DBG] Start authorize request protocol validation
2019-08-12 10:19:43.042 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-12 10:19:43.042 +03:00 [DBG] Checking for PKCE parameters
2019-08-12 10:19:43.043 +03:00 [DBG] No PKCE used.
2019-08-12 10:19:43.043 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-12 10:19:43.044 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/signin-oidc","AllowedRedirectUris":["http://localhost:5002/signin-oidc"],"SubjectId":"1","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9MmXX4gmlm1L4VgO8OZ_kUZqbA6XiQy21lsbg5HwNCZMqj5nBhyFYSWQSLGW1WlTUxhp3e3Gv1rkYj-pquXRlMWk6hbkZVqx7gd8HpHhYSzJEoN93Z3IeHS2y9FqWndHl8xU01ZzmBk03lGO13Rjqb7O2CcmqJEhdMkhoVG0sD9HrMoidyLxaEKnP3xNp5vjnf2rd59HRpjrukrs_w2-d6W5tpJc-3-KWTo37cbIwa-zQOLyNqilmnx86YGl8v258UqZKEQDTdPspUWWYWMZcWxytEzjks3dNwlrI3vq1kDGw","UiLocales":null,"Nonce":"637011910461716323.NDQ1MmI2NDItYzkxMy00MjA4LTk4YWUtOGJjYWFlNzE5YTAzN2FkMTNkOWQtMTI1ZS00ZjA1LWIxMjYtZGNmYWExZjdmM2U4","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"982f4301b143c882dda5550b3a0f4f41","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637011910461716323.NDQ1MmI2NDItYzkxMy00MjA4LTk4YWUtOGJjYWFlNzE5YTAzN2FkMTNkOWQtMTI1ZS00ZjA1LWIxMjYtZGNmYWExZjdmM2U4","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9MmXX4gmlm1L4VgO8OZ_kUZqbA6XiQy21lsbg5HwNCZMqj5nBhyFYSWQSLGW1WlTUxhp3e3Gv1rkYj-pquXRlMWk6hbkZVqx7gd8HpHhYSzJEoN93Z3IeHS2y9FqWndHl8xU01ZzmBk03lGO13Rjqb7O2CcmqJEhdMkhoVG0sD9HrMoidyLxaEKnP3xNp5vjnf2rd59HRpjrukrs_w2-d6W5tpJc-3-KWTo37cbIwa-zQOLyNqilmnx86YGl8v258UqZKEQDTdPspUWWYWMZcWxytEzjks3dNwlrI3vq1kDGw","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-12 10:19:43.069 +03:00 [DBG] Client is configured to not require consent, no consent is required
2019-08-12 10:19:43.079 +03:00 [DBG] Creating Hybrid Flow response.
2019-08-12 10:21:49.692 +03:00 [DBG] Creating Implicit Flow response.
2019-08-12 10:21:49.705 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-12 10:21:49.710 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-12 10:21:49.835 +03:00 [DBG] Authorize endpoint response
{"SubjectId":"1","ClientId":"mvc","RedirectUri":"http://localhost:5002/signin-oidc","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9MmXX4gmlm1L4VgO8OZ_kUZqbA6XiQy21lsbg5HwNCZMqj5nBhyFYSWQSLGW1WlTUxhp3e3Gv1rkYj-pquXRlMWk6hbkZVqx7gd8HpHhYSzJEoN93Z3IeHS2y9FqWndHl8xU01ZzmBk03lGO13Rjqb7O2CcmqJEhdMkhoVG0sD9HrMoidyLxaEKnP3xNp5vjnf2rd59HRpjrukrs_w2-d6W5tpJc-3-KWTo37cbIwa-zQOLyNqilmnx86YGl8v258UqZKEQDTdPspUWWYWMZcWxytEzjks3dNwlrI3vq1kDGw","Scope":"openid profile afcpayroll offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-08-12 10:21:49.865 +03:00 [DBG] Augmenting SignInContext
2019-08-12 10:21:49.869 +03:00 [INF] AuthenticationScheme: idsrv signed in.
2019-08-12 10:21:50.417 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-12 10:21:50.419 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-12 10:21:50.419 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-12 10:21:50.420 +03:00 [DBG] Start token request.
2019-08-12 10:21:50.421 +03:00 [DBG] Start client validation
2019-08-12 10:21:50.421 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-12 10:21:50.421 +03:00 [DBG] Start parsing for secret in post body
2019-08-12 10:21:50.422 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-12 10:21:50.423 +03:00 [DBG] Secret id found: mvc
2019-08-12 10:21:50.425 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-12 10:21:50.425 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-12 10:21:50.426 +03:00 [DBG] Client validation success
2019-08-12 10:21:50.426 +03:00 [DBG] Start token request validation
2019-08-12 10:21:50.439 +03:00 [DBG] Start validation of authorization code token request
2019-08-12 10:23:36.920 +03:00 [DBG] Validation of authorization code token request success
2019-08-12 10:23:36.922 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"5dab4f0be12ee44e4be7bde3476cff69fcd4915ff0ae9f5413ac80859762786f","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"mvc","client_secret":"***REDACTED***","code":"5dab4f0be12ee44e4be7bde3476cff69fcd4915ff0ae9f5413ac80859762786f","grant_type":"authorization_code","redirect_uri":"http://localhost:5002/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-08-12 10:23:36.951 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-12 10:23:36.972 +03:00 [DBG] Getting claims for access token for client: mvc
2019-08-12 10:23:36.974 +03:00 [DBG] Getting claims for access token for subject: 1
2019-08-12 10:23:36.997 +03:00 [DBG] Creating refresh token
2019-08-12 10:23:36.997 +03:00 [DBG] Setting an absolute lifetime: 2592000
2019-08-12 10:23:46.151 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-12 10:23:46.154 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-12 10:23:46.155 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-12 10:23:46.164 +03:00 [DBG] Token request success.
2019-08-12 10:24:08.323 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-08-12 10:24:08.330 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-08-12 10:24:08.342 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-08-12 10:24:08.343 +03:00 [DBG] Start authorize request
2019-08-12 10:24:08.345 +03:00 [DBG] No user present in authorize request
2019-08-12 10:24:08.346 +03:00 [DBG] Start authorize request protocol validation
2019-08-12 10:24:08.347 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-12 10:24:08.348 +03:00 [DBG] Checking for PKCE parameters
2019-08-12 10:24:08.348 +03:00 [DBG] No PKCE used.
2019-08-12 10:24:08.349 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-12 10:24:08.350 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/signin-oidc","AllowedRedirectUris":["http://localhost:5002/signin-oidc"],"SubjectId":"anonymous","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9Pyl35ILJkbnB9R1Y6kJu_-nyN8_qL4_Bmo9fijEHW5jIB8gsa0gDPE-J3jZPciOJN5gDJm3D_6Pzg8Fd-1LFwgmpwGKBlyBt85Pd8uF8ANHEoJLg4G2hS_Jsd8pQ0eOg_Vg-NxQ2T0TcRiFEY4ms6q7Msw47fQS6zfmvTn78-HXgMkpy1r7jw2CccENwweekvVv4EUpCyLq3l5Okxg2tKoqYU_USaJl27ydO2YJD-e-bkKdvhEA7_OLtvM4vgljVp63IbxeL2FgDQFRSb5AwN7JWeiuolkdsjaALVocLWaRw","UiLocales":null,"Nonce":"637011914483014424.ZDU5ZDQ0ODItZmIwZC00MDEwLTk5ZWEtYTZhZTk4N2QxYjAzYTNjYWNmNDQtM2ZjMy00MzJkLWI5YzMtNWE2NTMxMDhmOTJm","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637011914483014424.ZDU5ZDQ0ODItZmIwZC00MDEwLTk5ZWEtYTZhZTk4N2QxYjAzYTNjYWNmNDQtM2ZjMy00MzJkLWI5YzMtNWE2NTMxMDhmOTJm","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9Pyl35ILJkbnB9R1Y6kJu_-nyN8_qL4_Bmo9fijEHW5jIB8gsa0gDPE-J3jZPciOJN5gDJm3D_6Pzg8Fd-1LFwgmpwGKBlyBt85Pd8uF8ANHEoJLg4G2hS_Jsd8pQ0eOg_Vg-NxQ2T0TcRiFEY4ms6q7Msw47fQS6zfmvTn78-HXgMkpy1r7jw2CccENwweekvVv4EUpCyLq3l5Okxg2tKoqYU_USaJl27ydO2YJD-e-bkKdvhEA7_OLtvM4vgljVp63IbxeL2FgDQFRSb5AwN7JWeiuolkdsjaALVocLWaRw","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-12 10:24:08.359 +03:00 [INF] Showing login: User is not authenticated
2019-08-12 10:24:08.371 +03:00 [DBG] Start authorize request protocol validation
2019-08-12 10:24:08.372 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-12 10:24:08.373 +03:00 [DBG] Checking for PKCE parameters
2019-08-12 10:24:08.374 +03:00 [DBG] No PKCE used.
2019-08-12 10:24:08.375 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-12 10:24:08.377 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-12 10:24:10.821 +03:00 [DBG] CORS request made for path: /account/login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-08-12 10:24:10.827 +03:00 [DBG] Start authorize request protocol validation
2019-08-12 10:24:10.829 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-12 10:24:10.832 +03:00 [DBG] Checking for PKCE parameters
2019-08-12 10:24:10.833 +03:00 [DBG] No PKCE used.
2019-08-12 10:24:10.834 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-12 10:24:10.836 +03:00 [DBG] Augmenting SignInContext
2019-08-12 10:24:10.837 +03:00 [DBG] Adding idp claim with value: local
2019-08-12 10:24:10.838 +03:00 [DBG] Adding amr claim with value: pwd
2019-08-12 10:24:10.839 +03:00 [INF] AuthenticationScheme: idsrv signed in.
2019-08-12 10:24:10.840 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-12 10:24:10.858 +03:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-08-12 10:24:10.861 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-08-12 10:24:10.864 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-08-12 10:24:10.865 +03:00 [DBG] Start authorize callback request
2019-08-12 10:24:10.866 +03:00 [DBG] User in authorize request: 1
2019-08-12 10:24:10.867 +03:00 [DBG] Start authorize request protocol validation
2019-08-12 10:24:10.867 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-12 10:24:10.868 +03:00 [DBG] Checking for PKCE parameters
2019-08-12 10:24:10.872 +03:00 [DBG] No PKCE used.
2019-08-12 10:24:10.874 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-12 10:24:10.876 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/signin-oidc","AllowedRedirectUris":["http://localhost:5002/signin-oidc"],"SubjectId":"1","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9Pyl35ILJkbnB9R1Y6kJu_-nyN8_qL4_Bmo9fijEHW5jIB8gsa0gDPE-J3jZPciOJN5gDJm3D_6Pzg8Fd-1LFwgmpwGKBlyBt85Pd8uF8ANHEoJLg4G2hS_Jsd8pQ0eOg_Vg-NxQ2T0TcRiFEY4ms6q7Msw47fQS6zfmvTn78-HXgMkpy1r7jw2CccENwweekvVv4EUpCyLq3l5Okxg2tKoqYU_USaJl27ydO2YJD-e-bkKdvhEA7_OLtvM4vgljVp63IbxeL2FgDQFRSb5AwN7JWeiuolkdsjaALVocLWaRw","UiLocales":null,"Nonce":"637011914483014424.ZDU5ZDQ0ODItZmIwZC00MDEwLTk5ZWEtYTZhZTk4N2QxYjAzYTNjYWNmNDQtM2ZjMy00MzJkLWI5YzMtNWE2NTMxMDhmOTJm","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"4727f9be59aa1377f7bb2b6365c94be5","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637011914483014424.ZDU5ZDQ0ODItZmIwZC00MDEwLTk5ZWEtYTZhZTk4N2QxYjAzYTNjYWNmNDQtM2ZjMy00MzJkLWI5YzMtNWE2NTMxMDhmOTJm","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9Pyl35ILJkbnB9R1Y6kJu_-nyN8_qL4_Bmo9fijEHW5jIB8gsa0gDPE-J3jZPciOJN5gDJm3D_6Pzg8Fd-1LFwgmpwGKBlyBt85Pd8uF8ANHEoJLg4G2hS_Jsd8pQ0eOg_Vg-NxQ2T0TcRiFEY4ms6q7Msw47fQS6zfmvTn78-HXgMkpy1r7jw2CccENwweekvVv4EUpCyLq3l5Okxg2tKoqYU_USaJl27ydO2YJD-e-bkKdvhEA7_OLtvM4vgljVp63IbxeL2FgDQFRSb5AwN7JWeiuolkdsjaALVocLWaRw","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-12 10:24:10.888 +03:00 [DBG] Client is configured to not require consent, no consent is required
2019-08-12 10:24:10.889 +03:00 [DBG] Creating Hybrid Flow response.
2019-08-12 10:24:12.174 +03:00 [DBG] Creating Implicit Flow response.
2019-08-12 10:24:12.175 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-12 10:24:12.176 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-12 10:24:12.182 +03:00 [DBG] Authorize endpoint response
{"SubjectId":"1","ClientId":"mvc","RedirectUri":"http://localhost:5002/signin-oidc","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9Pyl35ILJkbnB9R1Y6kJu_-nyN8_qL4_Bmo9fijEHW5jIB8gsa0gDPE-J3jZPciOJN5gDJm3D_6Pzg8Fd-1LFwgmpwGKBlyBt85Pd8uF8ANHEoJLg4G2hS_Jsd8pQ0eOg_Vg-NxQ2T0TcRiFEY4ms6q7Msw47fQS6zfmvTn78-HXgMkpy1r7jw2CccENwweekvVv4EUpCyLq3l5Okxg2tKoqYU_USaJl27ydO2YJD-e-bkKdvhEA7_OLtvM4vgljVp63IbxeL2FgDQFRSb5AwN7JWeiuolkdsjaALVocLWaRw","Scope":"openid profile afcpayroll offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-08-12 10:24:12.185 +03:00 [DBG] Augmenting SignInContext
2019-08-12 10:24:12.186 +03:00 [INF] AuthenticationScheme: idsrv signed in.
2019-08-12 10:24:12.501 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-12 10:24:12.503 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-12 10:24:12.504 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-12 10:24:12.504 +03:00 [DBG] Start token request.
2019-08-12 10:24:12.505 +03:00 [DBG] Start client validation
2019-08-12 10:24:12.505 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-12 10:24:12.506 +03:00 [DBG] Start parsing for secret in post body
2019-08-12 10:24:12.507 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-12 10:24:12.507 +03:00 [DBG] Secret id found: mvc
2019-08-12 10:24:12.508 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-12 10:24:12.508 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-12 10:24:12.508 +03:00 [DBG] Client validation success
2019-08-12 10:24:12.509 +03:00 [DBG] Start token request validation
2019-08-12 10:24:12.512 +03:00 [DBG] Start validation of authorization code token request
2019-08-12 10:24:16.007 +03:00 [DBG] Validation of authorization code token request success
2019-08-12 10:24:16.008 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"9a5e426e0b571d594ef7ed52d7733c29aca3fe511d97137ec99efa66c13a3d6f","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"mvc","client_secret":"***REDACTED***","code":"9a5e426e0b571d594ef7ed52d7733c29aca3fe511d97137ec99efa66c13a3d6f","grant_type":"authorization_code","redirect_uri":"http://localhost:5002/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-08-12 10:24:16.013 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-12 10:24:16.014 +03:00 [DBG] Getting claims for access token for client: mvc
2019-08-12 10:24:16.014 +03:00 [DBG] Getting claims for access token for subject: 1
2019-08-12 10:24:16.018 +03:00 [DBG] Creating refresh token
2019-08-12 10:24:16.019 +03:00 [DBG] Setting an absolute lifetime: 2592000
2019-08-12 10:24:18.951 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-12 10:24:18.953 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-12 10:24:18.954 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-12 10:24:18.960 +03:00 [DBG] Token request success.
2019-08-12 10:24:18.970 +03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-08-12 10:24:18.972 +03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-08-12 10:24:18.973 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-08-12 10:24:18.985 +03:00 [DBG] Start userinfo request
2019-08-12 10:24:18.992 +03:00 [DBG] Bearer token found in header
2019-08-12 10:24:19.096 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-12 10:24:19.101 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-12 10:24:19.103 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-08-12 10:24:19.106 +03:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1565594656,"exp":1565594716,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","afcpayroll"],"client_id":"mvc","sub":"1","auth_time":1565594650,"idp":"local","name":"alice","email":"alice@email.com","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-08-12 10:24:19.121 +03:00 [DBG] Creating userinfo response
2019-08-12 10:24:19.128 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-12 10:24:19.134 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-12 10:24:19.139 +03:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-12 10:24:19.140 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-12 10:24:19.141 +03:00 [INF] Profile service returned the following claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-12 10:24:19.142 +03:00 [DBG] End userinfo request
2019-08-12 10:28:05.060 +03:00 [INF] Starting IdentityServer4 version 2.5.0.0
2019-08-12 10:28:05.144 +03:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2019-08-12 10:28:05.146 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for authentication
2019-08-12 10:28:05.147 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-in
2019-08-12 10:28:05.147 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-out
2019-08-12 10:28:05.147 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for challenge
2019-08-12 10:28:05.147 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for forbid
2019-08-12 10:28:22.428 +03:00 [DBG] Login Url: /account/login
2019-08-12 10:28:22.432 +03:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-08-12 10:28:22.435 +03:00 [DBG] Logout Url: /Account/Logout
2019-08-12 10:28:22.435 +03:00 [DBG] ConsentUrl Url: /consent
2019-08-12 10:28:22.435 +03:00 [DBG] Consent Return Url Parameter: returnUrl
2019-08-12 10:28:22.435 +03:00 [DBG] Error Url: /home/error
2019-08-12 10:28:22.436 +03:00 [DBG] Error Id Parameter: errorId
2019-08-12 10:28:22.489 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-12 10:28:22.498 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-12 10:28:22.499 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-12 10:28:22.508 +03:00 [DBG] Start discovery request
2019-08-12 10:28:22.856 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-12 10:28:22.865 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-12 10:28:22.865 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-12 10:28:22.870 +03:00 [DBG] Start key discovery request
2019-08-12 10:28:23.032 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-08-12 10:28:23.056 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-08-12 10:28:23.059 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-08-12 10:28:23.066 +03:00 [DBG] Start authorize request
2019-08-12 10:28:23.087 +03:00 [DBG] No user present in authorize request
2019-08-12 10:28:23.100 +03:00 [DBG] Start authorize request protocol validation
2019-08-12 10:28:23.146 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-12 10:28:23.174 +03:00 [DBG] Checking for PKCE parameters
2019-08-12 10:28:23.179 +03:00 [DBG] No PKCE used.
2019-08-12 10:28:23.255 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-12 10:28:23.293 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/signin-oidc","AllowedRedirectUris":["http://localhost:5002/signin-oidc"],"SubjectId":"anonymous","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9PTpwWns9XkE5vc6ahgwEULzETouBEVKAAhb7EjRliUIvdf_cRlVSItxwLzSQfMINhuCLcl0VbdOq50DvOzEevSbFutnxHMi6MLFQ_nyNtJxTWIe3YDRO4ZrR3RIBu_FcAN558cpNP6-LX5nBOLo1L7jCf0KfCwwkuL4jcoiBSCoddunnokuRvMOEqsPsDgreD3st23iFJUdLy0cwPHB4T9Zlv02Obbd-CJB9t2PxEevZQaYwfguE8VJcm3u_w6WZjlVWIxRZ6GCmCTBIp1-4G9nJxKSkwaveOztHK-bPEneg","UiLocales":null,"Nonce":"637011917029300742.YzVjMGQ3YWQtODdmOC00YzEzLWI4MDktZTdlNThhYTI0NWM3OWU2YjdhMTctY2MwNS00OTZjLWIxZjQtN2NhMzQxYWU4N2Ex","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637011917029300742.YzVjMGQ3YWQtODdmOC00YzEzLWI4MDktZTdlNThhYTI0NWM3OWU2YjdhMTctY2MwNS00OTZjLWIxZjQtN2NhMzQxYWU4N2Ex","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9PTpwWns9XkE5vc6ahgwEULzETouBEVKAAhb7EjRliUIvdf_cRlVSItxwLzSQfMINhuCLcl0VbdOq50DvOzEevSbFutnxHMi6MLFQ_nyNtJxTWIe3YDRO4ZrR3RIBu_FcAN558cpNP6-LX5nBOLo1L7jCf0KfCwwkuL4jcoiBSCoddunnokuRvMOEqsPsDgreD3st23iFJUdLy0cwPHB4T9Zlv02Obbd-CJB9t2PxEevZQaYwfguE8VJcm3u_w6WZjlVWIxRZ6GCmCTBIp1-4G9nJxKSkwaveOztHK-bPEneg","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-12 10:28:23.339 +03:00 [INF] Showing login: User is not authenticated
2019-08-12 10:28:23.643 +03:00 [DBG] Start authorize request protocol validation
2019-08-12 10:28:23.644 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-12 10:28:23.650 +03:00 [DBG] Checking for PKCE parameters
2019-08-12 10:28:23.651 +03:00 [DBG] No PKCE used.
2019-08-12 10:28:23.652 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-12 10:28:23.656 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-12 10:28:28.705 +03:00 [DBG] CORS request made for path: /account/login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-08-12 10:28:28.817 +03:00 [DBG] Start authorize request protocol validation
2019-08-12 10:28:28.819 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-12 10:28:28.821 +03:00 [DBG] Checking for PKCE parameters
2019-08-12 10:28:28.822 +03:00 [DBG] No PKCE used.
2019-08-12 10:28:28.822 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-12 10:28:28.866 +03:00 [DBG] Augmenting SignInContext
2019-08-12 10:28:28.873 +03:00 [DBG] Adding idp claim with value: local
2019-08-12 10:28:28.874 +03:00 [DBG] Adding amr claim with value: pwd
2019-08-12 10:28:28.897 +03:00 [INF] AuthenticationScheme: idsrv signed in.
2019-08-12 10:28:28.902 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-12 10:28:28.922 +03:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-08-12 10:28:28.929 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-08-12 10:28:28.930 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-08-12 10:28:28.942 +03:00 [DBG] Start authorize callback request
2019-08-12 10:28:28.952 +03:00 [DBG] User in authorize request: 1
2019-08-12 10:28:28.953 +03:00 [DBG] Start authorize request protocol validation
2019-08-12 10:28:28.954 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-12 10:28:28.954 +03:00 [DBG] Checking for PKCE parameters
2019-08-12 10:28:28.955 +03:00 [DBG] No PKCE used.
2019-08-12 10:28:28.955 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-12 10:28:28.956 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/signin-oidc","AllowedRedirectUris":["http://localhost:5002/signin-oidc"],"SubjectId":"1","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9PTpwWns9XkE5vc6ahgwEULzETouBEVKAAhb7EjRliUIvdf_cRlVSItxwLzSQfMINhuCLcl0VbdOq50DvOzEevSbFutnxHMi6MLFQ_nyNtJxTWIe3YDRO4ZrR3RIBu_FcAN558cpNP6-LX5nBOLo1L7jCf0KfCwwkuL4jcoiBSCoddunnokuRvMOEqsPsDgreD3st23iFJUdLy0cwPHB4T9Zlv02Obbd-CJB9t2PxEevZQaYwfguE8VJcm3u_w6WZjlVWIxRZ6GCmCTBIp1-4G9nJxKSkwaveOztHK-bPEneg","UiLocales":null,"Nonce":"637011917029300742.YzVjMGQ3YWQtODdmOC00YzEzLWI4MDktZTdlNThhYTI0NWM3OWU2YjdhMTctY2MwNS00OTZjLWIxZjQtN2NhMzQxYWU4N2Ex","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"22adec23b11666b8ab163d17eacf722b","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637011917029300742.YzVjMGQ3YWQtODdmOC00YzEzLWI4MDktZTdlNThhYTI0NWM3OWU2YjdhMTctY2MwNS00OTZjLWIxZjQtN2NhMzQxYWU4N2Ex","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9PTpwWns9XkE5vc6ahgwEULzETouBEVKAAhb7EjRliUIvdf_cRlVSItxwLzSQfMINhuCLcl0VbdOq50DvOzEevSbFutnxHMi6MLFQ_nyNtJxTWIe3YDRO4ZrR3RIBu_FcAN558cpNP6-LX5nBOLo1L7jCf0KfCwwkuL4jcoiBSCoddunnokuRvMOEqsPsDgreD3st23iFJUdLy0cwPHB4T9Zlv02Obbd-CJB9t2PxEevZQaYwfguE8VJcm3u_w6WZjlVWIxRZ6GCmCTBIp1-4G9nJxKSkwaveOztHK-bPEneg","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-12 10:28:28.995 +03:00 [DBG] Client is configured to not require consent, no consent is required
2019-08-12 10:28:29.006 +03:00 [DBG] Creating Hybrid Flow response.
2019-08-12 10:28:29.082 +03:00 [DBG] Creating Implicit Flow response.
2019-08-12 10:28:29.103 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-12 10:28:29.108 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-12 10:28:29.240 +03:00 [DBG] Authorize endpoint response
{"SubjectId":"1","ClientId":"mvc","RedirectUri":"http://localhost:5002/signin-oidc","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9PTpwWns9XkE5vc6ahgwEULzETouBEVKAAhb7EjRliUIvdf_cRlVSItxwLzSQfMINhuCLcl0VbdOq50DvOzEevSbFutnxHMi6MLFQ_nyNtJxTWIe3YDRO4ZrR3RIBu_FcAN558cpNP6-LX5nBOLo1L7jCf0KfCwwkuL4jcoiBSCoddunnokuRvMOEqsPsDgreD3st23iFJUdLy0cwPHB4T9Zlv02Obbd-CJB9t2PxEevZQaYwfguE8VJcm3u_w6WZjlVWIxRZ6GCmCTBIp1-4G9nJxKSkwaveOztHK-bPEneg","Scope":"openid profile afcpayroll offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-08-12 10:28:29.279 +03:00 [DBG] Augmenting SignInContext
2019-08-12 10:28:29.282 +03:00 [INF] AuthenticationScheme: idsrv signed in.
2019-08-12 10:28:29.839 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-12 10:28:29.849 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-12 10:28:29.850 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-12 10:28:29.868 +03:00 [DBG] Start token request.
2019-08-12 10:28:29.880 +03:00 [DBG] Start client validation
2019-08-12 10:28:29.890 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-12 10:28:29.898 +03:00 [DBG] Start parsing for secret in post body
2019-08-12 10:28:29.899 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-12 10:28:29.900 +03:00 [DBG] Secret id found: mvc
2019-08-12 10:28:29.903 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-12 10:28:29.922 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-12 10:28:29.922 +03:00 [DBG] Client validation success
2019-08-12 10:28:29.935 +03:00 [DBG] Start token request validation
2019-08-12 10:28:29.956 +03:00 [DBG] Start validation of authorization code token request
2019-08-12 10:28:29.995 +03:00 [DBG] Validation of authorization code token request success
2019-08-12 10:28:30.000 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"2a53a85b033ad2fd51cf557be11b1d138d3a9df91e35f895be20a1b0e984389e","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"mvc","client_secret":"***REDACTED***","code":"2a53a85b033ad2fd51cf557be11b1d138d3a9df91e35f895be20a1b0e984389e","grant_type":"authorization_code","redirect_uri":"http://localhost:5002/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-08-12 10:28:30.032 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-12 10:28:30.069 +03:00 [DBG] Getting claims for access token for client: mvc
2019-08-12 10:28:30.071 +03:00 [DBG] Getting claims for access token for subject: 1
2019-08-12 10:28:30.098 +03:00 [DBG] Creating refresh token
2019-08-12 10:28:30.098 +03:00 [DBG] Setting an absolute lifetime: 2592000
2019-08-12 10:28:30.132 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-12 10:28:30.138 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-12 10:28:30.139 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-12 10:28:30.148 +03:00 [DBG] Token request success.
2019-08-12 10:28:30.176 +03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-08-12 10:28:30.181 +03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-08-12 10:28:30.181 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-08-12 10:28:30.198 +03:00 [DBG] Start userinfo request
2019-08-12 10:28:30.209 +03:00 [DBG] Bearer token found in header
2019-08-12 10:28:30.339 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-12 10:28:30.350 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-12 10:28:30.352 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-08-12 10:28:30.359 +03:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1565594910,"exp":1565594970,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","afcpayroll"],"client_id":"mvc","sub":"1","auth_time":1565594908,"idp":"local","name":"alice","email":"alice@email.com","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-08-12 10:28:30.379 +03:00 [DBG] Creating userinfo response
2019-08-12 10:28:30.386 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-12 10:28:30.391 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-12 10:28:30.398 +03:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-12 10:28:30.399 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-12 10:28:30.400 +03:00 [INF] Profile service returned the following claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-12 10:28:30.401 +03:00 [DBG] End userinfo request
2019-08-12 10:30:05.189 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-12 10:30:05.196 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-12 10:30:05.202 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-12 10:30:05.213 +03:00 [DBG] Start discovery request
2019-08-12 10:30:05.432 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-12 10:30:05.435 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-12 10:30:05.435 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-12 10:30:05.435 +03:00 [DBG] Start key discovery request
2019-08-12 10:30:05.547 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-08-12 10:30:05.558 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-08-12 10:30:05.559 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-08-12 10:30:05.560 +03:00 [DBG] Start authorize request
2019-08-12 10:30:05.562 +03:00 [DBG] No user present in authorize request
2019-08-12 10:30:05.563 +03:00 [DBG] Start authorize request protocol validation
2019-08-12 10:30:05.564 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-12 10:30:05.570 +03:00 [DBG] Checking for PKCE parameters
2019-08-12 10:30:05.571 +03:00 [DBG] No PKCE used.
2019-08-12 10:30:05.571 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-12 10:30:05.572 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/signin-oidc","AllowedRedirectUris":["http://localhost:5002/signin-oidc"],"SubjectId":"anonymous","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9OsrP55bzGtU5SlLISTmvcY88iD0amsiTfm0RYrO54h4pkcLHlb6W8GHF9O1taPhWDXGLitaAIWE6-c3qxVH0fhi1h_CMpw6TXjg9fNg7KNnEW4im-LvRxHAZhsaLqpUDCBhplQ27gFR50fDWRNCCRppZBGRstD-5IxgMMmP2C7jyekIbQ7jd50-TYonp74D9TIoZiZtdULto5V_Nefapvm2M6YQ8c-OM6wN1Enaxsdo-VMSZ-wzzDbmQaAVhePQSfe1MSMQ106BZV8n6OAw3atUeYGG3kHp2IDAg4GmjyEbg","UiLocales":null,"Nonce":"637011918054660275.ZjlhODEzMDAtMDY0Yy00NjM1LWI2OTctMzQ2MTgwOTZlNzg4MGE3MmNmYmItOTRiZS00Mzg1LTlhY2QtODU3NzBhOWExN2E3","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637011918054660275.ZjlhODEzMDAtMDY0Yy00NjM1LWI2OTctMzQ2MTgwOTZlNzg4MGE3MmNmYmItOTRiZS00Mzg1LTlhY2QtODU3NzBhOWExN2E3","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9OsrP55bzGtU5SlLISTmvcY88iD0amsiTfm0RYrO54h4pkcLHlb6W8GHF9O1taPhWDXGLitaAIWE6-c3qxVH0fhi1h_CMpw6TXjg9fNg7KNnEW4im-LvRxHAZhsaLqpUDCBhplQ27gFR50fDWRNCCRppZBGRstD-5IxgMMmP2C7jyekIbQ7jd50-TYonp74D9TIoZiZtdULto5V_Nefapvm2M6YQ8c-OM6wN1Enaxsdo-VMSZ-wzzDbmQaAVhePQSfe1MSMQ106BZV8n6OAw3atUeYGG3kHp2IDAg4GmjyEbg","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-12 10:30:05.576 +03:00 [INF] Showing login: User is not authenticated
2019-08-12 10:30:05.591 +03:00 [DBG] Start authorize request protocol validation
2019-08-12 10:30:05.591 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-12 10:30:05.592 +03:00 [DBG] Checking for PKCE parameters
2019-08-12 10:30:05.592 +03:00 [DBG] No PKCE used.
2019-08-12 10:30:05.593 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-12 10:30:05.593 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-12 10:30:07.660 +03:00 [DBG] CORS request made for path: /account/login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-08-12 10:30:07.672 +03:00 [DBG] Start authorize request protocol validation
2019-08-12 10:30:07.673 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-12 10:30:07.674 +03:00 [DBG] Checking for PKCE parameters
2019-08-12 10:30:07.675 +03:00 [DBG] No PKCE used.
2019-08-12 10:30:07.675 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-12 10:30:07.676 +03:00 [DBG] Augmenting SignInContext
2019-08-12 10:30:07.676 +03:00 [DBG] Adding idp claim with value: local
2019-08-12 10:30:07.682 +03:00 [DBG] Adding amr claim with value: pwd
2019-08-12 10:30:07.683 +03:00 [INF] AuthenticationScheme: idsrv signed in.
2019-08-12 10:30:07.684 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-12 10:30:07.699 +03:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-08-12 10:30:07.699 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-08-12 10:30:07.700 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-08-12 10:30:07.700 +03:00 [DBG] Start authorize callback request
2019-08-12 10:30:07.701 +03:00 [DBG] User in authorize request: 1
2019-08-12 10:30:07.701 +03:00 [DBG] Start authorize request protocol validation
2019-08-12 10:30:07.701 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-12 10:30:07.702 +03:00 [DBG] Checking for PKCE parameters
2019-08-12 10:30:07.702 +03:00 [DBG] No PKCE used.
2019-08-12 10:30:07.702 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-12 10:30:07.703 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/signin-oidc","AllowedRedirectUris":["http://localhost:5002/signin-oidc"],"SubjectId":"1","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9OsrP55bzGtU5SlLISTmvcY88iD0amsiTfm0RYrO54h4pkcLHlb6W8GHF9O1taPhWDXGLitaAIWE6-c3qxVH0fhi1h_CMpw6TXjg9fNg7KNnEW4im-LvRxHAZhsaLqpUDCBhplQ27gFR50fDWRNCCRppZBGRstD-5IxgMMmP2C7jyekIbQ7jd50-TYonp74D9TIoZiZtdULto5V_Nefapvm2M6YQ8c-OM6wN1Enaxsdo-VMSZ-wzzDbmQaAVhePQSfe1MSMQ106BZV8n6OAw3atUeYGG3kHp2IDAg4GmjyEbg","UiLocales":null,"Nonce":"637011918054660275.ZjlhODEzMDAtMDY0Yy00NjM1LWI2OTctMzQ2MTgwOTZlNzg4MGE3MmNmYmItOTRiZS00Mzg1LTlhY2QtODU3NzBhOWExN2E3","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"dc784e29a59d5dcec6c30bcacac0bfc7","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637011918054660275.ZjlhODEzMDAtMDY0Yy00NjM1LWI2OTctMzQ2MTgwOTZlNzg4MGE3MmNmYmItOTRiZS00Mzg1LTlhY2QtODU3NzBhOWExN2E3","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9OsrP55bzGtU5SlLISTmvcY88iD0amsiTfm0RYrO54h4pkcLHlb6W8GHF9O1taPhWDXGLitaAIWE6-c3qxVH0fhi1h_CMpw6TXjg9fNg7KNnEW4im-LvRxHAZhsaLqpUDCBhplQ27gFR50fDWRNCCRppZBGRstD-5IxgMMmP2C7jyekIbQ7jd50-TYonp74D9TIoZiZtdULto5V_Nefapvm2M6YQ8c-OM6wN1Enaxsdo-VMSZ-wzzDbmQaAVhePQSfe1MSMQ106BZV8n6OAw3atUeYGG3kHp2IDAg4GmjyEbg","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-12 10:30:07.716 +03:00 [DBG] Client is configured to not require consent, no consent is required
2019-08-12 10:30:07.717 +03:00 [DBG] Creating Hybrid Flow response.
2019-08-12 10:30:07.718 +03:00 [DBG] Creating Implicit Flow response.
2019-08-12 10:30:07.718 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-12 10:30:07.719 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-12 10:30:07.724 +03:00 [DBG] Authorize endpoint response
{"SubjectId":"1","ClientId":"mvc","RedirectUri":"http://localhost:5002/signin-oidc","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9OsrP55bzGtU5SlLISTmvcY88iD0amsiTfm0RYrO54h4pkcLHlb6W8GHF9O1taPhWDXGLitaAIWE6-c3qxVH0fhi1h_CMpw6TXjg9fNg7KNnEW4im-LvRxHAZhsaLqpUDCBhplQ27gFR50fDWRNCCRppZBGRstD-5IxgMMmP2C7jyekIbQ7jd50-TYonp74D9TIoZiZtdULto5V_Nefapvm2M6YQ8c-OM6wN1Enaxsdo-VMSZ-wzzDbmQaAVhePQSfe1MSMQ106BZV8n6OAw3atUeYGG3kHp2IDAg4GmjyEbg","Scope":"openid profile afcpayroll offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-08-12 10:30:07.730 +03:00 [DBG] Augmenting SignInContext
2019-08-12 10:30:07.730 +03:00 [INF] AuthenticationScheme: idsrv signed in.
2019-08-12 10:30:08.173 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-12 10:30:08.177 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-12 10:30:08.178 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-12 10:30:08.179 +03:00 [DBG] Start token request.
2019-08-12 10:30:08.179 +03:00 [DBG] Start client validation
2019-08-12 10:30:08.179 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-12 10:30:08.180 +03:00 [DBG] Start parsing for secret in post body
2019-08-12 10:30:08.180 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-12 10:30:08.180 +03:00 [DBG] Secret id found: mvc
2019-08-12 10:30:08.181 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-12 10:30:08.182 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-12 10:30:08.182 +03:00 [DBG] Client validation success
2019-08-12 10:30:08.182 +03:00 [DBG] Start token request validation
2019-08-12 10:30:08.183 +03:00 [DBG] Start validation of authorization code token request
2019-08-12 10:30:08.184 +03:00 [DBG] Validation of authorization code token request success
2019-08-12 10:30:08.185 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"2d6057a4fbc0c2f9f26c6145b516c2d33073e34f935dfad519d2fe6c69e74de6","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"mvc","client_secret":"***REDACTED***","code":"2d6057a4fbc0c2f9f26c6145b516c2d33073e34f935dfad519d2fe6c69e74de6","grant_type":"authorization_code","redirect_uri":"http://localhost:5002/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-08-12 10:30:08.196 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-12 10:30:08.197 +03:00 [DBG] Getting claims for access token for client: mvc
2019-08-12 10:30:08.198 +03:00 [DBG] Getting claims for access token for subject: 1
2019-08-12 10:30:08.202 +03:00 [DBG] Creating refresh token
2019-08-12 10:30:08.202 +03:00 [DBG] Setting an absolute lifetime: 2592000
2019-08-12 10:30:08.212 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-12 10:30:08.213 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-12 10:30:08.213 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-12 10:30:08.218 +03:00 [DBG] Token request success.
2019-08-12 10:30:08.234 +03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-08-12 10:30:08.248 +03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-08-12 10:30:08.251 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-08-12 10:30:08.252 +03:00 [DBG] Start userinfo request
2019-08-12 10:30:08.253 +03:00 [DBG] Bearer token found in header
2019-08-12 10:30:08.265 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-12 10:30:08.266 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-12 10:30:08.270 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-08-12 10:30:08.276 +03:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1565595008,"exp":1565595068,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","afcpayroll"],"client_id":"mvc","sub":"1","auth_time":1565595007,"idp":"local","name":"alice","email":"alice@email.com","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-08-12 10:30:08.281 +03:00 [DBG] Creating userinfo response
2019-08-12 10:30:08.281 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-12 10:30:08.291 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-12 10:30:08.294 +03:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-12 10:30:08.298 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-12 10:30:08.299 +03:00 [INF] Profile service returned the following claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-12 10:30:08.300 +03:00 [DBG] End userinfo request
2019-08-12 10:40:56.402 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-12 10:40:56.409 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-12 10:40:56.413 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-12 10:40:56.414 +03:00 [DBG] Start discovery request
2019-08-12 10:43:36.237 +03:00 [INF] Starting IdentityServer4 version 2.5.0.0
2019-08-12 10:43:36.319 +03:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2019-08-12 10:43:36.324 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for authentication
2019-08-12 10:43:36.325 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-in
2019-08-12 10:43:36.326 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-out
2019-08-12 10:43:36.326 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for challenge
2019-08-12 10:43:36.326 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for forbid
2019-08-12 10:43:56.614 +03:00 [DBG] Login Url: /account/login
2019-08-12 10:43:56.626 +03:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-08-12 10:43:56.627 +03:00 [DBG] Logout Url: /Account/Logout
2019-08-12 10:43:56.627 +03:00 [DBG] ConsentUrl Url: /consent
2019-08-12 10:43:56.628 +03:00 [DBG] Consent Return Url Parameter: returnUrl
2019-08-12 10:43:56.628 +03:00 [DBG] Error Url: /home/error
2019-08-12 10:43:56.629 +03:00 [DBG] Error Id Parameter: errorId
2019-08-12 10:43:56.694 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-12 10:43:56.703 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-12 10:43:56.704 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-12 10:43:56.709 +03:00 [DBG] Start discovery request
2019-08-12 10:43:57.004 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-12 10:43:57.020 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-12 10:43:57.027 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-12 10:43:57.034 +03:00 [DBG] Start key discovery request
2019-08-12 10:43:57.233 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-08-12 10:43:57.257 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-08-12 10:43:57.258 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-08-12 10:43:57.272 +03:00 [DBG] Start authorize request
2019-08-12 10:43:57.291 +03:00 [DBG] No user present in authorize request
2019-08-12 10:43:57.299 +03:00 [DBG] Start authorize request protocol validation
2019-08-12 10:43:57.341 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-12 10:43:57.384 +03:00 [ERR] Invalid redirect_uri: http://localhost:5002/signin-oidc
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":null,"AllowedRedirectUris":["http://localhost:5002/home/signin-oidc"],"SubjectId":"anonymous","ResponseType":null,"ResponseMode":null,"GrantType":null,"RequestedScopes":"","State":null,"UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637011926371000742.NWI2NmJjZjYtMzFlOS00NzI5LWJkOGItMmQxNzQ2NGJiMmJkNDBkODQ2ZGMtNmFmYS00NDk4LWI5NDAtNWVmNGZkMTViMmJk","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9P59_G9TR1aFILaOtMyBdeMv1n4xv5KNSyZlgl5FUeVl9IKUqhJCyQsBxEliOJt-ve_bv_CyUb7NT6UixFPUaVCUm7jN2mfAaLh5FcH948c8-ZPEbG9Ejcodv9FxBlaXlXj7Iposg8lSrzUN7sQXBagJ5V0K_iRUKS9LLJ8KlHBIS01r9VmpJyZihMj-PR_gDCfcvyUpLxAlmfrkYG3zPB4HhH5LFrvCXqA-NyZVR7jy9EDCxz5u68Yn5aS-XCzT85-c1aLKT1V7nAoVVH-d-wYLUqd-i65WrZtt4zng5CrPQ","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-12 10:43:57.413 +03:00 [ERR] Request validation failed
2019-08-12 10:43:57.413 +03:00 [INF] {"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":null,"AllowedRedirectUris":["http://localhost:5002/home/signin-oidc"],"SubjectId":"anonymous","ResponseType":null,"ResponseMode":null,"GrantType":null,"RequestedScopes":"","State":null,"UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637011926371000742.NWI2NmJjZjYtMzFlOS00NzI5LWJkOGItMmQxNzQ2NGJiMmJkNDBkODQ2ZGMtNmFmYS00NDk4LWI5NDAtNWVmNGZkMTViMmJk","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9P59_G9TR1aFILaOtMyBdeMv1n4xv5KNSyZlgl5FUeVl9IKUqhJCyQsBxEliOJt-ve_bv_CyUb7NT6UixFPUaVCUm7jN2mfAaLh5FcH948c8-ZPEbG9Ejcodv9FxBlaXlXj7Iposg8lSrzUN7sQXBagJ5V0K_iRUKS9LLJ8KlHBIS01r9VmpJyZihMj-PR_gDCfcvyUpLxAlmfrkYG3zPB4HhH5LFrvCXqA-NyZVR7jy9EDCxz5u68Yn5aS-XCzT85-c1aLKT1V7nAoVVH-d-wYLUqd-i65WrZtt4zng5CrPQ","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-12 10:44:05.645 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-08-12 10:44:05.656 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-08-12 10:44:05.658 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-08-12 10:44:05.659 +03:00 [DBG] Start authorize request
2019-08-12 10:44:05.660 +03:00 [DBG] No user present in authorize request
2019-08-12 10:44:05.660 +03:00 [DBG] Start authorize request protocol validation
2019-08-12 10:44:05.661 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-12 10:44:05.661 +03:00 [ERR] Invalid redirect_uri: http://localhost:5002/signin-oidc
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":null,"AllowedRedirectUris":["http://localhost:5002/home/signin-oidc"],"SubjectId":"anonymous","ResponseType":null,"ResponseMode":null,"GrantType":null,"RequestedScopes":"","State":null,"UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637011926456168226.MjQ3NWU4MTYtYTYwMC00MWI0LTk2ZDctNThjN2NkODUyMWIxNmMzYjYwOTktNmVmMS00MzNiLTkzOWQtMDc4OTQ1MGFjOTFh","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9Oy7pj6_2NtLLI9KCHJ9P8tUt3CyYHPk9Wr3fp5a4h4jeUKZ2J3Fw7WUpQzgttRIGZs1OVIq8iguoSjYliRfPwK8xm1VGaN85UsI4ule0vZ2_SJ82ZdyYSfPw_QM95UYcoJzPF6Fetivy7yk2DLaUOH4eqU_2x-nSgZVn6rVQdNNqi0Iq1OEi8ZQvHY34_dbjuJI8HkuYpzZtiD6NoFA9we3pz32K2DxS_buTesBjghfS5hbQahgTe4U5Ql_49DMSZHjE850YvpYfUEh8qIf2KBCfF-im1LYACFeg-8HWn52g","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-12 10:44:05.665 +03:00 [ERR] Request validation failed
2019-08-12 10:44:05.666 +03:00 [INF] {"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":null,"AllowedRedirectUris":["http://localhost:5002/home/signin-oidc"],"SubjectId":"anonymous","ResponseType":null,"ResponseMode":null,"GrantType":null,"RequestedScopes":"","State":null,"UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637011926456168226.MjQ3NWU4MTYtYTYwMC00MWI0LTk2ZDctNThjN2NkODUyMWIxNmMzYjYwOTktNmVmMS00MzNiLTkzOWQtMDc4OTQ1MGFjOTFh","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9Oy7pj6_2NtLLI9KCHJ9P8tUt3CyYHPk9Wr3fp5a4h4jeUKZ2J3Fw7WUpQzgttRIGZs1OVIq8iguoSjYliRfPwK8xm1VGaN85UsI4ule0vZ2_SJ82ZdyYSfPw_QM95UYcoJzPF6Fetivy7yk2DLaUOH4eqU_2x-nSgZVn6rVQdNNqi0Iq1OEi8ZQvHY34_dbjuJI8HkuYpzZtiD6NoFA9we3pz32K2DxS_buTesBjghfS5hbQahgTe4U5Ql_49DMSZHjE850YvpYfUEh8qIf2KBCfF-im1LYACFeg-8HWn52g","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-12 10:44:49.226 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-08-12 10:44:49.228 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-08-12 10:44:49.228 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-08-12 10:44:49.229 +03:00 [DBG] Start authorize request
2019-08-12 10:44:49.229 +03:00 [DBG] No user present in authorize request
2019-08-12 10:44:49.230 +03:00 [DBG] Start authorize request protocol validation
2019-08-12 10:44:49.231 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-12 10:44:49.231 +03:00 [ERR] Invalid redirect_uri: http://localhost:5002/signin-oidc
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":null,"AllowedRedirectUris":["http://localhost:5002/home/signin-oidc"],"SubjectId":"anonymous","ResponseType":null,"ResponseMode":null,"GrantType":null,"RequestedScopes":"","State":null,"UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637011926891954437.ZjZhYTM3NWMtNDI2ZS00MDUzLWFlNzctMTA3MzY0YWY0NDY0MWMzMThkNjAtN2U0OS00Njk3LWI2NDItYzZjYmY3MjgzNDhj","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9ONoVpXqFt0mdRfu1vPghjVy05v0227tvbOSnd20hdvHwD1-mvKWroIUY2uMhLoyISHYNJ0ctCtQ95xLI_wh6TSBvidAdqvYnSW5FfGOex6i6E9Am50qxbVkCgPD_N3gL1EC9U8gI3KUC4g3A9RASkijN9GjgRumv-8G2Rgy7TjYD0FLNvtBsmcGzm_O8b1wwdhoYx6HZM9r1obnckruqIvvVgrRpLqIEw6vi6GtlpSlLSK6WXoUB0-0EhLfD0Lv1ugJkyUAodtWrmXDt_WGBWTnrZZAeY0hVYG7o9wtpCymw","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-12 10:44:49.239 +03:00 [ERR] Request validation failed
2019-08-12 10:44:49.240 +03:00 [INF] {"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":null,"AllowedRedirectUris":["http://localhost:5002/home/signin-oidc"],"SubjectId":"anonymous","ResponseType":null,"ResponseMode":null,"GrantType":null,"RequestedScopes":"","State":null,"UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637011926891954437.ZjZhYTM3NWMtNDI2ZS00MDUzLWFlNzctMTA3MzY0YWY0NDY0MWMzMThkNjAtN2U0OS00Njk3LWI2NDItYzZjYmY3MjgzNDhj","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9ONoVpXqFt0mdRfu1vPghjVy05v0227tvbOSnd20hdvHwD1-mvKWroIUY2uMhLoyISHYNJ0ctCtQ95xLI_wh6TSBvidAdqvYnSW5FfGOex6i6E9Am50qxbVkCgPD_N3gL1EC9U8gI3KUC4g3A9RASkijN9GjgRumv-8G2Rgy7TjYD0FLNvtBsmcGzm_O8b1wwdhoYx6HZM9r1obnckruqIvvVgrRpLqIEw6vi6GtlpSlLSK6WXoUB0-0EhLfD0Lv1ugJkyUAodtWrmXDt_WGBWTnrZZAeY0hVYG7o9wtpCymw","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-12 10:53:29.467 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-12 10:53:29.472 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-12 10:53:29.478 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-12 10:53:29.482 +03:00 [DBG] Start discovery request
2019-08-12 10:53:29.767 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-12 10:53:29.768 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-12 10:53:29.770 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-12 10:53:29.772 +03:00 [DBG] Start key discovery request
2019-08-12 10:53:29.919 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-08-12 10:53:29.921 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-08-12 10:53:29.922 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-08-12 10:53:29.923 +03:00 [DBG] Start authorize request
2019-08-12 10:53:29.924 +03:00 [DBG] No user present in authorize request
2019-08-12 10:53:29.924 +03:00 [DBG] Start authorize request protocol validation
2019-08-12 10:53:29.925 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-12 10:53:29.933 +03:00 [DBG] Checking for PKCE parameters
2019-08-12 10:53:29.935 +03:00 [DBG] No PKCE used.
2019-08-12 10:53:29.990 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-12 10:53:29.993 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/home/signin-oidc","AllowedRedirectUris":["http://localhost:5002/home/signin-oidc"],"SubjectId":"anonymous","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9MCHUPtdAg9rb_S7aSL3Xu7v7ohw8axLdRS4rXqmUTOUnQq66-_A1CYUfnPTxS-Fvvo6wzJM1aTzq3QqbrEsAbMFkNnik6pd1wjnz6kLAqwqB78-IcbBX15ztiZxWx2nrWSLuji-PEbwPZXvsf5e6w-xfZwsrOotGWFreycVejogbR2xGf0_gFQQeOp8mxR9N6ZXDQJ3sLgwqBgut-qaJc9zwbF4qMZf6BT4lhRBdqkdvflA0XaTv6RSXYaC2c-0-64_uU8HlKoCVGSWPaPeF07kyZRyGZV7ekb7LJF8lF7CHZO4mPiKdKX9GIRo9s0pYM","UiLocales":null,"Nonce":"637011932098077280.YzhjNGM0ZjYtMGRjZS00OGJmLWIxMTUtNWNhNWM1ZjI0OTNmYTQ4OThlMzYtMTNmNS00MzgyLTg2NTQtYzYxOGM1MDdkMzlm","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/home/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637011932098077280.YzhjNGM0ZjYtMGRjZS00OGJmLWIxMTUtNWNhNWM1ZjI0OTNmYTQ4OThlMzYtMTNmNS00MzgyLTg2NTQtYzYxOGM1MDdkMzlm","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9MCHUPtdAg9rb_S7aSL3Xu7v7ohw8axLdRS4rXqmUTOUnQq66-_A1CYUfnPTxS-Fvvo6wzJM1aTzq3QqbrEsAbMFkNnik6pd1wjnz6kLAqwqB78-IcbBX15ztiZxWx2nrWSLuji-PEbwPZXvsf5e6w-xfZwsrOotGWFreycVejogbR2xGf0_gFQQeOp8mxR9N6ZXDQJ3sLgwqBgut-qaJc9zwbF4qMZf6BT4lhRBdqkdvflA0XaTv6RSXYaC2c-0-64_uU8HlKoCVGSWPaPeF07kyZRyGZV7ekb7LJF8lF7CHZO4mPiKdKX9GIRo9s0pYM","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-12 10:53:30.011 +03:00 [INF] Showing login: User is not authenticated
2019-08-12 10:53:30.069 +03:00 [DBG] Start authorize request protocol validation
2019-08-12 10:53:30.070 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-12 10:53:30.070 +03:00 [DBG] Checking for PKCE parameters
2019-08-12 10:53:30.071 +03:00 [DBG] No PKCE used.
2019-08-12 10:53:30.071 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-12 10:53:30.077 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-12 10:53:38.111 +03:00 [DBG] CORS request made for path: /account/login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-08-12 10:53:38.178 +03:00 [DBG] Start authorize request protocol validation
2019-08-12 10:53:38.196 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-12 10:53:38.197 +03:00 [DBG] Checking for PKCE parameters
2019-08-12 10:53:38.198 +03:00 [DBG] No PKCE used.
2019-08-12 10:53:38.198 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-12 10:53:38.228 +03:00 [DBG] Augmenting SignInContext
2019-08-12 10:53:38.233 +03:00 [DBG] Adding idp claim with value: local
2019-08-12 10:53:38.233 +03:00 [DBG] Adding amr claim with value: pwd
2019-08-12 10:53:38.250 +03:00 [INF] AuthenticationScheme: idsrv signed in.
2019-08-12 10:53:38.253 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-12 10:53:38.270 +03:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-08-12 10:53:38.271 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-08-12 10:53:38.274 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-08-12 10:53:38.286 +03:00 [DBG] Start authorize callback request
2019-08-12 10:53:38.294 +03:00 [DBG] User in authorize request: 1
2019-08-12 10:53:38.294 +03:00 [DBG] Start authorize request protocol validation
2019-08-12 10:53:38.295 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-12 10:53:38.301 +03:00 [DBG] Checking for PKCE parameters
2019-08-12 10:53:38.301 +03:00 [DBG] No PKCE used.
2019-08-12 10:53:38.303 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-12 10:53:38.303 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/home/signin-oidc","AllowedRedirectUris":["http://localhost:5002/home/signin-oidc"],"SubjectId":"1","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9MCHUPtdAg9rb_S7aSL3Xu7v7ohw8axLdRS4rXqmUTOUnQq66-_A1CYUfnPTxS-Fvvo6wzJM1aTzq3QqbrEsAbMFkNnik6pd1wjnz6kLAqwqB78-IcbBX15ztiZxWx2nrWSLuji-PEbwPZXvsf5e6w-xfZwsrOotGWFreycVejogbR2xGf0_gFQQeOp8mxR9N6ZXDQJ3sLgwqBgut-qaJc9zwbF4qMZf6BT4lhRBdqkdvflA0XaTv6RSXYaC2c-0-64_uU8HlKoCVGSWPaPeF07kyZRyGZV7ekb7LJF8lF7CHZO4mPiKdKX9GIRo9s0pYM","UiLocales":null,"Nonce":"637011932098077280.YzhjNGM0ZjYtMGRjZS00OGJmLWIxMTUtNWNhNWM1ZjI0OTNmYTQ4OThlMzYtMTNmNS00MzgyLTg2NTQtYzYxOGM1MDdkMzlm","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"18ae62151ac0560a2c48f69d1570c772","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/home/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637011932098077280.YzhjNGM0ZjYtMGRjZS00OGJmLWIxMTUtNWNhNWM1ZjI0OTNmYTQ4OThlMzYtMTNmNS00MzgyLTg2NTQtYzYxOGM1MDdkMzlm","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9MCHUPtdAg9rb_S7aSL3Xu7v7ohw8axLdRS4rXqmUTOUnQq66-_A1CYUfnPTxS-Fvvo6wzJM1aTzq3QqbrEsAbMFkNnik6pd1wjnz6kLAqwqB78-IcbBX15ztiZxWx2nrWSLuji-PEbwPZXvsf5e6w-xfZwsrOotGWFreycVejogbR2xGf0_gFQQeOp8mxR9N6ZXDQJ3sLgwqBgut-qaJc9zwbF4qMZf6BT4lhRBdqkdvflA0XaTv6RSXYaC2c-0-64_uU8HlKoCVGSWPaPeF07kyZRyGZV7ekb7LJF8lF7CHZO4mPiKdKX9GIRo9s0pYM","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-12 10:53:38.322 +03:00 [DBG] Client is configured to not require consent, no consent is required
2019-08-12 10:53:38.332 +03:00 [DBG] Creating Hybrid Flow response.
2019-08-12 10:53:38.387 +03:00 [DBG] Creating Implicit Flow response.
2019-08-12 10:53:38.403 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-12 10:53:38.406 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-12 10:53:38.508 +03:00 [DBG] Authorize endpoint response
{"SubjectId":"1","ClientId":"mvc","RedirectUri":"http://localhost:5002/home/signin-oidc","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9MCHUPtdAg9rb_S7aSL3Xu7v7ohw8axLdRS4rXqmUTOUnQq66-_A1CYUfnPTxS-Fvvo6wzJM1aTzq3QqbrEsAbMFkNnik6pd1wjnz6kLAqwqB78-IcbBX15ztiZxWx2nrWSLuji-PEbwPZXvsf5e6w-xfZwsrOotGWFreycVejogbR2xGf0_gFQQeOp8mxR9N6ZXDQJ3sLgwqBgut-qaJc9zwbF4qMZf6BT4lhRBdqkdvflA0XaTv6RSXYaC2c-0-64_uU8HlKoCVGSWPaPeF07kyZRyGZV7ekb7LJF8lF7CHZO4mPiKdKX9GIRo9s0pYM","Scope":"openid profile afcpayroll offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-08-12 10:53:38.532 +03:00 [DBG] Augmenting SignInContext
2019-08-12 10:53:38.533 +03:00 [INF] AuthenticationScheme: idsrv signed in.
2019-08-12 10:53:38.957 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-12 10:53:38.968 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-12 10:53:38.969 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-12 10:53:38.980 +03:00 [DBG] Start token request.
2019-08-12 10:53:38.989 +03:00 [DBG] Start client validation
2019-08-12 10:53:38.998 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-12 10:53:39.006 +03:00 [DBG] Start parsing for secret in post body
2019-08-12 10:53:39.007 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-12 10:53:39.012 +03:00 [DBG] Secret id found: mvc
2019-08-12 10:53:39.012 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-12 10:53:39.030 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-12 10:53:39.031 +03:00 [DBG] Client validation success
2019-08-12 10:53:39.039 +03:00 [DBG] Start token request validation
2019-08-12 10:53:39.056 +03:00 [DBG] Start validation of authorization code token request
2019-08-12 10:53:39.082 +03:00 [DBG] Validation of authorization code token request success
2019-08-12 10:53:39.088 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"693379d5b817dbd3f5b4eea40eb0ea883c0dadf689a49d58cdaa6d71d6496c1e","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"mvc","client_secret":"***REDACTED***","code":"693379d5b817dbd3f5b4eea40eb0ea883c0dadf689a49d58cdaa6d71d6496c1e","grant_type":"authorization_code","redirect_uri":"http://localhost:5002/home/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-08-12 10:53:39.118 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-12 10:53:39.144 +03:00 [DBG] Getting claims for access token for client: mvc
2019-08-12 10:53:39.147 +03:00 [DBG] Getting claims for access token for subject: 1
2019-08-12 10:53:39.165 +03:00 [DBG] Creating refresh token
2019-08-12 10:53:39.166 +03:00 [DBG] Setting an absolute lifetime: 2592000
2019-08-12 10:53:39.188 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-12 10:53:39.189 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-12 10:53:39.189 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-12 10:53:39.198 +03:00 [DBG] Token request success.
2019-08-12 10:53:39.220 +03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-08-12 10:53:39.222 +03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-08-12 10:53:39.223 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-08-12 10:53:39.235 +03:00 [DBG] Start userinfo request
2019-08-12 10:53:39.241 +03:00 [DBG] Bearer token found in header
2019-08-12 10:53:39.342 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-12 10:53:39.347 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-12 10:53:39.349 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-08-12 10:53:39.351 +03:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1565596419,"exp":1565596479,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","afcpayroll"],"client_id":"mvc","sub":"1","auth_time":1565596418,"idp":"local","name":"alice","email":"alice@email.com","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-08-12 10:53:39.364 +03:00 [DBG] Creating userinfo response
2019-08-12 10:53:39.371 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-12 10:53:39.375 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-12 10:53:39.379 +03:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-12 10:53:39.380 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-12 10:53:39.380 +03:00 [INF] Profile service returned the following claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-12 10:53:39.381 +03:00 [DBG] End userinfo request
2019-08-20 09:28:47.071 +03:00 [INF] Starting IdentityServer4 version 2.5.0.0
2019-08-20 09:28:47.141 +03:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2019-08-20 09:28:47.142 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for authentication
2019-08-20 09:28:47.143 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-in
2019-08-20 09:28:47.143 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-out
2019-08-20 09:28:47.143 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for challenge
2019-08-20 09:28:47.144 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for forbid
2019-08-20 09:30:27.153 +03:00 [DBG] Login Url: /account/login
2019-08-20 09:30:27.159 +03:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-08-20 09:30:27.161 +03:00 [DBG] Logout Url: /Account/Logout
2019-08-20 09:30:27.161 +03:00 [DBG] ConsentUrl Url: /consent
2019-08-20 09:30:27.162 +03:00 [DBG] Consent Return Url Parameter: returnUrl
2019-08-20 09:30:27.162 +03:00 [DBG] Error Url: /home/error
2019-08-20 09:30:27.163 +03:00 [DBG] Error Id Parameter: errorId
2019-08-20 09:30:27.212 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-20 09:30:27.218 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-20 09:30:27.219 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-20 09:30:27.224 +03:00 [DBG] Start discovery request
2019-08-20 09:30:27.477 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-20 09:30:27.480 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-20 09:30:27.481 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-20 09:30:27.491 +03:00 [DBG] Start key discovery request
2019-08-20 09:30:27.591 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-08-20 09:30:27.633 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-08-20 09:30:27.635 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-08-20 09:30:27.642 +03:00 [DBG] Start authorize request
2019-08-20 09:30:27.657 +03:00 [DBG] No user present in authorize request
2019-08-20 09:30:27.667 +03:00 [DBG] Start authorize request protocol validation
2019-08-20 09:30:27.704 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 09:30:27.729 +03:00 [DBG] Checking for PKCE parameters
2019-08-20 09:30:27.731 +03:00 [DBG] No PKCE used.
2019-08-20 09:30:27.778 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-20 09:30:27.798 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/home/signin-oidc","AllowedRedirectUris":["http://localhost:5002/home/signin-oidc"],"SubjectId":"anonymous","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9Nuvl5YY9q9z8Kdu-BiozxVxRdKjCmO7kSUzT20Lup15Xo3qpFbfpqFU8ZYpJuk7MU6y6HHNxuDbSpHk3oGb-ATUEkE8oz6JsC1A8mxoQ8IdrheZqvUTWNKtuf_LXUhS9WypwciozIaVfXYq0ldm_bWe4quy_i67yyA516WLaKey5LSb9LLIV0Z331zhpDUEy3m6MSN6Qi5gAMFSr3Xfri0cvX9fEKs28GZ2U1OxOTVnNxabs6ulkaScNbbvrtv5P3VuIkZVWAh20a5uSf_dm_A-CZcqFl_x--6l_yMFIv8LC0HNmccGzkv9MqN9UKaELo","UiLocales":null,"Nonce":"637018794275363469.NTUwZGEyMjgtMDMyOS00MTJhLWIwY2ItYzJmODFjOTE0ODMwZmRjNTU0NGEtYThiZC00MTAzLThiYWUtNTYwZDM5MzY4MTBk","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/home/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637018794275363469.NTUwZGEyMjgtMDMyOS00MTJhLWIwY2ItYzJmODFjOTE0ODMwZmRjNTU0NGEtYThiZC00MTAzLThiYWUtNTYwZDM5MzY4MTBk","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9Nuvl5YY9q9z8Kdu-BiozxVxRdKjCmO7kSUzT20Lup15Xo3qpFbfpqFU8ZYpJuk7MU6y6HHNxuDbSpHk3oGb-ATUEkE8oz6JsC1A8mxoQ8IdrheZqvUTWNKtuf_LXUhS9WypwciozIaVfXYq0ldm_bWe4quy_i67yyA516WLaKey5LSb9LLIV0Z331zhpDUEy3m6MSN6Qi5gAMFSr3Xfri0cvX9fEKs28GZ2U1OxOTVnNxabs6ulkaScNbbvrtv5P3VuIkZVWAh20a5uSf_dm_A-CZcqFl_x--6l_yMFIv8LC0HNmccGzkv9MqN9UKaELo","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-20 09:30:27.838 +03:00 [INF] Showing login: User is not authenticated
2019-08-20 09:30:28.190 +03:00 [DBG] Start authorize request protocol validation
2019-08-20 09:30:28.198 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 09:30:28.202 +03:00 [DBG] Checking for PKCE parameters
2019-08-20 09:30:28.207 +03:00 [DBG] No PKCE used.
2019-08-20 09:30:28.213 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-20 09:30:28.219 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 09:30:28.746 +03:00 [DBG] Start authorize request protocol validation
2019-08-20 09:30:28.842 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 09:30:29.137 +03:00 [DBG] Checking for PKCE parameters
2019-08-20 09:30:29.266 +03:00 [DBG] No PKCE used.
2019-08-20 09:30:29.368 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-20 09:30:29.445 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 09:30:33.716 +03:00 [DBG] CORS request made for path: /account/login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-08-20 09:30:33.768 +03:00 [DBG] Start authorize request protocol validation
2019-08-20 09:30:33.769 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 09:30:33.770 +03:00 [DBG] Checking for PKCE parameters
2019-08-20 09:30:33.770 +03:00 [DBG] No PKCE used.
2019-08-20 09:30:33.771 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-20 09:30:33.801 +03:00 [DBG] Augmenting SignInContext
2019-08-20 09:30:33.805 +03:00 [DBG] Adding idp claim with value: local
2019-08-20 09:30:33.808 +03:00 [DBG] Adding amr claim with value: pwd
2019-08-20 09:30:33.822 +03:00 [INF] AuthenticationScheme: idsrv signed in.
2019-08-20 09:30:33.829 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 09:30:33.844 +03:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-08-20 09:30:33.849 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-08-20 09:30:33.850 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-08-20 09:30:33.863 +03:00 [DBG] Start authorize callback request
2019-08-20 09:30:33.870 +03:00 [DBG] User in authorize request: 1
2019-08-20 09:30:33.886 +03:00 [DBG] Start authorize request protocol validation
2019-08-20 09:30:33.887 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 09:30:33.888 +03:00 [DBG] Checking for PKCE parameters
2019-08-20 09:30:33.888 +03:00 [DBG] No PKCE used.
2019-08-20 09:30:33.889 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-20 09:30:33.890 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/home/signin-oidc","AllowedRedirectUris":["http://localhost:5002/home/signin-oidc"],"SubjectId":"1","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9Nuvl5YY9q9z8Kdu-BiozxVxRdKjCmO7kSUzT20Lup15Xo3qpFbfpqFU8ZYpJuk7MU6y6HHNxuDbSpHk3oGb-ATUEkE8oz6JsC1A8mxoQ8IdrheZqvUTWNKtuf_LXUhS9WypwciozIaVfXYq0ldm_bWe4quy_i67yyA516WLaKey5LSb9LLIV0Z331zhpDUEy3m6MSN6Qi5gAMFSr3Xfri0cvX9fEKs28GZ2U1OxOTVnNxabs6ulkaScNbbvrtv5P3VuIkZVWAh20a5uSf_dm_A-CZcqFl_x--6l_yMFIv8LC0HNmccGzkv9MqN9UKaELo","UiLocales":null,"Nonce":"637018794275363469.NTUwZGEyMjgtMDMyOS00MTJhLWIwY2ItYzJmODFjOTE0ODMwZmRjNTU0NGEtYThiZC00MTAzLThiYWUtNTYwZDM5MzY4MTBk","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"f5046b455b245dd5469ce0d58728f170","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/home/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637018794275363469.NTUwZGEyMjgtMDMyOS00MTJhLWIwY2ItYzJmODFjOTE0ODMwZmRjNTU0NGEtYThiZC00MTAzLThiYWUtNTYwZDM5MzY4MTBk","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9Nuvl5YY9q9z8Kdu-BiozxVxRdKjCmO7kSUzT20Lup15Xo3qpFbfpqFU8ZYpJuk7MU6y6HHNxuDbSpHk3oGb-ATUEkE8oz6JsC1A8mxoQ8IdrheZqvUTWNKtuf_LXUhS9WypwciozIaVfXYq0ldm_bWe4quy_i67yyA516WLaKey5LSb9LLIV0Z331zhpDUEy3m6MSN6Qi5gAMFSr3Xfri0cvX9fEKs28GZ2U1OxOTVnNxabs6ulkaScNbbvrtv5P3VuIkZVWAh20a5uSf_dm_A-CZcqFl_x--6l_yMFIv8LC0HNmccGzkv9MqN9UKaELo","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-20 09:30:33.918 +03:00 [DBG] Client is configured to not require consent, no consent is required
2019-08-20 09:30:33.925 +03:00 [DBG] Creating Hybrid Flow response.
2019-08-20 09:30:33.955 +03:00 [DBG] Creating Implicit Flow response.
2019-08-20 09:30:33.967 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 09:30:33.970 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 09:30:34.051 +03:00 [DBG] Authorize endpoint response
{"SubjectId":"1","ClientId":"mvc","RedirectUri":"http://localhost:5002/home/signin-oidc","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9Nuvl5YY9q9z8Kdu-BiozxVxRdKjCmO7kSUzT20Lup15Xo3qpFbfpqFU8ZYpJuk7MU6y6HHNxuDbSpHk3oGb-ATUEkE8oz6JsC1A8mxoQ8IdrheZqvUTWNKtuf_LXUhS9WypwciozIaVfXYq0ldm_bWe4quy_i67yyA516WLaKey5LSb9LLIV0Z331zhpDUEy3m6MSN6Qi5gAMFSr3Xfri0cvX9fEKs28GZ2U1OxOTVnNxabs6ulkaScNbbvrtv5P3VuIkZVWAh20a5uSf_dm_A-CZcqFl_x--6l_yMFIv8LC0HNmccGzkv9MqN9UKaELo","Scope":"openid profile afcpayroll offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-08-20 09:30:34.072 +03:00 [DBG] Augmenting SignInContext
2019-08-20 09:30:34.074 +03:00 [INF] AuthenticationScheme: idsrv signed in.
2019-08-20 09:30:34.387 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-20 09:30:34.397 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-20 09:30:34.399 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-20 09:30:34.413 +03:00 [DBG] Start token request.
2019-08-20 09:30:34.421 +03:00 [DBG] Start client validation
2019-08-20 09:30:34.430 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-20 09:30:34.436 +03:00 [DBG] Start parsing for secret in post body
2019-08-20 09:30:34.437 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-20 09:30:34.438 +03:00 [DBG] Secret id found: mvc
2019-08-20 09:30:34.439 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 09:30:34.455 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-20 09:30:34.456 +03:00 [DBG] Client validation success
2019-08-20 09:30:34.464 +03:00 [DBG] Start token request validation
2019-08-20 09:30:34.480 +03:00 [DBG] Start validation of authorization code token request
2019-08-20 09:30:34.497 +03:00 [DBG] Validation of authorization code token request success
2019-08-20 09:30:34.503 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"2f4b099e566aa91fbd8ee00ff0310468dbc752d4759608648df96a420c2b0ed8","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"mvc","client_secret":"***REDACTED***","code":"2f4b099e566aa91fbd8ee00ff0310468dbc752d4759608648df96a420c2b0ed8","grant_type":"authorization_code","redirect_uri":"http://localhost:5002/home/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-08-20 09:30:34.531 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 09:30:34.546 +03:00 [DBG] Getting claims for access token for client: mvc
2019-08-20 09:30:34.547 +03:00 [DBG] Getting claims for access token for subject: 1
2019-08-20 09:30:34.560 +03:00 [DBG] Creating refresh token
2019-08-20 09:30:34.561 +03:00 [DBG] Setting an absolute lifetime: 2592000
2019-08-20 09:30:34.575 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 09:30:34.576 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 09:30:34.577 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 09:30:34.586 +03:00 [DBG] Token request success.
2019-08-20 09:30:34.607 +03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-08-20 09:30:34.611 +03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-08-20 09:30:34.612 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-08-20 09:30:34.628 +03:00 [DBG] Start userinfo request
2019-08-20 09:30:34.636 +03:00 [DBG] Bearer token found in header
2019-08-20 09:30:34.719 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 09:30:34.724 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 09:30:34.726 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-08-20 09:30:34.730 +03:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1566282634,"exp":1566282694,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","afcpayroll"],"client_id":"mvc","sub":"1","auth_time":1566282633,"idp":"local","name":"alice","email":"alice@email.com","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-08-20 09:30:34.744 +03:00 [DBG] Creating userinfo response
2019-08-20 09:30:34.749 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 09:30:34.753 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 09:30:34.756 +03:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 09:30:34.758 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 09:30:34.760 +03:00 [INF] Profile service returned the following claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 09:30:34.762 +03:00 [DBG] End userinfo request
2019-08-20 09:31:59.879 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-20 09:31:59.881 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-20 09:31:59.882 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-20 09:31:59.883 +03:00 [DBG] Start discovery request
2019-08-20 09:31:59.893 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-20 09:31:59.895 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-20 09:31:59.896 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-20 09:31:59.897 +03:00 [DBG] Start key discovery request
2019-08-20 09:31:59.919 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-20 09:31:59.921 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-20 09:31:59.923 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-20 09:31:59.925 +03:00 [DBG] Start token request.
2019-08-20 09:31:59.926 +03:00 [DBG] Start client validation
2019-08-20 09:31:59.927 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-20 09:31:59.927 +03:00 [DBG] Start parsing for secret in post body
2019-08-20 09:31:59.928 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-20 09:31:59.929 +03:00 [DBG] Secret id found: mvc
2019-08-20 09:31:59.930 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 09:31:59.931 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-20 09:31:59.931 +03:00 [DBG] Client validation success
2019-08-20 09:31:59.932 +03:00 [DBG] Start token request validation
2019-08-20 09:31:59.936 +03:00 [DBG] Start validation of refresh token request
2019-08-20 09:31:59.960 +03:00 [DBG] Token validation success
{"ClientId":"mvc","ClientName":"MVC Client","ValidateLifetime":false,"AccessTokenType":null,"ExpectedScope":null,"TokenHandle":null,"JwtId":null,"Claims":{"sub":"1","client_id":"mvc","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"auth_time":1566282633,"idp":"local","amr":"pwd","name":"alice","email":"alice@email.com"},"$type":"TokenValidationLog"}
2019-08-20 09:31:59.964 +03:00 [DBG] Validation of refresh token request success
2019-08-20 09:31:59.965 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"refresh_token","Scopes":null,"AuthorizationCode":null,"RefreshToken":"ce9a8b0c655db1f288abe3bdc0fa78353a50cfc98890b937f721e08aa2555899","UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"refresh_token","refresh_token":"***REDACTED***","client_id":"mvc","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2019-08-20 09:31:59.987 +03:00 [DBG] Updating refresh token
2019-08-20 09:31:59.988 +03:00 [DBG] Token usage is one-time only. Generating new handle
2019-08-20 09:31:59.990 +03:00 [DBG] Created refresh token in store
2019-08-20 09:31:59.995 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 09:31:59.996 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 09:32:00.001 +03:00 [DBG] Token request success.
2019-08-20 09:35:11.946 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-20 09:35:11.949 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-20 09:35:11.950 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-20 09:35:11.951 +03:00 [DBG] Start discovery request
2019-08-20 09:35:11.956 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-20 09:35:11.957 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-20 09:35:11.959 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-20 09:35:11.960 +03:00 [DBG] Start key discovery request
2019-08-20 09:35:11.963 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-20 09:35:11.964 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-20 09:35:11.965 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-20 09:35:11.968 +03:00 [DBG] Start token request.
2019-08-20 09:35:11.969 +03:00 [DBG] Start client validation
2019-08-20 09:35:11.969 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-20 09:35:11.970 +03:00 [DBG] Start parsing for secret in post body
2019-08-20 09:35:11.971 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-20 09:35:11.971 +03:00 [DBG] Secret id found: mvc
2019-08-20 09:35:11.972 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 09:35:11.974 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-20 09:35:11.974 +03:00 [DBG] Client validation success
2019-08-20 09:35:11.975 +03:00 [DBG] Start token request validation
2019-08-20 09:35:11.976 +03:00 [DBG] Start validation of refresh token request
2019-08-20 09:35:11.978 +03:00 [DBG] Token validation success
{"ClientId":"mvc","ClientName":"MVC Client","ValidateLifetime":false,"AccessTokenType":null,"ExpectedScope":null,"TokenHandle":null,"JwtId":null,"Claims":{"sub":"1","client_id":"mvc","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"auth_time":1566282633,"idp":"local","amr":"pwd","name":"alice","email":"alice@email.com"},"$type":"TokenValidationLog"}
2019-08-20 09:35:11.983 +03:00 [DBG] Validation of refresh token request success
2019-08-20 09:35:11.985 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"refresh_token","Scopes":null,"AuthorizationCode":null,"RefreshToken":"0574108b5929305099ffcbaf9531a36ddf1896ee5eb9f399b5e5eeeaf1d84524","UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"refresh_token","refresh_token":"***REDACTED***","client_id":"mvc","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2019-08-20 09:35:11.994 +03:00 [DBG] Updating refresh token
2019-08-20 09:35:11.994 +03:00 [DBG] Token usage is one-time only. Generating new handle
2019-08-20 09:35:11.996 +03:00 [DBG] Created refresh token in store
2019-08-20 09:35:11.997 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 09:35:11.998 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 09:35:12.003 +03:00 [DBG] Token request success.
2019-08-20 09:38:33.110 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-20 09:38:33.112 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-20 09:38:33.113 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-20 09:38:33.114 +03:00 [DBG] Start discovery request
2019-08-20 09:38:33.117 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-20 09:38:33.118 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-20 09:38:33.123 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-20 09:38:33.124 +03:00 [DBG] Start key discovery request
2019-08-20 09:38:33.127 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-20 09:38:33.128 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-20 09:38:33.129 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-20 09:38:33.131 +03:00 [DBG] Start token request.
2019-08-20 09:38:33.134 +03:00 [DBG] Start client validation
2019-08-20 09:38:33.135 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-20 09:38:33.135 +03:00 [DBG] Start parsing for secret in post body
2019-08-20 09:38:33.136 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-20 09:38:33.137 +03:00 [DBG] Secret id found: mvc
2019-08-20 09:38:33.137 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 09:38:33.139 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-20 09:38:33.139 +03:00 [DBG] Client validation success
2019-08-20 09:38:33.140 +03:00 [DBG] Start token request validation
2019-08-20 09:38:33.140 +03:00 [DBG] Start validation of refresh token request
2019-08-20 09:38:33.141 +03:00 [DBG] Token validation success
{"ClientId":"mvc","ClientName":"MVC Client","ValidateLifetime":false,"AccessTokenType":null,"ExpectedScope":null,"TokenHandle":null,"JwtId":null,"Claims":{"sub":"1","client_id":"mvc","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"auth_time":1566282633,"idp":"local","amr":"pwd","name":"alice","email":"alice@email.com"},"$type":"TokenValidationLog"}
2019-08-20 09:38:33.145 +03:00 [DBG] Validation of refresh token request success
2019-08-20 09:38:33.146 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"refresh_token","Scopes":null,"AuthorizationCode":null,"RefreshToken":"ba7336ca5c155195e22bb2fcbe3df3b2d37bbebdebf0a44a235e3a7c14bbaf00","UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"refresh_token","refresh_token":"***REDACTED***","client_id":"mvc","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2019-08-20 09:38:33.159 +03:00 [DBG] Updating refresh token
2019-08-20 09:38:33.159 +03:00 [DBG] Token usage is one-time only. Generating new handle
2019-08-20 09:38:33.160 +03:00 [DBG] Created refresh token in store
2019-08-20 09:38:33.161 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 09:38:33.162 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 09:38:33.167 +03:00 [DBG] Token request success.
2019-08-20 09:39:16.902 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-20 09:39:16.905 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-20 09:39:16.906 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-20 09:39:16.908 +03:00 [DBG] Start discovery request
2019-08-20 09:39:16.911 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-20 09:39:16.912 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-20 09:39:16.913 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-20 09:39:16.914 +03:00 [DBG] Start key discovery request
2019-08-20 09:39:16.917 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-20 09:39:16.923 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-20 09:39:16.924 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-20 09:39:16.925 +03:00 [DBG] Start token request.
2019-08-20 09:39:16.927 +03:00 [DBG] Start client validation
2019-08-20 09:39:16.928 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-20 09:39:16.930 +03:00 [DBG] Start parsing for secret in post body
2019-08-20 09:39:16.932 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-20 09:39:16.932 +03:00 [DBG] Secret id found: mvc
2019-08-20 09:39:16.933 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 09:39:16.934 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-20 09:39:16.935 +03:00 [DBG] Client validation success
2019-08-20 09:39:16.937 +03:00 [DBG] Start token request validation
2019-08-20 09:39:16.938 +03:00 [DBG] Start validation of refresh token request
2019-08-20 09:39:16.939 +03:00 [DBG] Token validation success
{"ClientId":"mvc","ClientName":"MVC Client","ValidateLifetime":false,"AccessTokenType":null,"ExpectedScope":null,"TokenHandle":null,"JwtId":null,"Claims":{"sub":"1","client_id":"mvc","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"auth_time":1566282633,"idp":"local","amr":"pwd","name":"alice","email":"alice@email.com"},"$type":"TokenValidationLog"}
2019-08-20 09:39:16.949 +03:00 [DBG] Validation of refresh token request success
2019-08-20 09:39:16.951 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"refresh_token","Scopes":null,"AuthorizationCode":null,"RefreshToken":"b76a9e12b3bbe548e4d8392ec1f7365928fbbee8da5c2776cd3cff02d25487c8","UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"refresh_token","refresh_token":"***REDACTED***","client_id":"mvc","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2019-08-20 09:39:16.964 +03:00 [DBG] Updating refresh token
2019-08-20 09:39:16.965 +03:00 [DBG] Token usage is one-time only. Generating new handle
2019-08-20 09:39:16.966 +03:00 [DBG] Created refresh token in store
2019-08-20 09:39:16.967 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 09:39:16.967 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 09:39:16.973 +03:00 [DBG] Token request success.
2019-08-20 09:48:00.941 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-20 09:48:00.944 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-20 09:48:00.949 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-20 09:48:00.950 +03:00 [DBG] Start discovery request
2019-08-20 09:48:00.955 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-20 09:48:00.956 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-20 09:48:00.957 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-20 09:48:00.959 +03:00 [DBG] Start key discovery request
2019-08-20 09:48:00.962 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-20 09:48:00.963 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-20 09:48:00.964 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-20 09:48:00.967 +03:00 [DBG] Start token request.
2019-08-20 09:48:00.968 +03:00 [DBG] Start client validation
2019-08-20 09:48:00.969 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-20 09:48:00.969 +03:00 [DBG] Start parsing for secret in post body
2019-08-20 09:48:00.970 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-20 09:48:00.971 +03:00 [DBG] Secret id found: mvc
2019-08-20 09:48:00.971 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 09:48:00.975 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-20 09:48:00.975 +03:00 [DBG] Client validation success
2019-08-20 09:48:00.976 +03:00 [DBG] Start token request validation
2019-08-20 09:48:00.977 +03:00 [DBG] Start validation of refresh token request
2019-08-20 09:48:00.978 +03:00 [DBG] Token validation success
{"ClientId":"mvc","ClientName":"MVC Client","ValidateLifetime":false,"AccessTokenType":null,"ExpectedScope":null,"TokenHandle":null,"JwtId":null,"Claims":{"sub":"1","client_id":"mvc","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"auth_time":1566282633,"idp":"local","amr":"pwd","name":"alice","email":"alice@email.com"},"$type":"TokenValidationLog"}
2019-08-20 09:48:00.983 +03:00 [DBG] Validation of refresh token request success
2019-08-20 09:48:00.984 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"refresh_token","Scopes":null,"AuthorizationCode":null,"RefreshToken":"4e6b2d388376f11eca7727c9982d8f65229e200651524de9f83339e139923720","UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"refresh_token","refresh_token":"***REDACTED***","client_id":"mvc","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2019-08-20 09:48:00.992 +03:00 [DBG] Updating refresh token
2019-08-20 09:48:00.993 +03:00 [DBG] Token usage is one-time only. Generating new handle
2019-08-20 09:48:00.994 +03:00 [DBG] Created refresh token in store
2019-08-20 09:48:00.995 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 09:48:00.997 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 09:48:01.003 +03:00 [DBG] Token request success.
2019-08-20 10:01:10.353 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-20 10:01:10.357 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-20 10:01:10.358 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-20 10:01:10.359 +03:00 [DBG] Start discovery request
2019-08-20 10:01:10.394 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-20 10:01:10.395 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-20 10:01:10.396 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-20 10:01:10.397 +03:00 [DBG] Start key discovery request
2019-08-20 10:01:14.789 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-20 10:01:14.791 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-20 10:01:14.792 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-20 10:01:14.793 +03:00 [DBG] Start token request.
2019-08-20 10:01:14.794 +03:00 [DBG] Start client validation
2019-08-20 10:01:14.795 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-20 10:01:14.795 +03:00 [DBG] Start parsing for secret in post body
2019-08-20 10:01:14.796 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-20 10:01:14.797 +03:00 [DBG] Secret id found: mvc
2019-08-20 10:01:14.798 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 10:01:14.799 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-20 10:01:14.800 +03:00 [DBG] Client validation success
2019-08-20 10:01:14.800 +03:00 [DBG] Start token request validation
2019-08-20 10:01:14.801 +03:00 [DBG] Start validation of refresh token request
2019-08-20 10:01:14.802 +03:00 [DBG] Token validation success
{"ClientId":"mvc","ClientName":"MVC Client","ValidateLifetime":false,"AccessTokenType":null,"ExpectedScope":null,"TokenHandle":null,"JwtId":null,"Claims":{"sub":"1","client_id":"mvc","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"auth_time":1566282633,"idp":"local","amr":"pwd","name":"alice","email":"alice@email.com"},"$type":"TokenValidationLog"}
2019-08-20 10:01:14.809 +03:00 [DBG] Validation of refresh token request success
2019-08-20 10:01:14.810 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"refresh_token","Scopes":null,"AuthorizationCode":null,"RefreshToken":"470187a1ab059638ad216748b6b8904bcbd6762643475ec4d6f3179d387cf35d","UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"refresh_token","refresh_token":"***REDACTED***","client_id":"mvc","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2019-08-20 10:01:14.817 +03:00 [DBG] Updating refresh token
2019-08-20 10:01:14.819 +03:00 [DBG] Token usage is one-time only. Generating new handle
2019-08-20 10:01:14.821 +03:00 [DBG] Created refresh token in store
2019-08-20 10:01:14.821 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 10:01:14.822 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 10:01:14.827 +03:00 [DBG] Token request success.
2019-08-20 10:06:00.211 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-20 10:06:00.214 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-20 10:06:00.215 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-20 10:06:00.216 +03:00 [DBG] Start discovery request
2019-08-20 10:06:00.336 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-20 10:06:00.338 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-20 10:06:00.339 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-20 10:06:00.340 +03:00 [DBG] Start key discovery request
2019-08-20 10:06:00.450 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-08-20 10:06:00.452 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-08-20 10:06:00.453 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-08-20 10:06:00.455 +03:00 [DBG] Start authorize request
2019-08-20 10:06:00.456 +03:00 [DBG] No user present in authorize request
2019-08-20 10:06:00.457 +03:00 [DBG] Start authorize request protocol validation
2019-08-20 10:06:00.458 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 10:06:00.459 +03:00 [DBG] Checking for PKCE parameters
2019-08-20 10:06:00.460 +03:00 [DBG] No PKCE used.
2019-08-20 10:06:00.462 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-20 10:06:00.463 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/home/signin-oidc","AllowedRedirectUris":["http://localhost:5002/home/signin-oidc"],"SubjectId":"anonymous","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9PMPmCoRsBIkMuFzwHn90PmxmeOnAlVYG1pw017QwDd1BG1m3Br_tD4CcGUW7fZNAm1HWBBRkeEH5aEEMVTKIDnCNaCig3OhWW4G2M3kb6l0Eq7gCltbDMGzXTygYZt6UrhfY-E_xshnkxUADJl3cqEU4-goKj-1pWSgb237ZlU7LBeKgTZG9GW2Tqp9imAu6MwL5QOF8b9GYq_5vSm-zp_XvjcH4MdqOdZjsIMGi9zeU53ydanKU373hE9sQ9NNauA-EXX5Sdquy4Kbq8qT8JmS1F4E8uoBhEn5Jzk9_WGtn6QsrgXETNNltrZ9Ft5W6k","UiLocales":null,"Nonce":"637018815603615092.NTZkNTBkODAtZDBmNS00ZmNlLTkwOGYtZjkwNTJjZjhkNWIyZDRhMjhmNTQtM2M2Mi00ZDcxLWE0ODAtNzBhYWNkMzk4NWVh","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/home/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637018815603615092.NTZkNTBkODAtZDBmNS00ZmNlLTkwOGYtZjkwNTJjZjhkNWIyZDRhMjhmNTQtM2M2Mi00ZDcxLWE0ODAtNzBhYWNkMzk4NWVh","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9PMPmCoRsBIkMuFzwHn90PmxmeOnAlVYG1pw017QwDd1BG1m3Br_tD4CcGUW7fZNAm1HWBBRkeEH5aEEMVTKIDnCNaCig3OhWW4G2M3kb6l0Eq7gCltbDMGzXTygYZt6UrhfY-E_xshnkxUADJl3cqEU4-goKj-1pWSgb237ZlU7LBeKgTZG9GW2Tqp9imAu6MwL5QOF8b9GYq_5vSm-zp_XvjcH4MdqOdZjsIMGi9zeU53ydanKU373hE9sQ9NNauA-EXX5Sdquy4Kbq8qT8JmS1F4E8uoBhEn5Jzk9_WGtn6QsrgXETNNltrZ9Ft5W6k","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-20 10:06:00.473 +03:00 [INF] Showing login: User is not authenticated
2019-08-20 10:06:00.486 +03:00 [DBG] Start authorize request protocol validation
2019-08-20 10:06:00.487 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 10:06:00.491 +03:00 [DBG] Checking for PKCE parameters
2019-08-20 10:06:00.491 +03:00 [DBG] No PKCE used.
2019-08-20 10:06:00.492 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-20 10:06:00.493 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 10:06:05.390 +03:00 [DBG] CORS request made for path: /account/login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-08-20 10:06:05.395 +03:00 [DBG] Start authorize request protocol validation
2019-08-20 10:06:05.397 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 10:06:05.398 +03:00 [DBG] Checking for PKCE parameters
2019-08-20 10:06:05.399 +03:00 [DBG] No PKCE used.
2019-08-20 10:06:05.400 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-20 10:06:05.401 +03:00 [DBG] Augmenting SignInContext
2019-08-20 10:06:05.401 +03:00 [DBG] Adding idp claim with value: local
2019-08-20 10:06:05.402 +03:00 [DBG] Adding amr claim with value: pwd
2019-08-20 10:06:05.404 +03:00 [INF] AuthenticationScheme: idsrv signed in.
2019-08-20 10:06:05.405 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 10:06:05.421 +03:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-08-20 10:06:05.424 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-08-20 10:06:05.427 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-08-20 10:06:05.429 +03:00 [DBG] Start authorize callback request
2019-08-20 10:06:05.430 +03:00 [DBG] User in authorize request: 1
2019-08-20 10:06:05.432 +03:00 [DBG] Start authorize request protocol validation
2019-08-20 10:06:05.434 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 10:06:05.435 +03:00 [DBG] Checking for PKCE parameters
2019-08-20 10:06:05.436 +03:00 [DBG] No PKCE used.
2019-08-20 10:06:05.437 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-20 10:06:05.438 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/home/signin-oidc","AllowedRedirectUris":["http://localhost:5002/home/signin-oidc"],"SubjectId":"1","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9PMPmCoRsBIkMuFzwHn90PmxmeOnAlVYG1pw017QwDd1BG1m3Br_tD4CcGUW7fZNAm1HWBBRkeEH5aEEMVTKIDnCNaCig3OhWW4G2M3kb6l0Eq7gCltbDMGzXTygYZt6UrhfY-E_xshnkxUADJl3cqEU4-goKj-1pWSgb237ZlU7LBeKgTZG9GW2Tqp9imAu6MwL5QOF8b9GYq_5vSm-zp_XvjcH4MdqOdZjsIMGi9zeU53ydanKU373hE9sQ9NNauA-EXX5Sdquy4Kbq8qT8JmS1F4E8uoBhEn5Jzk9_WGtn6QsrgXETNNltrZ9Ft5W6k","UiLocales":null,"Nonce":"637018815603615092.NTZkNTBkODAtZDBmNS00ZmNlLTkwOGYtZjkwNTJjZjhkNWIyZDRhMjhmNTQtM2M2Mi00ZDcxLWE0ODAtNzBhYWNkMzk4NWVh","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"a8f9d7f335b51fbe093e25ae50fcb6da","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/home/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637018815603615092.NTZkNTBkODAtZDBmNS00ZmNlLTkwOGYtZjkwNTJjZjhkNWIyZDRhMjhmNTQtM2M2Mi00ZDcxLWE0ODAtNzBhYWNkMzk4NWVh","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9PMPmCoRsBIkMuFzwHn90PmxmeOnAlVYG1pw017QwDd1BG1m3Br_tD4CcGUW7fZNAm1HWBBRkeEH5aEEMVTKIDnCNaCig3OhWW4G2M3kb6l0Eq7gCltbDMGzXTygYZt6UrhfY-E_xshnkxUADJl3cqEU4-goKj-1pWSgb237ZlU7LBeKgTZG9GW2Tqp9imAu6MwL5QOF8b9GYq_5vSm-zp_XvjcH4MdqOdZjsIMGi9zeU53ydanKU373hE9sQ9NNauA-EXX5Sdquy4Kbq8qT8JmS1F4E8uoBhEn5Jzk9_WGtn6QsrgXETNNltrZ9Ft5W6k","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-20 10:06:05.452 +03:00 [DBG] Client is configured to not require consent, no consent is required
2019-08-20 10:06:05.453 +03:00 [DBG] Creating Hybrid Flow response.
2019-08-20 10:06:05.454 +03:00 [DBG] Creating Implicit Flow response.
2019-08-20 10:06:05.456 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 10:06:05.458 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 10:06:05.465 +03:00 [DBG] Authorize endpoint response
{"SubjectId":"1","ClientId":"mvc","RedirectUri":"http://localhost:5002/home/signin-oidc","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9PMPmCoRsBIkMuFzwHn90PmxmeOnAlVYG1pw017QwDd1BG1m3Br_tD4CcGUW7fZNAm1HWBBRkeEH5aEEMVTKIDnCNaCig3OhWW4G2M3kb6l0Eq7gCltbDMGzXTygYZt6UrhfY-E_xshnkxUADJl3cqEU4-goKj-1pWSgb237ZlU7LBeKgTZG9GW2Tqp9imAu6MwL5QOF8b9GYq_5vSm-zp_XvjcH4MdqOdZjsIMGi9zeU53ydanKU373hE9sQ9NNauA-EXX5Sdquy4Kbq8qT8JmS1F4E8uoBhEn5Jzk9_WGtn6QsrgXETNNltrZ9Ft5W6k","Scope":"openid profile afcpayroll offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-08-20 10:06:05.470 +03:00 [DBG] Augmenting SignInContext
2019-08-20 10:06:05.474 +03:00 [INF] AuthenticationScheme: idsrv signed in.
2019-08-20 10:06:07.925 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-20 10:06:07.927 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-20 10:06:07.930 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-20 10:06:07.932 +03:00 [DBG] Start token request.
2019-08-20 10:06:07.932 +03:00 [DBG] Start client validation
2019-08-20 10:06:07.933 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-20 10:06:07.934 +03:00 [DBG] Start parsing for secret in post body
2019-08-20 10:06:07.934 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-20 10:06:07.935 +03:00 [DBG] Secret id found: mvc
2019-08-20 10:06:07.936 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 10:06:07.937 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-20 10:06:07.938 +03:00 [DBG] Client validation success
2019-08-20 10:06:07.939 +03:00 [DBG] Start token request validation
2019-08-20 10:06:07.940 +03:00 [DBG] Start validation of authorization code token request
2019-08-20 10:06:07.941 +03:00 [DBG] Validation of authorization code token request success
2019-08-20 10:06:07.941 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"3371911a9b0edbdbad2125be6c6f13ec1de0913e9f5104364aab4bfd68da0c41","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"mvc","client_secret":"***REDACTED***","code":"3371911a9b0edbdbad2125be6c6f13ec1de0913e9f5104364aab4bfd68da0c41","grant_type":"authorization_code","redirect_uri":"http://localhost:5002/home/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-08-20 10:06:07.945 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 10:06:07.946 +03:00 [DBG] Getting claims for access token for client: mvc
2019-08-20 10:06:07.947 +03:00 [DBG] Getting claims for access token for subject: 1
2019-08-20 10:06:07.951 +03:00 [DBG] Creating refresh token
2019-08-20 10:06:07.952 +03:00 [DBG] Setting an absolute lifetime: 2592000
2019-08-20 10:06:07.953 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 10:06:07.955 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 10:06:07.956 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 10:06:07.961 +03:00 [DBG] Token request success.
2019-08-20 10:06:07.972 +03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-08-20 10:06:07.974 +03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-08-20 10:06:07.975 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-08-20 10:06:07.977 +03:00 [DBG] Start userinfo request
2019-08-20 10:06:07.978 +03:00 [DBG] Bearer token found in header
2019-08-20 10:06:07.981 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 10:06:07.983 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 10:06:07.984 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-08-20 10:06:07.985 +03:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1566284767,"exp":1566284827,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","afcpayroll"],"client_id":"mvc","sub":"1","auth_time":1566284765,"idp":"local","name":"alice","email":"alice@email.com","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-08-20 10:06:07.999 +03:00 [DBG] Creating userinfo response
2019-08-20 10:06:08.000 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 10:06:08.001 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 10:06:08.002 +03:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 10:06:08.003 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 10:06:08.008 +03:00 [INF] Profile service returned the following claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 10:06:08.009 +03:00 [DBG] End userinfo request
2019-08-20 10:07:46.636 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-08-20 10:07:46.643 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-08-20 10:07:46.649 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-08-20 10:07:46.652 +03:00 [DBG] Start authorize request
2019-08-20 10:07:46.652 +03:00 [DBG] No user present in authorize request
2019-08-20 10:07:46.653 +03:00 [DBG] Start authorize request protocol validation
2019-08-20 10:07:46.654 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 10:07:46.658 +03:00 [DBG] Checking for PKCE parameters
2019-08-20 10:07:46.659 +03:00 [DBG] No PKCE used.
2019-08-20 10:07:46.660 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-20 10:07:46.662 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/home/signin-oidc","AllowedRedirectUris":["http://localhost:5002/home/signin-oidc"],"SubjectId":"anonymous","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9N6HkhQ79h-4CMfBse53xYUNoI-fqclyzNIfcDjrBJEgoRTyc7CjOlcY4fhblj1dnhyCJf6k_kqSJlV_TUufaeHqoQwCr_TS-U_YCsPr4gxhBslER42Atlp0NexVH83GoXdZaARKhv0NaKM26ik9iqtNJ84jL6Nz9wUcsGroFQyTfC_RJolVVZPwhEg9ZGFDqjpb62Qh79rn-zL4nWWbuslByMp7e5ftkemJTgK5sgm-dreIpH2OAT5F0CjLqWgIRYj6x4VpsMZxhLnUpol2_LjJWLUPS4EXAhda3jBZICJZZi2nHvjpd4o3xOdWc7A-kM","UiLocales":null,"Nonce":"637018816666007928.NzNmYWE0MGEtYjFlZi00N2NlLWE3YjAtOWI1MjMyYTc0ZGIyNTRiNTMzMTMtOGNjZi00Mzg3LTg3NjYtNjhjM2JkOTM5NTJl","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/home/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637018816666007928.NzNmYWE0MGEtYjFlZi00N2NlLWE3YjAtOWI1MjMyYTc0ZGIyNTRiNTMzMTMtOGNjZi00Mzg3LTg3NjYtNjhjM2JkOTM5NTJl","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9N6HkhQ79h-4CMfBse53xYUNoI-fqclyzNIfcDjrBJEgoRTyc7CjOlcY4fhblj1dnhyCJf6k_kqSJlV_TUufaeHqoQwCr_TS-U_YCsPr4gxhBslER42Atlp0NexVH83GoXdZaARKhv0NaKM26ik9iqtNJ84jL6Nz9wUcsGroFQyTfC_RJolVVZPwhEg9ZGFDqjpb62Qh79rn-zL4nWWbuslByMp7e5ftkemJTgK5sgm-dreIpH2OAT5F0CjLqWgIRYj6x4VpsMZxhLnUpol2_LjJWLUPS4EXAhda3jBZICJZZi2nHvjpd4o3xOdWc7A-kM","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-20 10:07:46.676 +03:00 [INF] Showing login: User is not authenticated
2019-08-20 10:07:46.688 +03:00 [DBG] Start authorize request protocol validation
2019-08-20 10:07:46.689 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 10:07:46.691 +03:00 [DBG] Checking for PKCE parameters
2019-08-20 10:07:46.692 +03:00 [DBG] No PKCE used.
2019-08-20 10:07:46.693 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-20 10:07:46.694 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 10:32:37.048 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-20 10:32:37.050 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-20 10:32:37.051 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-20 10:32:37.052 +03:00 [DBG] Start discovery request
2019-08-20 10:32:37.140 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-20 10:32:37.142 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-20 10:32:37.143 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-20 10:32:37.144 +03:00 [DBG] Start key discovery request
2019-08-20 10:32:37.197 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-08-20 10:32:37.198 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-08-20 10:32:37.199 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-08-20 10:32:37.200 +03:00 [DBG] Start authorize request
2019-08-20 10:32:37.201 +03:00 [DBG] No user present in authorize request
2019-08-20 10:32:37.201 +03:00 [DBG] Start authorize request protocol validation
2019-08-20 10:32:37.202 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 10:32:37.203 +03:00 [DBG] Checking for PKCE parameters
2019-08-20 10:32:37.204 +03:00 [DBG] No PKCE used.
2019-08-20 10:32:37.204 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-20 10:32:37.205 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/home/signin-oidc","AllowedRedirectUris":["http://localhost:5002/home/signin-oidc"],"SubjectId":"anonymous","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9NwNqLEaN2_objbjpzCZ0rsmdD-2y_EITiEQ1jMlZX-KDkvGidTe-sIeNltmFGcH5zWWH1-i5NvFYnZ0gFbH3Hc0SvCkARxaHzJya4d2pRlzijAwH5GTe1PYPYnCSu47JLuY7RgQQ6aWuI-Npwrl5xDGn3N-pIw24lPh99J-4qQ5NhZiDw_eXfip7Xifbkk5u_IqLXKXip799aNUKYA1SrdNh51el3R_PKO7kz7F7uJczzUCZqHphgPQIoDbf6wjx9MIeg_LbADkhl3xziXAZPmY1UK2tHEsqtps9g4-jU3kvNOZIAMaPBQno4naUtRl44","UiLocales":null,"Nonce":"637018831571621737.ODUxZTQ0OTQtYmMzNi00MDIyLTg2NWEtYzA2MzdhZmY5ZTFiMGY2ZDE4MDgtMzc0NS00NDIwLWEzNGQtZmVjYmE3OTBkYWQ2","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/home/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637018831571621737.ODUxZTQ0OTQtYmMzNi00MDIyLTg2NWEtYzA2MzdhZmY5ZTFiMGY2ZDE4MDgtMzc0NS00NDIwLWEzNGQtZmVjYmE3OTBkYWQ2","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9NwNqLEaN2_objbjpzCZ0rsmdD-2y_EITiEQ1jMlZX-KDkvGidTe-sIeNltmFGcH5zWWH1-i5NvFYnZ0gFbH3Hc0SvCkARxaHzJya4d2pRlzijAwH5GTe1PYPYnCSu47JLuY7RgQQ6aWuI-Npwrl5xDGn3N-pIw24lPh99J-4qQ5NhZiDw_eXfip7Xifbkk5u_IqLXKXip799aNUKYA1SrdNh51el3R_PKO7kz7F7uJczzUCZqHphgPQIoDbf6wjx9MIeg_LbADkhl3xziXAZPmY1UK2tHEsqtps9g4-jU3kvNOZIAMaPBQno4naUtRl44","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-20 10:32:37.213 +03:00 [INF] Showing login: User is not authenticated
2019-08-20 10:32:37.226 +03:00 [DBG] Start authorize request protocol validation
2019-08-20 10:32:37.228 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 10:32:37.229 +03:00 [DBG] Checking for PKCE parameters
2019-08-20 10:32:37.230 +03:00 [DBG] No PKCE used.
2019-08-20 10:32:37.231 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-20 10:32:37.231 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 10:32:44.503 +03:00 [DBG] Start authorize request protocol validation
2019-08-20 10:32:44.512 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 10:32:44.519 +03:00 [DBG] Checking for PKCE parameters
2019-08-20 10:32:44.521 +03:00 [DBG] No PKCE used.
2019-08-20 10:32:44.522 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-20 10:32:44.527 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 10:32:46.568 +03:00 [DBG] CORS request made for path: /account/login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-08-20 10:32:46.576 +03:00 [DBG] Start authorize request protocol validation
2019-08-20 10:32:46.577 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 10:32:46.579 +03:00 [DBG] Checking for PKCE parameters
2019-08-20 10:32:46.579 +03:00 [DBG] No PKCE used.
2019-08-20 10:32:46.580 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-20 10:32:46.581 +03:00 [DBG] Augmenting SignInContext
2019-08-20 10:32:46.582 +03:00 [DBG] Adding idp claim with value: local
2019-08-20 10:32:46.584 +03:00 [DBG] Adding amr claim with value: pwd
2019-08-20 10:32:46.586 +03:00 [INF] AuthenticationScheme: idsrv signed in.
2019-08-20 10:32:46.587 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 10:32:46.599 +03:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-08-20 10:32:46.601 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-08-20 10:32:46.602 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-08-20 10:32:46.605 +03:00 [DBG] Start authorize callback request
2019-08-20 10:32:46.606 +03:00 [DBG] User in authorize request: 1
2019-08-20 10:32:46.608 +03:00 [DBG] Start authorize request protocol validation
2019-08-20 10:32:46.609 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 10:32:46.610 +03:00 [DBG] Checking for PKCE parameters
2019-08-20 10:32:46.611 +03:00 [DBG] No PKCE used.
2019-08-20 10:32:46.612 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-20 10:32:46.613 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/home/signin-oidc","AllowedRedirectUris":["http://localhost:5002/home/signin-oidc"],"SubjectId":"1","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9NwNqLEaN2_objbjpzCZ0rsmdD-2y_EITiEQ1jMlZX-KDkvGidTe-sIeNltmFGcH5zWWH1-i5NvFYnZ0gFbH3Hc0SvCkARxaHzJya4d2pRlzijAwH5GTe1PYPYnCSu47JLuY7RgQQ6aWuI-Npwrl5xDGn3N-pIw24lPh99J-4qQ5NhZiDw_eXfip7Xifbkk5u_IqLXKXip799aNUKYA1SrdNh51el3R_PKO7kz7F7uJczzUCZqHphgPQIoDbf6wjx9MIeg_LbADkhl3xziXAZPmY1UK2tHEsqtps9g4-jU3kvNOZIAMaPBQno4naUtRl44","UiLocales":null,"Nonce":"637018831571621737.ODUxZTQ0OTQtYmMzNi00MDIyLTg2NWEtYzA2MzdhZmY5ZTFiMGY2ZDE4MDgtMzc0NS00NDIwLWEzNGQtZmVjYmE3OTBkYWQ2","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"eae2212d71fecb3b07956f5038dc28e0","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/home/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637018831571621737.ODUxZTQ0OTQtYmMzNi00MDIyLTg2NWEtYzA2MzdhZmY5ZTFiMGY2ZDE4MDgtMzc0NS00NDIwLWEzNGQtZmVjYmE3OTBkYWQ2","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9NwNqLEaN2_objbjpzCZ0rsmdD-2y_EITiEQ1jMlZX-KDkvGidTe-sIeNltmFGcH5zWWH1-i5NvFYnZ0gFbH3Hc0SvCkARxaHzJya4d2pRlzijAwH5GTe1PYPYnCSu47JLuY7RgQQ6aWuI-Npwrl5xDGn3N-pIw24lPh99J-4qQ5NhZiDw_eXfip7Xifbkk5u_IqLXKXip799aNUKYA1SrdNh51el3R_PKO7kz7F7uJczzUCZqHphgPQIoDbf6wjx9MIeg_LbADkhl3xziXAZPmY1UK2tHEsqtps9g4-jU3kvNOZIAMaPBQno4naUtRl44","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-20 10:32:46.623 +03:00 [DBG] Client is configured to not require consent, no consent is required
2019-08-20 10:32:46.624 +03:00 [DBG] Creating Hybrid Flow response.
2019-08-20 10:32:46.625 +03:00 [DBG] Creating Implicit Flow response.
2019-08-20 10:32:46.626 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 10:32:46.627 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 10:32:46.632 +03:00 [DBG] Authorize endpoint response
{"SubjectId":"1","ClientId":"mvc","RedirectUri":"http://localhost:5002/home/signin-oidc","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9NwNqLEaN2_objbjpzCZ0rsmdD-2y_EITiEQ1jMlZX-KDkvGidTe-sIeNltmFGcH5zWWH1-i5NvFYnZ0gFbH3Hc0SvCkARxaHzJya4d2pRlzijAwH5GTe1PYPYnCSu47JLuY7RgQQ6aWuI-Npwrl5xDGn3N-pIw24lPh99J-4qQ5NhZiDw_eXfip7Xifbkk5u_IqLXKXip799aNUKYA1SrdNh51el3R_PKO7kz7F7uJczzUCZqHphgPQIoDbf6wjx9MIeg_LbADkhl3xziXAZPmY1UK2tHEsqtps9g4-jU3kvNOZIAMaPBQno4naUtRl44","Scope":"openid profile afcpayroll offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-08-20 10:32:46.637 +03:00 [DBG] Augmenting SignInContext
2019-08-20 10:32:46.637 +03:00 [INF] AuthenticationScheme: idsrv signed in.
2019-08-20 10:32:46.919 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-20 10:32:46.920 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-20 10:32:46.922 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-20 10:32:46.923 +03:00 [DBG] Start token request.
2019-08-20 10:32:46.923 +03:00 [DBG] Start client validation
2019-08-20 10:32:46.924 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-20 10:32:46.924 +03:00 [DBG] Start parsing for secret in post body
2019-08-20 10:32:46.927 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-20 10:32:46.930 +03:00 [DBG] Secret id found: mvc
2019-08-20 10:32:46.933 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 10:32:46.936 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-20 10:32:46.937 +03:00 [DBG] Client validation success
2019-08-20 10:32:46.938 +03:00 [DBG] Start token request validation
2019-08-20 10:32:46.942 +03:00 [DBG] Start validation of authorization code token request
2019-08-20 10:32:46.945 +03:00 [DBG] Validation of authorization code token request success
2019-08-20 10:32:46.947 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"14a876ecdb0524a9b66d7222d0a22ac419aac9143ad8f0965527711f1e7d4e3d","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"mvc","client_secret":"***REDACTED***","code":"14a876ecdb0524a9b66d7222d0a22ac419aac9143ad8f0965527711f1e7d4e3d","grant_type":"authorization_code","redirect_uri":"http://localhost:5002/home/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-08-20 10:32:46.958 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 10:32:46.968 +03:00 [DBG] Getting claims for access token for client: mvc
2019-08-20 10:32:46.969 +03:00 [DBG] Getting claims for access token for subject: 1
2019-08-20 10:32:46.975 +03:00 [DBG] Creating refresh token
2019-08-20 10:32:46.976 +03:00 [DBG] Setting an absolute lifetime: 2592000
2019-08-20 10:32:46.977 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 10:32:46.978 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 10:32:46.979 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 10:32:46.984 +03:00 [DBG] Token request success.
2019-08-20 10:32:46.996 +03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-08-20 10:32:46.997 +03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-08-20 10:32:46.999 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-08-20 10:32:46.999 +03:00 [DBG] Start userinfo request
2019-08-20 10:32:47.000 +03:00 [DBG] Bearer token found in header
2019-08-20 10:32:47.003 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 10:32:47.004 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 10:32:47.005 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-08-20 10:32:47.007 +03:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1566286366,"exp":1566286426,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","afcpayroll"],"client_id":"mvc","sub":"1","auth_time":1566286366,"idp":"local","name":"alice","email":"alice@email.com","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-08-20 10:32:47.013 +03:00 [DBG] Creating userinfo response
2019-08-20 10:32:47.014 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 10:32:47.015 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 10:32:47.017 +03:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 10:32:47.018 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 10:32:47.019 +03:00 [INF] Profile service returned the following claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 10:32:47.021 +03:00 [DBG] End userinfo request
2019-08-20 10:32:54.906 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-20 10:32:54.908 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-20 10:32:54.909 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-20 10:32:54.910 +03:00 [DBG] Start discovery request
2019-08-20 10:32:55.046 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-20 10:32:55.047 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-20 10:32:55.048 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-20 10:32:55.049 +03:00 [DBG] Start key discovery request
2019-08-20 10:32:55.095 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-08-20 10:32:55.101 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-08-20 10:32:55.102 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-08-20 10:32:55.105 +03:00 [DBG] Start authorize request
2019-08-20 10:32:55.106 +03:00 [DBG] No user present in authorize request
2019-08-20 10:32:55.107 +03:00 [DBG] Start authorize request protocol validation
2019-08-20 10:32:55.108 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 10:32:55.109 +03:00 [ERR] Invalid redirect_uri: http://localhost:5001/signin-oidc
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":null,"AllowedRedirectUris":["http://localhost:5002/home/signin-oidc"],"SubjectId":"anonymous","ResponseType":null,"ResponseMode":null,"GrantType":null,"RequestedScopes":"","State":null,"UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5001/signin-oidc","response_type":"code id_token","scope":"openid profile","response_mode":"form_post","nonce":"637018831750691113.NWE4ZmI4YTctMWEzMi00MzQ2LTg0YzctM2FmYWRkNzY3ZjQ1YTNhMDhmMTAtMjdjNC00YjM1LThmZDEtNzhkNmFkMmM5NjMw","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9PBJt6NuCMeEsR1uDkUGBJauDOFxsRWuqkaVoGyrNxlmVJlDbnOMXqbBetD9jb7m--8Ct8Cl45MhSiOV29UICWVg5wm1M1f3Pb8eHN6Im1uSJdNJ2gopA0oEBLtKCPy-wE04gscsc7lYraLMWTwU61fw7WU-JQd7NuFH-uL38PX1siIgBjzAdhejMokuH5fPLAiDwed13l4IMDbSdgwZjhtstYDyoMvZ8TXA3KWhQJWVomn8Bs4GPO8QYHnRxJaejnFvx183sDgaebzGLNwsYdI3fu_3FoONp2N-6bq9lO5md2AQmErMTeMSxne8EjZvvc","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-20 10:32:55.120 +03:00 [ERR] Request validation failed
2019-08-20 10:32:55.121 +03:00 [INF] {"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":null,"AllowedRedirectUris":["http://localhost:5002/home/signin-oidc"],"SubjectId":"anonymous","ResponseType":null,"ResponseMode":null,"GrantType":null,"RequestedScopes":"","State":null,"UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5001/signin-oidc","response_type":"code id_token","scope":"openid profile","response_mode":"form_post","nonce":"637018831750691113.NWE4ZmI4YTctMWEzMi00MzQ2LTg0YzctM2FmYWRkNzY3ZjQ1YTNhMDhmMTAtMjdjNC00YjM1LThmZDEtNzhkNmFkMmM5NjMw","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9PBJt6NuCMeEsR1uDkUGBJauDOFxsRWuqkaVoGyrNxlmVJlDbnOMXqbBetD9jb7m--8Ct8Cl45MhSiOV29UICWVg5wm1M1f3Pb8eHN6Im1uSJdNJ2gopA0oEBLtKCPy-wE04gscsc7lYraLMWTwU61fw7WU-JQd7NuFH-uL38PX1siIgBjzAdhejMokuH5fPLAiDwed13l4IMDbSdgwZjhtstYDyoMvZ8TXA3KWhQJWVomn8Bs4GPO8QYHnRxJaejnFvx183sDgaebzGLNwsYdI3fu_3FoONp2N-6bq9lO5md2AQmErMTeMSxne8EjZvvc","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-20 10:55:54.315 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-20 10:55:54.318 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-20 10:55:54.322 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-20 10:55:54.323 +03:00 [DBG] Start discovery request
2019-08-20 10:55:54.334 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-20 10:55:54.339 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-20 10:55:54.341 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-20 10:55:54.343 +03:00 [DBG] Start key discovery request
2019-08-20 10:55:54.371 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-20 10:55:54.373 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-20 10:55:54.374 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-20 10:55:54.375 +03:00 [DBG] Start token request.
2019-08-20 10:55:54.376 +03:00 [DBG] Start client validation
2019-08-20 10:55:54.377 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-20 10:55:54.377 +03:00 [DBG] Start parsing for secret in post body
2019-08-20 10:55:54.378 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-20 10:55:54.379 +03:00 [DBG] Secret id found: mvc
2019-08-20 10:55:54.379 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 10:55:54.381 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-20 10:55:54.381 +03:00 [DBG] Client validation success
2019-08-20 10:55:54.382 +03:00 [DBG] Start token request validation
2019-08-20 10:55:54.383 +03:00 [DBG] Start validation of refresh token request
2019-08-20 10:55:54.384 +03:00 [DBG] Token validation success
{"ClientId":"mvc","ClientName":"MVC Client","ValidateLifetime":false,"AccessTokenType":null,"ExpectedScope":null,"TokenHandle":null,"JwtId":null,"Claims":{"sub":"1","client_id":"mvc","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"auth_time":1566286366,"idp":"local","amr":"pwd","name":"alice","email":"alice@email.com"},"$type":"TokenValidationLog"}
2019-08-20 10:55:54.390 +03:00 [DBG] Validation of refresh token request success
2019-08-20 10:55:54.391 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"refresh_token","Scopes":null,"AuthorizationCode":null,"RefreshToken":"128ab44636dc22c3656fc7353936516fe57889bf0264b3e2dd82275eed4f2a16","UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"refresh_token","refresh_token":"***REDACTED***","client_id":"mvc","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2019-08-20 10:55:54.398 +03:00 [DBG] Updating refresh token
2019-08-20 10:55:54.399 +03:00 [DBG] Token usage is one-time only. Generating new handle
2019-08-20 10:55:54.400 +03:00 [DBG] Created refresh token in store
2019-08-20 10:55:54.400 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 10:55:54.401 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 10:55:54.406 +03:00 [DBG] Token request success.
2019-08-20 10:55:57.925 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-20 10:55:57.926 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-20 10:55:57.931 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-20 10:55:57.932 +03:00 [DBG] Start discovery request
2019-08-20 10:55:57.937 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-20 10:55:57.940 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-20 10:55:57.941 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-20 10:55:57.942 +03:00 [DBG] Start key discovery request
2019-08-20 10:55:57.946 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-20 10:55:57.948 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-20 10:55:57.949 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-20 10:55:57.950 +03:00 [DBG] Start token request.
2019-08-20 10:55:57.951 +03:00 [DBG] Start client validation
2019-08-20 10:55:57.951 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-20 10:55:57.952 +03:00 [DBG] Start parsing for secret in post body
2019-08-20 10:55:57.953 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-20 10:55:57.953 +03:00 [DBG] Secret id found: mvc
2019-08-20 10:55:57.954 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 10:55:57.955 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-20 10:55:57.956 +03:00 [DBG] Client validation success
2019-08-20 10:55:57.957 +03:00 [DBG] Start token request validation
2019-08-20 10:55:57.957 +03:00 [DBG] Start validation of refresh token request
2019-08-20 10:55:57.958 +03:00 [DBG] Token validation success
{"ClientId":"mvc","ClientName":"MVC Client","ValidateLifetime":false,"AccessTokenType":null,"ExpectedScope":null,"TokenHandle":null,"JwtId":null,"Claims":{"sub":"1","client_id":"mvc","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"auth_time":1566286366,"idp":"local","amr":"pwd","name":"alice","email":"alice@email.com"},"$type":"TokenValidationLog"}
2019-08-20 10:55:57.962 +03:00 [DBG] Validation of refresh token request success
2019-08-20 10:55:57.963 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"refresh_token","Scopes":null,"AuthorizationCode":null,"RefreshToken":"15064befc7b2ab6216ce765550f1aadae7ae69b748841d738695643ab1111417","UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"refresh_token","refresh_token":"***REDACTED***","client_id":"mvc","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2019-08-20 10:55:57.971 +03:00 [DBG] Updating refresh token
2019-08-20 10:55:57.972 +03:00 [DBG] Token usage is one-time only. Generating new handle
2019-08-20 10:55:57.973 +03:00 [DBG] Created refresh token in store
2019-08-20 10:55:57.973 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 10:55:57.976 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 10:55:57.983 +03:00 [DBG] Token request success.
2019-08-20 10:56:59.860 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-20 10:56:59.861 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-20 10:56:59.863 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-20 10:56:59.864 +03:00 [DBG] Start discovery request
2019-08-20 10:56:59.867 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-20 10:56:59.869 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-20 10:56:59.873 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-20 10:56:59.874 +03:00 [DBG] Start key discovery request
2019-08-20 10:56:59.877 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-20 10:56:59.878 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-20 10:56:59.879 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-20 10:56:59.881 +03:00 [DBG] Start token request.
2019-08-20 10:56:59.882 +03:00 [DBG] Start client validation
2019-08-20 10:56:59.883 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-20 10:56:59.883 +03:00 [DBG] Start parsing for secret in post body
2019-08-20 10:56:59.884 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-20 10:56:59.885 +03:00 [DBG] Secret id found: mvc
2019-08-20 10:56:59.886 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 10:56:59.888 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-20 10:56:59.888 +03:00 [DBG] Client validation success
2019-08-20 10:56:59.889 +03:00 [DBG] Start token request validation
2019-08-20 10:56:59.890 +03:00 [DBG] Start validation of refresh token request
2019-08-20 10:56:59.890 +03:00 [DBG] Token validation success
{"ClientId":"mvc","ClientName":"MVC Client","ValidateLifetime":false,"AccessTokenType":null,"ExpectedScope":null,"TokenHandle":null,"JwtId":null,"Claims":{"sub":"1","client_id":"mvc","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"auth_time":1566286366,"idp":"local","amr":"pwd","name":"alice","email":"alice@email.com"},"$type":"TokenValidationLog"}
2019-08-20 10:56:59.898 +03:00 [DBG] Validation of refresh token request success
2019-08-20 10:56:59.900 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"refresh_token","Scopes":null,"AuthorizationCode":null,"RefreshToken":"5744bb05012e394397c53cc4acccf8908873013c034ff93c7f98dc4cd821bffe","UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"refresh_token","refresh_token":"***REDACTED***","client_id":"mvc","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2019-08-20 10:56:59.910 +03:00 [DBG] Updating refresh token
2019-08-20 10:56:59.912 +03:00 [DBG] Token usage is one-time only. Generating new handle
2019-08-20 10:56:59.914 +03:00 [DBG] Created refresh token in store
2019-08-20 10:56:59.915 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 10:56:59.916 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 10:56:59.921 +03:00 [DBG] Token request success.
2019-08-20 10:58:00.399 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-20 10:58:00.401 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-20 10:58:00.403 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-20 10:58:00.404 +03:00 [DBG] Start discovery request
2019-08-20 10:58:00.409 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-20 10:58:00.410 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-20 10:58:00.412 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-20 10:58:00.413 +03:00 [DBG] Start key discovery request
2019-08-20 10:58:00.416 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-20 10:58:00.418 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-20 10:58:00.420 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-20 10:58:00.422 +03:00 [DBG] Start token request.
2019-08-20 10:58:00.423 +03:00 [DBG] Start client validation
2019-08-20 10:58:00.424 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-20 10:58:00.425 +03:00 [DBG] Start parsing for secret in post body
2019-08-20 10:58:00.426 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-20 10:58:00.429 +03:00 [DBG] Secret id found: mvc
2019-08-20 10:58:00.432 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 10:58:00.434 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-20 10:58:00.436 +03:00 [DBG] Client validation success
2019-08-20 10:58:00.438 +03:00 [DBG] Start token request validation
2019-08-20 10:58:00.439 +03:00 [DBG] Start validation of refresh token request
2019-08-20 10:58:00.442 +03:00 [DBG] Token validation success
{"ClientId":"mvc","ClientName":"MVC Client","ValidateLifetime":false,"AccessTokenType":null,"ExpectedScope":null,"TokenHandle":null,"JwtId":null,"Claims":{"sub":"1","client_id":"mvc","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"auth_time":1566286366,"idp":"local","amr":"pwd","name":"alice","email":"alice@email.com"},"$type":"TokenValidationLog"}
2019-08-20 10:58:00.449 +03:00 [DBG] Validation of refresh token request success
2019-08-20 10:58:00.451 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"refresh_token","Scopes":null,"AuthorizationCode":null,"RefreshToken":"c18b24e2b8640d4a126f4a3c2e669f0c1a61e006d3b9f99d9d4a4963be5f0893","UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"refresh_token","refresh_token":"***REDACTED***","client_id":"mvc","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2019-08-20 10:58:00.471 +03:00 [DBG] Updating refresh token
2019-08-20 10:58:00.472 +03:00 [DBG] Token usage is one-time only. Generating new handle
2019-08-20 10:58:00.474 +03:00 [DBG] Created refresh token in store
2019-08-20 10:58:00.475 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 10:58:00.476 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 10:58:00.481 +03:00 [DBG] Token request success.
2019-08-20 11:04:02.483 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-20 11:04:02.487 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-20 11:04:02.492 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-20 11:04:02.495 +03:00 [DBG] Start discovery request
2019-08-20 11:04:02.686 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-20 11:04:02.688 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-20 11:04:02.690 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-20 11:04:02.692 +03:00 [DBG] Start key discovery request
2019-08-20 11:04:02.762 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-08-20 11:04:02.764 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-08-20 11:04:02.766 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-08-20 11:04:02.768 +03:00 [DBG] Start authorize request
2019-08-20 11:04:02.785 +03:00 [DBG] No user present in authorize request
2019-08-20 11:04:02.787 +03:00 [DBG] Start authorize request protocol validation
2019-08-20 11:04:02.794 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:04:02.796 +03:00 [DBG] Checking for PKCE parameters
2019-08-20 11:04:02.798 +03:00 [DBG] No PKCE used.
2019-08-20 11:04:02.806 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-20 11:04:02.809 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/home/signin-oidc","AllowedRedirectUris":["http://localhost:5002/home/signin-oidc"],"SubjectId":"anonymous","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9NYV2psP7l7w4lha0tSAcOSSihTgCRK6sqgcHw1npJqGolEP5lsjOXsQo1atTzk_5wShwOnNLZCU5VKOc4hSveppZG18hcnSnx616NBpf3rhYuqnBnYNk5cTWCjswJFa8B145YVdEe_aEwutxcN1DEJsK0tW0HBn6ZzgDQl3bYp7Gj6t4h8cpx51Ee2gcOKStAd8apu3nfFsVe2o6up4dUp5tRD3GkVykgVsY6xHhwNM_lNaaAeDF9qX67BPf8oqAMYv5lOe-oS6OjlHYdImToDvaKq1Vo_UT2Nwbc0t4qA8IRWRlrgBq_IuNMX17GXCro","UiLocales":null,"Nonce":"637018850427204056.NzMyZTI2NmYtZjUyNC00YzMwLTg5NjQtOTQ4NThjOWQ1OGJhMDZhNGQ0MDktMjU0NC00ZGZkLWIwOTAtYjg1MmU2MDdiMTQ3","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/home/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637018850427204056.NzMyZTI2NmYtZjUyNC00YzMwLTg5NjQtOTQ4NThjOWQ1OGJhMDZhNGQ0MDktMjU0NC00ZGZkLWIwOTAtYjg1MmU2MDdiMTQ3","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9NYV2psP7l7w4lha0tSAcOSSihTgCRK6sqgcHw1npJqGolEP5lsjOXsQo1atTzk_5wShwOnNLZCU5VKOc4hSveppZG18hcnSnx616NBpf3rhYuqnBnYNk5cTWCjswJFa8B145YVdEe_aEwutxcN1DEJsK0tW0HBn6ZzgDQl3bYp7Gj6t4h8cpx51Ee2gcOKStAd8apu3nfFsVe2o6up4dUp5tRD3GkVykgVsY6xHhwNM_lNaaAeDF9qX67BPf8oqAMYv5lOe-oS6OjlHYdImToDvaKq1Vo_UT2Nwbc0t4qA8IRWRlrgBq_IuNMX17GXCro","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-20 11:04:02.822 +03:00 [INF] Showing login: User is not authenticated
2019-08-20 11:04:02.835 +03:00 [DBG] Start authorize request protocol validation
2019-08-20 11:04:02.836 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:04:02.837 +03:00 [DBG] Checking for PKCE parameters
2019-08-20 11:04:02.838 +03:00 [DBG] No PKCE used.
2019-08-20 11:04:02.839 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-20 11:04:02.840 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:04:05.312 +03:00 [DBG] CORS request made for path: /account/login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-08-20 11:04:05.315 +03:00 [DBG] Start authorize request protocol validation
2019-08-20 11:04:05.316 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:04:05.317 +03:00 [DBG] Checking for PKCE parameters
2019-08-20 11:04:05.318 +03:00 [DBG] No PKCE used.
2019-08-20 11:04:05.319 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-20 11:04:05.320 +03:00 [DBG] Augmenting SignInContext
2019-08-20 11:04:05.323 +03:00 [DBG] Adding idp claim with value: local
2019-08-20 11:04:05.324 +03:00 [DBG] Adding amr claim with value: pwd
2019-08-20 11:04:05.325 +03:00 [INF] AuthenticationScheme: idsrv signed in.
2019-08-20 11:04:05.326 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:04:05.337 +03:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-08-20 11:04:05.338 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-08-20 11:04:05.340 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-08-20 11:04:05.341 +03:00 [DBG] Start authorize callback request
2019-08-20 11:04:05.342 +03:00 [DBG] User in authorize request: 1
2019-08-20 11:04:05.343 +03:00 [DBG] Start authorize request protocol validation
2019-08-20 11:04:05.343 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:04:05.345 +03:00 [DBG] Checking for PKCE parameters
2019-08-20 11:04:05.346 +03:00 [DBG] No PKCE used.
2019-08-20 11:04:05.347 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-20 11:04:05.348 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/home/signin-oidc","AllowedRedirectUris":["http://localhost:5002/home/signin-oidc"],"SubjectId":"1","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9NYV2psP7l7w4lha0tSAcOSSihTgCRK6sqgcHw1npJqGolEP5lsjOXsQo1atTzk_5wShwOnNLZCU5VKOc4hSveppZG18hcnSnx616NBpf3rhYuqnBnYNk5cTWCjswJFa8B145YVdEe_aEwutxcN1DEJsK0tW0HBn6ZzgDQl3bYp7Gj6t4h8cpx51Ee2gcOKStAd8apu3nfFsVe2o6up4dUp5tRD3GkVykgVsY6xHhwNM_lNaaAeDF9qX67BPf8oqAMYv5lOe-oS6OjlHYdImToDvaKq1Vo_UT2Nwbc0t4qA8IRWRlrgBq_IuNMX17GXCro","UiLocales":null,"Nonce":"637018850427204056.NzMyZTI2NmYtZjUyNC00YzMwLTg5NjQtOTQ4NThjOWQ1OGJhMDZhNGQ0MDktMjU0NC00ZGZkLWIwOTAtYjg1MmU2MDdiMTQ3","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"ce0664be06e739b8efb3ff612acb2c06","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/home/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637018850427204056.NzMyZTI2NmYtZjUyNC00YzMwLTg5NjQtOTQ4NThjOWQ1OGJhMDZhNGQ0MDktMjU0NC00ZGZkLWIwOTAtYjg1MmU2MDdiMTQ3","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9NYV2psP7l7w4lha0tSAcOSSihTgCRK6sqgcHw1npJqGolEP5lsjOXsQo1atTzk_5wShwOnNLZCU5VKOc4hSveppZG18hcnSnx616NBpf3rhYuqnBnYNk5cTWCjswJFa8B145YVdEe_aEwutxcN1DEJsK0tW0HBn6ZzgDQl3bYp7Gj6t4h8cpx51Ee2gcOKStAd8apu3nfFsVe2o6up4dUp5tRD3GkVykgVsY6xHhwNM_lNaaAeDF9qX67BPf8oqAMYv5lOe-oS6OjlHYdImToDvaKq1Vo_UT2Nwbc0t4qA8IRWRlrgBq_IuNMX17GXCro","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-20 11:04:05.358 +03:00 [DBG] Client is configured to not require consent, no consent is required
2019-08-20 11:04:05.358 +03:00 [DBG] Creating Hybrid Flow response.
2019-08-20 11:04:05.359 +03:00 [DBG] Creating Implicit Flow response.
2019-08-20 11:04:05.360 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 11:04:05.361 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 11:04:05.368 +03:00 [DBG] Authorize endpoint response
{"SubjectId":"1","ClientId":"mvc","RedirectUri":"http://localhost:5002/home/signin-oidc","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9NYV2psP7l7w4lha0tSAcOSSihTgCRK6sqgcHw1npJqGolEP5lsjOXsQo1atTzk_5wShwOnNLZCU5VKOc4hSveppZG18hcnSnx616NBpf3rhYuqnBnYNk5cTWCjswJFa8B145YVdEe_aEwutxcN1DEJsK0tW0HBn6ZzgDQl3bYp7Gj6t4h8cpx51Ee2gcOKStAd8apu3nfFsVe2o6up4dUp5tRD3GkVykgVsY6xHhwNM_lNaaAeDF9qX67BPf8oqAMYv5lOe-oS6OjlHYdImToDvaKq1Vo_UT2Nwbc0t4qA8IRWRlrgBq_IuNMX17GXCro","Scope":"openid profile afcpayroll offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-08-20 11:04:05.374 +03:00 [DBG] Augmenting SignInContext
2019-08-20 11:04:05.375 +03:00 [INF] AuthenticationScheme: idsrv signed in.
2019-08-20 11:04:05.704 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-20 11:04:05.705 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-20 11:04:05.707 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-20 11:04:05.709 +03:00 [DBG] Start token request.
2019-08-20 11:04:05.709 +03:00 [DBG] Start client validation
2019-08-20 11:04:05.711 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-20 11:04:05.712 +03:00 [DBG] Start parsing for secret in post body
2019-08-20 11:04:05.714 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-20 11:04:05.715 +03:00 [DBG] Secret id found: mvc
2019-08-20 11:04:05.717 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:04:05.718 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-20 11:04:05.719 +03:00 [DBG] Client validation success
2019-08-20 11:04:05.720 +03:00 [DBG] Start token request validation
2019-08-20 11:04:05.721 +03:00 [DBG] Start validation of authorization code token request
2019-08-20 11:04:05.722 +03:00 [DBG] Validation of authorization code token request success
2019-08-20 11:04:05.722 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"06a4b2a69f2eb77a4f6d44340866275de24090360774dfa69e4e28fba4002bfc","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"mvc","client_secret":"***REDACTED***","code":"06a4b2a69f2eb77a4f6d44340866275de24090360774dfa69e4e28fba4002bfc","grant_type":"authorization_code","redirect_uri":"http://localhost:5002/home/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-08-20 11:04:05.726 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:04:05.728 +03:00 [DBG] Getting claims for access token for client: mvc
2019-08-20 11:04:05.728 +03:00 [DBG] Getting claims for access token for subject: 1
2019-08-20 11:04:05.733 +03:00 [DBG] Creating refresh token
2019-08-20 11:04:05.734 +03:00 [DBG] Setting an absolute lifetime: 2592000
2019-08-20 11:04:05.735 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:04:05.736 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 11:04:05.737 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 11:04:05.742 +03:00 [DBG] Token request success.
2019-08-20 11:04:05.755 +03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-08-20 11:04:05.756 +03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-08-20 11:04:05.757 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-08-20 11:04:05.758 +03:00 [DBG] Start userinfo request
2019-08-20 11:04:05.759 +03:00 [DBG] Bearer token found in header
2019-08-20 11:04:05.762 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:04:05.763 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:04:05.764 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-08-20 11:04:05.766 +03:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1566288245,"exp":1566288305,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","afcpayroll"],"client_id":"mvc","sub":"1","auth_time":1566288245,"idp":"local","name":"alice","email":"alice@email.com","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-08-20 11:04:05.773 +03:00 [DBG] Creating userinfo response
2019-08-20 11:04:05.773 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:04:05.774 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:04:05.775 +03:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 11:04:05.776 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:04:05.778 +03:00 [INF] Profile service returned the following claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 11:04:05.779 +03:00 [DBG] End userinfo request
2019-08-20 11:08:01.039 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-20 11:08:01.042 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-20 11:08:01.044 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-20 11:08:01.046 +03:00 [DBG] Start discovery request
2019-08-20 11:08:01.186 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-20 11:08:01.188 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-20 11:08:01.191 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-20 11:08:01.192 +03:00 [DBG] Start key discovery request
2019-08-20 11:08:01.280 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-20 11:08:01.281 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-20 11:08:01.284 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-20 11:08:01.285 +03:00 [DBG] Start token request.
2019-08-20 11:08:01.286 +03:00 [DBG] Start client validation
2019-08-20 11:08:01.287 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-20 11:08:01.287 +03:00 [DBG] Start parsing for secret in post body
2019-08-20 11:08:01.288 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-20 11:08:01.289 +03:00 [DBG] Secret id found: mvc
2019-08-20 11:08:01.290 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:08:01.291 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-20 11:08:01.292 +03:00 [DBG] Client validation success
2019-08-20 11:08:01.293 +03:00 [DBG] Start token request validation
2019-08-20 11:08:01.293 +03:00 [DBG] Start validation of authorization code token request
2019-08-20 11:08:01.297 +03:00 [DBG] authorization_code grant with value: 06a4b2a69f2eb77a4f6d44340866275de24090360774dfa69e4e28fba4002bfc not found in store.
2019-08-20 11:08:01.301 +03:00 [ERR] Invalid authorization code{"code":"06a4b2a69f2eb77a4f6d44340866275de24090360774dfa69e4e28fba4002bfc"}, details: {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"06a4b2a69f2eb77a4f6d44340866275de24090360774dfa69e4e28fba4002bfc","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"mvc","client_secret":"***REDACTED***","code":"06a4b2a69f2eb77a4f6d44340866275de24090360774dfa69e4e28fba4002bfc","grant_type":"authorization_code","redirect_uri":"http://localhost:5002/home/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-08-20 11:08:09.982 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-08-20 11:08:10.003 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-08-20 11:08:10.009 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-08-20 11:08:10.011 +03:00 [DBG] Start authorize request
2019-08-20 11:08:10.012 +03:00 [DBG] No user present in authorize request
2019-08-20 11:08:10.012 +03:00 [DBG] Start authorize request protocol validation
2019-08-20 11:08:10.013 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:08:10.016 +03:00 [DBG] Checking for PKCE parameters
2019-08-20 11:08:10.017 +03:00 [DBG] No PKCE used.
2019-08-20 11:08:10.019 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-20 11:08:10.022 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/home/signin-oidc","AllowedRedirectUris":["http://localhost:5002/home/signin-oidc"],"SubjectId":"anonymous","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9OXI1wnfyItF8f8xxKtSf5407EGKmfC_Jyunkp2JHuHukrGaZqs_sEFMCIvFips-loVsg0K3AL9WDXplCYuguj54FjCpO7Bl1mXI2m9m-oxDnzWUXSJwMRmeV46XuR537-NVvV8l1daAy2kRpT-UJYCOxmix3CJxIsgVJ0mHEbGUeZhuB5dLVDZfFpYC6BT8LEn36axRS_nqHP7SRexr0ZqNTELCuzPRjDnl7xc_LavUJ96sVVB8pCifLLh7Csvf-lvzkRdQT4-xMdN739ixnDiULD5wTVhRFBkFCp85CMDcQ2S-z4LkWmw1FznhoJG0zY","UiLocales":null,"Nonce":"637018852899274527.NjgwYThhYzYtYTEyOC00ZTc4LWFlYTktM2JjMWJkZGFhM2UwOWNhZDBlMjMtN2NmMC00NWIyLWEwYTgtOWM5ZGI5MjdmMGEy","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/home/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637018852899274527.NjgwYThhYzYtYTEyOC00ZTc4LWFlYTktM2JjMWJkZGFhM2UwOWNhZDBlMjMtN2NmMC00NWIyLWEwYTgtOWM5ZGI5MjdmMGEy","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9OXI1wnfyItF8f8xxKtSf5407EGKmfC_Jyunkp2JHuHukrGaZqs_sEFMCIvFips-loVsg0K3AL9WDXplCYuguj54FjCpO7Bl1mXI2m9m-oxDnzWUXSJwMRmeV46XuR537-NVvV8l1daAy2kRpT-UJYCOxmix3CJxIsgVJ0mHEbGUeZhuB5dLVDZfFpYC6BT8LEn36axRS_nqHP7SRexr0ZqNTELCuzPRjDnl7xc_LavUJ96sVVB8pCifLLh7Csvf-lvzkRdQT4-xMdN739ixnDiULD5wTVhRFBkFCp85CMDcQ2S-z4LkWmw1FznhoJG0zY","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-20 11:08:10.034 +03:00 [INF] Showing login: User is not authenticated
2019-08-20 11:08:10.045 +03:00 [DBG] Start authorize request protocol validation
2019-08-20 11:08:10.048 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:08:10.052 +03:00 [DBG] Checking for PKCE parameters
2019-08-20 11:08:10.053 +03:00 [DBG] No PKCE used.
2019-08-20 11:08:10.054 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-20 11:08:10.055 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:08:12.002 +03:00 [DBG] CORS request made for path: /account/login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-08-20 11:08:12.005 +03:00 [DBG] Start authorize request protocol validation
2019-08-20 11:08:12.008 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:08:12.010 +03:00 [DBG] Checking for PKCE parameters
2019-08-20 11:08:12.011 +03:00 [DBG] No PKCE used.
2019-08-20 11:08:12.012 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-20 11:08:12.013 +03:00 [DBG] Augmenting SignInContext
2019-08-20 11:08:12.014 +03:00 [DBG] Adding idp claim with value: local
2019-08-20 11:08:12.014 +03:00 [DBG] Adding amr claim with value: pwd
2019-08-20 11:08:12.015 +03:00 [INF] AuthenticationScheme: idsrv signed in.
2019-08-20 11:08:12.016 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:08:12.028 +03:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-08-20 11:08:12.029 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-08-20 11:08:12.031 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-08-20 11:08:12.032 +03:00 [DBG] Start authorize callback request
2019-08-20 11:08:12.035 +03:00 [DBG] User in authorize request: 1
2019-08-20 11:08:12.036 +03:00 [DBG] Start authorize request protocol validation
2019-08-20 11:08:12.037 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:08:12.038 +03:00 [DBG] Checking for PKCE parameters
2019-08-20 11:08:12.039 +03:00 [DBG] No PKCE used.
2019-08-20 11:08:12.040 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-20 11:08:12.041 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/home/signin-oidc","AllowedRedirectUris":["http://localhost:5002/home/signin-oidc"],"SubjectId":"1","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9OXI1wnfyItF8f8xxKtSf5407EGKmfC_Jyunkp2JHuHukrGaZqs_sEFMCIvFips-loVsg0K3AL9WDXplCYuguj54FjCpO7Bl1mXI2m9m-oxDnzWUXSJwMRmeV46XuR537-NVvV8l1daAy2kRpT-UJYCOxmix3CJxIsgVJ0mHEbGUeZhuB5dLVDZfFpYC6BT8LEn36axRS_nqHP7SRexr0ZqNTELCuzPRjDnl7xc_LavUJ96sVVB8pCifLLh7Csvf-lvzkRdQT4-xMdN739ixnDiULD5wTVhRFBkFCp85CMDcQ2S-z4LkWmw1FznhoJG0zY","UiLocales":null,"Nonce":"637018852899274527.NjgwYThhYzYtYTEyOC00ZTc4LWFlYTktM2JjMWJkZGFhM2UwOWNhZDBlMjMtN2NmMC00NWIyLWEwYTgtOWM5ZGI5MjdmMGEy","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"cbac3e633b35582c41e7e5a652148a6b","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/home/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637018852899274527.NjgwYThhYzYtYTEyOC00ZTc4LWFlYTktM2JjMWJkZGFhM2UwOWNhZDBlMjMtN2NmMC00NWIyLWEwYTgtOWM5ZGI5MjdmMGEy","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9OXI1wnfyItF8f8xxKtSf5407EGKmfC_Jyunkp2JHuHukrGaZqs_sEFMCIvFips-loVsg0K3AL9WDXplCYuguj54FjCpO7Bl1mXI2m9m-oxDnzWUXSJwMRmeV46XuR537-NVvV8l1daAy2kRpT-UJYCOxmix3CJxIsgVJ0mHEbGUeZhuB5dLVDZfFpYC6BT8LEn36axRS_nqHP7SRexr0ZqNTELCuzPRjDnl7xc_LavUJ96sVVB8pCifLLh7Csvf-lvzkRdQT4-xMdN739ixnDiULD5wTVhRFBkFCp85CMDcQ2S-z4LkWmw1FznhoJG0zY","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-20 11:08:12.048 +03:00 [DBG] Client is configured to not require consent, no consent is required
2019-08-20 11:08:12.050 +03:00 [DBG] Creating Hybrid Flow response.
2019-08-20 11:08:12.052 +03:00 [DBG] Creating Implicit Flow response.
2019-08-20 11:08:12.053 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 11:08:12.054 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 11:08:12.060 +03:00 [DBG] Authorize endpoint response
{"SubjectId":"1","ClientId":"mvc","RedirectUri":"http://localhost:5002/home/signin-oidc","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9OXI1wnfyItF8f8xxKtSf5407EGKmfC_Jyunkp2JHuHukrGaZqs_sEFMCIvFips-loVsg0K3AL9WDXplCYuguj54FjCpO7Bl1mXI2m9m-oxDnzWUXSJwMRmeV46XuR537-NVvV8l1daAy2kRpT-UJYCOxmix3CJxIsgVJ0mHEbGUeZhuB5dLVDZfFpYC6BT8LEn36axRS_nqHP7SRexr0ZqNTELCuzPRjDnl7xc_LavUJ96sVVB8pCifLLh7Csvf-lvzkRdQT4-xMdN739ixnDiULD5wTVhRFBkFCp85CMDcQ2S-z4LkWmw1FznhoJG0zY","Scope":"openid profile afcpayroll offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-08-20 11:08:12.065 +03:00 [DBG] Augmenting SignInContext
2019-08-20 11:08:12.066 +03:00 [INF] AuthenticationScheme: idsrv signed in.
2019-08-20 11:08:12.288 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-20 11:08:12.290 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-20 11:08:12.291 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-20 11:08:12.297 +03:00 [DBG] Start token request.
2019-08-20 11:08:12.301 +03:00 [DBG] Start client validation
2019-08-20 11:08:12.303 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-20 11:08:12.304 +03:00 [DBG] Start parsing for secret in post body
2019-08-20 11:08:12.307 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-20 11:08:12.308 +03:00 [DBG] Secret id found: mvc
2019-08-20 11:08:12.309 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:08:12.310 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-20 11:08:12.311 +03:00 [DBG] Client validation success
2019-08-20 11:08:12.312 +03:00 [DBG] Start token request validation
2019-08-20 11:08:12.313 +03:00 [DBG] Start validation of authorization code token request
2019-08-20 11:08:12.314 +03:00 [DBG] Validation of authorization code token request success
2019-08-20 11:08:12.315 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"fa11e413909a3b2e7c520489299b56861024ec0c907c03f6508b9e5b52b162f7","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"mvc","client_secret":"***REDACTED***","code":"fa11e413909a3b2e7c520489299b56861024ec0c907c03f6508b9e5b52b162f7","grant_type":"authorization_code","redirect_uri":"http://localhost:5002/home/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-08-20 11:08:12.321 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:08:12.322 +03:00 [DBG] Getting claims for access token for client: mvc
2019-08-20 11:08:12.323 +03:00 [DBG] Getting claims for access token for subject: 1
2019-08-20 11:08:12.328 +03:00 [DBG] Creating refresh token
2019-08-20 11:08:12.328 +03:00 [DBG] Setting an absolute lifetime: 2592000
2019-08-20 11:08:12.329 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:08:12.331 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 11:08:12.333 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 11:08:12.338 +03:00 [DBG] Token request success.
2019-08-20 11:08:12.354 +03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-08-20 11:08:12.356 +03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-08-20 11:08:12.357 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-08-20 11:08:12.358 +03:00 [DBG] Start userinfo request
2019-08-20 11:08:12.359 +03:00 [DBG] Bearer token found in header
2019-08-20 11:08:12.363 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:08:12.367 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:08:12.369 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-08-20 11:08:12.371 +03:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1566288492,"exp":1566288552,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","afcpayroll"],"client_id":"mvc","sub":"1","auth_time":1566288492,"idp":"local","name":"alice","email":"alice@email.com","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-08-20 11:08:12.375 +03:00 [DBG] Creating userinfo response
2019-08-20 11:08:12.377 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:08:12.379 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:08:12.381 +03:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 11:08:12.383 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:08:12.386 +03:00 [INF] Profile service returned the following claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 11:08:12.388 +03:00 [DBG] End userinfo request
2019-08-20 11:19:32.004 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-20 11:19:32.008 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-20 11:19:32.010 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-20 11:19:32.012 +03:00 [DBG] Start discovery request
2019-08-20 11:19:32.155 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-20 11:19:32.157 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-20 11:19:32.162 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-20 11:19:32.163 +03:00 [DBG] Start key discovery request
2019-08-20 11:19:43.016 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-08-20 11:19:43.018 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-08-20 11:19:43.019 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-08-20 11:19:43.020 +03:00 [DBG] Start authorize request
2019-08-20 11:19:43.027 +03:00 [DBG] No user present in authorize request
2019-08-20 11:19:43.029 +03:00 [DBG] Start authorize request protocol validation
2019-08-20 11:19:43.031 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:19:43.036 +03:00 [DBG] Checking for PKCE parameters
2019-08-20 11:19:43.037 +03:00 [DBG] No PKCE used.
2019-08-20 11:19:43.039 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-20 11:19:43.064 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/home/signin-oidc","AllowedRedirectUris":["http://localhost:5002/home/signin-oidc"],"SubjectId":"anonymous","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9NpPzPpGzJS33dYA7E2uKCgLFEyE1-ol3JF14C1CdZtXeu-5-sTWNDN7RCEhdd2aY6RSaSQcKkQO_3qJxe9ziyZ_0NVHR1xkGpr1x9ThfIcTqPtefvWf9PRlptQ9aQeXY8SOyy0YdlMbVz9OGrUOz2qpTCRMkSwFDKXRn7oEXtivDe2uHSBd5G-qMQbJBEM9x_iN-piaKgxL-2Ao78M1jSlMnIg2Cgx4hcmuZr2iCfv3Ui3pswyOx7hfRUg2VNQPZyIKuPZIAPYmVLa8sg0Vi8Zrm0xVcknuVpaggEvlM-ws9b-XP_Je9W1txk_tZVSRJ4","UiLocales":null,"Nonce":"637018859829856365.NTJmMDc3NjgtODRjZC00N2NhLWI5OGQtOGNhZTI1NWI5MDg4MDgzYzNkZjQtNjc4OC00MjJkLWJiNjYtNzY4OWFlZDg5MTZl","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/home/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637018859829856365.NTJmMDc3NjgtODRjZC00N2NhLWI5OGQtOGNhZTI1NWI5MDg4MDgzYzNkZjQtNjc4OC00MjJkLWJiNjYtNzY4OWFlZDg5MTZl","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9NpPzPpGzJS33dYA7E2uKCgLFEyE1-ol3JF14C1CdZtXeu-5-sTWNDN7RCEhdd2aY6RSaSQcKkQO_3qJxe9ziyZ_0NVHR1xkGpr1x9ThfIcTqPtefvWf9PRlptQ9aQeXY8SOyy0YdlMbVz9OGrUOz2qpTCRMkSwFDKXRn7oEXtivDe2uHSBd5G-qMQbJBEM9x_iN-piaKgxL-2Ao78M1jSlMnIg2Cgx4hcmuZr2iCfv3Ui3pswyOx7hfRUg2VNQPZyIKuPZIAPYmVLa8sg0Vi8Zrm0xVcknuVpaggEvlM-ws9b-XP_Je9W1txk_tZVSRJ4","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-20 11:19:43.076 +03:00 [INF] Showing login: User is not authenticated
2019-08-20 11:19:43.085 +03:00 [DBG] Start authorize request protocol validation
2019-08-20 11:19:43.086 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:19:43.089 +03:00 [DBG] Checking for PKCE parameters
2019-08-20 11:19:43.090 +03:00 [DBG] No PKCE used.
2019-08-20 11:19:43.092 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-20 11:19:43.093 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:19:45.138 +03:00 [DBG] CORS request made for path: /account/login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-08-20 11:19:45.142 +03:00 [DBG] Start authorize request protocol validation
2019-08-20 11:19:45.143 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:19:45.144 +03:00 [DBG] Checking for PKCE parameters
2019-08-20 11:19:45.145 +03:00 [DBG] No PKCE used.
2019-08-20 11:19:45.147 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-20 11:19:45.148 +03:00 [DBG] Augmenting SignInContext
2019-08-20 11:19:45.149 +03:00 [DBG] Adding idp claim with value: local
2019-08-20 11:19:45.149 +03:00 [DBG] Adding amr claim with value: pwd
2019-08-20 11:19:45.151 +03:00 [INF] AuthenticationScheme: idsrv signed in.
2019-08-20 11:19:45.152 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:19:45.162 +03:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-08-20 11:19:45.165 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-08-20 11:19:45.166 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-08-20 11:19:45.168 +03:00 [DBG] Start authorize callback request
2019-08-20 11:19:45.169 +03:00 [DBG] User in authorize request: 1
2019-08-20 11:19:45.170 +03:00 [DBG] Start authorize request protocol validation
2019-08-20 11:19:45.170 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:19:45.171 +03:00 [DBG] Checking for PKCE parameters
2019-08-20 11:19:45.172 +03:00 [DBG] No PKCE used.
2019-08-20 11:19:45.174 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-20 11:19:45.177 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/home/signin-oidc","AllowedRedirectUris":["http://localhost:5002/home/signin-oidc"],"SubjectId":"1","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9NpPzPpGzJS33dYA7E2uKCgLFEyE1-ol3JF14C1CdZtXeu-5-sTWNDN7RCEhdd2aY6RSaSQcKkQO_3qJxe9ziyZ_0NVHR1xkGpr1x9ThfIcTqPtefvWf9PRlptQ9aQeXY8SOyy0YdlMbVz9OGrUOz2qpTCRMkSwFDKXRn7oEXtivDe2uHSBd5G-qMQbJBEM9x_iN-piaKgxL-2Ao78M1jSlMnIg2Cgx4hcmuZr2iCfv3Ui3pswyOx7hfRUg2VNQPZyIKuPZIAPYmVLa8sg0Vi8Zrm0xVcknuVpaggEvlM-ws9b-XP_Je9W1txk_tZVSRJ4","UiLocales":null,"Nonce":"637018859829856365.NTJmMDc3NjgtODRjZC00N2NhLWI5OGQtOGNhZTI1NWI5MDg4MDgzYzNkZjQtNjc4OC00MjJkLWJiNjYtNzY4OWFlZDg5MTZl","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"01601862b42fdb09ff90cf02e4274331","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/home/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637018859829856365.NTJmMDc3NjgtODRjZC00N2NhLWI5OGQtOGNhZTI1NWI5MDg4MDgzYzNkZjQtNjc4OC00MjJkLWJiNjYtNzY4OWFlZDg5MTZl","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9NpPzPpGzJS33dYA7E2uKCgLFEyE1-ol3JF14C1CdZtXeu-5-sTWNDN7RCEhdd2aY6RSaSQcKkQO_3qJxe9ziyZ_0NVHR1xkGpr1x9ThfIcTqPtefvWf9PRlptQ9aQeXY8SOyy0YdlMbVz9OGrUOz2qpTCRMkSwFDKXRn7oEXtivDe2uHSBd5G-qMQbJBEM9x_iN-piaKgxL-2Ao78M1jSlMnIg2Cgx4hcmuZr2iCfv3Ui3pswyOx7hfRUg2VNQPZyIKuPZIAPYmVLa8sg0Vi8Zrm0xVcknuVpaggEvlM-ws9b-XP_Je9W1txk_tZVSRJ4","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-20 11:19:45.185 +03:00 [DBG] Client is configured to not require consent, no consent is required
2019-08-20 11:19:45.186 +03:00 [DBG] Creating Hybrid Flow response.
2019-08-20 11:19:45.187 +03:00 [DBG] Creating Implicit Flow response.
2019-08-20 11:19:45.187 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 11:19:45.188 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 11:19:45.195 +03:00 [DBG] Authorize endpoint response
{"SubjectId":"1","ClientId":"mvc","RedirectUri":"http://localhost:5002/home/signin-oidc","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9NpPzPpGzJS33dYA7E2uKCgLFEyE1-ol3JF14C1CdZtXeu-5-sTWNDN7RCEhdd2aY6RSaSQcKkQO_3qJxe9ziyZ_0NVHR1xkGpr1x9ThfIcTqPtefvWf9PRlptQ9aQeXY8SOyy0YdlMbVz9OGrUOz2qpTCRMkSwFDKXRn7oEXtivDe2uHSBd5G-qMQbJBEM9x_iN-piaKgxL-2Ao78M1jSlMnIg2Cgx4hcmuZr2iCfv3Ui3pswyOx7hfRUg2VNQPZyIKuPZIAPYmVLa8sg0Vi8Zrm0xVcknuVpaggEvlM-ws9b-XP_Je9W1txk_tZVSRJ4","Scope":"openid profile afcpayroll offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-08-20 11:19:45.201 +03:00 [DBG] Augmenting SignInContext
2019-08-20 11:19:45.202 +03:00 [INF] AuthenticationScheme: idsrv signed in.
2019-08-20 11:19:45.433 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-20 11:19:45.434 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-20 11:19:45.435 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-20 11:19:45.436 +03:00 [DBG] Start token request.
2019-08-20 11:19:45.436 +03:00 [DBG] Start client validation
2019-08-20 11:19:45.438 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-20 11:19:45.438 +03:00 [DBG] Start parsing for secret in post body
2019-08-20 11:19:45.440 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-20 11:19:45.440 +03:00 [DBG] Secret id found: mvc
2019-08-20 11:19:45.441 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:19:45.441 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-20 11:19:45.442 +03:00 [DBG] Client validation success
2019-08-20 11:19:45.442 +03:00 [DBG] Start token request validation
2019-08-20 11:19:45.444 +03:00 [DBG] Start validation of authorization code token request
2019-08-20 11:19:45.446 +03:00 [DBG] Validation of authorization code token request success
2019-08-20 11:19:45.447 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"ea10500af82fcf931661ab8492640dc94870ad61484c3afd6cb8339ea4bac3fd","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"mvc","client_secret":"***REDACTED***","code":"ea10500af82fcf931661ab8492640dc94870ad61484c3afd6cb8339ea4bac3fd","grant_type":"authorization_code","redirect_uri":"http://localhost:5002/home/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-08-20 11:19:45.451 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:19:45.451 +03:00 [DBG] Getting claims for access token for client: mvc
2019-08-20 11:19:45.452 +03:00 [DBG] Getting claims for access token for subject: 1
2019-08-20 11:19:45.456 +03:00 [DBG] Creating refresh token
2019-08-20 11:19:45.457 +03:00 [DBG] Setting an absolute lifetime: 2592000
2019-08-20 11:19:45.458 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:19:45.458 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 11:19:45.459 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 11:19:45.463 +03:00 [DBG] Token request success.
2019-08-20 11:19:45.472 +03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-08-20 11:19:45.475 +03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-08-20 11:19:45.476 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-08-20 11:19:45.476 +03:00 [DBG] Start userinfo request
2019-08-20 11:19:45.477 +03:00 [DBG] Bearer token found in header
2019-08-20 11:19:45.480 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:19:45.481 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:19:45.481 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-08-20 11:19:45.482 +03:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1566289185,"exp":1566289245,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","afcpayroll"],"client_id":"mvc","sub":"1","auth_time":1566289185,"idp":"local","name":"alice","email":"alice@email.com","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-08-20 11:19:45.486 +03:00 [DBG] Creating userinfo response
2019-08-20 11:19:45.486 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:19:45.487 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:19:45.487 +03:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 11:19:45.488 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:19:45.489 +03:00 [INF] Profile service returned the following claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 11:19:45.489 +03:00 [DBG] End userinfo request
2019-08-20 11:20:10.775 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-20 11:20:10.782 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-20 11:20:10.791 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-20 11:20:10.795 +03:00 [DBG] Start discovery request
2019-08-20 11:20:10.968 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-20 11:20:10.969 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-20 11:20:10.970 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-20 11:20:10.970 +03:00 [DBG] Start key discovery request
2019-08-20 11:20:11.054 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-08-20 11:20:11.057 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-08-20 11:20:11.057 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-08-20 11:20:11.058 +03:00 [DBG] Start authorize request
2019-08-20 11:20:11.059 +03:00 [DBG] User in authorize request: 1
2019-08-20 11:20:11.059 +03:00 [DBG] Start authorize request protocol validation
2019-08-20 11:20:11.060 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:20:11.060 +03:00 [DBG] Checking for PKCE parameters
2019-08-20 11:20:11.061 +03:00 [DBG] No PKCE used.
2019-08-20 11:20:11.062 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-20 11:20:11.064 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/home/signin-oidc","AllowedRedirectUris":["http://localhost:5002/home/signin-oidc"],"SubjectId":"1","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9OoZVneMybq_YWlQS2f9Z3xPkBn4tlLSNxdzlteyTyjmRLpcrx_Ypwny1gCAMuKhcNYOgrTgLvu2ilxV2Va1KfO_dqMsGuh1t7nHmtfEAuuvWulq4uFTjlXVwyhO2Zfi7qQd7zdNwHSXKPO0kpa_LSdph2722gxyh5nYn0BhoRT9MXB1GccQ_rLIOPKl02e5MT3MX83Z-_jKx3guQTm5qT8Bz6V6fJArhxmIk2pYGZGEZ_qAR5lbwCusbSpqKERuVFSqF61LRf5rcEKDiDLZgUvUXea-5qUZ5Usk8EG_mZyt-YD8NhKUaEY_3IaAj_NQjI","UiLocales":null,"Nonce":"637018860109927928.NWZiYmNkNTctODBiZS00NjZjLWI1ODgtMzU0N2EyNmQ0NjBjZTdhNTJjMzUtYjljYi00OTdhLWI5OWQtZDVjMTMzMTcxZTY4","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"01601862b42fdb09ff90cf02e4274331","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/home/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637018860109927928.NWZiYmNkNTctODBiZS00NjZjLWI1ODgtMzU0N2EyNmQ0NjBjZTdhNTJjMzUtYjljYi00OTdhLWI5OWQtZDVjMTMzMTcxZTY4","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9OoZVneMybq_YWlQS2f9Z3xPkBn4tlLSNxdzlteyTyjmRLpcrx_Ypwny1gCAMuKhcNYOgrTgLvu2ilxV2Va1KfO_dqMsGuh1t7nHmtfEAuuvWulq4uFTjlXVwyhO2Zfi7qQd7zdNwHSXKPO0kpa_LSdph2722gxyh5nYn0BhoRT9MXB1GccQ_rLIOPKl02e5MT3MX83Z-_jKx3guQTm5qT8Bz6V6fJArhxmIk2pYGZGEZ_qAR5lbwCusbSpqKERuVFSqF61LRf5rcEKDiDLZgUvUXea-5qUZ5Usk8EG_mZyt-YD8NhKUaEY_3IaAj_NQjI","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-20 11:20:11.076 +03:00 [DBG] Client is configured to not require consent, no consent is required
2019-08-20 11:20:11.077 +03:00 [DBG] Creating Hybrid Flow response.
2019-08-20 11:20:11.077 +03:00 [DBG] Creating Implicit Flow response.
2019-08-20 11:20:11.078 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 11:20:11.078 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 11:20:11.084 +03:00 [DBG] Authorize endpoint response
{"SubjectId":"1","ClientId":"mvc","RedirectUri":"http://localhost:5002/home/signin-oidc","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9OoZVneMybq_YWlQS2f9Z3xPkBn4tlLSNxdzlteyTyjmRLpcrx_Ypwny1gCAMuKhcNYOgrTgLvu2ilxV2Va1KfO_dqMsGuh1t7nHmtfEAuuvWulq4uFTjlXVwyhO2Zfi7qQd7zdNwHSXKPO0kpa_LSdph2722gxyh5nYn0BhoRT9MXB1GccQ_rLIOPKl02e5MT3MX83Z-_jKx3guQTm5qT8Bz6V6fJArhxmIk2pYGZGEZ_qAR5lbwCusbSpqKERuVFSqF61LRf5rcEKDiDLZgUvUXea-5qUZ5Usk8EG_mZyt-YD8NhKUaEY_3IaAj_NQjI","Scope":"openid profile afcpayroll offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-08-20 11:20:11.415 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-20 11:20:11.417 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-20 11:20:11.418 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-20 11:20:11.419 +03:00 [DBG] Start token request.
2019-08-20 11:20:11.420 +03:00 [DBG] Start client validation
2019-08-20 11:20:11.420 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-20 11:20:11.425 +03:00 [DBG] Start parsing for secret in post body
2019-08-20 11:20:11.426 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-20 11:20:11.427 +03:00 [DBG] Secret id found: mvc
2019-08-20 11:20:11.428 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:20:11.429 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-20 11:20:11.429 +03:00 [DBG] Client validation success
2019-08-20 11:20:11.430 +03:00 [DBG] Start token request validation
2019-08-20 11:20:11.430 +03:00 [DBG] Start validation of authorization code token request
2019-08-20 11:20:11.431 +03:00 [DBG] Validation of authorization code token request success
2019-08-20 11:20:11.431 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"d23636c16edbf4d059dd02e3d53ebecb6a7cd097c6497a67688b1d9338e5b193","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"mvc","client_secret":"***REDACTED***","code":"d23636c16edbf4d059dd02e3d53ebecb6a7cd097c6497a67688b1d9338e5b193","grant_type":"authorization_code","redirect_uri":"http://localhost:5002/home/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-08-20 11:20:11.435 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:20:11.435 +03:00 [DBG] Getting claims for access token for client: mvc
2019-08-20 11:20:11.436 +03:00 [DBG] Getting claims for access token for subject: 1
2019-08-20 11:20:11.443 +03:00 [DBG] Creating refresh token
2019-08-20 11:20:11.443 +03:00 [DBG] Setting an absolute lifetime: 2592000
2019-08-20 11:20:11.444 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:20:11.445 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 11:20:11.445 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 11:20:11.449 +03:00 [DBG] Token request success.
2019-08-20 11:20:11.460 +03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-08-20 11:20:11.460 +03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-08-20 11:20:11.461 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-08-20 11:20:11.461 +03:00 [DBG] Start userinfo request
2019-08-20 11:20:11.462 +03:00 [DBG] Bearer token found in header
2019-08-20 11:20:11.464 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:20:11.465 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:20:11.466 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-08-20 11:20:11.466 +03:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1566289211,"exp":1566289271,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","afcpayroll"],"client_id":"mvc","sub":"1","auth_time":1566289185,"idp":"local","name":"alice","email":"alice@email.com","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-08-20 11:20:11.470 +03:00 [DBG] Creating userinfo response
2019-08-20 11:20:11.471 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:20:11.474 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:20:11.474 +03:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 11:20:11.475 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:20:11.476 +03:00 [INF] Profile service returned the following claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 11:20:11.476 +03:00 [DBG] End userinfo request
2019-08-20 11:47:46.256 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-20 11:47:46.257 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-20 11:47:46.258 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-20 11:47:46.259 +03:00 [DBG] Start discovery request
2019-08-20 11:47:46.418 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-20 11:47:46.419 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-20 11:47:46.420 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-20 11:47:46.420 +03:00 [DBG] Start key discovery request
2019-08-20 11:47:46.481 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-08-20 11:47:46.483 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-08-20 11:47:46.484 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-08-20 11:47:46.484 +03:00 [DBG] Start authorize request
2019-08-20 11:47:46.485 +03:00 [DBG] No user present in authorize request
2019-08-20 11:47:46.486 +03:00 [DBG] Start authorize request protocol validation
2019-08-20 11:47:46.486 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:47:46.487 +03:00 [DBG] Checking for PKCE parameters
2019-08-20 11:47:46.487 +03:00 [DBG] No PKCE used.
2019-08-20 11:47:46.488 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-20 11:47:46.489 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/home/signin-oidc","AllowedRedirectUris":["http://localhost:5002/home/signin-oidc"],"SubjectId":"anonymous","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9Mzpsi8zXp-e_1zQCpXUbe-S2gArcP8AcPWtdPSFWlm0tkY4jY95I8c83xeMY8bvWv1cAYLOFF5oBHl0Dm-9DfAWorJSfa7wKWVUSkk1geNIL_ay1obomuPjqcsVqy3wFcFT_HNNFsOIX80bMvuMUem-EXrghV4piCk5kXSMlEByitFhE_Yuq1Imcqu80Ph1PjKxwFScta2ojHKdFCRYBMnmJjF_UycAZXl4drHR8qRsJ7aD8qCS_xKhHzmdo1_-LOMVi0_0t9btJ5id0a-B4ldzBSVM5yEP-lFpQO-0PxNS-oshpKBmiGv7UiszvYnsJE","UiLocales":null,"Nonce":"637018876664421366.Zjc4Njg2YmEtMDVlZS00NWM1LWExOGQtNGY3MTM4NTk2MDA4MjhiZDEwYmQtZjkwNC00Nzk2LWE4OTQtYzhiNWFjNDg5MTUz","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/home/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637018876664421366.Zjc4Njg2YmEtMDVlZS00NWM1LWExOGQtNGY3MTM4NTk2MDA4MjhiZDEwYmQtZjkwNC00Nzk2LWE4OTQtYzhiNWFjNDg5MTUz","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9Mzpsi8zXp-e_1zQCpXUbe-S2gArcP8AcPWtdPSFWlm0tkY4jY95I8c83xeMY8bvWv1cAYLOFF5oBHl0Dm-9DfAWorJSfa7wKWVUSkk1geNIL_ay1obomuPjqcsVqy3wFcFT_HNNFsOIX80bMvuMUem-EXrghV4piCk5kXSMlEByitFhE_Yuq1Imcqu80Ph1PjKxwFScta2ojHKdFCRYBMnmJjF_UycAZXl4drHR8qRsJ7aD8qCS_xKhHzmdo1_-LOMVi0_0t9btJ5id0a-B4ldzBSVM5yEP-lFpQO-0PxNS-oshpKBmiGv7UiszvYnsJE","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-20 11:47:46.498 +03:00 [INF] Showing login: User is not authenticated
2019-08-20 11:47:46.508 +03:00 [DBG] Start authorize request protocol validation
2019-08-20 11:47:46.509 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:47:46.510 +03:00 [DBG] Checking for PKCE parameters
2019-08-20 11:47:46.511 +03:00 [DBG] No PKCE used.
2019-08-20 11:47:46.512 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-20 11:47:46.514 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:47:48.507 +03:00 [DBG] CORS request made for path: /account/login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-08-20 11:47:48.509 +03:00 [DBG] Start authorize request protocol validation
2019-08-20 11:47:48.510 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:47:48.511 +03:00 [DBG] Checking for PKCE parameters
2019-08-20 11:47:48.512 +03:00 [DBG] No PKCE used.
2019-08-20 11:47:48.512 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-20 11:47:48.513 +03:00 [DBG] Augmenting SignInContext
2019-08-20 11:47:48.514 +03:00 [DBG] Adding idp claim with value: local
2019-08-20 11:47:48.515 +03:00 [DBG] Adding amr claim with value: pwd
2019-08-20 11:47:48.517 +03:00 [INF] AuthenticationScheme: idsrv signed in.
2019-08-20 11:47:48.518 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:47:48.528 +03:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-08-20 11:47:48.530 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-08-20 11:47:48.530 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-08-20 11:47:48.531 +03:00 [DBG] Start authorize callback request
2019-08-20 11:47:48.532 +03:00 [DBG] User in authorize request: 1
2019-08-20 11:47:48.532 +03:00 [DBG] Start authorize request protocol validation
2019-08-20 11:47:48.533 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:47:48.533 +03:00 [DBG] Checking for PKCE parameters
2019-08-20 11:47:48.534 +03:00 [DBG] No PKCE used.
2019-08-20 11:47:48.535 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-20 11:47:48.535 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/home/signin-oidc","AllowedRedirectUris":["http://localhost:5002/home/signin-oidc"],"SubjectId":"1","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9Mzpsi8zXp-e_1zQCpXUbe-S2gArcP8AcPWtdPSFWlm0tkY4jY95I8c83xeMY8bvWv1cAYLOFF5oBHl0Dm-9DfAWorJSfa7wKWVUSkk1geNIL_ay1obomuPjqcsVqy3wFcFT_HNNFsOIX80bMvuMUem-EXrghV4piCk5kXSMlEByitFhE_Yuq1Imcqu80Ph1PjKxwFScta2ojHKdFCRYBMnmJjF_UycAZXl4drHR8qRsJ7aD8qCS_xKhHzmdo1_-LOMVi0_0t9btJ5id0a-B4ldzBSVM5yEP-lFpQO-0PxNS-oshpKBmiGv7UiszvYnsJE","UiLocales":null,"Nonce":"637018876664421366.Zjc4Njg2YmEtMDVlZS00NWM1LWExOGQtNGY3MTM4NTk2MDA4MjhiZDEwYmQtZjkwNC00Nzk2LWE4OTQtYzhiNWFjNDg5MTUz","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"e74d8cbe5a0a3326c07e4e0a82ece454","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/home/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637018876664421366.Zjc4Njg2YmEtMDVlZS00NWM1LWExOGQtNGY3MTM4NTk2MDA4MjhiZDEwYmQtZjkwNC00Nzk2LWE4OTQtYzhiNWFjNDg5MTUz","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9Mzpsi8zXp-e_1zQCpXUbe-S2gArcP8AcPWtdPSFWlm0tkY4jY95I8c83xeMY8bvWv1cAYLOFF5oBHl0Dm-9DfAWorJSfa7wKWVUSkk1geNIL_ay1obomuPjqcsVqy3wFcFT_HNNFsOIX80bMvuMUem-EXrghV4piCk5kXSMlEByitFhE_Yuq1Imcqu80Ph1PjKxwFScta2ojHKdFCRYBMnmJjF_UycAZXl4drHR8qRsJ7aD8qCS_xKhHzmdo1_-LOMVi0_0t9btJ5id0a-B4ldzBSVM5yEP-lFpQO-0PxNS-oshpKBmiGv7UiszvYnsJE","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-20 11:47:48.544 +03:00 [DBG] Client is configured to not require consent, no consent is required
2019-08-20 11:47:48.544 +03:00 [DBG] Creating Hybrid Flow response.
2019-08-20 11:47:48.545 +03:00 [DBG] Creating Implicit Flow response.
2019-08-20 11:47:48.546 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 11:47:48.546 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 11:47:48.551 +03:00 [DBG] Authorize endpoint response
{"SubjectId":"1","ClientId":"mvc","RedirectUri":"http://localhost:5002/home/signin-oidc","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9Mzpsi8zXp-e_1zQCpXUbe-S2gArcP8AcPWtdPSFWlm0tkY4jY95I8c83xeMY8bvWv1cAYLOFF5oBHl0Dm-9DfAWorJSfa7wKWVUSkk1geNIL_ay1obomuPjqcsVqy3wFcFT_HNNFsOIX80bMvuMUem-EXrghV4piCk5kXSMlEByitFhE_Yuq1Imcqu80Ph1PjKxwFScta2ojHKdFCRYBMnmJjF_UycAZXl4drHR8qRsJ7aD8qCS_xKhHzmdo1_-LOMVi0_0t9btJ5id0a-B4ldzBSVM5yEP-lFpQO-0PxNS-oshpKBmiGv7UiszvYnsJE","Scope":"openid profile afcpayroll offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-08-20 11:47:48.554 +03:00 [DBG] Augmenting SignInContext
2019-08-20 11:47:48.554 +03:00 [INF] AuthenticationScheme: idsrv signed in.
2019-08-20 11:47:48.876 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-20 11:47:48.877 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-20 11:47:48.878 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-20 11:47:48.879 +03:00 [DBG] Start token request.
2019-08-20 11:47:48.879 +03:00 [DBG] Start client validation
2019-08-20 11:47:48.880 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-20 11:47:48.880 +03:00 [DBG] Start parsing for secret in post body
2019-08-20 11:47:48.881 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-20 11:47:48.881 +03:00 [DBG] Secret id found: mvc
2019-08-20 11:47:48.882 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:47:48.883 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-20 11:47:48.883 +03:00 [DBG] Client validation success
2019-08-20 11:47:48.884 +03:00 [DBG] Start token request validation
2019-08-20 11:47:48.884 +03:00 [DBG] Start validation of authorization code token request
2019-08-20 11:47:48.884 +03:00 [DBG] Validation of authorization code token request success
2019-08-20 11:47:48.885 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"e77190f3cb7d0774ec08f95c7106e00843cfd9e95d690bfc0e75311d1d734f7c","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"mvc","client_secret":"***REDACTED***","code":"e77190f3cb7d0774ec08f95c7106e00843cfd9e95d690bfc0e75311d1d734f7c","grant_type":"authorization_code","redirect_uri":"http://localhost:5002/home/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-08-20 11:47:48.891 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:47:48.892 +03:00 [DBG] Getting claims for access token for client: mvc
2019-08-20 11:47:48.892 +03:00 [DBG] Getting claims for access token for subject: 1
2019-08-20 11:47:48.897 +03:00 [DBG] Creating refresh token
2019-08-20 11:47:48.897 +03:00 [DBG] Setting an absolute lifetime: 2592000
2019-08-20 11:47:48.898 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:47:48.899 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 11:47:48.899 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 11:47:48.903 +03:00 [DBG] Token request success.
2019-08-20 11:47:48.914 +03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-08-20 11:47:48.915 +03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-08-20 11:47:48.915 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-08-20 11:47:48.916 +03:00 [DBG] Start userinfo request
2019-08-20 11:47:48.916 +03:00 [DBG] Bearer token found in header
2019-08-20 11:47:48.919 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:47:48.920 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:47:48.920 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-08-20 11:47:48.921 +03:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1566290868,"exp":1566290928,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","afcpayroll"],"client_id":"mvc","sub":"1","auth_time":1566290868,"idp":"local","name":"alice","email":"alice@email.com","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-08-20 11:47:48.928 +03:00 [DBG] Creating userinfo response
2019-08-20 11:47:48.929 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:47:48.929 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:47:48.930 +03:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 11:47:48.930 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:47:48.931 +03:00 [INF] Profile service returned the following claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 11:47:48.932 +03:00 [DBG] End userinfo request
2019-08-20 11:48:14.129 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-08-20 11:48:14.135 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-08-20 11:48:14.136 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-08-20 11:48:14.137 +03:00 [DBG] Start authorize request
2019-08-20 11:48:14.137 +03:00 [DBG] User in authorize request: 1
2019-08-20 11:48:14.138 +03:00 [DBG] Start authorize request protocol validation
2019-08-20 11:48:14.138 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:14.139 +03:00 [DBG] Checking for PKCE parameters
2019-08-20 11:48:14.140 +03:00 [DBG] No PKCE used.
2019-08-20 11:48:14.140 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-20 11:48:14.141 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/home/signin-oidc","AllowedRedirectUris":["http://localhost:5002/home/signin-oidc"],"SubjectId":"1","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9Mp8oZRHgJo8T6rh0iF526NINMO3Qo1zLoXD2seoFfBzKFVbtFSpUwvGmVHYPZCZs5Tvp3tn7Y-gAbr1io56U5iMgLBdF8IMtbjVWasz2-BXDhi0IcWPfoCfefZRxwL-ZnHDjT3lddvCWwpgdvOzyndcX8nzJmHqunNEbJojG8JDXEfQNv7n2BrDZYGDmTdU90bEOtpgJF-z9ixDFDTNtPbj295jx5Zipp3YwnE2kzpd9nLV0kWCQdnyYQqk5NTCyXxB5Gsyg5p_jiNFStS3sCYTJ2r9i34S_jUJh4u6Yh7c4i1F_L6P6_6RrS1Xf8FY6U","UiLocales":null,"Nonce":"637018876941010027.ZDg0NzVkNjgtMTUxOC00ZjM2LTgwOGYtYWFjYWU1NTExNGI3Yzk4ZjIyYmEtYTQ5Zi00NmVmLTgxMTUtZTY4ZjkzMDJhZTEx","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"e74d8cbe5a0a3326c07e4e0a82ece454","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/home/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637018876941010027.ZDg0NzVkNjgtMTUxOC00ZjM2LTgwOGYtYWFjYWU1NTExNGI3Yzk4ZjIyYmEtYTQ5Zi00NmVmLTgxMTUtZTY4ZjkzMDJhZTEx","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9Mp8oZRHgJo8T6rh0iF526NINMO3Qo1zLoXD2seoFfBzKFVbtFSpUwvGmVHYPZCZs5Tvp3tn7Y-gAbr1io56U5iMgLBdF8IMtbjVWasz2-BXDhi0IcWPfoCfefZRxwL-ZnHDjT3lddvCWwpgdvOzyndcX8nzJmHqunNEbJojG8JDXEfQNv7n2BrDZYGDmTdU90bEOtpgJF-z9ixDFDTNtPbj295jx5Zipp3YwnE2kzpd9nLV0kWCQdnyYQqk5NTCyXxB5Gsyg5p_jiNFStS3sCYTJ2r9i34S_jUJh4u6Yh7c4i1F_L6P6_6RrS1Xf8FY6U","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-20 11:48:14.150 +03:00 [DBG] Client is configured to not require consent, no consent is required
2019-08-20 11:48:14.150 +03:00 [DBG] Creating Hybrid Flow response.
2019-08-20 11:48:14.151 +03:00 [DBG] Creating Implicit Flow response.
2019-08-20 11:48:14.151 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 11:48:14.152 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 11:48:14.157 +03:00 [DBG] Authorize endpoint response
{"SubjectId":"1","ClientId":"mvc","RedirectUri":"http://localhost:5002/home/signin-oidc","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9Mp8oZRHgJo8T6rh0iF526NINMO3Qo1zLoXD2seoFfBzKFVbtFSpUwvGmVHYPZCZs5Tvp3tn7Y-gAbr1io56U5iMgLBdF8IMtbjVWasz2-BXDhi0IcWPfoCfefZRxwL-ZnHDjT3lddvCWwpgdvOzyndcX8nzJmHqunNEbJojG8JDXEfQNv7n2BrDZYGDmTdU90bEOtpgJF-z9ixDFDTNtPbj295jx5Zipp3YwnE2kzpd9nLV0kWCQdnyYQqk5NTCyXxB5Gsyg5p_jiNFStS3sCYTJ2r9i34S_jUJh4u6Yh7c4i1F_L6P6_6RrS1Xf8FY6U","Scope":"openid profile afcpayroll offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-08-20 11:48:14.402 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-20 11:48:14.403 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-20 11:48:14.404 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-20 11:48:14.405 +03:00 [DBG] Start token request.
2019-08-20 11:48:14.405 +03:00 [DBG] Start client validation
2019-08-20 11:48:14.405 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-20 11:48:14.406 +03:00 [DBG] Start parsing for secret in post body
2019-08-20 11:48:14.407 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-20 11:48:14.407 +03:00 [DBG] Secret id found: mvc
2019-08-20 11:48:14.408 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:14.410 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-20 11:48:14.411 +03:00 [DBG] Client validation success
2019-08-20 11:48:14.411 +03:00 [DBG] Start token request validation
2019-08-20 11:48:14.412 +03:00 [DBG] Start validation of authorization code token request
2019-08-20 11:48:14.413 +03:00 [DBG] Validation of authorization code token request success
2019-08-20 11:48:14.413 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"a46b6b9813bad4b4f9b9aed6bf39f8a53bd188e4a54c6999153e1667244eec87","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"mvc","client_secret":"***REDACTED***","code":"a46b6b9813bad4b4f9b9aed6bf39f8a53bd188e4a54c6999153e1667244eec87","grant_type":"authorization_code","redirect_uri":"http://localhost:5002/home/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-08-20 11:48:14.418 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:14.419 +03:00 [DBG] Getting claims for access token for client: mvc
2019-08-20 11:48:14.420 +03:00 [DBG] Getting claims for access token for subject: 1
2019-08-20 11:48:14.425 +03:00 [DBG] Creating refresh token
2019-08-20 11:48:14.425 +03:00 [DBG] Setting an absolute lifetime: 2592000
2019-08-20 11:48:14.426 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:14.427 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 11:48:14.428 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 11:48:14.432 +03:00 [DBG] Token request success.
2019-08-20 11:48:14.435 +03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-08-20 11:48:14.436 +03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-08-20 11:48:14.438 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-08-20 11:48:14.439 +03:00 [DBG] Start userinfo request
2019-08-20 11:48:14.439 +03:00 [DBG] Bearer token found in header
2019-08-20 11:48:14.442 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:14.443 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:14.443 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-08-20 11:48:14.445 +03:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1566290894,"exp":1566290954,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","afcpayroll"],"client_id":"mvc","sub":"1","auth_time":1566290868,"idp":"local","name":"alice","email":"alice@email.com","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-08-20 11:48:14.450 +03:00 [DBG] Creating userinfo response
2019-08-20 11:48:14.450 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:48:14.451 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:48:14.452 +03:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 11:48:14.452 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:48:14.453 +03:00 [INF] Profile service returned the following claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 11:48:14.453 +03:00 [DBG] End userinfo request
2019-08-20 11:48:20.839 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-08-20 11:48:20.840 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-08-20 11:48:20.841 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-08-20 11:48:20.842 +03:00 [DBG] Start authorize request
2019-08-20 11:48:20.842 +03:00 [DBG] User in authorize request: 1
2019-08-20 11:48:20.843 +03:00 [DBG] Start authorize request protocol validation
2019-08-20 11:48:20.845 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:20.846 +03:00 [DBG] Checking for PKCE parameters
2019-08-20 11:48:20.846 +03:00 [DBG] No PKCE used.
2019-08-20 11:48:20.847 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-20 11:48:20.848 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/home/signin-oidc","AllowedRedirectUris":["http://localhost:5002/home/signin-oidc"],"SubjectId":"1","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9NqKyX7TyDEI63rklOKjiICUC9l3Jpf16WcDz--smf22dKaRvY_O9_IY5J9l6jmUHzXPjmClsCF5MG7kfiLR5WcK9rPbBbll4wpl2bae6Qw7KTEpoj8krcpDZ-nHjdps8MJCbAYrINcjqxVAVtFtkm-GVcL_N2mHRP8XThs334XWiNSB0WD696gvUwqN6CWjmhxDrMU3ZRTVVFuOSV4wYysfEuW5gXWDgppk9BHBOBn6fRFqdxafgPHBmHy4Y2-Z7NzEjYVxg3_9uKmHVTSLaorkIvY3oaxVEAubCE_mbPuUkJtb9C9sJbhPj-ZxqGf0C4","UiLocales":null,"Nonce":"637018877008220633.NjJhZWNlM2MtNzM5YS00NzJhLTgyMmEtZDMyYjc0ZGUxNWM3ZWRlM2MwMzctNDIyOC00Y2I5LWI4ZTAtYjcxZGQyNmQ5ZDZk","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"e74d8cbe5a0a3326c07e4e0a82ece454","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/home/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637018877008220633.NjJhZWNlM2MtNzM5YS00NzJhLTgyMmEtZDMyYjc0ZGUxNWM3ZWRlM2MwMzctNDIyOC00Y2I5LWI4ZTAtYjcxZGQyNmQ5ZDZk","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9NqKyX7TyDEI63rklOKjiICUC9l3Jpf16WcDz--smf22dKaRvY_O9_IY5J9l6jmUHzXPjmClsCF5MG7kfiLR5WcK9rPbBbll4wpl2bae6Qw7KTEpoj8krcpDZ-nHjdps8MJCbAYrINcjqxVAVtFtkm-GVcL_N2mHRP8XThs334XWiNSB0WD696gvUwqN6CWjmhxDrMU3ZRTVVFuOSV4wYysfEuW5gXWDgppk9BHBOBn6fRFqdxafgPHBmHy4Y2-Z7NzEjYVxg3_9uKmHVTSLaorkIvY3oaxVEAubCE_mbPuUkJtb9C9sJbhPj-ZxqGf0C4","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-20 11:48:20.854 +03:00 [DBG] Client is configured to not require consent, no consent is required
2019-08-20 11:48:20.855 +03:00 [DBG] Creating Hybrid Flow response.
2019-08-20 11:48:20.855 +03:00 [DBG] Creating Implicit Flow response.
2019-08-20 11:48:20.856 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 11:48:20.857 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 11:48:20.862 +03:00 [DBG] Authorize endpoint response
{"SubjectId":"1","ClientId":"mvc","RedirectUri":"http://localhost:5002/home/signin-oidc","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9NqKyX7TyDEI63rklOKjiICUC9l3Jpf16WcDz--smf22dKaRvY_O9_IY5J9l6jmUHzXPjmClsCF5MG7kfiLR5WcK9rPbBbll4wpl2bae6Qw7KTEpoj8krcpDZ-nHjdps8MJCbAYrINcjqxVAVtFtkm-GVcL_N2mHRP8XThs334XWiNSB0WD696gvUwqN6CWjmhxDrMU3ZRTVVFuOSV4wYysfEuW5gXWDgppk9BHBOBn6fRFqdxafgPHBmHy4Y2-Z7NzEjYVxg3_9uKmHVTSLaorkIvY3oaxVEAubCE_mbPuUkJtb9C9sJbhPj-ZxqGf0C4","Scope":"openid profile afcpayroll offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-08-20 11:48:21.140 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-20 11:48:21.142 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-20 11:48:21.143 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-20 11:48:21.144 +03:00 [DBG] Start token request.
2019-08-20 11:48:21.144 +03:00 [DBG] Start client validation
2019-08-20 11:48:21.145 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-20 11:48:21.145 +03:00 [DBG] Start parsing for secret in post body
2019-08-20 11:48:21.147 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-20 11:48:21.148 +03:00 [DBG] Secret id found: mvc
2019-08-20 11:48:21.148 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:21.149 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-20 11:48:21.150 +03:00 [DBG] Client validation success
2019-08-20 11:48:21.150 +03:00 [DBG] Start token request validation
2019-08-20 11:48:21.151 +03:00 [DBG] Start validation of authorization code token request
2019-08-20 11:48:21.152 +03:00 [DBG] Validation of authorization code token request success
2019-08-20 11:48:21.152 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"e32cd449836fdf5151cb6745d2dbdd2f120588a8e2bb6e007e6b12da6d9e76bd","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"mvc","client_secret":"***REDACTED***","code":"e32cd449836fdf5151cb6745d2dbdd2f120588a8e2bb6e007e6b12da6d9e76bd","grant_type":"authorization_code","redirect_uri":"http://localhost:5002/home/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-08-20 11:48:21.157 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:21.158 +03:00 [DBG] Getting claims for access token for client: mvc
2019-08-20 11:48:21.159 +03:00 [DBG] Getting claims for access token for subject: 1
2019-08-20 11:48:21.163 +03:00 [DBG] Creating refresh token
2019-08-20 11:48:21.164 +03:00 [DBG] Setting an absolute lifetime: 2592000
2019-08-20 11:48:21.165 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:21.165 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 11:48:21.166 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 11:48:21.170 +03:00 [DBG] Token request success.
2019-08-20 11:48:21.172 +03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-08-20 11:48:21.173 +03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-08-20 11:48:21.173 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-08-20 11:48:21.174 +03:00 [DBG] Start userinfo request
2019-08-20 11:48:21.174 +03:00 [DBG] Bearer token found in header
2019-08-20 11:48:21.179 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:21.180 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:21.180 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-08-20 11:48:21.181 +03:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1566290901,"exp":1566290961,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","afcpayroll"],"client_id":"mvc","sub":"1","auth_time":1566290868,"idp":"local","name":"alice","email":"alice@email.com","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-08-20 11:48:21.187 +03:00 [DBG] Creating userinfo response
2019-08-20 11:48:21.187 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:48:21.188 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:48:21.189 +03:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 11:48:21.189 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:48:21.190 +03:00 [INF] Profile service returned the following claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 11:48:21.190 +03:00 [DBG] End userinfo request
2019-08-20 11:48:27.114 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-08-20 11:48:27.115 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-08-20 11:48:27.116 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-08-20 11:48:27.116 +03:00 [DBG] Start authorize request
2019-08-20 11:48:27.117 +03:00 [DBG] User in authorize request: 1
2019-08-20 11:48:27.117 +03:00 [DBG] Start authorize request protocol validation
2019-08-20 11:48:27.118 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:27.119 +03:00 [DBG] Checking for PKCE parameters
2019-08-20 11:48:27.119 +03:00 [DBG] No PKCE used.
2019-08-20 11:48:27.120 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-20 11:48:27.120 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/home/signin-oidc","AllowedRedirectUris":["http://localhost:5002/home/signin-oidc"],"SubjectId":"1","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9MAun9VdHvhkC1850w5Wu8S72Jz8I7bWEX74WJdHMcHWCz96nw-hWIuRQ5JeaQIEXrvx9E0lUdjJV4-5hWKz4cBTBZQrOBWYEtnSjkEkTASykQTFbzbbdHiRfxBXiMoh8e7KRjAPEeNmvazvxC7_6aduREvAMJBqo26TO9BHXCqxFPpxorpvkaPbssvtbK4uq9whO-yCsZMw5Q-IrF6yGY-yw7nJ9Q74ampdi9FaufjRSEV4Muxqdbu6LAgfUH2-187fjjS1p_0A8vEDSwf2PUL4W6W9qF95Q8rCO_uqRnWLZ5RKmhSoM3Q3Vct7hIyaMU","UiLocales":null,"Nonce":"637018877070980123.Yjk4MmJjOGUtNzVmNi00YTA1LThjN2ItODhlYzQ2OGE0NGNkM2QzODgwOTItNGM4YS00MjUxLTliZmItNWJjMTk4OTc4MjMy","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"e74d8cbe5a0a3326c07e4e0a82ece454","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/home/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637018877070980123.Yjk4MmJjOGUtNzVmNi00YTA1LThjN2ItODhlYzQ2OGE0NGNkM2QzODgwOTItNGM4YS00MjUxLTliZmItNWJjMTk4OTc4MjMy","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9MAun9VdHvhkC1850w5Wu8S72Jz8I7bWEX74WJdHMcHWCz96nw-hWIuRQ5JeaQIEXrvx9E0lUdjJV4-5hWKz4cBTBZQrOBWYEtnSjkEkTASykQTFbzbbdHiRfxBXiMoh8e7KRjAPEeNmvazvxC7_6aduREvAMJBqo26TO9BHXCqxFPpxorpvkaPbssvtbK4uq9whO-yCsZMw5Q-IrF6yGY-yw7nJ9Q74ampdi9FaufjRSEV4Muxqdbu6LAgfUH2-187fjjS1p_0A8vEDSwf2PUL4W6W9qF95Q8rCO_uqRnWLZ5RKmhSoM3Q3Vct7hIyaMU","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-20 11:48:27.129 +03:00 [DBG] Client is configured to not require consent, no consent is required
2019-08-20 11:48:27.130 +03:00 [DBG] Creating Hybrid Flow response.
2019-08-20 11:48:27.130 +03:00 [DBG] Creating Implicit Flow response.
2019-08-20 11:48:27.131 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 11:48:27.131 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 11:48:27.136 +03:00 [DBG] Authorize endpoint response
{"SubjectId":"1","ClientId":"mvc","RedirectUri":"http://localhost:5002/home/signin-oidc","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9MAun9VdHvhkC1850w5Wu8S72Jz8I7bWEX74WJdHMcHWCz96nw-hWIuRQ5JeaQIEXrvx9E0lUdjJV4-5hWKz4cBTBZQrOBWYEtnSjkEkTASykQTFbzbbdHiRfxBXiMoh8e7KRjAPEeNmvazvxC7_6aduREvAMJBqo26TO9BHXCqxFPpxorpvkaPbssvtbK4uq9whO-yCsZMw5Q-IrF6yGY-yw7nJ9Q74ampdi9FaufjRSEV4Muxqdbu6LAgfUH2-187fjjS1p_0A8vEDSwf2PUL4W6W9qF95Q8rCO_uqRnWLZ5RKmhSoM3Q3Vct7hIyaMU","Scope":"openid profile afcpayroll offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-08-20 11:48:27.350 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-20 11:48:27.351 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-20 11:48:27.352 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-20 11:48:27.352 +03:00 [DBG] Start token request.
2019-08-20 11:48:27.353 +03:00 [DBG] Start client validation
2019-08-20 11:48:27.353 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-20 11:48:27.354 +03:00 [DBG] Start parsing for secret in post body
2019-08-20 11:48:27.355 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-20 11:48:27.355 +03:00 [DBG] Secret id found: mvc
2019-08-20 11:48:27.356 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:27.356 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-20 11:48:27.357 +03:00 [DBG] Client validation success
2019-08-20 11:48:27.357 +03:00 [DBG] Start token request validation
2019-08-20 11:48:27.358 +03:00 [DBG] Start validation of authorization code token request
2019-08-20 11:48:27.358 +03:00 [DBG] Validation of authorization code token request success
2019-08-20 11:48:27.359 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"83315e62936e70ab1c93eb1c03c3487ef37eceadb566e57e9ccab3cec7179113","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"mvc","client_secret":"***REDACTED***","code":"83315e62936e70ab1c93eb1c03c3487ef37eceadb566e57e9ccab3cec7179113","grant_type":"authorization_code","redirect_uri":"http://localhost:5002/home/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-08-20 11:48:27.364 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:27.365 +03:00 [DBG] Getting claims for access token for client: mvc
2019-08-20 11:48:27.365 +03:00 [DBG] Getting claims for access token for subject: 1
2019-08-20 11:48:27.370 +03:00 [DBG] Creating refresh token
2019-08-20 11:48:27.370 +03:00 [DBG] Setting an absolute lifetime: 2592000
2019-08-20 11:48:27.371 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:27.371 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 11:48:27.372 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 11:48:27.376 +03:00 [DBG] Token request success.
2019-08-20 11:48:27.379 +03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-08-20 11:48:27.379 +03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-08-20 11:48:27.380 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-08-20 11:48:27.381 +03:00 [DBG] Start userinfo request
2019-08-20 11:48:27.381 +03:00 [DBG] Bearer token found in header
2019-08-20 11:48:27.384 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:27.384 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:27.387 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-08-20 11:48:27.388 +03:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1566290907,"exp":1566290967,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","afcpayroll"],"client_id":"mvc","sub":"1","auth_time":1566290868,"idp":"local","name":"alice","email":"alice@email.com","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-08-20 11:48:27.392 +03:00 [DBG] Creating userinfo response
2019-08-20 11:48:27.392 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:48:27.393 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:48:27.394 +03:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 11:48:27.394 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:48:27.395 +03:00 [INF] Profile service returned the following claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 11:48:27.395 +03:00 [DBG] End userinfo request
2019-08-20 11:48:30.544 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-08-20 11:48:30.546 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-08-20 11:48:30.547 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-08-20 11:48:30.548 +03:00 [DBG] Start authorize request
2019-08-20 11:48:30.548 +03:00 [DBG] User in authorize request: 1
2019-08-20 11:48:30.549 +03:00 [DBG] Start authorize request protocol validation
2019-08-20 11:48:30.549 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:30.550 +03:00 [DBG] Checking for PKCE parameters
2019-08-20 11:48:30.551 +03:00 [DBG] No PKCE used.
2019-08-20 11:48:30.551 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-20 11:48:30.552 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/home/signin-oidc","AllowedRedirectUris":["http://localhost:5002/home/signin-oidc"],"SubjectId":"1","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9PEPyxnQiIIg23HQrxKhnteAtT_OQOhIoFbB71-Lq0I9g1D-QvU9w3-hHyl5tUKHQV60ZMJeJy3V3lf_kwRCez9WTTAwBh2cGheY-VER2VRSQmw8xRzix7swfVH-w6GXk8b-m6-yFZd0CwUkd0dFJ-cpb6V8PSQ1F098mFg1Pfe1EiCB446zCrwCJFMo-_WT4piUOCig4si7ohWmAHZqqsRrqZiq2kLU4b9eFbUKjTTbz-aeM_8EMQPbo9xfSM7mejBn-ag_sNDwjLeABqJ9lpH1rSYLu5n3owalZ6Claq8M-BlyhoNtrpKRXhsBF16r0o","UiLocales":null,"Nonce":"637018877105259239.ZTA1NTM2NmEtMDc4My00ZGRhLWExZjgtZTUyYmY4YTY5NDNjMWY5ZjAyMDYtOTU1Ni00OWZhLTk5YzktYzM0OTYzMjVlNmM5","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"e74d8cbe5a0a3326c07e4e0a82ece454","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/home/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637018877105259239.ZTA1NTM2NmEtMDc4My00ZGRhLWExZjgtZTUyYmY4YTY5NDNjMWY5ZjAyMDYtOTU1Ni00OWZhLTk5YzktYzM0OTYzMjVlNmM5","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9PEPyxnQiIIg23HQrxKhnteAtT_OQOhIoFbB71-Lq0I9g1D-QvU9w3-hHyl5tUKHQV60ZMJeJy3V3lf_kwRCez9WTTAwBh2cGheY-VER2VRSQmw8xRzix7swfVH-w6GXk8b-m6-yFZd0CwUkd0dFJ-cpb6V8PSQ1F098mFg1Pfe1EiCB446zCrwCJFMo-_WT4piUOCig4si7ohWmAHZqqsRrqZiq2kLU4b9eFbUKjTTbz-aeM_8EMQPbo9xfSM7mejBn-ag_sNDwjLeABqJ9lpH1rSYLu5n3owalZ6Claq8M-BlyhoNtrpKRXhsBF16r0o","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-20 11:48:30.562 +03:00 [DBG] Client is configured to not require consent, no consent is required
2019-08-20 11:48:30.562 +03:00 [DBG] Creating Hybrid Flow response.
2019-08-20 11:48:30.563 +03:00 [DBG] Creating Implicit Flow response.
2019-08-20 11:48:30.564 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 11:48:30.564 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 11:48:30.568 +03:00 [DBG] Authorize endpoint response
{"SubjectId":"1","ClientId":"mvc","RedirectUri":"http://localhost:5002/home/signin-oidc","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9PEPyxnQiIIg23HQrxKhnteAtT_OQOhIoFbB71-Lq0I9g1D-QvU9w3-hHyl5tUKHQV60ZMJeJy3V3lf_kwRCez9WTTAwBh2cGheY-VER2VRSQmw8xRzix7swfVH-w6GXk8b-m6-yFZd0CwUkd0dFJ-cpb6V8PSQ1F098mFg1Pfe1EiCB446zCrwCJFMo-_WT4piUOCig4si7ohWmAHZqqsRrqZiq2kLU4b9eFbUKjTTbz-aeM_8EMQPbo9xfSM7mejBn-ag_sNDwjLeABqJ9lpH1rSYLu5n3owalZ6Claq8M-BlyhoNtrpKRXhsBF16r0o","Scope":"openid profile afcpayroll offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-08-20 11:48:30.829 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-20 11:48:30.830 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-20 11:48:30.831 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-20 11:48:30.832 +03:00 [DBG] Start token request.
2019-08-20 11:48:30.832 +03:00 [DBG] Start client validation
2019-08-20 11:48:30.833 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-20 11:48:30.833 +03:00 [DBG] Start parsing for secret in post body
2019-08-20 11:48:30.834 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-20 11:48:30.835 +03:00 [DBG] Secret id found: mvc
2019-08-20 11:48:30.836 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:30.836 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-20 11:48:30.837 +03:00 [DBG] Client validation success
2019-08-20 11:48:30.837 +03:00 [DBG] Start token request validation
2019-08-20 11:48:30.838 +03:00 [DBG] Start validation of authorization code token request
2019-08-20 11:48:30.838 +03:00 [DBG] Validation of authorization code token request success
2019-08-20 11:48:30.839 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"df9efadd62c193bb28c8ea1fcfd33698c8e4d5edb8bfc49d7fca391180e922cd","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"mvc","client_secret":"***REDACTED***","code":"df9efadd62c193bb28c8ea1fcfd33698c8e4d5edb8bfc49d7fca391180e922cd","grant_type":"authorization_code","redirect_uri":"http://localhost:5002/home/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-08-20 11:48:30.844 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:30.845 +03:00 [DBG] Getting claims for access token for client: mvc
2019-08-20 11:48:30.846 +03:00 [DBG] Getting claims for access token for subject: 1
2019-08-20 11:48:30.850 +03:00 [DBG] Creating refresh token
2019-08-20 11:48:30.850 +03:00 [DBG] Setting an absolute lifetime: 2592000
2019-08-20 11:48:30.851 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:30.852 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 11:48:30.852 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 11:48:30.856 +03:00 [DBG] Token request success.
2019-08-20 11:48:30.859 +03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-08-20 11:48:30.860 +03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-08-20 11:48:30.860 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-08-20 11:48:30.861 +03:00 [DBG] Start userinfo request
2019-08-20 11:48:30.862 +03:00 [DBG] Bearer token found in header
2019-08-20 11:48:30.866 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:30.866 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:30.867 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-08-20 11:48:30.867 +03:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1566290910,"exp":1566290970,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","afcpayroll"],"client_id":"mvc","sub":"1","auth_time":1566290868,"idp":"local","name":"alice","email":"alice@email.com","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-08-20 11:48:30.872 +03:00 [DBG] Creating userinfo response
2019-08-20 11:48:30.872 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:48:30.872 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:48:30.874 +03:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 11:48:30.874 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:48:30.875 +03:00 [INF] Profile service returned the following claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 11:48:30.875 +03:00 [DBG] End userinfo request
2019-08-20 11:48:34.018 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-08-20 11:48:34.020 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-08-20 11:48:34.021 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-08-20 11:48:34.021 +03:00 [DBG] Start authorize request
2019-08-20 11:48:34.022 +03:00 [DBG] User in authorize request: 1
2019-08-20 11:48:34.023 +03:00 [DBG] Start authorize request protocol validation
2019-08-20 11:48:34.024 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:34.025 +03:00 [DBG] Checking for PKCE parameters
2019-08-20 11:48:34.025 +03:00 [DBG] No PKCE used.
2019-08-20 11:48:34.026 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-20 11:48:34.026 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/home/signin-oidc","AllowedRedirectUris":["http://localhost:5002/home/signin-oidc"],"SubjectId":"1","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9Oeczu5eIBGuqTfdbt3-2WO1DAjR6rIl0Wke1-IsKQxJGR-6bIuOlJITHXKLz0WC5eWQoYnCuNe-IdRDJNAWqi8qcAeCXGMcKCncMqTwDsrlrZRNUUmYooY5rVPy5ngIS1s3Ore7O5a0rFOfcrpobbol5fYQkngJ8VlOW21McojyftG6BQwDib1neRQqK7WGCeAhT1eIbjRDk67e1r4vpRRrR0a43pPCURDD8GAFPQzp_T-h7Nux4UPsUQG_l8wToWa0fW9OaCJaA_s8ApNNeusVGXbjDxw6SOWyc0u6wE5zhK3k7DkFCJXKoEumfxd8zQ","UiLocales":null,"Nonce":"637018877140013860.NjNlODQxYzMtMjFlZS00ZWU3LWE1NjktMmE0MWFiODUxMTZlNjBlMTczYjAtNmI5Zi00ZmRkLTlkNmQtMDY0NTU2MDg2OTg1","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"e74d8cbe5a0a3326c07e4e0a82ece454","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/home/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637018877140013860.NjNlODQxYzMtMjFlZS00ZWU3LWE1NjktMmE0MWFiODUxMTZlNjBlMTczYjAtNmI5Zi00ZmRkLTlkNmQtMDY0NTU2MDg2OTg1","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9Oeczu5eIBGuqTfdbt3-2WO1DAjR6rIl0Wke1-IsKQxJGR-6bIuOlJITHXKLz0WC5eWQoYnCuNe-IdRDJNAWqi8qcAeCXGMcKCncMqTwDsrlrZRNUUmYooY5rVPy5ngIS1s3Ore7O5a0rFOfcrpobbol5fYQkngJ8VlOW21McojyftG6BQwDib1neRQqK7WGCeAhT1eIbjRDk67e1r4vpRRrR0a43pPCURDD8GAFPQzp_T-h7Nux4UPsUQG_l8wToWa0fW9OaCJaA_s8ApNNeusVGXbjDxw6SOWyc0u6wE5zhK3k7DkFCJXKoEumfxd8zQ","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-20 11:48:34.037 +03:00 [DBG] Client is configured to not require consent, no consent is required
2019-08-20 11:48:34.037 +03:00 [DBG] Creating Hybrid Flow response.
2019-08-20 11:48:34.038 +03:00 [DBG] Creating Implicit Flow response.
2019-08-20 11:48:34.039 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 11:48:34.040 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 11:48:34.044 +03:00 [DBG] Authorize endpoint response
{"SubjectId":"1","ClientId":"mvc","RedirectUri":"http://localhost:5002/home/signin-oidc","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9Oeczu5eIBGuqTfdbt3-2WO1DAjR6rIl0Wke1-IsKQxJGR-6bIuOlJITHXKLz0WC5eWQoYnCuNe-IdRDJNAWqi8qcAeCXGMcKCncMqTwDsrlrZRNUUmYooY5rVPy5ngIS1s3Ore7O5a0rFOfcrpobbol5fYQkngJ8VlOW21McojyftG6BQwDib1neRQqK7WGCeAhT1eIbjRDk67e1r4vpRRrR0a43pPCURDD8GAFPQzp_T-h7Nux4UPsUQG_l8wToWa0fW9OaCJaA_s8ApNNeusVGXbjDxw6SOWyc0u6wE5zhK3k7DkFCJXKoEumfxd8zQ","Scope":"openid profile afcpayroll offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-08-20 11:48:34.253 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-20 11:48:34.255 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-20 11:48:34.255 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-20 11:48:34.256 +03:00 [DBG] Start token request.
2019-08-20 11:48:34.257 +03:00 [DBG] Start client validation
2019-08-20 11:48:34.257 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-20 11:48:34.258 +03:00 [DBG] Start parsing for secret in post body
2019-08-20 11:48:34.259 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-20 11:48:34.259 +03:00 [DBG] Secret id found: mvc
2019-08-20 11:48:34.261 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:34.262 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-20 11:48:34.262 +03:00 [DBG] Client validation success
2019-08-20 11:48:34.262 +03:00 [DBG] Start token request validation
2019-08-20 11:48:34.263 +03:00 [DBG] Start validation of authorization code token request
2019-08-20 11:48:34.264 +03:00 [DBG] Validation of authorization code token request success
2019-08-20 11:48:34.264 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"f4f8117421abb2e9b8a980bb36237343ec9190daa87c0c064fc903a0befd96fb","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"mvc","client_secret":"***REDACTED***","code":"f4f8117421abb2e9b8a980bb36237343ec9190daa87c0c064fc903a0befd96fb","grant_type":"authorization_code","redirect_uri":"http://localhost:5002/home/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-08-20 11:48:34.269 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:34.269 +03:00 [DBG] Getting claims for access token for client: mvc
2019-08-20 11:48:34.270 +03:00 [DBG] Getting claims for access token for subject: 1
2019-08-20 11:48:34.274 +03:00 [DBG] Creating refresh token
2019-08-20 11:48:34.275 +03:00 [DBG] Setting an absolute lifetime: 2592000
2019-08-20 11:48:34.276 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:34.277 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 11:48:34.278 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 11:48:34.283 +03:00 [DBG] Token request success.
2019-08-20 11:48:34.286 +03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-08-20 11:48:34.287 +03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-08-20 11:48:34.287 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-08-20 11:48:34.288 +03:00 [DBG] Start userinfo request
2019-08-20 11:48:34.288 +03:00 [DBG] Bearer token found in header
2019-08-20 11:48:34.291 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:34.292 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:34.293 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-08-20 11:48:34.294 +03:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1566290914,"exp":1566290974,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","afcpayroll"],"client_id":"mvc","sub":"1","auth_time":1566290868,"idp":"local","name":"alice","email":"alice@email.com","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-08-20 11:48:34.298 +03:00 [DBG] Creating userinfo response
2019-08-20 11:48:34.299 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:48:34.299 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:48:34.300 +03:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 11:48:34.301 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:48:34.301 +03:00 [INF] Profile service returned the following claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 11:48:34.302 +03:00 [DBG] End userinfo request
2019-08-20 11:48:34.350 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-08-20 11:48:34.351 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-08-20 11:48:34.352 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-08-20 11:48:34.352 +03:00 [DBG] Start authorize request
2019-08-20 11:48:34.353 +03:00 [DBG] User in authorize request: 1
2019-08-20 11:48:34.353 +03:00 [DBG] Start authorize request protocol validation
2019-08-20 11:48:34.354 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:34.355 +03:00 [DBG] Checking for PKCE parameters
2019-08-20 11:48:34.356 +03:00 [DBG] No PKCE used.
2019-08-20 11:48:34.356 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-20 11:48:34.357 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/home/signin-oidc","AllowedRedirectUris":["http://localhost:5002/home/signin-oidc"],"SubjectId":"1","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9Ny6Ly1n_tL6bzyt3dURJP6U4-DW0P6bUy6rvMg16dGEwAP-FS_yCZqXeQE26-UUuv4I4RfwiDF60YAU26q8rUNNhigF5YaIhl2tzImFFLdwc25mVG_qaz95WWZaQDeSwwoWr5W3FvoeEWY8pBUwGtEa8wCXWcxQZhwY68CfLb1f3xC64yOZ_GL0deBBDvDiXrXFsym0mtErFf8D1xMlszlgEAIyv_UTYyNq3CDGn10Da3syK0bF4Y9tu85_c_gdhMaKlo1GOEGbW9hiqbFwUBDWjoZj9-98hBcn3DxpQxcp5Jj_IfwwEJbTmbF5YNUcco","UiLocales":null,"Nonce":"637018877143339449.YjdiNWVkY2QtM2M0NS00NzRiLWIwOTMtZTM0NDk1MTBkMTQ0ZmIyYjNhZmYtZmNkYy00Y2NjLWFlOGQtMDNhMmU4ZDdlYjg0","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"e74d8cbe5a0a3326c07e4e0a82ece454","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/home/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637018877143339449.YjdiNWVkY2QtM2M0NS00NzRiLWIwOTMtZTM0NDk1MTBkMTQ0ZmIyYjNhZmYtZmNkYy00Y2NjLWFlOGQtMDNhMmU4ZDdlYjg0","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9Ny6Ly1n_tL6bzyt3dURJP6U4-DW0P6bUy6rvMg16dGEwAP-FS_yCZqXeQE26-UUuv4I4RfwiDF60YAU26q8rUNNhigF5YaIhl2tzImFFLdwc25mVG_qaz95WWZaQDeSwwoWr5W3FvoeEWY8pBUwGtEa8wCXWcxQZhwY68CfLb1f3xC64yOZ_GL0deBBDvDiXrXFsym0mtErFf8D1xMlszlgEAIyv_UTYyNq3CDGn10Da3syK0bF4Y9tu85_c_gdhMaKlo1GOEGbW9hiqbFwUBDWjoZj9-98hBcn3DxpQxcp5Jj_IfwwEJbTmbF5YNUcco","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-20 11:48:34.363 +03:00 [DBG] Client is configured to not require consent, no consent is required
2019-08-20 11:48:34.363 +03:00 [DBG] Creating Hybrid Flow response.
2019-08-20 11:48:34.364 +03:00 [DBG] Creating Implicit Flow response.
2019-08-20 11:48:34.364 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 11:48:34.365 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 11:48:34.369 +03:00 [DBG] Authorize endpoint response
{"SubjectId":"1","ClientId":"mvc","RedirectUri":"http://localhost:5002/home/signin-oidc","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9Ny6Ly1n_tL6bzyt3dURJP6U4-DW0P6bUy6rvMg16dGEwAP-FS_yCZqXeQE26-UUuv4I4RfwiDF60YAU26q8rUNNhigF5YaIhl2tzImFFLdwc25mVG_qaz95WWZaQDeSwwoWr5W3FvoeEWY8pBUwGtEa8wCXWcxQZhwY68CfLb1f3xC64yOZ_GL0deBBDvDiXrXFsym0mtErFf8D1xMlszlgEAIyv_UTYyNq3CDGn10Da3syK0bF4Y9tu85_c_gdhMaKlo1GOEGbW9hiqbFwUBDWjoZj9-98hBcn3DxpQxcp5Jj_IfwwEJbTmbF5YNUcco","Scope":"openid profile afcpayroll offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-08-20 11:48:34.577 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-20 11:48:34.581 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-20 11:48:34.582 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-20 11:48:34.584 +03:00 [DBG] Start token request.
2019-08-20 11:48:34.584 +03:00 [DBG] Start client validation
2019-08-20 11:48:34.585 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-20 11:48:34.585 +03:00 [DBG] Start parsing for secret in post body
2019-08-20 11:48:34.586 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-20 11:48:34.586 +03:00 [DBG] Secret id found: mvc
2019-08-20 11:48:34.587 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:34.587 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-20 11:48:34.588 +03:00 [DBG] Client validation success
2019-08-20 11:48:34.589 +03:00 [DBG] Start token request validation
2019-08-20 11:48:34.589 +03:00 [DBG] Start validation of authorization code token request
2019-08-20 11:48:34.590 +03:00 [DBG] Validation of authorization code token request success
2019-08-20 11:48:34.591 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"4b2d3dfae10af499899014478de6185be62e1c347cf65a7bbf8033eaea5ee3a4","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"mvc","client_secret":"***REDACTED***","code":"4b2d3dfae10af499899014478de6185be62e1c347cf65a7bbf8033eaea5ee3a4","grant_type":"authorization_code","redirect_uri":"http://localhost:5002/home/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-08-20 11:48:34.595 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:34.596 +03:00 [DBG] Getting claims for access token for client: mvc
2019-08-20 11:48:34.596 +03:00 [DBG] Getting claims for access token for subject: 1
2019-08-20 11:48:34.601 +03:00 [DBG] Creating refresh token
2019-08-20 11:48:34.602 +03:00 [DBG] Setting an absolute lifetime: 2592000
2019-08-20 11:48:34.602 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:34.603 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 11:48:34.605 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 11:48:34.609 +03:00 [DBG] Token request success.
2019-08-20 11:48:34.614 +03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-08-20 11:48:34.614 +03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-08-20 11:48:34.615 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-08-20 11:48:34.615 +03:00 [DBG] Start userinfo request
2019-08-20 11:48:34.616 +03:00 [DBG] Bearer token found in header
2019-08-20 11:48:34.619 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:34.619 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:34.620 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-08-20 11:48:34.621 +03:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1566290914,"exp":1566290974,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","afcpayroll"],"client_id":"mvc","sub":"1","auth_time":1566290868,"idp":"local","name":"alice","email":"alice@email.com","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-08-20 11:48:34.629 +03:00 [DBG] Creating userinfo response
2019-08-20 11:48:34.629 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:48:34.630 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:48:34.631 +03:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 11:48:34.631 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:48:34.632 +03:00 [INF] Profile service returned the following claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 11:48:34.632 +03:00 [DBG] End userinfo request
2019-08-20 11:48:34.684 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-08-20 11:48:34.685 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-08-20 11:48:34.685 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-08-20 11:48:34.686 +03:00 [DBG] Start authorize request
2019-08-20 11:48:34.686 +03:00 [DBG] User in authorize request: 1
2019-08-20 11:48:34.687 +03:00 [DBG] Start authorize request protocol validation
2019-08-20 11:48:34.687 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:34.688 +03:00 [DBG] Checking for PKCE parameters
2019-08-20 11:48:34.688 +03:00 [DBG] No PKCE used.
2019-08-20 11:48:34.691 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-20 11:48:34.692 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/home/signin-oidc","AllowedRedirectUris":["http://localhost:5002/home/signin-oidc"],"SubjectId":"1","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9NZEZ1mAb8LRqtZA91uz4e-OnLG9qAqcPyPbLpJPi951gE-5BWKPhOPVIjPd5s7LTW7ynfKKYZvG5fF03LrebpDbrPg7Xib4PpPFJG1BRJlIxvgGGJovqlTDq3LCjFAjVM3F30-Y5NgXjGTNm3cmQ-LWoztkp7F9cTM9b2WT6hZotYJLZb2e0ORtjFNpSnJry9dvMLz2QkBkbu8Dc_MKxAIiXu9SsoQLRQvFrL65SPExUJZV-0nNMQnXn5KE1St-hHNerlWjR05MRVK7hvFKUFhkq_NnNBlrk1V2I7ETr20W5d854Bt1kRf0y8AKt8cYEk","UiLocales":null,"Nonce":"637018877146660226.NDRmNDgxNmEtYzAzOS00ZWEwLWFlYzItNTk3OTM0ZGE5NjQ3NGMyMzE2NTEtMjUwNC00ZjViLWIyMGYtNzM5OTQ3N2JiOTQ1","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"e74d8cbe5a0a3326c07e4e0a82ece454","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/home/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637018877146660226.NDRmNDgxNmEtYzAzOS00ZWEwLWFlYzItNTk3OTM0ZGE5NjQ3NGMyMzE2NTEtMjUwNC00ZjViLWIyMGYtNzM5OTQ3N2JiOTQ1","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9NZEZ1mAb8LRqtZA91uz4e-OnLG9qAqcPyPbLpJPi951gE-5BWKPhOPVIjPd5s7LTW7ynfKKYZvG5fF03LrebpDbrPg7Xib4PpPFJG1BRJlIxvgGGJovqlTDq3LCjFAjVM3F30-Y5NgXjGTNm3cmQ-LWoztkp7F9cTM9b2WT6hZotYJLZb2e0ORtjFNpSnJry9dvMLz2QkBkbu8Dc_MKxAIiXu9SsoQLRQvFrL65SPExUJZV-0nNMQnXn5KE1St-hHNerlWjR05MRVK7hvFKUFhkq_NnNBlrk1V2I7ETr20W5d854Bt1kRf0y8AKt8cYEk","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-20 11:48:34.698 +03:00 [DBG] Client is configured to not require consent, no consent is required
2019-08-20 11:48:34.698 +03:00 [DBG] Creating Hybrid Flow response.
2019-08-20 11:48:34.699 +03:00 [DBG] Creating Implicit Flow response.
2019-08-20 11:48:34.699 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 11:48:34.700 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 11:48:34.705 +03:00 [DBG] Authorize endpoint response
{"SubjectId":"1","ClientId":"mvc","RedirectUri":"http://localhost:5002/home/signin-oidc","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9NZEZ1mAb8LRqtZA91uz4e-OnLG9qAqcPyPbLpJPi951gE-5BWKPhOPVIjPd5s7LTW7ynfKKYZvG5fF03LrebpDbrPg7Xib4PpPFJG1BRJlIxvgGGJovqlTDq3LCjFAjVM3F30-Y5NgXjGTNm3cmQ-LWoztkp7F9cTM9b2WT6hZotYJLZb2e0ORtjFNpSnJry9dvMLz2QkBkbu8Dc_MKxAIiXu9SsoQLRQvFrL65SPExUJZV-0nNMQnXn5KE1St-hHNerlWjR05MRVK7hvFKUFhkq_NnNBlrk1V2I7ETr20W5d854Bt1kRf0y8AKt8cYEk","Scope":"openid profile afcpayroll offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-08-20 11:48:34.899 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-20 11:48:34.901 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-20 11:48:34.902 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-20 11:48:34.902 +03:00 [DBG] Start token request.
2019-08-20 11:48:34.903 +03:00 [DBG] Start client validation
2019-08-20 11:48:34.903 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-20 11:48:34.904 +03:00 [DBG] Start parsing for secret in post body
2019-08-20 11:48:34.905 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-20 11:48:34.905 +03:00 [DBG] Secret id found: mvc
2019-08-20 11:48:34.907 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:34.907 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-20 11:48:34.908 +03:00 [DBG] Client validation success
2019-08-20 11:48:34.908 +03:00 [DBG] Start token request validation
2019-08-20 11:48:34.909 +03:00 [DBG] Start validation of authorization code token request
2019-08-20 11:48:34.911 +03:00 [DBG] Validation of authorization code token request success
2019-08-20 11:48:34.912 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"cea6b8f1ae4f465ad2cb63461f8c1efd06fad6265ffcce741ffa7940062a3b11","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"mvc","client_secret":"***REDACTED***","code":"cea6b8f1ae4f465ad2cb63461f8c1efd06fad6265ffcce741ffa7940062a3b11","grant_type":"authorization_code","redirect_uri":"http://localhost:5002/home/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-08-20 11:48:34.915 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:34.917 +03:00 [DBG] Getting claims for access token for client: mvc
2019-08-20 11:48:34.922 +03:00 [DBG] Getting claims for access token for subject: 1
2019-08-20 11:48:34.942 +03:00 [DBG] Creating refresh token
2019-08-20 11:48:34.944 +03:00 [DBG] Setting an absolute lifetime: 2592000
2019-08-20 11:48:34.945 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:34.947 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 11:48:34.951 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 11:48:34.958 +03:00 [DBG] Token request success.
2019-08-20 11:48:34.961 +03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-08-20 11:48:34.963 +03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-08-20 11:48:34.964 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-08-20 11:48:34.964 +03:00 [DBG] Start userinfo request
2019-08-20 11:48:34.965 +03:00 [DBG] Bearer token found in header
2019-08-20 11:48:34.968 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:34.969 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:34.971 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-08-20 11:48:34.972 +03:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1566290914,"exp":1566290974,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","afcpayroll"],"client_id":"mvc","sub":"1","auth_time":1566290868,"idp":"local","name":"alice","email":"alice@email.com","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-08-20 11:48:34.977 +03:00 [DBG] Creating userinfo response
2019-08-20 11:48:34.978 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:48:34.978 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:48:34.979 +03:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 11:48:34.982 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:48:34.983 +03:00 [INF] Profile service returned the following claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 11:48:34.983 +03:00 [DBG] End userinfo request
2019-08-20 11:48:35.030 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-08-20 11:48:35.032 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-08-20 11:48:35.033 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-08-20 11:48:35.033 +03:00 [DBG] Start authorize request
2019-08-20 11:48:35.034 +03:00 [DBG] User in authorize request: 1
2019-08-20 11:48:35.034 +03:00 [DBG] Start authorize request protocol validation
2019-08-20 11:48:35.034 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:35.035 +03:00 [DBG] Checking for PKCE parameters
2019-08-20 11:48:35.035 +03:00 [DBG] No PKCE used.
2019-08-20 11:48:35.036 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-20 11:48:35.037 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/home/signin-oidc","AllowedRedirectUris":["http://localhost:5002/home/signin-oidc"],"SubjectId":"1","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9OZtei0p5V4gjDnaejfFRb8WwrO3Dd39rxGyvRV99kB_XLXxUUh2SLjg-VIGEUdQ_6WGLt9JGy5PxkIkLkR-Ptk0P4ENlZnb1CLWlsZDX8okLC4yaqHFoJi5FmhDg253GqdRhh_u6I_GI_eynt7cMJiZlDamC5GAPnpq3MTOcauwR902PRJ-B1yBezFfd0rHbTf6ely-StyhOgAOa22OZOMRM9vyvLfouaPsvnhArWlKExw8fSUh5X5A2WYUN11dQbOFXECYt7nB-xcMFruxqdIsJEWgclUn4eiQAQbjnWNNOMC_fC2FIxy1HqMbE_YmrE","UiLocales":null,"Nonce":"637018877150114170.OWZhOTc1NjgtNjZmOS00NTlmLThlNjEtMWFjMWE5ZWE5ZjZjNmQ4YjNhNjAtZGQxMi00NjFiLWI4YjQtMzIwNTFmYmNjYmUz","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"e74d8cbe5a0a3326c07e4e0a82ece454","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/home/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637018877150114170.OWZhOTc1NjgtNjZmOS00NTlmLThlNjEtMWFjMWE5ZWE5ZjZjNmQ4YjNhNjAtZGQxMi00NjFiLWI4YjQtMzIwNTFmYmNjYmUz","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9OZtei0p5V4gjDnaejfFRb8WwrO3Dd39rxGyvRV99kB_XLXxUUh2SLjg-VIGEUdQ_6WGLt9JGy5PxkIkLkR-Ptk0P4ENlZnb1CLWlsZDX8okLC4yaqHFoJi5FmhDg253GqdRhh_u6I_GI_eynt7cMJiZlDamC5GAPnpq3MTOcauwR902PRJ-B1yBezFfd0rHbTf6ely-StyhOgAOa22OZOMRM9vyvLfouaPsvnhArWlKExw8fSUh5X5A2WYUN11dQbOFXECYt7nB-xcMFruxqdIsJEWgclUn4eiQAQbjnWNNOMC_fC2FIxy1HqMbE_YmrE","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-20 11:48:35.042 +03:00 [DBG] Client is configured to not require consent, no consent is required
2019-08-20 11:48:35.042 +03:00 [DBG] Creating Hybrid Flow response.
2019-08-20 11:48:35.043 +03:00 [DBG] Creating Implicit Flow response.
2019-08-20 11:48:35.043 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 11:48:35.044 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 11:48:35.050 +03:00 [DBG] Authorize endpoint response
{"SubjectId":"1","ClientId":"mvc","RedirectUri":"http://localhost:5002/home/signin-oidc","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9OZtei0p5V4gjDnaejfFRb8WwrO3Dd39rxGyvRV99kB_XLXxUUh2SLjg-VIGEUdQ_6WGLt9JGy5PxkIkLkR-Ptk0P4ENlZnb1CLWlsZDX8okLC4yaqHFoJi5FmhDg253GqdRhh_u6I_GI_eynt7cMJiZlDamC5GAPnpq3MTOcauwR902PRJ-B1yBezFfd0rHbTf6ely-StyhOgAOa22OZOMRM9vyvLfouaPsvnhArWlKExw8fSUh5X5A2WYUN11dQbOFXECYt7nB-xcMFruxqdIsJEWgclUn4eiQAQbjnWNNOMC_fC2FIxy1HqMbE_YmrE","Scope":"openid profile afcpayroll offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-08-20 11:48:35.258 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-20 11:48:35.260 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-20 11:48:35.262 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-20 11:48:35.263 +03:00 [DBG] Start token request.
2019-08-20 11:48:35.264 +03:00 [DBG] Start client validation
2019-08-20 11:48:35.266 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-20 11:48:35.267 +03:00 [DBG] Start parsing for secret in post body
2019-08-20 11:48:35.268 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-20 11:48:35.268 +03:00 [DBG] Secret id found: mvc
2019-08-20 11:48:35.269 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:35.270 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-20 11:48:35.271 +03:00 [DBG] Client validation success
2019-08-20 11:48:35.271 +03:00 [DBG] Start token request validation
2019-08-20 11:48:35.272 +03:00 [DBG] Start validation of authorization code token request
2019-08-20 11:48:35.274 +03:00 [DBG] Validation of authorization code token request success
2019-08-20 11:48:35.274 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"f103c63e5af8a2bd6b58fd3490a5b12e3248758cee2a7a0b0876d7d24be4606d","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"mvc","client_secret":"***REDACTED***","code":"f103c63e5af8a2bd6b58fd3490a5b12e3248758cee2a7a0b0876d7d24be4606d","grant_type":"authorization_code","redirect_uri":"http://localhost:5002/home/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-08-20 11:48:35.283 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:35.283 +03:00 [DBG] Getting claims for access token for client: mvc
2019-08-20 11:48:35.284 +03:00 [DBG] Getting claims for access token for subject: 1
2019-08-20 11:48:35.288 +03:00 [DBG] Creating refresh token
2019-08-20 11:48:35.288 +03:00 [DBG] Setting an absolute lifetime: 2592000
2019-08-20 11:48:35.289 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:35.289 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 11:48:35.290 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 11:48:35.295 +03:00 [DBG] Token request success.
2019-08-20 11:48:35.299 +03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-08-20 11:48:35.300 +03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-08-20 11:48:35.301 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-08-20 11:48:35.301 +03:00 [DBG] Start userinfo request
2019-08-20 11:48:35.302 +03:00 [DBG] Bearer token found in header
2019-08-20 11:48:35.305 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:35.305 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:35.306 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-08-20 11:48:35.306 +03:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1566290915,"exp":1566290975,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","afcpayroll"],"client_id":"mvc","sub":"1","auth_time":1566290868,"idp":"local","name":"alice","email":"alice@email.com","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-08-20 11:48:35.312 +03:00 [DBG] Creating userinfo response
2019-08-20 11:48:35.313 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:48:35.313 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:48:35.314 +03:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 11:48:35.315 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:48:35.315 +03:00 [INF] Profile service returned the following claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 11:48:35.316 +03:00 [DBG] End userinfo request
2019-08-20 11:48:35.365 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-08-20 11:48:35.366 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-08-20 11:48:35.367 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-08-20 11:48:35.368 +03:00 [DBG] Start authorize request
2019-08-20 11:48:35.369 +03:00 [DBG] User in authorize request: 1
2019-08-20 11:48:35.369 +03:00 [DBG] Start authorize request protocol validation
2019-08-20 11:48:35.370 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:35.370 +03:00 [DBG] Checking for PKCE parameters
2019-08-20 11:48:35.371 +03:00 [DBG] No PKCE used.
2019-08-20 11:48:35.371 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-20 11:48:35.372 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/home/signin-oidc","AllowedRedirectUris":["http://localhost:5002/home/signin-oidc"],"SubjectId":"1","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9M-Q6ueD_f5tnrOexpgQOYmcVr4WzWqw6uK7bG2440JetIJ3GcjH0lGlkRXyGzHgfiWLVxD63PUHpfrZtsCbWB6TlzBsXobNsXYoWwxACPrxitarQ8A4WBG6bP3aM2ar4uTXuHQFlAOnw10Gnx7CKGfi7ldR1RrMd5VzGZBXDZfLyESGBA_lg4j8nlCa8TKUn7vKWx1RRi4n-tarQRHDUdjFOEXvmlWe9M073gsUezMv2lZN8OF1sZBfWyyLX5cxO1yllATxbs-M2ltQhGc5nAQZAiT1TejmGp7vv97y6tPbZcYd_3OSfeuHoc1bAJYzUg","UiLocales":null,"Nonce":"637018877153492345.ZjQ3ZGNmNjItMmI5MC00ZmZmLWEzYWQtYzdkOGY2NjE1MTBkNWRlYjFhYTgtMTE4OS00MGIxLTkxMDktNjNkYmJiODljNDI4","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"e74d8cbe5a0a3326c07e4e0a82ece454","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/home/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637018877153492345.ZjQ3ZGNmNjItMmI5MC00ZmZmLWEzYWQtYzdkOGY2NjE1MTBkNWRlYjFhYTgtMTE4OS00MGIxLTkxMDktNjNkYmJiODljNDI4","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9M-Q6ueD_f5tnrOexpgQOYmcVr4WzWqw6uK7bG2440JetIJ3GcjH0lGlkRXyGzHgfiWLVxD63PUHpfrZtsCbWB6TlzBsXobNsXYoWwxACPrxitarQ8A4WBG6bP3aM2ar4uTXuHQFlAOnw10Gnx7CKGfi7ldR1RrMd5VzGZBXDZfLyESGBA_lg4j8nlCa8TKUn7vKWx1RRi4n-tarQRHDUdjFOEXvmlWe9M073gsUezMv2lZN8OF1sZBfWyyLX5cxO1yllATxbs-M2ltQhGc5nAQZAiT1TejmGp7vv97y6tPbZcYd_3OSfeuHoc1bAJYzUg","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-20 11:48:35.380 +03:00 [DBG] Client is configured to not require consent, no consent is required
2019-08-20 11:48:35.380 +03:00 [DBG] Creating Hybrid Flow response.
2019-08-20 11:48:35.381 +03:00 [DBG] Creating Implicit Flow response.
2019-08-20 11:48:35.382 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 11:48:35.382 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 11:48:35.387 +03:00 [DBG] Authorize endpoint response
{"SubjectId":"1","ClientId":"mvc","RedirectUri":"http://localhost:5002/home/signin-oidc","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9M-Q6ueD_f5tnrOexpgQOYmcVr4WzWqw6uK7bG2440JetIJ3GcjH0lGlkRXyGzHgfiWLVxD63PUHpfrZtsCbWB6TlzBsXobNsXYoWwxACPrxitarQ8A4WBG6bP3aM2ar4uTXuHQFlAOnw10Gnx7CKGfi7ldR1RrMd5VzGZBXDZfLyESGBA_lg4j8nlCa8TKUn7vKWx1RRi4n-tarQRHDUdjFOEXvmlWe9M073gsUezMv2lZN8OF1sZBfWyyLX5cxO1yllATxbs-M2ltQhGc5nAQZAiT1TejmGp7vv97y6tPbZcYd_3OSfeuHoc1bAJYzUg","Scope":"openid profile afcpayroll offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-08-20 11:48:35.573 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-20 11:48:35.574 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-20 11:48:35.575 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-20 11:48:35.575 +03:00 [DBG] Start token request.
2019-08-20 11:48:35.576 +03:00 [DBG] Start client validation
2019-08-20 11:48:35.576 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-20 11:48:35.577 +03:00 [DBG] Start parsing for secret in post body
2019-08-20 11:48:35.578 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-20 11:48:35.580 +03:00 [DBG] Secret id found: mvc
2019-08-20 11:48:35.581 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:35.581 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-20 11:48:35.582 +03:00 [DBG] Client validation success
2019-08-20 11:48:35.583 +03:00 [DBG] Start token request validation
2019-08-20 11:48:35.584 +03:00 [DBG] Start validation of authorization code token request
2019-08-20 11:48:35.584 +03:00 [DBG] Validation of authorization code token request success
2019-08-20 11:48:35.585 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"b69967c11df7111b6965bd50d8a8900001841aac44ee2ea5640efab64bbbf4b1","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"mvc","client_secret":"***REDACTED***","code":"b69967c11df7111b6965bd50d8a8900001841aac44ee2ea5640efab64bbbf4b1","grant_type":"authorization_code","redirect_uri":"http://localhost:5002/home/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-08-20 11:48:35.588 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:35.588 +03:00 [DBG] Getting claims for access token for client: mvc
2019-08-20 11:48:35.589 +03:00 [DBG] Getting claims for access token for subject: 1
2019-08-20 11:48:35.593 +03:00 [DBG] Creating refresh token
2019-08-20 11:48:35.594 +03:00 [DBG] Setting an absolute lifetime: 2592000
2019-08-20 11:48:35.595 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:35.596 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 11:48:35.597 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 11:48:35.601 +03:00 [DBG] Token request success.
2019-08-20 11:48:35.603 +03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-08-20 11:48:35.604 +03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-08-20 11:48:35.606 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-08-20 11:48:35.607 +03:00 [DBG] Start userinfo request
2019-08-20 11:48:35.607 +03:00 [DBG] Bearer token found in header
2019-08-20 11:48:35.610 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:35.611 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:35.611 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-08-20 11:48:35.612 +03:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1566290915,"exp":1566290975,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","afcpayroll"],"client_id":"mvc","sub":"1","auth_time":1566290868,"idp":"local","name":"alice","email":"alice@email.com","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-08-20 11:48:35.617 +03:00 [DBG] Creating userinfo response
2019-08-20 11:48:35.617 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:48:35.618 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:48:35.618 +03:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 11:48:35.619 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:48:35.620 +03:00 [INF] Profile service returned the following claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 11:48:35.620 +03:00 [DBG] End userinfo request
2019-08-20 11:48:35.673 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-08-20 11:48:35.676 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-08-20 11:48:35.676 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-08-20 11:48:35.678 +03:00 [DBG] Start authorize request
2019-08-20 11:48:35.678 +03:00 [DBG] User in authorize request: 1
2019-08-20 11:48:35.679 +03:00 [DBG] Start authorize request protocol validation
2019-08-20 11:48:35.680 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:35.681 +03:00 [DBG] Checking for PKCE parameters
2019-08-20 11:48:35.681 +03:00 [DBG] No PKCE used.
2019-08-20 11:48:35.682 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-20 11:48:35.683 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/home/signin-oidc","AllowedRedirectUris":["http://localhost:5002/home/signin-oidc"],"SubjectId":"1","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9M6zG-cVdAPAqX6DT_uB_mFL6nMHKWpSkym9W1dl64DkOVqhMCceM_bO1Rq4Kwcg_1PBJoJRZFHwDUSCYehNmPYf_kmxzUxFOv8YpDNtHYVFvemaKXxvvGZLhcEwiYOzywH8xgDMcDuLzJtkoKNXzckH7AzrcddU1hnyyn9U1w8veGwvNzkNs2DaWbKmropE5-4sHbaI8ahEosd1GVyZn1PuoY01OEs8FW0mJzmpMfV3b2an45n28s-wouZojKO7_qmsX_KSWFAyFREEI45c9mX3H7cbuxDpYX6hPU-xYXU3-Ge72I1zXUM3PAth-41glI","UiLocales":null,"Nonce":"637018877156514048.MTk1Y2UzNmMtZDRkZC00YzQ4LWI0MDMtMjhhYzE2NzBmZDRhZTExOTg2YzQtYTA2NC00NzAyLTk1YjktM2E4NGYyN2UzZTc1","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"e74d8cbe5a0a3326c07e4e0a82ece454","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/home/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637018877156514048.MTk1Y2UzNmMtZDRkZC00YzQ4LWI0MDMtMjhhYzE2NzBmZDRhZTExOTg2YzQtYTA2NC00NzAyLTk1YjktM2E4NGYyN2UzZTc1","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9M6zG-cVdAPAqX6DT_uB_mFL6nMHKWpSkym9W1dl64DkOVqhMCceM_bO1Rq4Kwcg_1PBJoJRZFHwDUSCYehNmPYf_kmxzUxFOv8YpDNtHYVFvemaKXxvvGZLhcEwiYOzywH8xgDMcDuLzJtkoKNXzckH7AzrcddU1hnyyn9U1w8veGwvNzkNs2DaWbKmropE5-4sHbaI8ahEosd1GVyZn1PuoY01OEs8FW0mJzmpMfV3b2an45n28s-wouZojKO7_qmsX_KSWFAyFREEI45c9mX3H7cbuxDpYX6hPU-xYXU3-Ge72I1zXUM3PAth-41glI","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-20 11:48:35.692 +03:00 [DBG] Client is configured to not require consent, no consent is required
2019-08-20 11:48:35.692 +03:00 [DBG] Creating Hybrid Flow response.
2019-08-20 11:48:35.693 +03:00 [DBG] Creating Implicit Flow response.
2019-08-20 11:48:35.693 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 11:48:35.694 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 11:48:35.699 +03:00 [DBG] Authorize endpoint response
{"SubjectId":"1","ClientId":"mvc","RedirectUri":"http://localhost:5002/home/signin-oidc","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9M6zG-cVdAPAqX6DT_uB_mFL6nMHKWpSkym9W1dl64DkOVqhMCceM_bO1Rq4Kwcg_1PBJoJRZFHwDUSCYehNmPYf_kmxzUxFOv8YpDNtHYVFvemaKXxvvGZLhcEwiYOzywH8xgDMcDuLzJtkoKNXzckH7AzrcddU1hnyyn9U1w8veGwvNzkNs2DaWbKmropE5-4sHbaI8ahEosd1GVyZn1PuoY01OEs8FW0mJzmpMfV3b2an45n28s-wouZojKO7_qmsX_KSWFAyFREEI45c9mX3H7cbuxDpYX6hPU-xYXU3-Ge72I1zXUM3PAth-41glI","Scope":"openid profile afcpayroll offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-08-20 11:48:35.905 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-20 11:48:35.931 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-20 11:48:35.934 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-20 11:48:35.935 +03:00 [DBG] Start token request.
2019-08-20 11:48:35.936 +03:00 [DBG] Start client validation
2019-08-20 11:48:35.936 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-20 11:48:35.937 +03:00 [DBG] Start parsing for secret in post body
2019-08-20 11:48:35.938 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-20 11:48:35.948 +03:00 [DBG] Secret id found: mvc
2019-08-20 11:48:35.952 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:35.953 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-20 11:48:35.954 +03:00 [DBG] Client validation success
2019-08-20 11:48:35.954 +03:00 [DBG] Start token request validation
2019-08-20 11:48:35.955 +03:00 [DBG] Start validation of authorization code token request
2019-08-20 11:48:35.956 +03:00 [DBG] Validation of authorization code token request success
2019-08-20 11:48:35.957 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"b9b1c5b9a75e019f5daec8729c2f9cda1c3846a22e0ce8fab3f1ee384cb13dd5","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"mvc","client_secret":"***REDACTED***","code":"b9b1c5b9a75e019f5daec8729c2f9cda1c3846a22e0ce8fab3f1ee384cb13dd5","grant_type":"authorization_code","redirect_uri":"http://localhost:5002/home/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-08-20 11:48:35.966 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:35.967 +03:00 [DBG] Getting claims for access token for client: mvc
2019-08-20 11:48:35.967 +03:00 [DBG] Getting claims for access token for subject: 1
2019-08-20 11:48:35.972 +03:00 [DBG] Creating refresh token
2019-08-20 11:48:35.973 +03:00 [DBG] Setting an absolute lifetime: 2592000
2019-08-20 11:48:35.973 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:35.974 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 11:48:35.975 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 11:48:35.979 +03:00 [DBG] Token request success.
2019-08-20 11:48:35.984 +03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-08-20 11:48:35.987 +03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-08-20 11:48:35.988 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-08-20 11:48:35.989 +03:00 [DBG] Start userinfo request
2019-08-20 11:48:35.989 +03:00 [DBG] Bearer token found in header
2019-08-20 11:48:35.992 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:35.993 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:35.994 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-08-20 11:48:35.995 +03:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1566290915,"exp":1566290975,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","afcpayroll"],"client_id":"mvc","sub":"1","auth_time":1566290868,"idp":"local","name":"alice","email":"alice@email.com","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-08-20 11:48:35.999 +03:00 [DBG] Creating userinfo response
2019-08-20 11:48:36.000 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:48:36.001 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:48:36.001 +03:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 11:48:36.002 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:48:36.003 +03:00 [INF] Profile service returned the following claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 11:48:36.004 +03:00 [DBG] End userinfo request
2019-08-20 11:48:36.079 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-08-20 11:48:36.081 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-08-20 11:48:36.082 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-08-20 11:48:36.083 +03:00 [DBG] Start authorize request
2019-08-20 11:48:36.084 +03:00 [DBG] User in authorize request: 1
2019-08-20 11:48:36.085 +03:00 [DBG] Start authorize request protocol validation
2019-08-20 11:48:36.088 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:36.089 +03:00 [DBG] Checking for PKCE parameters
2019-08-20 11:48:36.089 +03:00 [DBG] No PKCE used.
2019-08-20 11:48:36.091 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-20 11:48:36.091 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/home/signin-oidc","AllowedRedirectUris":["http://localhost:5002/home/signin-oidc"],"SubjectId":"1","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9PrGPYHXv1cWG-PlLp5YIc5Rm5uJLe_l9ErjHp4RTMmSsKGDkUrqJZtl6cnPCY4fijSGjlMFYR6HiPF1_g9hmlZ7e8Pa3pOpa6WEsdUDUld-qjNeRV6_u_qGNNU9C8vDSjmKks4NeozEto-z7GBV572Rk_jykzZZHY95jJMwI3edsUnwFdJlGBPZ_75sSKt7zBphZVdxHJwAcRB8WERuSAxzmTpOCGLVbaWxSYfzKKDq6ua0yExxoHWv0W0Not5SFckLYdbApG1dbm1SqbuGWON8iSYhONYojKPYs30e-VdyQ8rTjnoTQAlqyUUPCQrTwQ","UiLocales":null,"Nonce":"637018877160493701.ODg5OWJkODEtY2RhNC00ZGY0LWFhMTMtZTUzZDZlNzYxZGVlZmY1ODhiMzktYWE3Ny00ZWVmLThiMzQtZmJjNTc0NGRlMWUw","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"e74d8cbe5a0a3326c07e4e0a82ece454","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/home/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637018877160493701.ODg5OWJkODEtY2RhNC00ZGY0LWFhMTMtZTUzZDZlNzYxZGVlZmY1ODhiMzktYWE3Ny00ZWVmLThiMzQtZmJjNTc0NGRlMWUw","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9PrGPYHXv1cWG-PlLp5YIc5Rm5uJLe_l9ErjHp4RTMmSsKGDkUrqJZtl6cnPCY4fijSGjlMFYR6HiPF1_g9hmlZ7e8Pa3pOpa6WEsdUDUld-qjNeRV6_u_qGNNU9C8vDSjmKks4NeozEto-z7GBV572Rk_jykzZZHY95jJMwI3edsUnwFdJlGBPZ_75sSKt7zBphZVdxHJwAcRB8WERuSAxzmTpOCGLVbaWxSYfzKKDq6ua0yExxoHWv0W0Not5SFckLYdbApG1dbm1SqbuGWON8iSYhONYojKPYs30e-VdyQ8rTjnoTQAlqyUUPCQrTwQ","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-20 11:48:36.099 +03:00 [DBG] Client is configured to not require consent, no consent is required
2019-08-20 11:48:36.100 +03:00 [DBG] Creating Hybrid Flow response.
2019-08-20 11:48:36.100 +03:00 [DBG] Creating Implicit Flow response.
2019-08-20 11:48:36.101 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 11:48:36.101 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 11:48:36.106 +03:00 [DBG] Authorize endpoint response
{"SubjectId":"1","ClientId":"mvc","RedirectUri":"http://localhost:5002/home/signin-oidc","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9PrGPYHXv1cWG-PlLp5YIc5Rm5uJLe_l9ErjHp4RTMmSsKGDkUrqJZtl6cnPCY4fijSGjlMFYR6HiPF1_g9hmlZ7e8Pa3pOpa6WEsdUDUld-qjNeRV6_u_qGNNU9C8vDSjmKks4NeozEto-z7GBV572Rk_jykzZZHY95jJMwI3edsUnwFdJlGBPZ_75sSKt7zBphZVdxHJwAcRB8WERuSAxzmTpOCGLVbaWxSYfzKKDq6ua0yExxoHWv0W0Not5SFckLYdbApG1dbm1SqbuGWON8iSYhONYojKPYs30e-VdyQ8rTjnoTQAlqyUUPCQrTwQ","Scope":"openid profile afcpayroll offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-08-20 11:48:36.308 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-20 11:48:36.310 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-20 11:48:36.311 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-20 11:48:36.312 +03:00 [DBG] Start token request.
2019-08-20 11:48:36.312 +03:00 [DBG] Start client validation
2019-08-20 11:48:36.313 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-20 11:48:36.314 +03:00 [DBG] Start parsing for secret in post body
2019-08-20 11:48:36.314 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-20 11:48:36.315 +03:00 [DBG] Secret id found: mvc
2019-08-20 11:48:36.315 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:36.316 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-20 11:48:36.316 +03:00 [DBG] Client validation success
2019-08-20 11:48:36.317 +03:00 [DBG] Start token request validation
2019-08-20 11:48:36.317 +03:00 [DBG] Start validation of authorization code token request
2019-08-20 11:48:36.318 +03:00 [DBG] Validation of authorization code token request success
2019-08-20 11:48:36.319 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"28933934cb11b1661736efe3aff55b061d23e5c71af8361e7c01c4534e82e3af","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"mvc","client_secret":"***REDACTED***","code":"28933934cb11b1661736efe3aff55b061d23e5c71af8361e7c01c4534e82e3af","grant_type":"authorization_code","redirect_uri":"http://localhost:5002/home/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-08-20 11:48:36.322 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:36.323 +03:00 [DBG] Getting claims for access token for client: mvc
2019-08-20 11:48:36.323 +03:00 [DBG] Getting claims for access token for subject: 1
2019-08-20 11:48:36.327 +03:00 [DBG] Creating refresh token
2019-08-20 11:48:36.328 +03:00 [DBG] Setting an absolute lifetime: 2592000
2019-08-20 11:48:36.330 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:36.331 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 11:48:36.331 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 11:48:36.336 +03:00 [DBG] Token request success.
2019-08-20 11:48:36.338 +03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-08-20 11:48:36.339 +03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-08-20 11:48:36.339 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-08-20 11:48:36.340 +03:00 [DBG] Start userinfo request
2019-08-20 11:48:36.341 +03:00 [DBG] Bearer token found in header
2019-08-20 11:48:36.345 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:36.346 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:36.347 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-08-20 11:48:36.347 +03:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1566290916,"exp":1566290976,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","afcpayroll"],"client_id":"mvc","sub":"1","auth_time":1566290868,"idp":"local","name":"alice","email":"alice@email.com","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-08-20 11:48:36.352 +03:00 [DBG] Creating userinfo response
2019-08-20 11:48:36.352 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:48:36.353 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:48:36.353 +03:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 11:48:36.354 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:48:36.354 +03:00 [INF] Profile service returned the following claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 11:48:36.355 +03:00 [DBG] End userinfo request
2019-08-20 11:48:36.406 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-08-20 11:48:36.407 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-08-20 11:48:36.408 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-08-20 11:48:36.408 +03:00 [DBG] Start authorize request
2019-08-20 11:48:36.409 +03:00 [DBG] User in authorize request: 1
2019-08-20 11:48:36.410 +03:00 [DBG] Start authorize request protocol validation
2019-08-20 11:48:36.411 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:36.412 +03:00 [DBG] Checking for PKCE parameters
2019-08-20 11:48:36.413 +03:00 [DBG] No PKCE used.
2019-08-20 11:48:36.413 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-20 11:48:36.414 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/home/signin-oidc","AllowedRedirectUris":["http://localhost:5002/home/signin-oidc"],"SubjectId":"1","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9OSeinyxb6iPQPfhOvZIOBYEC8NQV07C9CDANR4O3dGQttGJ626u_hCoX8C_H1MEjSd_IkUmAZvv2zqVUAWZwxmNVYhQ66i1u9_M9Rx-jO0qFwglDkrVGdSp9wAA8l7exuyp3fC5-PJeZUry2_fMT6fHPjpwhsFb6HsMgme6NoP9UEJR-_QKTjYyjSM1CF734KVhea6PaRLQzHWGTmV5U7fZ_2Uhnv093VexLOt84DvlUhtXvXVbBCdm1-nkxf5nhrjSR0MB4apWOdBKa1XqkkvNxnqXbAqZwdCuiES8DKaUl7DqSeH0RUPWurAVFp9_4M","UiLocales":null,"Nonce":"637018877163839445.YzUzOTgwMmYtNTFlNS00NmI4LTg1MmItMjk0MWMzNmMzMDdlMzdjZWI3YWQtZGY0Mi00ODc4LWJhZDktZTllN2RhODc5MzY4","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"e74d8cbe5a0a3326c07e4e0a82ece454","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/home/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637018877163839445.YzUzOTgwMmYtNTFlNS00NmI4LTg1MmItMjk0MWMzNmMzMDdlMzdjZWI3YWQtZGY0Mi00ODc4LWJhZDktZTllN2RhODc5MzY4","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9OSeinyxb6iPQPfhOvZIOBYEC8NQV07C9CDANR4O3dGQttGJ626u_hCoX8C_H1MEjSd_IkUmAZvv2zqVUAWZwxmNVYhQ66i1u9_M9Rx-jO0qFwglDkrVGdSp9wAA8l7exuyp3fC5-PJeZUry2_fMT6fHPjpwhsFb6HsMgme6NoP9UEJR-_QKTjYyjSM1CF734KVhea6PaRLQzHWGTmV5U7fZ_2Uhnv093VexLOt84DvlUhtXvXVbBCdm1-nkxf5nhrjSR0MB4apWOdBKa1XqkkvNxnqXbAqZwdCuiES8DKaUl7DqSeH0RUPWurAVFp9_4M","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-20 11:48:36.419 +03:00 [DBG] Client is configured to not require consent, no consent is required
2019-08-20 11:48:36.420 +03:00 [DBG] Creating Hybrid Flow response.
2019-08-20 11:48:36.420 +03:00 [DBG] Creating Implicit Flow response.
2019-08-20 11:48:36.421 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 11:48:36.421 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 11:48:36.426 +03:00 [DBG] Authorize endpoint response
{"SubjectId":"1","ClientId":"mvc","RedirectUri":"http://localhost:5002/home/signin-oidc","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9OSeinyxb6iPQPfhOvZIOBYEC8NQV07C9CDANR4O3dGQttGJ626u_hCoX8C_H1MEjSd_IkUmAZvv2zqVUAWZwxmNVYhQ66i1u9_M9Rx-jO0qFwglDkrVGdSp9wAA8l7exuyp3fC5-PJeZUry2_fMT6fHPjpwhsFb6HsMgme6NoP9UEJR-_QKTjYyjSM1CF734KVhea6PaRLQzHWGTmV5U7fZ_2Uhnv093VexLOt84DvlUhtXvXVbBCdm1-nkxf5nhrjSR0MB4apWOdBKa1XqkkvNxnqXbAqZwdCuiES8DKaUl7DqSeH0RUPWurAVFp9_4M","Scope":"openid profile afcpayroll offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-08-20 11:48:36.662 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-20 11:48:36.664 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-20 11:48:36.665 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-20 11:48:36.665 +03:00 [DBG] Start token request.
2019-08-20 11:48:36.666 +03:00 [DBG] Start client validation
2019-08-20 11:48:36.666 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-20 11:48:36.666 +03:00 [DBG] Start parsing for secret in post body
2019-08-20 11:48:36.667 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-20 11:48:36.668 +03:00 [DBG] Secret id found: mvc
2019-08-20 11:48:36.669 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:36.669 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-20 11:48:36.670 +03:00 [DBG] Client validation success
2019-08-20 11:48:36.670 +03:00 [DBG] Start token request validation
2019-08-20 11:48:36.671 +03:00 [DBG] Start validation of authorization code token request
2019-08-20 11:48:36.673 +03:00 [DBG] Validation of authorization code token request success
2019-08-20 11:48:36.673 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"248cdc38c8857e122b015cb59c0cc5ce119133250bb80c4d43eedb009afe16f1","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"mvc","client_secret":"***REDACTED***","code":"248cdc38c8857e122b015cb59c0cc5ce119133250bb80c4d43eedb009afe16f1","grant_type":"authorization_code","redirect_uri":"http://localhost:5002/home/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-08-20 11:48:36.677 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:36.678 +03:00 [DBG] Getting claims for access token for client: mvc
2019-08-20 11:48:36.679 +03:00 [DBG] Getting claims for access token for subject: 1
2019-08-20 11:48:36.683 +03:00 [DBG] Creating refresh token
2019-08-20 11:48:36.683 +03:00 [DBG] Setting an absolute lifetime: 2592000
2019-08-20 11:48:36.684 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:36.685 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 11:48:36.686 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 11:48:36.691 +03:00 [DBG] Token request success.
2019-08-20 11:48:36.695 +03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-08-20 11:48:36.696 +03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-08-20 11:48:36.697 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-08-20 11:48:36.697 +03:00 [DBG] Start userinfo request
2019-08-20 11:48:36.698 +03:00 [DBG] Bearer token found in header
2019-08-20 11:48:36.701 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:36.703 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:36.704 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-08-20 11:48:36.705 +03:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1566290916,"exp":1566290976,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","afcpayroll"],"client_id":"mvc","sub":"1","auth_time":1566290868,"idp":"local","name":"alice","email":"alice@email.com","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-08-20 11:48:36.710 +03:00 [DBG] Creating userinfo response
2019-08-20 11:48:36.710 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:48:36.711 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:48:36.712 +03:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 11:48:36.712 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:48:36.714 +03:00 [INF] Profile service returned the following claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 11:48:36.714 +03:00 [DBG] End userinfo request
2019-08-20 11:48:36.769 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-08-20 11:48:36.771 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-08-20 11:48:36.772 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-08-20 11:48:36.773 +03:00 [DBG] Start authorize request
2019-08-20 11:48:36.773 +03:00 [DBG] User in authorize request: 1
2019-08-20 11:48:36.774 +03:00 [DBG] Start authorize request protocol validation
2019-08-20 11:48:36.775 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:36.777 +03:00 [DBG] Checking for PKCE parameters
2019-08-20 11:48:36.778 +03:00 [DBG] No PKCE used.
2019-08-20 11:48:36.780 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-20 11:48:36.782 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/home/signin-oidc","AllowedRedirectUris":["http://localhost:5002/home/signin-oidc"],"SubjectId":"1","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9NY2vREXSdpvvZrbRhA2h8qtnaMYrF2rPX-joIVmxiH-JONlqej8P1UPAWfiNlAIasuR0KExlyaco4FD3BygrChsqXExaAIhoQ-Sw7YTGv0BiBeO3Z29eKlLSd_2vKtS7Yjz0tPSQj1syCIn7_g4k1S6XZEZUNPzCZ-OY22i46Vt46ri3HvvW_UOT3HDpzzl9ySlT8x7J9uwG8P-m3WMYJooE4S2K7PxXQ5YCeZb9rg0XZvzZ9_aE2Gmu4pFgimDvcDLxaWTZeZipSgCNKQzXYHQnUrZyo1WSopqa8ht9Ih-P29GGvc7JTv-VzeAKhwlcU","UiLocales":null,"Nonce":"637018877167464578.YWVmMjcyNzMtZWExYS00N2NlLThmZTAtZmJlYzBlMDhmNjNiOTc4ODk1MDctZGNkYS00MmNlLWEwNDktN2M5NTJhNGE4ZGY0","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"e74d8cbe5a0a3326c07e4e0a82ece454","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/home/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637018877167464578.YWVmMjcyNzMtZWExYS00N2NlLThmZTAtZmJlYzBlMDhmNjNiOTc4ODk1MDctZGNkYS00MmNlLWEwNDktN2M5NTJhNGE4ZGY0","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9NY2vREXSdpvvZrbRhA2h8qtnaMYrF2rPX-joIVmxiH-JONlqej8P1UPAWfiNlAIasuR0KExlyaco4FD3BygrChsqXExaAIhoQ-Sw7YTGv0BiBeO3Z29eKlLSd_2vKtS7Yjz0tPSQj1syCIn7_g4k1S6XZEZUNPzCZ-OY22i46Vt46ri3HvvW_UOT3HDpzzl9ySlT8x7J9uwG8P-m3WMYJooE4S2K7PxXQ5YCeZb9rg0XZvzZ9_aE2Gmu4pFgimDvcDLxaWTZeZipSgCNKQzXYHQnUrZyo1WSopqa8ht9Ih-P29GGvc7JTv-VzeAKhwlcU","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-20 11:48:36.788 +03:00 [DBG] Client is configured to not require consent, no consent is required
2019-08-20 11:48:36.788 +03:00 [DBG] Creating Hybrid Flow response.
2019-08-20 11:48:36.789 +03:00 [DBG] Creating Implicit Flow response.
2019-08-20 11:48:36.790 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 11:48:36.790 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 11:48:36.796 +03:00 [DBG] Authorize endpoint response
{"SubjectId":"1","ClientId":"mvc","RedirectUri":"http://localhost:5002/home/signin-oidc","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9NY2vREXSdpvvZrbRhA2h8qtnaMYrF2rPX-joIVmxiH-JONlqej8P1UPAWfiNlAIasuR0KExlyaco4FD3BygrChsqXExaAIhoQ-Sw7YTGv0BiBeO3Z29eKlLSd_2vKtS7Yjz0tPSQj1syCIn7_g4k1S6XZEZUNPzCZ-OY22i46Vt46ri3HvvW_UOT3HDpzzl9ySlT8x7J9uwG8P-m3WMYJooE4S2K7PxXQ5YCeZb9rg0XZvzZ9_aE2Gmu4pFgimDvcDLxaWTZeZipSgCNKQzXYHQnUrZyo1WSopqa8ht9Ih-P29GGvc7JTv-VzeAKhwlcU","Scope":"openid profile afcpayroll offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-08-20 11:48:36.989 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-20 11:48:36.990 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-20 11:48:36.990 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-20 11:48:36.991 +03:00 [DBG] Start token request.
2019-08-20 11:48:36.991 +03:00 [DBG] Start client validation
2019-08-20 11:48:36.992 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-20 11:48:36.992 +03:00 [DBG] Start parsing for secret in post body
2019-08-20 11:48:36.993 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-20 11:48:36.993 +03:00 [DBG] Secret id found: mvc
2019-08-20 11:48:36.994 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:36.996 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-20 11:48:36.998 +03:00 [DBG] Client validation success
2019-08-20 11:48:36.998 +03:00 [DBG] Start token request validation
2019-08-20 11:48:36.999 +03:00 [DBG] Start validation of authorization code token request
2019-08-20 11:48:37.000 +03:00 [DBG] Validation of authorization code token request success
2019-08-20 11:48:37.000 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"29491606043f0e4be76dcfdcf6ff166064f8e832f368e6c31ca04de1d7c87643","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"mvc","client_secret":"***REDACTED***","code":"29491606043f0e4be76dcfdcf6ff166064f8e832f368e6c31ca04de1d7c87643","grant_type":"authorization_code","redirect_uri":"http://localhost:5002/home/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-08-20 11:48:37.004 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:37.004 +03:00 [DBG] Getting claims for access token for client: mvc
2019-08-20 11:48:37.005 +03:00 [DBG] Getting claims for access token for subject: 1
2019-08-20 11:48:37.009 +03:00 [DBG] Creating refresh token
2019-08-20 11:48:37.009 +03:00 [DBG] Setting an absolute lifetime: 2592000
2019-08-20 11:48:37.010 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:37.011 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 11:48:37.013 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 11:48:37.017 +03:00 [DBG] Token request success.
2019-08-20 11:48:37.019 +03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-08-20 11:48:37.020 +03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-08-20 11:48:37.020 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-08-20 11:48:37.021 +03:00 [DBG] Start userinfo request
2019-08-20 11:48:37.021 +03:00 [DBG] Bearer token found in header
2019-08-20 11:48:37.024 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:37.024 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:37.025 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-08-20 11:48:37.026 +03:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1566290917,"exp":1566290977,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","afcpayroll"],"client_id":"mvc","sub":"1","auth_time":1566290868,"idp":"local","name":"alice","email":"alice@email.com","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-08-20 11:48:37.033 +03:00 [DBG] Creating userinfo response
2019-08-20 11:48:37.034 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:48:37.035 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:48:37.035 +03:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 11:48:37.036 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:48:37.036 +03:00 [INF] Profile service returned the following claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 11:48:37.037 +03:00 [DBG] End userinfo request
2019-08-20 11:48:37.087 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-08-20 11:48:37.089 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-08-20 11:48:37.089 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-08-20 11:48:37.090 +03:00 [DBG] Start authorize request
2019-08-20 11:48:37.090 +03:00 [DBG] User in authorize request: 1
2019-08-20 11:48:37.091 +03:00 [DBG] Start authorize request protocol validation
2019-08-20 11:48:37.091 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:37.092 +03:00 [DBG] Checking for PKCE parameters
2019-08-20 11:48:37.092 +03:00 [DBG] No PKCE used.
2019-08-20 11:48:37.095 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-20 11:48:37.096 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/home/signin-oidc","AllowedRedirectUris":["http://localhost:5002/home/signin-oidc"],"SubjectId":"1","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9NSgLBc5wFcfcTpRRBLavXx05wMBq7isJgqYDjM-idtvBFEWuGbHSMesksLrXyHYVtfpuLmyjrq-EY7Cqmr2fZT8-D5BnzBE2ZzNVZu_5TpUYaiQ6CE4OrgSa565UfSf6i-BDwqL3iMkNUBF4Bfqjyi0LaMwR9LA9H4-KffCB7sfhkWA1vv5EfQTymt21WHgSplUNCm8i-KaaxLqrnDE6VQZIdvqGZ7ONhyrCxgM0_UJ1RRwZwv_jqhw98LWILXqLnfZU5SXx6wsZV2Jah-EyjhZcrsFD87q-7zzhUTr_u9aQ9bnWxpu08zIjEPyVQjnAs","UiLocales":null,"Nonce":"637018877170709978.YjBlNGQ2YTYtMjU2Ny00YTAwLTkwODMtNTA2MmUzYTJkODJkZjg4ZDE2NzktYzVhYS00Njk4LWE2MTMtYzg1MDdmNzc3NGZj","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"e74d8cbe5a0a3326c07e4e0a82ece454","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/home/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637018877170709978.YjBlNGQ2YTYtMjU2Ny00YTAwLTkwODMtNTA2MmUzYTJkODJkZjg4ZDE2NzktYzVhYS00Njk4LWE2MTMtYzg1MDdmNzc3NGZj","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9NSgLBc5wFcfcTpRRBLavXx05wMBq7isJgqYDjM-idtvBFEWuGbHSMesksLrXyHYVtfpuLmyjrq-EY7Cqmr2fZT8-D5BnzBE2ZzNVZu_5TpUYaiQ6CE4OrgSa565UfSf6i-BDwqL3iMkNUBF4Bfqjyi0LaMwR9LA9H4-KffCB7sfhkWA1vv5EfQTymt21WHgSplUNCm8i-KaaxLqrnDE6VQZIdvqGZ7ONhyrCxgM0_UJ1RRwZwv_jqhw98LWILXqLnfZU5SXx6wsZV2Jah-EyjhZcrsFD87q-7zzhUTr_u9aQ9bnWxpu08zIjEPyVQjnAs","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-20 11:48:37.101 +03:00 [DBG] Client is configured to not require consent, no consent is required
2019-08-20 11:48:37.101 +03:00 [DBG] Creating Hybrid Flow response.
2019-08-20 11:48:37.102 +03:00 [DBG] Creating Implicit Flow response.
2019-08-20 11:48:37.102 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 11:48:37.103 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 11:48:37.108 +03:00 [DBG] Authorize endpoint response
{"SubjectId":"1","ClientId":"mvc","RedirectUri":"http://localhost:5002/home/signin-oidc","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9NSgLBc5wFcfcTpRRBLavXx05wMBq7isJgqYDjM-idtvBFEWuGbHSMesksLrXyHYVtfpuLmyjrq-EY7Cqmr2fZT8-D5BnzBE2ZzNVZu_5TpUYaiQ6CE4OrgSa565UfSf6i-BDwqL3iMkNUBF4Bfqjyi0LaMwR9LA9H4-KffCB7sfhkWA1vv5EfQTymt21WHgSplUNCm8i-KaaxLqrnDE6VQZIdvqGZ7ONhyrCxgM0_UJ1RRwZwv_jqhw98LWILXqLnfZU5SXx6wsZV2Jah-EyjhZcrsFD87q-7zzhUTr_u9aQ9bnWxpu08zIjEPyVQjnAs","Scope":"openid profile afcpayroll offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-08-20 11:48:37.305 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-20 11:48:37.306 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-20 11:48:37.308 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-20 11:48:37.309 +03:00 [DBG] Start token request.
2019-08-20 11:48:37.309 +03:00 [DBG] Start client validation
2019-08-20 11:48:37.310 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-20 11:48:37.310 +03:00 [DBG] Start parsing for secret in post body
2019-08-20 11:48:37.312 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-20 11:48:37.312 +03:00 [DBG] Secret id found: mvc
2019-08-20 11:48:37.313 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:37.314 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-20 11:48:37.314 +03:00 [DBG] Client validation success
2019-08-20 11:48:37.314 +03:00 [DBG] Start token request validation
2019-08-20 11:48:37.315 +03:00 [DBG] Start validation of authorization code token request
2019-08-20 11:48:37.316 +03:00 [DBG] Validation of authorization code token request success
2019-08-20 11:48:37.316 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"a194eef412ff351bf9dd1f4a8b22675cbdab1b66f78c77b61b34aa2cfdb44c96","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"mvc","client_secret":"***REDACTED***","code":"a194eef412ff351bf9dd1f4a8b22675cbdab1b66f78c77b61b34aa2cfdb44c96","grant_type":"authorization_code","redirect_uri":"http://localhost:5002/home/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-08-20 11:48:37.319 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:37.320 +03:00 [DBG] Getting claims for access token for client: mvc
2019-08-20 11:48:37.320 +03:00 [DBG] Getting claims for access token for subject: 1
2019-08-20 11:48:37.324 +03:00 [DBG] Creating refresh token
2019-08-20 11:48:37.325 +03:00 [DBG] Setting an absolute lifetime: 2592000
2019-08-20 11:48:37.325 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:37.326 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 11:48:37.326 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 11:48:37.331 +03:00 [DBG] Token request success.
2019-08-20 11:48:37.334 +03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-08-20 11:48:37.335 +03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-08-20 11:48:37.335 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-08-20 11:48:37.336 +03:00 [DBG] Start userinfo request
2019-08-20 11:48:37.336 +03:00 [DBG] Bearer token found in header
2019-08-20 11:48:37.339 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:37.340 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:37.341 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-08-20 11:48:37.341 +03:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1566290917,"exp":1566290977,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","afcpayroll"],"client_id":"mvc","sub":"1","auth_time":1566290868,"idp":"local","name":"alice","email":"alice@email.com","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-08-20 11:48:37.346 +03:00 [DBG] Creating userinfo response
2019-08-20 11:48:37.347 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:48:37.347 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:48:37.348 +03:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 11:48:37.348 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:48:37.349 +03:00 [INF] Profile service returned the following claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 11:48:37.349 +03:00 [DBG] End userinfo request
2019-08-20 11:48:37.393 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-08-20 11:48:37.394 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-08-20 11:48:37.395 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-08-20 11:48:37.395 +03:00 [DBG] Start authorize request
2019-08-20 11:48:37.396 +03:00 [DBG] User in authorize request: 1
2019-08-20 11:48:37.396 +03:00 [DBG] Start authorize request protocol validation
2019-08-20 11:48:37.397 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:37.397 +03:00 [DBG] Checking for PKCE parameters
2019-08-20 11:48:37.398 +03:00 [DBG] No PKCE used.
2019-08-20 11:48:37.398 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-20 11:48:37.399 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/home/signin-oidc","AllowedRedirectUris":["http://localhost:5002/home/signin-oidc"],"SubjectId":"1","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9PQ3OvD-FAyUqmkL0rE8GkbUdq2IrZAUL_hWhEE5H5RWWTLgQ6wcfQA1CzY5HYly71zyEkhPcmg-0_0UZ2-RRRB6Vwy8YaxaLy2CP78rHFZYItuMrE2WUTl-aM3vePqZPQawefpRENPC48BNwMTBne7n3p8U6UVVrhbtoIJX0R4UkXBenCsErMR1rkd5stY934dQivuwPmwWTlQbXOYKkQM0nrvKBuwkB2dK4SQrBWvg1hh-JmiZtaOA5-OCrx4bOSPlAwPQ89T7yWBm-gt9iVXhbFz8pnuawGqYprOhWjHnjfs282eDPpjsFaJl9UDoiM","UiLocales":null,"Nonce":"637018877173783192.ZDUwNDI4ZTMtMWIzNy00ZjA3LTk1M2UtYTkxOWIzNWEwYjgzMTM5ZjIyMDYtOWNhMC00ZmY5LWIwODgtNDhkZmI3MWMwZTg3","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"e74d8cbe5a0a3326c07e4e0a82ece454","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/home/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637018877173783192.ZDUwNDI4ZTMtMWIzNy00ZjA3LTk1M2UtYTkxOWIzNWEwYjgzMTM5ZjIyMDYtOWNhMC00ZmY5LWIwODgtNDhkZmI3MWMwZTg3","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9PQ3OvD-FAyUqmkL0rE8GkbUdq2IrZAUL_hWhEE5H5RWWTLgQ6wcfQA1CzY5HYly71zyEkhPcmg-0_0UZ2-RRRB6Vwy8YaxaLy2CP78rHFZYItuMrE2WUTl-aM3vePqZPQawefpRENPC48BNwMTBne7n3p8U6UVVrhbtoIJX0R4UkXBenCsErMR1rkd5stY934dQivuwPmwWTlQbXOYKkQM0nrvKBuwkB2dK4SQrBWvg1hh-JmiZtaOA5-OCrx4bOSPlAwPQ89T7yWBm-gt9iVXhbFz8pnuawGqYprOhWjHnjfs282eDPpjsFaJl9UDoiM","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-20 11:48:37.404 +03:00 [DBG] Client is configured to not require consent, no consent is required
2019-08-20 11:48:37.404 +03:00 [DBG] Creating Hybrid Flow response.
2019-08-20 11:48:37.405 +03:00 [DBG] Creating Implicit Flow response.
2019-08-20 11:48:37.405 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 11:48:37.407 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 11:48:37.411 +03:00 [DBG] Authorize endpoint response
{"SubjectId":"1","ClientId":"mvc","RedirectUri":"http://localhost:5002/home/signin-oidc","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9PQ3OvD-FAyUqmkL0rE8GkbUdq2IrZAUL_hWhEE5H5RWWTLgQ6wcfQA1CzY5HYly71zyEkhPcmg-0_0UZ2-RRRB6Vwy8YaxaLy2CP78rHFZYItuMrE2WUTl-aM3vePqZPQawefpRENPC48BNwMTBne7n3p8U6UVVrhbtoIJX0R4UkXBenCsErMR1rkd5stY934dQivuwPmwWTlQbXOYKkQM0nrvKBuwkB2dK4SQrBWvg1hh-JmiZtaOA5-OCrx4bOSPlAwPQ89T7yWBm-gt9iVXhbFz8pnuawGqYprOhWjHnjfs282eDPpjsFaJl9UDoiM","Scope":"openid profile afcpayroll offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-08-20 11:48:37.627 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-20 11:48:37.628 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-20 11:48:37.629 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-20 11:48:37.630 +03:00 [DBG] Start token request.
2019-08-20 11:48:37.630 +03:00 [DBG] Start client validation
2019-08-20 11:48:37.631 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-20 11:48:37.632 +03:00 [DBG] Start parsing for secret in post body
2019-08-20 11:48:37.633 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-20 11:48:37.634 +03:00 [DBG] Secret id found: mvc
2019-08-20 11:48:37.634 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:37.635 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-20 11:48:37.636 +03:00 [DBG] Client validation success
2019-08-20 11:48:37.637 +03:00 [DBG] Start token request validation
2019-08-20 11:48:37.637 +03:00 [DBG] Start validation of authorization code token request
2019-08-20 11:48:37.638 +03:00 [DBG] Validation of authorization code token request success
2019-08-20 11:48:37.638 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"fe0609fc6dcb144fc922eb5b49b80cbbf052a41efef07991552d2100143b42d5","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"mvc","client_secret":"***REDACTED***","code":"fe0609fc6dcb144fc922eb5b49b80cbbf052a41efef07991552d2100143b42d5","grant_type":"authorization_code","redirect_uri":"http://localhost:5002/home/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-08-20 11:48:37.641 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:37.642 +03:00 [DBG] Getting claims for access token for client: mvc
2019-08-20 11:48:37.643 +03:00 [DBG] Getting claims for access token for subject: 1
2019-08-20 11:48:37.647 +03:00 [DBG] Creating refresh token
2019-08-20 11:48:37.648 +03:00 [DBG] Setting an absolute lifetime: 2592000
2019-08-20 11:48:37.649 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:37.649 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 11:48:37.650 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 11:48:37.654 +03:00 [DBG] Token request success.
2019-08-20 11:48:37.657 +03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-08-20 11:48:37.658 +03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-08-20 11:48:37.659 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-08-20 11:48:37.659 +03:00 [DBG] Start userinfo request
2019-08-20 11:48:37.660 +03:00 [DBG] Bearer token found in header
2019-08-20 11:48:37.663 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:37.664 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:37.665 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-08-20 11:48:37.665 +03:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1566290917,"exp":1566290977,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","afcpayroll"],"client_id":"mvc","sub":"1","auth_time":1566290868,"idp":"local","name":"alice","email":"alice@email.com","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-08-20 11:48:37.671 +03:00 [DBG] Creating userinfo response
2019-08-20 11:48:37.671 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:48:37.672 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:48:37.672 +03:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 11:48:37.673 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:48:37.673 +03:00 [INF] Profile service returned the following claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 11:48:37.674 +03:00 [DBG] End userinfo request
2019-08-20 11:48:37.728 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-08-20 11:48:37.730 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-08-20 11:48:37.730 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-08-20 11:48:37.731 +03:00 [DBG] Start authorize request
2019-08-20 11:48:37.731 +03:00 [DBG] User in authorize request: 1
2019-08-20 11:48:37.732 +03:00 [DBG] Start authorize request protocol validation
2019-08-20 11:48:37.732 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:37.733 +03:00 [DBG] Checking for PKCE parameters
2019-08-20 11:48:37.733 +03:00 [DBG] No PKCE used.
2019-08-20 11:48:37.735 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-20 11:48:37.735 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/home/signin-oidc","AllowedRedirectUris":["http://localhost:5002/home/signin-oidc"],"SubjectId":"1","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9NY70MJ5qW_1zlEeiNwS8azx6ArjckTR1SzlcjdM6b9M_kCOFIYJ_Ri11-gj9zS5KF17YeO9n1P_VWWYYqMkASSot8POaRPVOOIhHx7hDTOpctMTY1EnI68H8fXAuqOzAwCp4QIj-VXoZuAqQ1tDgn8oCzWomMRYOVGuhQx4itCTRHXBy9q0UfARM4S78b-o3yTXLxlI4B8EfXtOQUrbgDeaYKQODMcX3iVhhtcr583GEeTbT8lITLt633LbuHrsZuX-il5hUcDZZlIqV1rgjbshL6iAhIKJLbbIKAyBDwYRmrY-TyRdYcD4GTbLSmf-zI","UiLocales":null,"Nonce":"637018877177072638.YjMyNGI0NWMtYWM0YS00YmMwLTgyOTctNTFhZjYxNWI3YWI2ZmIzMzliYTMtN2M1Yi00N2NmLTk3MjEtZWMxNWNiY2U0YmM4","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"e74d8cbe5a0a3326c07e4e0a82ece454","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/home/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637018877177072638.YjMyNGI0NWMtYWM0YS00YmMwLTgyOTctNTFhZjYxNWI3YWI2ZmIzMzliYTMtN2M1Yi00N2NmLTk3MjEtZWMxNWNiY2U0YmM4","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9NY70MJ5qW_1zlEeiNwS8azx6ArjckTR1SzlcjdM6b9M_kCOFIYJ_Ri11-gj9zS5KF17YeO9n1P_VWWYYqMkASSot8POaRPVOOIhHx7hDTOpctMTY1EnI68H8fXAuqOzAwCp4QIj-VXoZuAqQ1tDgn8oCzWomMRYOVGuhQx4itCTRHXBy9q0UfARM4S78b-o3yTXLxlI4B8EfXtOQUrbgDeaYKQODMcX3iVhhtcr583GEeTbT8lITLt633LbuHrsZuX-il5hUcDZZlIqV1rgjbshL6iAhIKJLbbIKAyBDwYRmrY-TyRdYcD4GTbLSmf-zI","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-20 11:48:37.741 +03:00 [DBG] Client is configured to not require consent, no consent is required
2019-08-20 11:48:37.741 +03:00 [DBG] Creating Hybrid Flow response.
2019-08-20 11:48:37.742 +03:00 [DBG] Creating Implicit Flow response.
2019-08-20 11:48:37.742 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 11:48:37.743 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 11:48:37.749 +03:00 [DBG] Authorize endpoint response
{"SubjectId":"1","ClientId":"mvc","RedirectUri":"http://localhost:5002/home/signin-oidc","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9NY70MJ5qW_1zlEeiNwS8azx6ArjckTR1SzlcjdM6b9M_kCOFIYJ_Ri11-gj9zS5KF17YeO9n1P_VWWYYqMkASSot8POaRPVOOIhHx7hDTOpctMTY1EnI68H8fXAuqOzAwCp4QIj-VXoZuAqQ1tDgn8oCzWomMRYOVGuhQx4itCTRHXBy9q0UfARM4S78b-o3yTXLxlI4B8EfXtOQUrbgDeaYKQODMcX3iVhhtcr583GEeTbT8lITLt633LbuHrsZuX-il5hUcDZZlIqV1rgjbshL6iAhIKJLbbIKAyBDwYRmrY-TyRdYcD4GTbLSmf-zI","Scope":"openid profile afcpayroll offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-08-20 11:48:37.969 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-20 11:48:37.971 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-20 11:48:37.971 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-20 11:48:37.972 +03:00 [DBG] Start token request.
2019-08-20 11:48:37.972 +03:00 [DBG] Start client validation
2019-08-20 11:48:37.973 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-20 11:48:37.973 +03:00 [DBG] Start parsing for secret in post body
2019-08-20 11:48:37.973 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-20 11:48:37.974 +03:00 [DBG] Secret id found: mvc
2019-08-20 11:48:37.974 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:37.976 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-20 11:48:37.977 +03:00 [DBG] Client validation success
2019-08-20 11:48:37.977 +03:00 [DBG] Start token request validation
2019-08-20 11:48:37.978 +03:00 [DBG] Start validation of authorization code token request
2019-08-20 11:48:37.979 +03:00 [DBG] Validation of authorization code token request success
2019-08-20 11:48:37.979 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"2309c75db8bc44cb08007876680bea54eeaa8da11a4d5fb965fa4fbf2e3a9495","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"mvc","client_secret":"***REDACTED***","code":"2309c75db8bc44cb08007876680bea54eeaa8da11a4d5fb965fa4fbf2e3a9495","grant_type":"authorization_code","redirect_uri":"http://localhost:5002/home/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-08-20 11:48:37.983 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:37.985 +03:00 [DBG] Getting claims for access token for client: mvc
2019-08-20 11:48:37.986 +03:00 [DBG] Getting claims for access token for subject: 1
2019-08-20 11:48:37.990 +03:00 [DBG] Creating refresh token
2019-08-20 11:48:37.990 +03:00 [DBG] Setting an absolute lifetime: 2592000
2019-08-20 11:48:37.991 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:37.992 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 11:48:37.992 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 11:48:37.997 +03:00 [DBG] Token request success.
2019-08-20 11:48:38.000 +03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-08-20 11:48:38.001 +03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-08-20 11:48:38.001 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-08-20 11:48:38.002 +03:00 [DBG] Start userinfo request
2019-08-20 11:48:38.002 +03:00 [DBG] Bearer token found in header
2019-08-20 11:48:38.005 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:38.005 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:38.006 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-08-20 11:48:38.006 +03:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1566290917,"exp":1566290977,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","afcpayroll"],"client_id":"mvc","sub":"1","auth_time":1566290868,"idp":"local","name":"alice","email":"alice@email.com","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-08-20 11:48:38.011 +03:00 [DBG] Creating userinfo response
2019-08-20 11:48:38.011 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:48:38.012 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:48:38.013 +03:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 11:48:38.013 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:48:38.014 +03:00 [INF] Profile service returned the following claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 11:48:38.014 +03:00 [DBG] End userinfo request
2019-08-20 11:48:38.064 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-08-20 11:48:38.065 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-08-20 11:48:38.065 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-08-20 11:48:38.066 +03:00 [DBG] Start authorize request
2019-08-20 11:48:38.066 +03:00 [DBG] User in authorize request: 1
2019-08-20 11:48:38.067 +03:00 [DBG] Start authorize request protocol validation
2019-08-20 11:48:38.067 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:38.068 +03:00 [DBG] Checking for PKCE parameters
2019-08-20 11:48:38.068 +03:00 [DBG] No PKCE used.
2019-08-20 11:48:38.069 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-20 11:48:38.069 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/home/signin-oidc","AllowedRedirectUris":["http://localhost:5002/home/signin-oidc"],"SubjectId":"1","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9NptT-noB6no9bM2ddq86F4W8avVyPMazRLyylRNcyxN7HralyBYP_ISdsvnePN7h5-PoKXdh-29TYQdxfRVrNewo7UtE0lTlRiy2lA_z4RUsjVVNaRG0uUilFpb-IBUfkwg9XCzp85vwHNeDc6m9LzMZ3Q9v09QceAgtvXMMQeh2POermfzG-efreOJhg-Fp6ok1chgBDazZuwtX4xU6SyA6eLOzlZ6O16DI2pOacc2BxbXbrSihfcBJODaBaQ2ytPk2LgyvzjXtNt97QNJGVA4p200a1mcQMTiweTzIN9zWY9GBG41In3vW1rgt2UO-w","UiLocales":null,"Nonce":"637018877180449685.NzcxZTZhMDAtMjEzOC00NjVkLWIwN2UtMmZjMTQyNTkxZTg5ZDAxYTg3OTQtOTU5Mi00MjY1LTk2NjItY2FiYzZhOTcwNDM5","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"e74d8cbe5a0a3326c07e4e0a82ece454","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/home/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637018877180449685.NzcxZTZhMDAtMjEzOC00NjVkLWIwN2UtMmZjMTQyNTkxZTg5ZDAxYTg3OTQtOTU5Mi00MjY1LTk2NjItY2FiYzZhOTcwNDM5","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9NptT-noB6no9bM2ddq86F4W8avVyPMazRLyylRNcyxN7HralyBYP_ISdsvnePN7h5-PoKXdh-29TYQdxfRVrNewo7UtE0lTlRiy2lA_z4RUsjVVNaRG0uUilFpb-IBUfkwg9XCzp85vwHNeDc6m9LzMZ3Q9v09QceAgtvXMMQeh2POermfzG-efreOJhg-Fp6ok1chgBDazZuwtX4xU6SyA6eLOzlZ6O16DI2pOacc2BxbXbrSihfcBJODaBaQ2ytPk2LgyvzjXtNt97QNJGVA4p200a1mcQMTiweTzIN9zWY9GBG41In3vW1rgt2UO-w","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-20 11:48:38.080 +03:00 [DBG] Client is configured to not require consent, no consent is required
2019-08-20 11:48:38.080 +03:00 [DBG] Creating Hybrid Flow response.
2019-08-20 11:48:38.081 +03:00 [DBG] Creating Implicit Flow response.
2019-08-20 11:48:38.082 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 11:48:38.082 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 11:48:38.087 +03:00 [DBG] Authorize endpoint response
{"SubjectId":"1","ClientId":"mvc","RedirectUri":"http://localhost:5002/home/signin-oidc","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9NptT-noB6no9bM2ddq86F4W8avVyPMazRLyylRNcyxN7HralyBYP_ISdsvnePN7h5-PoKXdh-29TYQdxfRVrNewo7UtE0lTlRiy2lA_z4RUsjVVNaRG0uUilFpb-IBUfkwg9XCzp85vwHNeDc6m9LzMZ3Q9v09QceAgtvXMMQeh2POermfzG-efreOJhg-Fp6ok1chgBDazZuwtX4xU6SyA6eLOzlZ6O16DI2pOacc2BxbXbrSihfcBJODaBaQ2ytPk2LgyvzjXtNt97QNJGVA4p200a1mcQMTiweTzIN9zWY9GBG41In3vW1rgt2UO-w","Scope":"openid profile afcpayroll offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-08-20 11:48:38.313 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-20 11:48:38.315 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-20 11:48:38.316 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-20 11:48:38.317 +03:00 [DBG] Start token request.
2019-08-20 11:48:38.317 +03:00 [DBG] Start client validation
2019-08-20 11:48:38.318 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-20 11:48:38.319 +03:00 [DBG] Start parsing for secret in post body
2019-08-20 11:48:38.319 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-20 11:48:38.320 +03:00 [DBG] Secret id found: mvc
2019-08-20 11:48:38.320 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:38.321 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-20 11:48:38.321 +03:00 [DBG] Client validation success
2019-08-20 11:48:38.322 +03:00 [DBG] Start token request validation
2019-08-20 11:48:38.322 +03:00 [DBG] Start validation of authorization code token request
2019-08-20 11:48:38.323 +03:00 [DBG] Validation of authorization code token request success
2019-08-20 11:48:38.323 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"8ebd0be838893564d3cb19a5cb157d579731db53927c98002ce28fe192fc0bf7","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"mvc","client_secret":"***REDACTED***","code":"8ebd0be838893564d3cb19a5cb157d579731db53927c98002ce28fe192fc0bf7","grant_type":"authorization_code","redirect_uri":"http://localhost:5002/home/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-08-20 11:48:38.327 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:38.329 +03:00 [DBG] Getting claims for access token for client: mvc
2019-08-20 11:48:38.330 +03:00 [DBG] Getting claims for access token for subject: 1
2019-08-20 11:48:38.334 +03:00 [DBG] Creating refresh token
2019-08-20 11:48:38.334 +03:00 [DBG] Setting an absolute lifetime: 2592000
2019-08-20 11:48:38.335 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:38.335 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 11:48:38.336 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 11:48:38.340 +03:00 [DBG] Token request success.
2019-08-20 11:48:38.342 +03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-08-20 11:48:38.343 +03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-08-20 11:48:38.344 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-08-20 11:48:38.344 +03:00 [DBG] Start userinfo request
2019-08-20 11:48:38.345 +03:00 [DBG] Bearer token found in header
2019-08-20 11:48:38.347 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:38.348 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:38.349 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-08-20 11:48:38.349 +03:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1566290918,"exp":1566290978,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","afcpayroll"],"client_id":"mvc","sub":"1","auth_time":1566290868,"idp":"local","name":"alice","email":"alice@email.com","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-08-20 11:48:38.355 +03:00 [DBG] Creating userinfo response
2019-08-20 11:48:38.357 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:48:38.357 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:48:38.358 +03:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 11:48:38.359 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:48:38.359 +03:00 [INF] Profile service returned the following claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 11:48:38.360 +03:00 [DBG] End userinfo request
2019-08-20 11:48:38.412 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-08-20 11:48:38.413 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-08-20 11:48:38.414 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-08-20 11:48:38.414 +03:00 [DBG] Start authorize request
2019-08-20 11:48:38.415 +03:00 [DBG] User in authorize request: 1
2019-08-20 11:48:38.415 +03:00 [DBG] Start authorize request protocol validation
2019-08-20 11:48:38.416 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:38.417 +03:00 [DBG] Checking for PKCE parameters
2019-08-20 11:48:38.417 +03:00 [DBG] No PKCE used.
2019-08-20 11:48:38.418 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-20 11:48:38.418 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/home/signin-oidc","AllowedRedirectUris":["http://localhost:5002/home/signin-oidc"],"SubjectId":"1","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9MlioZEIy2HJ8o45eGQuZagAbTLpd-IvP5qXcfUoHrZeHHpLOEfyKeG8ih9-xsAv58bvhfR2xi41IyRkOz1gz3GF90KuwfByKoSgEIfcP921lZKWhIMRMzpdeVws5348EKr8Vxka_Pfus9tuehNqVNvgWfcjWKMPnn1q2I7pUec9pRVRf4N5EnwJyD53OFHlWuxdiwa1MCWYwsWnp3aj-sDrUZZ-T_Ht0AYZgMJ6cKEVCA6E8tKu_--5G6mDIBhLZz5rl-MzrpA0l4DJKS-sJkj5w3t9W7MqXrNL1K3RNEieCNj__ssNeTupxeqx-61fGM","UiLocales":null,"Nonce":"637018877183947474.ODdhOWZiODUtMTE1ZC00MjMyLWIwODUtM2U1YzVlMGQ4ZWE0YmY2NTU5MmMtMGQ3Ni00ODkwLWI4YWYtNmQ4M2QwNjdiMzZj","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"e74d8cbe5a0a3326c07e4e0a82ece454","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/home/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637018877183947474.ODdhOWZiODUtMTE1ZC00MjMyLWIwODUtM2U1YzVlMGQ4ZWE0YmY2NTU5MmMtMGQ3Ni00ODkwLWI4YWYtNmQ4M2QwNjdiMzZj","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9MlioZEIy2HJ8o45eGQuZagAbTLpd-IvP5qXcfUoHrZeHHpLOEfyKeG8ih9-xsAv58bvhfR2xi41IyRkOz1gz3GF90KuwfByKoSgEIfcP921lZKWhIMRMzpdeVws5348EKr8Vxka_Pfus9tuehNqVNvgWfcjWKMPnn1q2I7pUec9pRVRf4N5EnwJyD53OFHlWuxdiwa1MCWYwsWnp3aj-sDrUZZ-T_Ht0AYZgMJ6cKEVCA6E8tKu_--5G6mDIBhLZz5rl-MzrpA0l4DJKS-sJkj5w3t9W7MqXrNL1K3RNEieCNj__ssNeTupxeqx-61fGM","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-20 11:48:38.429 +03:00 [DBG] Client is configured to not require consent, no consent is required
2019-08-20 11:48:38.429 +03:00 [DBG] Creating Hybrid Flow response.
2019-08-20 11:48:38.430 +03:00 [DBG] Creating Implicit Flow response.
2019-08-20 11:48:38.430 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 11:48:38.431 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 11:48:38.436 +03:00 [DBG] Authorize endpoint response
{"SubjectId":"1","ClientId":"mvc","RedirectUri":"http://localhost:5002/home/signin-oidc","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9MlioZEIy2HJ8o45eGQuZagAbTLpd-IvP5qXcfUoHrZeHHpLOEfyKeG8ih9-xsAv58bvhfR2xi41IyRkOz1gz3GF90KuwfByKoSgEIfcP921lZKWhIMRMzpdeVws5348EKr8Vxka_Pfus9tuehNqVNvgWfcjWKMPnn1q2I7pUec9pRVRf4N5EnwJyD53OFHlWuxdiwa1MCWYwsWnp3aj-sDrUZZ-T_Ht0AYZgMJ6cKEVCA6E8tKu_--5G6mDIBhLZz5rl-MzrpA0l4DJKS-sJkj5w3t9W7MqXrNL1K3RNEieCNj__ssNeTupxeqx-61fGM","Scope":"openid profile afcpayroll offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-08-20 11:48:38.647 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-20 11:48:38.648 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-20 11:48:38.649 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-20 11:48:38.650 +03:00 [DBG] Start token request.
2019-08-20 11:48:38.650 +03:00 [DBG] Start client validation
2019-08-20 11:48:38.650 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-20 11:48:38.652 +03:00 [DBG] Start parsing for secret in post body
2019-08-20 11:48:38.652 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-20 11:48:38.653 +03:00 [DBG] Secret id found: mvc
2019-08-20 11:48:38.653 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:38.655 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-20 11:48:38.655 +03:00 [DBG] Client validation success
2019-08-20 11:48:38.656 +03:00 [DBG] Start token request validation
2019-08-20 11:48:38.656 +03:00 [DBG] Start validation of authorization code token request
2019-08-20 11:48:38.657 +03:00 [DBG] Validation of authorization code token request success
2019-08-20 11:48:38.658 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"3a5832cb55aded39fbe7aeaf0e24ed673fb16acd6a3c91c41482d4d2807f3de9","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"mvc","client_secret":"***REDACTED***","code":"3a5832cb55aded39fbe7aeaf0e24ed673fb16acd6a3c91c41482d4d2807f3de9","grant_type":"authorization_code","redirect_uri":"http://localhost:5002/home/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-08-20 11:48:38.661 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:38.662 +03:00 [DBG] Getting claims for access token for client: mvc
2019-08-20 11:48:38.662 +03:00 [DBG] Getting claims for access token for subject: 1
2019-08-20 11:48:38.666 +03:00 [DBG] Creating refresh token
2019-08-20 11:48:38.667 +03:00 [DBG] Setting an absolute lifetime: 2592000
2019-08-20 11:48:38.668 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:38.669 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 11:48:38.670 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 11:48:38.675 +03:00 [DBG] Token request success.
2019-08-20 11:48:38.679 +03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-08-20 11:48:38.679 +03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-08-20 11:48:38.680 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-08-20 11:48:38.681 +03:00 [DBG] Start userinfo request
2019-08-20 11:48:38.681 +03:00 [DBG] Bearer token found in header
2019-08-20 11:48:38.684 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:38.684 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:38.685 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-08-20 11:48:38.685 +03:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1566290918,"exp":1566290978,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","afcpayroll"],"client_id":"mvc","sub":"1","auth_time":1566290868,"idp":"local","name":"alice","email":"alice@email.com","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-08-20 11:48:38.689 +03:00 [DBG] Creating userinfo response
2019-08-20 11:48:38.690 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:48:38.691 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:48:38.692 +03:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 11:48:38.693 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:48:38.694 +03:00 [INF] Profile service returned the following claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 11:48:38.694 +03:00 [DBG] End userinfo request
2019-08-20 11:48:38.752 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-08-20 11:48:38.753 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-08-20 11:48:38.754 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-08-20 11:48:38.755 +03:00 [DBG] Start authorize request
2019-08-20 11:48:38.755 +03:00 [DBG] User in authorize request: 1
2019-08-20 11:48:38.756 +03:00 [DBG] Start authorize request protocol validation
2019-08-20 11:48:38.756 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:38.757 +03:00 [DBG] Checking for PKCE parameters
2019-08-20 11:48:38.757 +03:00 [DBG] No PKCE used.
2019-08-20 11:48:38.758 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-20 11:48:38.759 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/home/signin-oidc","AllowedRedirectUris":["http://localhost:5002/home/signin-oidc"],"SubjectId":"1","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9OpMyx5Q_nQtkNnL5yewBTtgel_RoYbCpKMzGxRFA9nh-9QE6j_WdADtWv2RY2jO-d7VZ3m922t0YU-zNJ_KDyUCWz02Q63XmUIWL7h2Ntkwd8aSWMaSWu6lFzsDVdwEfOsq7ig2K3PfMsxLW2GibZKMgpGrnRcqezAOertXZg-_OA9NTPZyN4Dwboc7h1qjwdUdcS_cEKrZDnA1zICVEj-tqZbF55Nq_VG2wFE7RjH904m3XPpiULQxIHEdYyuLCEdJ2VJU3OCY00MFInZ8ZX3BHKoibo5lefan_OUCtiGoB0ZJIV_CZM97lIPXSOVeU4","UiLocales":null,"Nonce":"637018877187316359.ZjUzNTM0YTEtZWMwNS00YTNkLWE1ZmMtYmU0MTAxZDc2N2U1ZGZiNzkyOGEtNmM3Yy00MWNlLTlmZjgtZTMzZWY3MWZjMGIw","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"e74d8cbe5a0a3326c07e4e0a82ece454","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/home/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637018877187316359.ZjUzNTM0YTEtZWMwNS00YTNkLWE1ZmMtYmU0MTAxZDc2N2U1ZGZiNzkyOGEtNmM3Yy00MWNlLTlmZjgtZTMzZWY3MWZjMGIw","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9OpMyx5Q_nQtkNnL5yewBTtgel_RoYbCpKMzGxRFA9nh-9QE6j_WdADtWv2RY2jO-d7VZ3m922t0YU-zNJ_KDyUCWz02Q63XmUIWL7h2Ntkwd8aSWMaSWu6lFzsDVdwEfOsq7ig2K3PfMsxLW2GibZKMgpGrnRcqezAOertXZg-_OA9NTPZyN4Dwboc7h1qjwdUdcS_cEKrZDnA1zICVEj-tqZbF55Nq_VG2wFE7RjH904m3XPpiULQxIHEdYyuLCEdJ2VJU3OCY00MFInZ8ZX3BHKoibo5lefan_OUCtiGoB0ZJIV_CZM97lIPXSOVeU4","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-20 11:48:38.770 +03:00 [DBG] Client is configured to not require consent, no consent is required
2019-08-20 11:48:38.770 +03:00 [DBG] Creating Hybrid Flow response.
2019-08-20 11:48:38.771 +03:00 [DBG] Creating Implicit Flow response.
2019-08-20 11:48:38.772 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 11:48:38.773 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 11:48:38.777 +03:00 [DBG] Authorize endpoint response
{"SubjectId":"1","ClientId":"mvc","RedirectUri":"http://localhost:5002/home/signin-oidc","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9OpMyx5Q_nQtkNnL5yewBTtgel_RoYbCpKMzGxRFA9nh-9QE6j_WdADtWv2RY2jO-d7VZ3m922t0YU-zNJ_KDyUCWz02Q63XmUIWL7h2Ntkwd8aSWMaSWu6lFzsDVdwEfOsq7ig2K3PfMsxLW2GibZKMgpGrnRcqezAOertXZg-_OA9NTPZyN4Dwboc7h1qjwdUdcS_cEKrZDnA1zICVEj-tqZbF55Nq_VG2wFE7RjH904m3XPpiULQxIHEdYyuLCEdJ2VJU3OCY00MFInZ8ZX3BHKoibo5lefan_OUCtiGoB0ZJIV_CZM97lIPXSOVeU4","Scope":"openid profile afcpayroll offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-08-20 11:48:39.059 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-20 11:48:39.060 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-20 11:48:39.061 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-20 11:48:39.061 +03:00 [DBG] Start token request.
2019-08-20 11:48:39.064 +03:00 [DBG] Start client validation
2019-08-20 11:48:39.065 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-20 11:48:39.066 +03:00 [DBG] Start parsing for secret in post body
2019-08-20 11:48:39.066 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-20 11:48:39.067 +03:00 [DBG] Secret id found: mvc
2019-08-20 11:48:39.067 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:39.068 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-20 11:48:39.068 +03:00 [DBG] Client validation success
2019-08-20 11:48:39.069 +03:00 [DBG] Start token request validation
2019-08-20 11:48:39.069 +03:00 [DBG] Start validation of authorization code token request
2019-08-20 11:48:39.070 +03:00 [DBG] Validation of authorization code token request success
2019-08-20 11:48:39.070 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"bea67d70fdf759bca9d86381335740ba16c1fbe28e0624e84851c79dc99505ff","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"mvc","client_secret":"***REDACTED***","code":"bea67d70fdf759bca9d86381335740ba16c1fbe28e0624e84851c79dc99505ff","grant_type":"authorization_code","redirect_uri":"http://localhost:5002/home/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-08-20 11:48:39.078 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:39.079 +03:00 [DBG] Getting claims for access token for client: mvc
2019-08-20 11:48:39.079 +03:00 [DBG] Getting claims for access token for subject: 1
2019-08-20 11:48:39.083 +03:00 [DBG] Creating refresh token
2019-08-20 11:48:39.084 +03:00 [DBG] Setting an absolute lifetime: 2592000
2019-08-20 11:48:39.085 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:39.085 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 11:48:39.086 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 11:48:39.090 +03:00 [DBG] Token request success.
2019-08-20 11:48:39.095 +03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-08-20 11:48:39.096 +03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-08-20 11:48:39.097 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-08-20 11:48:39.098 +03:00 [DBG] Start userinfo request
2019-08-20 11:48:39.098 +03:00 [DBG] Bearer token found in header
2019-08-20 11:48:39.101 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:39.101 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:39.102 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-08-20 11:48:39.102 +03:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1566290919,"exp":1566290979,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","afcpayroll"],"client_id":"mvc","sub":"1","auth_time":1566290868,"idp":"local","name":"alice","email":"alice@email.com","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-08-20 11:48:39.110 +03:00 [DBG] Creating userinfo response
2019-08-20 11:48:39.111 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:48:39.112 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:48:39.112 +03:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 11:48:39.113 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:48:39.114 +03:00 [INF] Profile service returned the following claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 11:48:39.114 +03:00 [DBG] End userinfo request
2019-08-20 11:48:39.163 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-08-20 11:48:39.164 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-08-20 11:48:39.166 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-08-20 11:48:39.166 +03:00 [DBG] Start authorize request
2019-08-20 11:48:39.167 +03:00 [DBG] User in authorize request: 1
2019-08-20 11:48:39.167 +03:00 [DBG] Start authorize request protocol validation
2019-08-20 11:48:39.168 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:39.168 +03:00 [DBG] Checking for PKCE parameters
2019-08-20 11:48:39.169 +03:00 [DBG] No PKCE used.
2019-08-20 11:48:39.169 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-20 11:48:39.170 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/home/signin-oidc","AllowedRedirectUris":["http://localhost:5002/home/signin-oidc"],"SubjectId":"1","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9NXJV_rBTkL_2SX-vcDrm9WHyWtF0cBxBy6aQI0GyJFClnAsCHqs_wYVYjsMZDgOt8WugPuAa5Ijm9_xkE3D8r4gjtAKMaJzArifibxCoLY9e6BeiHNQuSji4Tvtb1vNpEDK_x-y_EXp1vJvpvnPGJQdibCvPyThwu86mckw5Grb8z-9PUQe9UIO1_OSVYChFVIdkVf8Q_FYBl0gdztBIonAPXFImnaOzm43L5qPAWb_UvA9h5wDYfaaBQmGCCeCY7UQpvwEUD-ChxGjIguo-j9YU70NTAqE0R6kdu_y5KqazQyNQzKFrcUeYBRQtEBqVc","UiLocales":null,"Nonce":"637018877191454206.ZGE5YTdiMWItNjlmMi00NTY2LWJmODItYWY5Y2U2MWI0YjNhNWIwMDFiMzktNmIyOC00MGYxLWI4NjYtNzZmNmM0YzU3YzMw","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"e74d8cbe5a0a3326c07e4e0a82ece454","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/home/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637018877191454206.ZGE5YTdiMWItNjlmMi00NTY2LWJmODItYWY5Y2U2MWI0YjNhNWIwMDFiMzktNmIyOC00MGYxLWI4NjYtNzZmNmM0YzU3YzMw","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9NXJV_rBTkL_2SX-vcDrm9WHyWtF0cBxBy6aQI0GyJFClnAsCHqs_wYVYjsMZDgOt8WugPuAa5Ijm9_xkE3D8r4gjtAKMaJzArifibxCoLY9e6BeiHNQuSji4Tvtb1vNpEDK_x-y_EXp1vJvpvnPGJQdibCvPyThwu86mckw5Grb8z-9PUQe9UIO1_OSVYChFVIdkVf8Q_FYBl0gdztBIonAPXFImnaOzm43L5qPAWb_UvA9h5wDYfaaBQmGCCeCY7UQpvwEUD-ChxGjIguo-j9YU70NTAqE0R6kdu_y5KqazQyNQzKFrcUeYBRQtEBqVc","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-20 11:48:39.178 +03:00 [DBG] Client is configured to not require consent, no consent is required
2019-08-20 11:48:39.179 +03:00 [DBG] Creating Hybrid Flow response.
2019-08-20 11:48:39.180 +03:00 [DBG] Creating Implicit Flow response.
2019-08-20 11:48:39.180 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 11:48:39.181 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 11:48:39.185 +03:00 [DBG] Authorize endpoint response
{"SubjectId":"1","ClientId":"mvc","RedirectUri":"http://localhost:5002/home/signin-oidc","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9NXJV_rBTkL_2SX-vcDrm9WHyWtF0cBxBy6aQI0GyJFClnAsCHqs_wYVYjsMZDgOt8WugPuAa5Ijm9_xkE3D8r4gjtAKMaJzArifibxCoLY9e6BeiHNQuSji4Tvtb1vNpEDK_x-y_EXp1vJvpvnPGJQdibCvPyThwu86mckw5Grb8z-9PUQe9UIO1_OSVYChFVIdkVf8Q_FYBl0gdztBIonAPXFImnaOzm43L5qPAWb_UvA9h5wDYfaaBQmGCCeCY7UQpvwEUD-ChxGjIguo-j9YU70NTAqE0R6kdu_y5KqazQyNQzKFrcUeYBRQtEBqVc","Scope":"openid profile afcpayroll offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-08-20 11:48:39.422 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-20 11:48:39.424 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-20 11:48:39.424 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-20 11:48:39.425 +03:00 [DBG] Start token request.
2019-08-20 11:48:39.426 +03:00 [DBG] Start client validation
2019-08-20 11:48:39.428 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-20 11:48:39.429 +03:00 [DBG] Start parsing for secret in post body
2019-08-20 11:48:39.430 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-20 11:48:39.431 +03:00 [DBG] Secret id found: mvc
2019-08-20 11:48:39.432 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:39.433 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-20 11:48:39.433 +03:00 [DBG] Client validation success
2019-08-20 11:48:39.434 +03:00 [DBG] Start token request validation
2019-08-20 11:48:39.434 +03:00 [DBG] Start validation of authorization code token request
2019-08-20 11:48:39.435 +03:00 [DBG] Validation of authorization code token request success
2019-08-20 11:48:39.435 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"126ab900a613d6a9610aeb167d2246b73253e5807a83e7e17e6d8223a276e6cf","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"mvc","client_secret":"***REDACTED***","code":"126ab900a613d6a9610aeb167d2246b73253e5807a83e7e17e6d8223a276e6cf","grant_type":"authorization_code","redirect_uri":"http://localhost:5002/home/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-08-20 11:48:39.445 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:39.445 +03:00 [DBG] Getting claims for access token for client: mvc
2019-08-20 11:48:39.446 +03:00 [DBG] Getting claims for access token for subject: 1
2019-08-20 11:48:39.451 +03:00 [DBG] Creating refresh token
2019-08-20 11:48:39.452 +03:00 [DBG] Setting an absolute lifetime: 2592000
2019-08-20 11:48:39.452 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:39.453 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 11:48:39.454 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 11:48:39.458 +03:00 [DBG] Token request success.
2019-08-20 11:48:39.461 +03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-08-20 11:48:39.462 +03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-08-20 11:48:39.463 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-08-20 11:48:39.463 +03:00 [DBG] Start userinfo request
2019-08-20 11:48:39.464 +03:00 [DBG] Bearer token found in header
2019-08-20 11:48:39.466 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:39.467 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:39.467 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-08-20 11:48:39.468 +03:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1566290919,"exp":1566290979,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","afcpayroll"],"client_id":"mvc","sub":"1","auth_time":1566290868,"idp":"local","name":"alice","email":"alice@email.com","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-08-20 11:48:39.473 +03:00 [DBG] Creating userinfo response
2019-08-20 11:48:39.474 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:48:39.474 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:48:39.475 +03:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 11:48:39.475 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:48:39.476 +03:00 [INF] Profile service returned the following claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 11:48:39.477 +03:00 [DBG] End userinfo request
2019-08-20 11:48:39.525 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-08-20 11:48:39.529 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-08-20 11:48:39.531 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-08-20 11:48:39.532 +03:00 [DBG] Start authorize request
2019-08-20 11:48:39.533 +03:00 [DBG] User in authorize request: 1
2019-08-20 11:48:39.534 +03:00 [DBG] Start authorize request protocol validation
2019-08-20 11:48:39.534 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:39.535 +03:00 [DBG] Checking for PKCE parameters
2019-08-20 11:48:39.535 +03:00 [DBG] No PKCE used.
2019-08-20 11:48:39.536 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-20 11:48:39.536 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/home/signin-oidc","AllowedRedirectUris":["http://localhost:5002/home/signin-oidc"],"SubjectId":"1","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9N-8lZD2eGG6Hv0TlznEfJRWRbouf990LU5kFehsPtYSjuBleFXt-9E96GZ59k60gKS-qGByTdU6JvXYlrCtwWzXiQgVbDA_iQgN-aWO2ntF3BXLzeEB-iQzDf_3cLorAa51cAjxApwwMUy-z-L2Qx4EG097EoGygsBCQiavqNtHaCslUUCJdjj1cdvZCEsxyjbtkZJnQtFqL3HzE_WHMSlC4C2XyJXEBnERI9gosdCcV6dG6L_Ygp7O_tPgH55L9oRkwyHgewFEW_9YQJKjcRPWZV95q0IrcCZgT1_pF_tfAZRdFI_gIegeE95XTtD9vI","UiLocales":null,"Nonce":"637018877195069269.MTAzNDI0OTItZWYzOC00Mzg1LTgwMTgtODI4YTg0NTcyMmZmZGU0OGQzNWUtMzJjNC00MmEyLThlOTQtYjBhMjNhY2FkYzgy","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"e74d8cbe5a0a3326c07e4e0a82ece454","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/home/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637018877195069269.MTAzNDI0OTItZWYzOC00Mzg1LTgwMTgtODI4YTg0NTcyMmZmZGU0OGQzNWUtMzJjNC00MmEyLThlOTQtYjBhMjNhY2FkYzgy","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9N-8lZD2eGG6Hv0TlznEfJRWRbouf990LU5kFehsPtYSjuBleFXt-9E96GZ59k60gKS-qGByTdU6JvXYlrCtwWzXiQgVbDA_iQgN-aWO2ntF3BXLzeEB-iQzDf_3cLorAa51cAjxApwwMUy-z-L2Qx4EG097EoGygsBCQiavqNtHaCslUUCJdjj1cdvZCEsxyjbtkZJnQtFqL3HzE_WHMSlC4C2XyJXEBnERI9gosdCcV6dG6L_Ygp7O_tPgH55L9oRkwyHgewFEW_9YQJKjcRPWZV95q0IrcCZgT1_pF_tfAZRdFI_gIegeE95XTtD9vI","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-20 11:48:39.542 +03:00 [DBG] Client is configured to not require consent, no consent is required
2019-08-20 11:48:39.542 +03:00 [DBG] Creating Hybrid Flow response.
2019-08-20 11:48:39.543 +03:00 [DBG] Creating Implicit Flow response.
2019-08-20 11:48:39.544 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 11:48:39.544 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 11:48:39.549 +03:00 [DBG] Authorize endpoint response
{"SubjectId":"1","ClientId":"mvc","RedirectUri":"http://localhost:5002/home/signin-oidc","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9N-8lZD2eGG6Hv0TlznEfJRWRbouf990LU5kFehsPtYSjuBleFXt-9E96GZ59k60gKS-qGByTdU6JvXYlrCtwWzXiQgVbDA_iQgN-aWO2ntF3BXLzeEB-iQzDf_3cLorAa51cAjxApwwMUy-z-L2Qx4EG097EoGygsBCQiavqNtHaCslUUCJdjj1cdvZCEsxyjbtkZJnQtFqL3HzE_WHMSlC4C2XyJXEBnERI9gosdCcV6dG6L_Ygp7O_tPgH55L9oRkwyHgewFEW_9YQJKjcRPWZV95q0IrcCZgT1_pF_tfAZRdFI_gIegeE95XTtD9vI","Scope":"openid profile afcpayroll offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-08-20 11:48:39.727 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-20 11:48:39.728 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-20 11:48:39.729 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-20 11:48:39.729 +03:00 [DBG] Start token request.
2019-08-20 11:48:39.730 +03:00 [DBG] Start client validation
2019-08-20 11:48:39.731 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-20 11:48:39.732 +03:00 [DBG] Start parsing for secret in post body
2019-08-20 11:48:39.732 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-20 11:48:39.732 +03:00 [DBG] Secret id found: mvc
2019-08-20 11:48:39.733 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:39.734 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-20 11:48:39.735 +03:00 [DBG] Client validation success
2019-08-20 11:48:39.735 +03:00 [DBG] Start token request validation
2019-08-20 11:48:39.736 +03:00 [DBG] Start validation of authorization code token request
2019-08-20 11:48:39.736 +03:00 [DBG] Validation of authorization code token request success
2019-08-20 11:48:39.737 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"f6bf36f06df7606d8aa33aa300cc47689fe5fef8b3586b7d9bb4404925cbdb60","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"mvc","client_secret":"***REDACTED***","code":"f6bf36f06df7606d8aa33aa300cc47689fe5fef8b3586b7d9bb4404925cbdb60","grant_type":"authorization_code","redirect_uri":"http://localhost:5002/home/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-08-20 11:48:39.740 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:39.740 +03:00 [DBG] Getting claims for access token for client: mvc
2019-08-20 11:48:39.741 +03:00 [DBG] Getting claims for access token for subject: 1
2019-08-20 11:48:39.745 +03:00 [DBG] Creating refresh token
2019-08-20 11:48:39.746 +03:00 [DBG] Setting an absolute lifetime: 2592000
2019-08-20 11:48:39.747 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:39.748 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 11:48:39.749 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 11:48:39.753 +03:00 [DBG] Token request success.
2019-08-20 11:48:39.755 +03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-08-20 11:48:39.756 +03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-08-20 11:48:39.756 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-08-20 11:48:39.757 +03:00 [DBG] Start userinfo request
2019-08-20 11:48:39.757 +03:00 [DBG] Bearer token found in header
2019-08-20 11:48:39.760 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:39.761 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:39.761 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-08-20 11:48:39.762 +03:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1566290919,"exp":1566290979,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","afcpayroll"],"client_id":"mvc","sub":"1","auth_time":1566290868,"idp":"local","name":"alice","email":"alice@email.com","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-08-20 11:48:39.766 +03:00 [DBG] Creating userinfo response
2019-08-20 11:48:39.766 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:48:39.767 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:48:39.767 +03:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 11:48:39.768 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:48:39.769 +03:00 [INF] Profile service returned the following claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 11:48:39.770 +03:00 [DBG] End userinfo request
2019-08-20 11:48:39.812 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-08-20 11:48:39.815 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-08-20 11:48:39.815 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-08-20 11:48:39.816 +03:00 [DBG] Start authorize request
2019-08-20 11:48:39.816 +03:00 [DBG] User in authorize request: 1
2019-08-20 11:48:39.817 +03:00 [DBG] Start authorize request protocol validation
2019-08-20 11:48:39.817 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:39.818 +03:00 [DBG] Checking for PKCE parameters
2019-08-20 11:48:39.818 +03:00 [DBG] No PKCE used.
2019-08-20 11:48:39.819 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-20 11:48:39.819 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/home/signin-oidc","AllowedRedirectUris":["http://localhost:5002/home/signin-oidc"],"SubjectId":"1","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9PbRrsay-xFHHkYlAHtkFY6PXXL2J5L5GvOiqbcZgJ-JL3pSHWLQ_qQsmRaNcPVMiteHfrLlZo2EofbqUl6f36hmVhw0RltYpWwK8fjqHzvMcdPjacvYLyTTrFlIzliJ6YM3Wh77q-ylcYL97nL5UVl5PnfIUZ70I9QPW0YU3YU5Jx_mJUtepA8wCKTPu327rx2cTGYk-VczeWu9wTIDuR9VrjgGbi8HJV1srQEXQ8aaGTmsPjjmsvQaeHZ2oMwii1muWdrzThSoO5HgzwIK7-HQZob5yOg9ybbhYUSRbNtYhJpIOP60eu8JLD6S9ANf20","UiLocales":null,"Nonce":"637018877197969776.MmU0MWZhMmMtOTc2Ni00NDM0LWIyODYtNzNhZDcyZWI1YjUzMTI0MzBkNDctZDdiNC00NGEwLWE0ZGQtYWFkZWNhNWU4Mzhj","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"e74d8cbe5a0a3326c07e4e0a82ece454","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/home/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637018877197969776.MmU0MWZhMmMtOTc2Ni00NDM0LWIyODYtNzNhZDcyZWI1YjUzMTI0MzBkNDctZDdiNC00NGEwLWE0ZGQtYWFkZWNhNWU4Mzhj","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9PbRrsay-xFHHkYlAHtkFY6PXXL2J5L5GvOiqbcZgJ-JL3pSHWLQ_qQsmRaNcPVMiteHfrLlZo2EofbqUl6f36hmVhw0RltYpWwK8fjqHzvMcdPjacvYLyTTrFlIzliJ6YM3Wh77q-ylcYL97nL5UVl5PnfIUZ70I9QPW0YU3YU5Jx_mJUtepA8wCKTPu327rx2cTGYk-VczeWu9wTIDuR9VrjgGbi8HJV1srQEXQ8aaGTmsPjjmsvQaeHZ2oMwii1muWdrzThSoO5HgzwIK7-HQZob5yOg9ybbhYUSRbNtYhJpIOP60eu8JLD6S9ANf20","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-20 11:48:39.824 +03:00 [DBG] Client is configured to not require consent, no consent is required
2019-08-20 11:48:39.825 +03:00 [DBG] Creating Hybrid Flow response.
2019-08-20 11:48:39.825 +03:00 [DBG] Creating Implicit Flow response.
2019-08-20 11:48:39.826 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 11:48:39.827 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 11:48:39.831 +03:00 [DBG] Authorize endpoint response
{"SubjectId":"1","ClientId":"mvc","RedirectUri":"http://localhost:5002/home/signin-oidc","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9PbRrsay-xFHHkYlAHtkFY6PXXL2J5L5GvOiqbcZgJ-JL3pSHWLQ_qQsmRaNcPVMiteHfrLlZo2EofbqUl6f36hmVhw0RltYpWwK8fjqHzvMcdPjacvYLyTTrFlIzliJ6YM3Wh77q-ylcYL97nL5UVl5PnfIUZ70I9QPW0YU3YU5Jx_mJUtepA8wCKTPu327rx2cTGYk-VczeWu9wTIDuR9VrjgGbi8HJV1srQEXQ8aaGTmsPjjmsvQaeHZ2oMwii1muWdrzThSoO5HgzwIK7-HQZob5yOg9ybbhYUSRbNtYhJpIOP60eu8JLD6S9ANf20","Scope":"openid profile afcpayroll offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-08-20 11:48:40.040 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-20 11:48:40.042 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-20 11:48:40.046 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-20 11:48:40.048 +03:00 [DBG] Start token request.
2019-08-20 11:48:40.048 +03:00 [DBG] Start client validation
2019-08-20 11:48:40.049 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-20 11:48:40.049 +03:00 [DBG] Start parsing for secret in post body
2019-08-20 11:48:40.050 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-20 11:48:40.051 +03:00 [DBG] Secret id found: mvc
2019-08-20 11:48:40.051 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:40.052 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-20 11:48:40.052 +03:00 [DBG] Client validation success
2019-08-20 11:48:40.052 +03:00 [DBG] Start token request validation
2019-08-20 11:48:40.053 +03:00 [DBG] Start validation of authorization code token request
2019-08-20 11:48:40.054 +03:00 [DBG] Validation of authorization code token request success
2019-08-20 11:48:40.055 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"8721ec90139ec502f7e639acb4bbe31530c8980e569afb0f08b818f0d69d8f32","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"mvc","client_secret":"***REDACTED***","code":"8721ec90139ec502f7e639acb4bbe31530c8980e569afb0f08b818f0d69d8f32","grant_type":"authorization_code","redirect_uri":"http://localhost:5002/home/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-08-20 11:48:40.064 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:40.065 +03:00 [DBG] Getting claims for access token for client: mvc
2019-08-20 11:48:40.066 +03:00 [DBG] Getting claims for access token for subject: 1
2019-08-20 11:48:40.070 +03:00 [DBG] Creating refresh token
2019-08-20 11:48:40.070 +03:00 [DBG] Setting an absolute lifetime: 2592000
2019-08-20 11:48:40.071 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:40.071 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 11:48:40.072 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 11:48:40.078 +03:00 [DBG] Token request success.
2019-08-20 11:48:40.081 +03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-08-20 11:48:40.082 +03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-08-20 11:48:40.083 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-08-20 11:48:40.083 +03:00 [DBG] Start userinfo request
2019-08-20 11:48:40.083 +03:00 [DBG] Bearer token found in header
2019-08-20 11:48:40.086 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:40.087 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:40.087 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-08-20 11:48:40.088 +03:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1566290920,"exp":1566290980,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","afcpayroll"],"client_id":"mvc","sub":"1","auth_time":1566290868,"idp":"local","name":"alice","email":"alice@email.com","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-08-20 11:48:40.092 +03:00 [DBG] Creating userinfo response
2019-08-20 11:48:40.093 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:48:40.093 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:48:40.094 +03:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 11:48:40.095 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:48:40.096 +03:00 [INF] Profile service returned the following claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 11:48:40.097 +03:00 [DBG] End userinfo request
2019-08-20 11:48:40.145 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-08-20 11:48:40.146 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-08-20 11:48:40.147 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-08-20 11:48:40.148 +03:00 [DBG] Start authorize request
2019-08-20 11:48:40.148 +03:00 [DBG] User in authorize request: 1
2019-08-20 11:48:40.148 +03:00 [DBG] Start authorize request protocol validation
2019-08-20 11:48:40.149 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:40.151 +03:00 [DBG] Checking for PKCE parameters
2019-08-20 11:48:40.153 +03:00 [DBG] No PKCE used.
2019-08-20 11:48:40.153 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-20 11:48:40.154 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/home/signin-oidc","AllowedRedirectUris":["http://localhost:5002/home/signin-oidc"],"SubjectId":"1","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9NPfel-Lxp5nto-tQ_mqM_ivFIeGPZrU11YRQq93M0kA2qXa5W8BBxOlRYWd1bG1BO7JF-M4BpnfX6m4ZRp6H-ZindNzxA9cwnJmk7i35lw61ATCsu8_cYS_Tlrhirq2SP_e3L6qZehE2HVLfxP7wF2FAesKeHbm53pT89tf6sM1PjarDFBwJMMu2FeUZdzInECibCwC2x8YxRuWZOqEUjd_yUEjdmmDPEnGbNtG8mH26JwBSX40CbJtMftof_ikMwttKIKoQG-YD5EZj-IRYYSk2q4wZuARhNeziojwPXK3vcGndZF2SLOaRBG6cEetD4","UiLocales":null,"Nonce":"637018877201287925.ZmY3Njg2NWMtOWY5NC00MDUyLTllM2ItM2RhZmRlMTI1MmQxODUxNjNhYzQtOGI3NC00YThiLWExYzctMDVjNWZmMmY2ZmFk","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"e74d8cbe5a0a3326c07e4e0a82ece454","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/home/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637018877201287925.ZmY3Njg2NWMtOWY5NC00MDUyLTllM2ItM2RhZmRlMTI1MmQxODUxNjNhYzQtOGI3NC00YThiLWExYzctMDVjNWZmMmY2ZmFk","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9NPfel-Lxp5nto-tQ_mqM_ivFIeGPZrU11YRQq93M0kA2qXa5W8BBxOlRYWd1bG1BO7JF-M4BpnfX6m4ZRp6H-ZindNzxA9cwnJmk7i35lw61ATCsu8_cYS_Tlrhirq2SP_e3L6qZehE2HVLfxP7wF2FAesKeHbm53pT89tf6sM1PjarDFBwJMMu2FeUZdzInECibCwC2x8YxRuWZOqEUjd_yUEjdmmDPEnGbNtG8mH26JwBSX40CbJtMftof_ikMwttKIKoQG-YD5EZj-IRYYSk2q4wZuARhNeziojwPXK3vcGndZF2SLOaRBG6cEetD4","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-20 11:48:40.160 +03:00 [DBG] Client is configured to not require consent, no consent is required
2019-08-20 11:48:40.161 +03:00 [DBG] Creating Hybrid Flow response.
2019-08-20 11:48:40.161 +03:00 [DBG] Creating Implicit Flow response.
2019-08-20 11:48:40.162 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 11:48:40.163 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 11:48:40.168 +03:00 [DBG] Authorize endpoint response
{"SubjectId":"1","ClientId":"mvc","RedirectUri":"http://localhost:5002/home/signin-oidc","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9NPfel-Lxp5nto-tQ_mqM_ivFIeGPZrU11YRQq93M0kA2qXa5W8BBxOlRYWd1bG1BO7JF-M4BpnfX6m4ZRp6H-ZindNzxA9cwnJmk7i35lw61ATCsu8_cYS_Tlrhirq2SP_e3L6qZehE2HVLfxP7wF2FAesKeHbm53pT89tf6sM1PjarDFBwJMMu2FeUZdzInECibCwC2x8YxRuWZOqEUjd_yUEjdmmDPEnGbNtG8mH26JwBSX40CbJtMftof_ikMwttKIKoQG-YD5EZj-IRYYSk2q4wZuARhNeziojwPXK3vcGndZF2SLOaRBG6cEetD4","Scope":"openid profile afcpayroll offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-08-20 11:48:40.358 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-20 11:48:40.359 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-20 11:48:40.359 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-20 11:48:40.360 +03:00 [DBG] Start token request.
2019-08-20 11:48:40.360 +03:00 [DBG] Start client validation
2019-08-20 11:48:40.361 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-20 11:48:40.361 +03:00 [DBG] Start parsing for secret in post body
2019-08-20 11:48:40.362 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-20 11:48:40.363 +03:00 [DBG] Secret id found: mvc
2019-08-20 11:48:40.363 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:40.365 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-20 11:48:40.365 +03:00 [DBG] Client validation success
2019-08-20 11:48:40.366 +03:00 [DBG] Start token request validation
2019-08-20 11:48:40.366 +03:00 [DBG] Start validation of authorization code token request
2019-08-20 11:48:40.367 +03:00 [DBG] Validation of authorization code token request success
2019-08-20 11:48:40.367 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"7c5c85a40998bc3bb4cc83c248145fe882d5fd6162eafd3adebc3e2e2cdb2d68","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"mvc","client_secret":"***REDACTED***","code":"7c5c85a40998bc3bb4cc83c248145fe882d5fd6162eafd3adebc3e2e2cdb2d68","grant_type":"authorization_code","redirect_uri":"http://localhost:5002/home/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-08-20 11:48:40.372 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:40.372 +03:00 [DBG] Getting claims for access token for client: mvc
2019-08-20 11:48:40.373 +03:00 [DBG] Getting claims for access token for subject: 1
2019-08-20 11:48:40.377 +03:00 [DBG] Creating refresh token
2019-08-20 11:48:40.378 +03:00 [DBG] Setting an absolute lifetime: 2592000
2019-08-20 11:48:40.378 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:40.379 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 11:48:40.380 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 11:48:40.384 +03:00 [DBG] Token request success.
2019-08-20 11:48:40.386 +03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-08-20 11:48:40.387 +03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-08-20 11:48:40.388 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-08-20 11:48:40.388 +03:00 [DBG] Start userinfo request
2019-08-20 11:48:40.389 +03:00 [DBG] Bearer token found in header
2019-08-20 11:48:40.392 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:40.392 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:40.393 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-08-20 11:48:40.393 +03:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1566290920,"exp":1566290980,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","afcpayroll"],"client_id":"mvc","sub":"1","auth_time":1566290868,"idp":"local","name":"alice","email":"alice@email.com","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-08-20 11:48:40.398 +03:00 [DBG] Creating userinfo response
2019-08-20 11:48:40.399 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:48:40.399 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:48:40.400 +03:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 11:48:40.400 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:48:40.401 +03:00 [INF] Profile service returned the following claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 11:48:40.401 +03:00 [DBG] End userinfo request
2019-08-20 11:48:40.447 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-08-20 11:48:40.448 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-08-20 11:48:40.449 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-08-20 11:48:40.450 +03:00 [DBG] Start authorize request
2019-08-20 11:48:40.450 +03:00 [DBG] User in authorize request: 1
2019-08-20 11:48:40.450 +03:00 [DBG] Start authorize request protocol validation
2019-08-20 11:48:40.451 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:40.451 +03:00 [DBG] Checking for PKCE parameters
2019-08-20 11:48:40.452 +03:00 [DBG] No PKCE used.
2019-08-20 11:48:40.453 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-20 11:48:40.454 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/home/signin-oidc","AllowedRedirectUris":["http://localhost:5002/home/signin-oidc"],"SubjectId":"1","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9PrPQMzZmyK2ZMNZSTuT-lYcmEsgxOKgJUoL5m42KR2ohb--ktoEeox4_ZP6m9gCSMJGnAbSJSm1L2cjQQFGLWDmmO4WzClBUORkiDi9OW6UvFNW_0qse3tNicg-8FryLgVOWhuPMoskhxCXf88dQDf2Yo8vKMOJpJbDiSIhtEWHrHEz0lsDkx-l7XR7J4Hg6y5RlEitJ1ds5xf1yEQsuOUrXOYlUhVYisFVt-SDNtVvjeKNRfUFSHhu00RnzMX6OIs6IIzDZ1wwTRab5N7KhKnue7MP6IvG4VfbR3skl_EtjCyURU-QtLQQ24hu88tvM4","UiLocales":null,"Nonce":"637018877204300838.ODk1Y2M1MjktYWE3OS00YmNkLTk4OWUtYzc0NWExZGMxODc1ODU0ZTU1M2ItMjQ1NS00ZjViLTk4YzAtZWY1NzM1MDBhYTg5","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"e74d8cbe5a0a3326c07e4e0a82ece454","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/home/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637018877204300838.ODk1Y2M1MjktYWE3OS00YmNkLTk4OWUtYzc0NWExZGMxODc1ODU0ZTU1M2ItMjQ1NS00ZjViLTk4YzAtZWY1NzM1MDBhYTg5","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9PrPQMzZmyK2ZMNZSTuT-lYcmEsgxOKgJUoL5m42KR2ohb--ktoEeox4_ZP6m9gCSMJGnAbSJSm1L2cjQQFGLWDmmO4WzClBUORkiDi9OW6UvFNW_0qse3tNicg-8FryLgVOWhuPMoskhxCXf88dQDf2Yo8vKMOJpJbDiSIhtEWHrHEz0lsDkx-l7XR7J4Hg6y5RlEitJ1ds5xf1yEQsuOUrXOYlUhVYisFVt-SDNtVvjeKNRfUFSHhu00RnzMX6OIs6IIzDZ1wwTRab5N7KhKnue7MP6IvG4VfbR3skl_EtjCyURU-QtLQQ24hu88tvM4","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-20 11:48:40.460 +03:00 [DBG] Client is configured to not require consent, no consent is required
2019-08-20 11:48:40.461 +03:00 [DBG] Creating Hybrid Flow response.
2019-08-20 11:48:40.461 +03:00 [DBG] Creating Implicit Flow response.
2019-08-20 11:48:40.462 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 11:48:40.463 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 11:48:40.468 +03:00 [DBG] Authorize endpoint response
{"SubjectId":"1","ClientId":"mvc","RedirectUri":"http://localhost:5002/home/signin-oidc","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9PrPQMzZmyK2ZMNZSTuT-lYcmEsgxOKgJUoL5m42KR2ohb--ktoEeox4_ZP6m9gCSMJGnAbSJSm1L2cjQQFGLWDmmO4WzClBUORkiDi9OW6UvFNW_0qse3tNicg-8FryLgVOWhuPMoskhxCXf88dQDf2Yo8vKMOJpJbDiSIhtEWHrHEz0lsDkx-l7XR7J4Hg6y5RlEitJ1ds5xf1yEQsuOUrXOYlUhVYisFVt-SDNtVvjeKNRfUFSHhu00RnzMX6OIs6IIzDZ1wwTRab5N7KhKnue7MP6IvG4VfbR3skl_EtjCyURU-QtLQQ24hu88tvM4","Scope":"openid profile afcpayroll offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-08-20 11:48:40.657 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-20 11:48:40.658 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-20 11:48:40.658 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-20 11:48:40.659 +03:00 [DBG] Start token request.
2019-08-20 11:48:40.659 +03:00 [DBG] Start client validation
2019-08-20 11:48:40.661 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-20 11:48:40.662 +03:00 [DBG] Start parsing for secret in post body
2019-08-20 11:48:40.663 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-20 11:48:40.663 +03:00 [DBG] Secret id found: mvc
2019-08-20 11:48:40.664 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:40.664 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-20 11:48:40.665 +03:00 [DBG] Client validation success
2019-08-20 11:48:40.665 +03:00 [DBG] Start token request validation
2019-08-20 11:48:40.667 +03:00 [DBG] Start validation of authorization code token request
2019-08-20 11:48:40.668 +03:00 [DBG] Validation of authorization code token request success
2019-08-20 11:48:40.668 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"d211732b14b64468547bfe84a25ad9ea2f4c6744ee62ae093be5a39cded98563","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"mvc","client_secret":"***REDACTED***","code":"d211732b14b64468547bfe84a25ad9ea2f4c6744ee62ae093be5a39cded98563","grant_type":"authorization_code","redirect_uri":"http://localhost:5002/home/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-08-20 11:48:40.671 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:40.672 +03:00 [DBG] Getting claims for access token for client: mvc
2019-08-20 11:48:40.674 +03:00 [DBG] Getting claims for access token for subject: 1
2019-08-20 11:48:40.678 +03:00 [DBG] Creating refresh token
2019-08-20 11:48:40.679 +03:00 [DBG] Setting an absolute lifetime: 2592000
2019-08-20 11:48:40.680 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:40.680 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 11:48:40.681 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 11:48:40.685 +03:00 [DBG] Token request success.
2019-08-20 11:48:40.689 +03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-08-20 11:48:40.690 +03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-08-20 11:48:40.691 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-08-20 11:48:40.692 +03:00 [DBG] Start userinfo request
2019-08-20 11:48:40.692 +03:00 [DBG] Bearer token found in header
2019-08-20 11:48:40.696 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:40.696 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:40.697 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-08-20 11:48:40.699 +03:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1566290920,"exp":1566290980,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","afcpayroll"],"client_id":"mvc","sub":"1","auth_time":1566290868,"idp":"local","name":"alice","email":"alice@email.com","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-08-20 11:48:40.704 +03:00 [DBG] Creating userinfo response
2019-08-20 11:48:40.705 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:48:40.706 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:48:40.706 +03:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 11:48:40.707 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:48:40.707 +03:00 [INF] Profile service returned the following claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 11:48:40.708 +03:00 [DBG] End userinfo request
2019-08-20 11:48:40.759 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-08-20 11:48:40.760 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-08-20 11:48:40.760 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-08-20 11:48:40.761 +03:00 [DBG] Start authorize request
2019-08-20 11:48:40.762 +03:00 [DBG] User in authorize request: 1
2019-08-20 11:48:40.763 +03:00 [DBG] Start authorize request protocol validation
2019-08-20 11:48:40.764 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:40.765 +03:00 [DBG] Checking for PKCE parameters
2019-08-20 11:48:40.765 +03:00 [DBG] No PKCE used.
2019-08-20 11:48:40.766 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-20 11:48:40.766 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/home/signin-oidc","AllowedRedirectUris":["http://localhost:5002/home/signin-oidc"],"SubjectId":"1","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9Pips6YzGqyYkQ3caO4P5dY4rrWYvGC_VyuOzQBYUGRoEMXg7fv8g5Yzl5fbFsURHv5bV58nkOaxO8Wsr9-IcW9MXNftzhRPCEdkN8gGzhgx7gWO_FdXye68v63F3EAcrJ1cjNsr43rAl-yhRToUAJCtGQegPhhB9BNoBym8Zy7PMw4KzxAqN6OO8YQsEHQpHDyKY85gkmt629ZmhpyHmnJXN6AvBo4ePc2_DD2i1uRUHJoq3VFADnCEbOImUZeJZtwI3Zjuoj8xGgvPwbOkOVQ6fjVj50Ztixg7-i5TXtg2KHXXMZ-toOKRipurkdW7WQ","UiLocales":null,"Nonce":"637018877207416576.ZWI1MDRiZGQtMjNmMi00NDI5LWE2NjAtODNiODA5MmNmZGZkMGFhZjFkNDMtNWI5OC00NDFmLWFlZDUtZTM2MDAzNTY0NmJi","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"e74d8cbe5a0a3326c07e4e0a82ece454","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/home/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637018877207416576.ZWI1MDRiZGQtMjNmMi00NDI5LWE2NjAtODNiODA5MmNmZGZkMGFhZjFkNDMtNWI5OC00NDFmLWFlZDUtZTM2MDAzNTY0NmJi","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9Pips6YzGqyYkQ3caO4P5dY4rrWYvGC_VyuOzQBYUGRoEMXg7fv8g5Yzl5fbFsURHv5bV58nkOaxO8Wsr9-IcW9MXNftzhRPCEdkN8gGzhgx7gWO_FdXye68v63F3EAcrJ1cjNsr43rAl-yhRToUAJCtGQegPhhB9BNoBym8Zy7PMw4KzxAqN6OO8YQsEHQpHDyKY85gkmt629ZmhpyHmnJXN6AvBo4ePc2_DD2i1uRUHJoq3VFADnCEbOImUZeJZtwI3Zjuoj8xGgvPwbOkOVQ6fjVj50Ztixg7-i5TXtg2KHXXMZ-toOKRipurkdW7WQ","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-20 11:48:40.771 +03:00 [DBG] Client is configured to not require consent, no consent is required
2019-08-20 11:48:40.772 +03:00 [DBG] Creating Hybrid Flow response.
2019-08-20 11:48:40.772 +03:00 [DBG] Creating Implicit Flow response.
2019-08-20 11:48:40.773 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 11:48:40.773 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 11:48:40.778 +03:00 [DBG] Authorize endpoint response
{"SubjectId":"1","ClientId":"mvc","RedirectUri":"http://localhost:5002/home/signin-oidc","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9Pips6YzGqyYkQ3caO4P5dY4rrWYvGC_VyuOzQBYUGRoEMXg7fv8g5Yzl5fbFsURHv5bV58nkOaxO8Wsr9-IcW9MXNftzhRPCEdkN8gGzhgx7gWO_FdXye68v63F3EAcrJ1cjNsr43rAl-yhRToUAJCtGQegPhhB9BNoBym8Zy7PMw4KzxAqN6OO8YQsEHQpHDyKY85gkmt629ZmhpyHmnJXN6AvBo4ePc2_DD2i1uRUHJoq3VFADnCEbOImUZeJZtwI3Zjuoj8xGgvPwbOkOVQ6fjVj50Ztixg7-i5TXtg2KHXXMZ-toOKRipurkdW7WQ","Scope":"openid profile afcpayroll offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-08-20 11:48:40.986 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-20 11:48:40.987 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-20 11:48:40.988 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-20 11:48:40.988 +03:00 [DBG] Start token request.
2019-08-20 11:48:40.989 +03:00 [DBG] Start client validation
2019-08-20 11:48:40.989 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-20 11:48:40.989 +03:00 [DBG] Start parsing for secret in post body
2019-08-20 11:48:40.990 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-20 11:48:40.990 +03:00 [DBG] Secret id found: mvc
2019-08-20 11:48:40.991 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:40.991 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-20 11:48:40.992 +03:00 [DBG] Client validation success
2019-08-20 11:48:40.993 +03:00 [DBG] Start token request validation
2019-08-20 11:48:40.993 +03:00 [DBG] Start validation of authorization code token request
2019-08-20 11:48:40.994 +03:00 [DBG] Validation of authorization code token request success
2019-08-20 11:48:40.995 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"f492bcd8cc309390b6464f9336d31854b411cbdefc4d38086c824890ec5ace72","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"mvc","client_secret":"***REDACTED***","code":"f492bcd8cc309390b6464f9336d31854b411cbdefc4d38086c824890ec5ace72","grant_type":"authorization_code","redirect_uri":"http://localhost:5002/home/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-08-20 11:48:40.998 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:40.998 +03:00 [DBG] Getting claims for access token for client: mvc
2019-08-20 11:48:40.999 +03:00 [DBG] Getting claims for access token for subject: 1
2019-08-20 11:48:41.003 +03:00 [DBG] Creating refresh token
2019-08-20 11:48:41.004 +03:00 [DBG] Setting an absolute lifetime: 2592000
2019-08-20 11:48:41.005 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:41.005 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 11:48:41.006 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 11:48:41.011 +03:00 [DBG] Token request success.
2019-08-20 11:48:41.014 +03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-08-20 11:48:41.015 +03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-08-20 11:48:41.015 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-08-20 11:48:41.017 +03:00 [DBG] Start userinfo request
2019-08-20 11:48:41.017 +03:00 [DBG] Bearer token found in header
2019-08-20 11:48:41.020 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:41.021 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:41.021 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-08-20 11:48:41.022 +03:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1566290920,"exp":1566290980,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","afcpayroll"],"client_id":"mvc","sub":"1","auth_time":1566290868,"idp":"local","name":"alice","email":"alice@email.com","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-08-20 11:48:41.027 +03:00 [DBG] Creating userinfo response
2019-08-20 11:48:41.027 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:48:41.028 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:48:41.029 +03:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 11:48:41.029 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:48:41.030 +03:00 [INF] Profile service returned the following claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 11:48:41.030 +03:00 [DBG] End userinfo request
2019-08-20 11:48:41.072 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-08-20 11:48:41.074 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-08-20 11:48:41.075 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-08-20 11:48:41.075 +03:00 [DBG] Start authorize request
2019-08-20 11:48:41.076 +03:00 [DBG] User in authorize request: 1
2019-08-20 11:48:41.076 +03:00 [DBG] Start authorize request protocol validation
2019-08-20 11:48:41.077 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:41.077 +03:00 [DBG] Checking for PKCE parameters
2019-08-20 11:48:41.078 +03:00 [DBG] No PKCE used.
2019-08-20 11:48:41.078 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-20 11:48:41.079 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/home/signin-oidc","AllowedRedirectUris":["http://localhost:5002/home/signin-oidc"],"SubjectId":"1","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9Nv0c7jXib7aOYnQQv5aQbhJw1gx7DgcDDZm6iojeXdaQ1fHc1WqIWtlUEJFf_3chMyoVQ_4lHxB-VPGqSjxeI1OS8DMIz_8RabxNzHoqkNQIk7qLbWLQTG36Aa4VvyKUQgNCjmba99zRYEkeA1yNlK3lYgKgjSlasngFGcwkw56dO6RV_Kplr5oPkr_TbBgnRE_B4Ylu83VgfxY6W8mL6gQqIP3EpQ6p2nWpsGduWS9_HewoJ8CsHk4N9ht6FLde06ldtacLHY0bepyfYkRSa-HGt_X1lj_tjzw_7u4dR2hd2upjOf36OTyUwEDUk34_w","UiLocales":null,"Nonce":"637018877210559925.ODg3MDMwZTgtZjhjNy00MjU4LTk5ZDctYmQ1YjgzNjRhODQ1OWIwNDM4MmUtYTg2Yy00NjEwLTkyMDAtOWY5Y2RjZDNjMWEy","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"e74d8cbe5a0a3326c07e4e0a82ece454","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/home/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637018877210559925.ODg3MDMwZTgtZjhjNy00MjU4LTk5ZDctYmQ1YjgzNjRhODQ1OWIwNDM4MmUtYTg2Yy00NjEwLTkyMDAtOWY5Y2RjZDNjMWEy","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9Nv0c7jXib7aOYnQQv5aQbhJw1gx7DgcDDZm6iojeXdaQ1fHc1WqIWtlUEJFf_3chMyoVQ_4lHxB-VPGqSjxeI1OS8DMIz_8RabxNzHoqkNQIk7qLbWLQTG36Aa4VvyKUQgNCjmba99zRYEkeA1yNlK3lYgKgjSlasngFGcwkw56dO6RV_Kplr5oPkr_TbBgnRE_B4Ylu83VgfxY6W8mL6gQqIP3EpQ6p2nWpsGduWS9_HewoJ8CsHk4N9ht6FLde06ldtacLHY0bepyfYkRSa-HGt_X1lj_tjzw_7u4dR2hd2upjOf36OTyUwEDUk34_w","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-20 11:48:41.084 +03:00 [DBG] Client is configured to not require consent, no consent is required
2019-08-20 11:48:41.084 +03:00 [DBG] Creating Hybrid Flow response.
2019-08-20 11:48:41.085 +03:00 [DBG] Creating Implicit Flow response.
2019-08-20 11:48:41.085 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 11:48:41.086 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 11:48:41.090 +03:00 [DBG] Authorize endpoint response
{"SubjectId":"1","ClientId":"mvc","RedirectUri":"http://localhost:5002/home/signin-oidc","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9Nv0c7jXib7aOYnQQv5aQbhJw1gx7DgcDDZm6iojeXdaQ1fHc1WqIWtlUEJFf_3chMyoVQ_4lHxB-VPGqSjxeI1OS8DMIz_8RabxNzHoqkNQIk7qLbWLQTG36Aa4VvyKUQgNCjmba99zRYEkeA1yNlK3lYgKgjSlasngFGcwkw56dO6RV_Kplr5oPkr_TbBgnRE_B4Ylu83VgfxY6W8mL6gQqIP3EpQ6p2nWpsGduWS9_HewoJ8CsHk4N9ht6FLde06ldtacLHY0bepyfYkRSa-HGt_X1lj_tjzw_7u4dR2hd2upjOf36OTyUwEDUk34_w","Scope":"openid profile afcpayroll offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-08-20 11:48:41.301 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-20 11:48:41.303 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-20 11:48:41.304 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-20 11:48:41.304 +03:00 [DBG] Start token request.
2019-08-20 11:48:41.305 +03:00 [DBG] Start client validation
2019-08-20 11:48:41.306 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-20 11:48:41.307 +03:00 [DBG] Start parsing for secret in post body
2019-08-20 11:48:41.307 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-20 11:48:41.308 +03:00 [DBG] Secret id found: mvc
2019-08-20 11:48:41.309 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:41.312 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-20 11:48:41.313 +03:00 [DBG] Client validation success
2019-08-20 11:48:41.314 +03:00 [DBG] Start token request validation
2019-08-20 11:48:41.314 +03:00 [DBG] Start validation of authorization code token request
2019-08-20 11:48:41.315 +03:00 [DBG] Validation of authorization code token request success
2019-08-20 11:48:41.316 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"c17713dab242a49a954b73c21edd972443fd697da8e6a64fdf967e0dff291c30","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"mvc","client_secret":"***REDACTED***","code":"c17713dab242a49a954b73c21edd972443fd697da8e6a64fdf967e0dff291c30","grant_type":"authorization_code","redirect_uri":"http://localhost:5002/home/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-08-20 11:48:41.320 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:41.321 +03:00 [DBG] Getting claims for access token for client: mvc
2019-08-20 11:48:41.321 +03:00 [DBG] Getting claims for access token for subject: 1
2019-08-20 11:48:41.326 +03:00 [DBG] Creating refresh token
2019-08-20 11:48:41.326 +03:00 [DBG] Setting an absolute lifetime: 2592000
2019-08-20 11:48:41.327 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:41.328 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 11:48:41.329 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 11:48:41.333 +03:00 [DBG] Token request success.
2019-08-20 11:48:41.336 +03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-08-20 11:48:41.337 +03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-08-20 11:48:41.337 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-08-20 11:48:41.338 +03:00 [DBG] Start userinfo request
2019-08-20 11:48:41.338 +03:00 [DBG] Bearer token found in header
2019-08-20 11:48:41.341 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:41.345 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:41.345 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-08-20 11:48:41.346 +03:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1566290921,"exp":1566290981,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","afcpayroll"],"client_id":"mvc","sub":"1","auth_time":1566290868,"idp":"local","name":"alice","email":"alice@email.com","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-08-20 11:48:41.350 +03:00 [DBG] Creating userinfo response
2019-08-20 11:48:41.351 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:48:41.351 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:48:41.352 +03:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 11:48:41.352 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:48:41.353 +03:00 [INF] Profile service returned the following claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 11:48:41.354 +03:00 [DBG] End userinfo request
2019-08-20 11:48:41.412 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-08-20 11:48:41.413 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-08-20 11:48:41.414 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-08-20 11:48:41.416 +03:00 [DBG] Start authorize request
2019-08-20 11:48:41.417 +03:00 [DBG] User in authorize request: 1
2019-08-20 11:48:41.417 +03:00 [DBG] Start authorize request protocol validation
2019-08-20 11:48:41.418 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:41.418 +03:00 [DBG] Checking for PKCE parameters
2019-08-20 11:48:41.419 +03:00 [DBG] No PKCE used.
2019-08-20 11:48:41.420 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-20 11:48:41.423 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/home/signin-oidc","AllowedRedirectUris":["http://localhost:5002/home/signin-oidc"],"SubjectId":"1","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9M0gB3cdx8UoYmfSYQHXzfd2pHdcZ4Is7C1YMG2BYUQIVwv4xrMb2TtV65DhYtlS12NYUDiylfNBQTtxfEiZaK3zE8QdCR0ArmMbB-cU7z-wQlmJZO-XXhGz4U5po_YbxxuNlfJuDb3nzTP4OkaPt0ISpJrzf5ov-gyRcegMAWVRNlYnZrT6ny33pkvz5YfJq9YDHS7DlSXtpzlx92_OhqTjRJOTgo3nJLRQYtDdF821pGfGiDv55wMiUyhrpeKzLD7dOOcfhW5-nnCk0jPqhTDzfU7CVBlE1SHEnsb9A2httQ79g1f3kqH-1-AOklkERE","UiLocales":null,"Nonce":"637018877213952639.YmFlMGZiMjYtYTg3My00OTM5LTkyZWMtZGY2MzdiZjkyYjA4ZTU4NDRiYjktODBlNi00MmZhLThhYzEtNzE2NDc4OTgwZmRm","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"e74d8cbe5a0a3326c07e4e0a82ece454","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/home/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637018877213952639.YmFlMGZiMjYtYTg3My00OTM5LTkyZWMtZGY2MzdiZjkyYjA4ZTU4NDRiYjktODBlNi00MmZhLThhYzEtNzE2NDc4OTgwZmRm","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9M0gB3cdx8UoYmfSYQHXzfd2pHdcZ4Is7C1YMG2BYUQIVwv4xrMb2TtV65DhYtlS12NYUDiylfNBQTtxfEiZaK3zE8QdCR0ArmMbB-cU7z-wQlmJZO-XXhGz4U5po_YbxxuNlfJuDb3nzTP4OkaPt0ISpJrzf5ov-gyRcegMAWVRNlYnZrT6ny33pkvz5YfJq9YDHS7DlSXtpzlx92_OhqTjRJOTgo3nJLRQYtDdF821pGfGiDv55wMiUyhrpeKzLD7dOOcfhW5-nnCk0jPqhTDzfU7CVBlE1SHEnsb9A2httQ79g1f3kqH-1-AOklkERE","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-20 11:48:41.431 +03:00 [DBG] Client is configured to not require consent, no consent is required
2019-08-20 11:48:41.431 +03:00 [DBG] Creating Hybrid Flow response.
2019-08-20 11:48:41.432 +03:00 [DBG] Creating Implicit Flow response.
2019-08-20 11:48:41.432 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 11:48:41.433 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 11:48:41.437 +03:00 [DBG] Authorize endpoint response
{"SubjectId":"1","ClientId":"mvc","RedirectUri":"http://localhost:5002/home/signin-oidc","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9M0gB3cdx8UoYmfSYQHXzfd2pHdcZ4Is7C1YMG2BYUQIVwv4xrMb2TtV65DhYtlS12NYUDiylfNBQTtxfEiZaK3zE8QdCR0ArmMbB-cU7z-wQlmJZO-XXhGz4U5po_YbxxuNlfJuDb3nzTP4OkaPt0ISpJrzf5ov-gyRcegMAWVRNlYnZrT6ny33pkvz5YfJq9YDHS7DlSXtpzlx92_OhqTjRJOTgo3nJLRQYtDdF821pGfGiDv55wMiUyhrpeKzLD7dOOcfhW5-nnCk0jPqhTDzfU7CVBlE1SHEnsb9A2httQ79g1f3kqH-1-AOklkERE","Scope":"openid profile afcpayroll offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-08-20 11:48:41.642 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-20 11:48:41.645 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-20 11:48:41.646 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-20 11:48:41.647 +03:00 [DBG] Start token request.
2019-08-20 11:48:41.649 +03:00 [DBG] Start client validation
2019-08-20 11:48:41.649 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-20 11:48:41.650 +03:00 [DBG] Start parsing for secret in post body
2019-08-20 11:48:41.650 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-20 11:48:41.651 +03:00 [DBG] Secret id found: mvc
2019-08-20 11:48:41.651 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:41.652 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-20 11:48:41.653 +03:00 [DBG] Client validation success
2019-08-20 11:48:41.653 +03:00 [DBG] Start token request validation
2019-08-20 11:48:41.654 +03:00 [DBG] Start validation of authorization code token request
2019-08-20 11:48:41.655 +03:00 [DBG] Validation of authorization code token request success
2019-08-20 11:48:41.655 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"ced108a36168131270227822c8ad5f368b20bfe4c9eee15e9594df7ff32a7feb","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"mvc","client_secret":"***REDACTED***","code":"ced108a36168131270227822c8ad5f368b20bfe4c9eee15e9594df7ff32a7feb","grant_type":"authorization_code","redirect_uri":"http://localhost:5002/home/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-08-20 11:48:41.658 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:41.659 +03:00 [DBG] Getting claims for access token for client: mvc
2019-08-20 11:48:41.660 +03:00 [DBG] Getting claims for access token for subject: 1
2019-08-20 11:48:41.664 +03:00 [DBG] Creating refresh token
2019-08-20 11:48:41.665 +03:00 [DBG] Setting an absolute lifetime: 2592000
2019-08-20 11:48:41.665 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:41.667 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 11:48:41.668 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 11:48:41.672 +03:00 [DBG] Token request success.
2019-08-20 11:48:41.674 +03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-08-20 11:48:41.675 +03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-08-20 11:48:41.676 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-08-20 11:48:41.676 +03:00 [DBG] Start userinfo request
2019-08-20 11:48:41.677 +03:00 [DBG] Bearer token found in header
2019-08-20 11:48:41.680 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:41.680 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:41.681 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-08-20 11:48:41.682 +03:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1566290921,"exp":1566290981,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","afcpayroll"],"client_id":"mvc","sub":"1","auth_time":1566290868,"idp":"local","name":"alice","email":"alice@email.com","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-08-20 11:48:41.688 +03:00 [DBG] Creating userinfo response
2019-08-20 11:48:41.688 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:48:41.689 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:48:41.689 +03:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 11:48:41.690 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:48:41.690 +03:00 [INF] Profile service returned the following claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 11:48:41.691 +03:00 [DBG] End userinfo request
2019-08-20 11:48:41.735 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-08-20 11:48:41.737 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-08-20 11:48:41.738 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-08-20 11:48:41.738 +03:00 [DBG] Start authorize request
2019-08-20 11:48:41.739 +03:00 [DBG] User in authorize request: 1
2019-08-20 11:48:41.739 +03:00 [DBG] Start authorize request protocol validation
2019-08-20 11:48:41.740 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:41.741 +03:00 [DBG] Checking for PKCE parameters
2019-08-20 11:48:41.741 +03:00 [DBG] No PKCE used.
2019-08-20 11:48:41.742 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-20 11:48:41.742 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/home/signin-oidc","AllowedRedirectUris":["http://localhost:5002/home/signin-oidc"],"SubjectId":"1","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9NefEVAaIwgWVVRFRmsLZObUcrdm8Wlzqk-990yqEY4Qnf2zh3Vc_48RfRAFGyzl8UvudmhGRmmWZawFjKmCXH0hffbUBNaKVi4_-IgBpMF9uK0WGsgBBVi4aX7Zzr044M4JMljWJlvNDzaCrw9daXEuoRjIboGTotEqjI3Tj7UeGFOzy31gMK5xt08tR6bpUKXtcXH96lqxDuGS7H4x5x2gXRJt2XW5RizYAGjiW2Z1WMBf-VS6XUuicYD8Y77eHKsdFJ7HS2rB7MVNZkFAef4YKNhRAzdU_8mBymicCgzjGpNJjUmBNKRMPk73jrqC-s","UiLocales":null,"Nonce":"637018877217205553.ZGU2ZTM5ZDAtYmRiMi00NTAyLWExMTctZDdmZTE1MTVkN2NjZDhlN2U3NjMtODY5MS00NGEzLWJlZDUtMWJiNDU4NTY2YTUx","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"e74d8cbe5a0a3326c07e4e0a82ece454","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/home/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637018877217205553.ZGU2ZTM5ZDAtYmRiMi00NTAyLWExMTctZDdmZTE1MTVkN2NjZDhlN2U3NjMtODY5MS00NGEzLWJlZDUtMWJiNDU4NTY2YTUx","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9NefEVAaIwgWVVRFRmsLZObUcrdm8Wlzqk-990yqEY4Qnf2zh3Vc_48RfRAFGyzl8UvudmhGRmmWZawFjKmCXH0hffbUBNaKVi4_-IgBpMF9uK0WGsgBBVi4aX7Zzr044M4JMljWJlvNDzaCrw9daXEuoRjIboGTotEqjI3Tj7UeGFOzy31gMK5xt08tR6bpUKXtcXH96lqxDuGS7H4x5x2gXRJt2XW5RizYAGjiW2Z1WMBf-VS6XUuicYD8Y77eHKsdFJ7HS2rB7MVNZkFAef4YKNhRAzdU_8mBymicCgzjGpNJjUmBNKRMPk73jrqC-s","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-20 11:48:41.752 +03:00 [DBG] Client is configured to not require consent, no consent is required
2019-08-20 11:48:41.753 +03:00 [DBG] Creating Hybrid Flow response.
2019-08-20 11:48:41.753 +03:00 [DBG] Creating Implicit Flow response.
2019-08-20 11:48:41.754 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 11:48:41.754 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 11:48:41.758 +03:00 [DBG] Authorize endpoint response
{"SubjectId":"1","ClientId":"mvc","RedirectUri":"http://localhost:5002/home/signin-oidc","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9NefEVAaIwgWVVRFRmsLZObUcrdm8Wlzqk-990yqEY4Qnf2zh3Vc_48RfRAFGyzl8UvudmhGRmmWZawFjKmCXH0hffbUBNaKVi4_-IgBpMF9uK0WGsgBBVi4aX7Zzr044M4JMljWJlvNDzaCrw9daXEuoRjIboGTotEqjI3Tj7UeGFOzy31gMK5xt08tR6bpUKXtcXH96lqxDuGS7H4x5x2gXRJt2XW5RizYAGjiW2Z1WMBf-VS6XUuicYD8Y77eHKsdFJ7HS2rB7MVNZkFAef4YKNhRAzdU_8mBymicCgzjGpNJjUmBNKRMPk73jrqC-s","Scope":"openid profile afcpayroll offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-08-20 11:48:41.951 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-20 11:48:41.953 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-20 11:48:41.954 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-20 11:48:41.954 +03:00 [DBG] Start token request.
2019-08-20 11:48:41.955 +03:00 [DBG] Start client validation
2019-08-20 11:48:41.956 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-20 11:48:41.956 +03:00 [DBG] Start parsing for secret in post body
2019-08-20 11:48:41.957 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-20 11:48:41.957 +03:00 [DBG] Secret id found: mvc
2019-08-20 11:48:41.958 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:41.959 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-20 11:48:41.959 +03:00 [DBG] Client validation success
2019-08-20 11:48:41.959 +03:00 [DBG] Start token request validation
2019-08-20 11:48:41.960 +03:00 [DBG] Start validation of authorization code token request
2019-08-20 11:48:41.961 +03:00 [DBG] Validation of authorization code token request success
2019-08-20 11:48:41.962 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"ead9da98dea2d122fe5e57502ae62ef954a99f5af3a20f3b9a7cc1d22c4e0342","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"mvc","client_secret":"***REDACTED***","code":"ead9da98dea2d122fe5e57502ae62ef954a99f5af3a20f3b9a7cc1d22c4e0342","grant_type":"authorization_code","redirect_uri":"http://localhost:5002/home/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-08-20 11:48:41.966 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:41.966 +03:00 [DBG] Getting claims for access token for client: mvc
2019-08-20 11:48:41.967 +03:00 [DBG] Getting claims for access token for subject: 1
2019-08-20 11:48:41.971 +03:00 [DBG] Creating refresh token
2019-08-20 11:48:41.972 +03:00 [DBG] Setting an absolute lifetime: 2592000
2019-08-20 11:48:41.972 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:41.973 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 11:48:41.973 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 11:48:41.978 +03:00 [DBG] Token request success.
2019-08-20 11:48:41.981 +03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-08-20 11:48:41.982 +03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-08-20 11:48:41.983 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-08-20 11:48:41.983 +03:00 [DBG] Start userinfo request
2019-08-20 11:48:41.984 +03:00 [DBG] Bearer token found in header
2019-08-20 11:48:41.987 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:41.987 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:41.988 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-08-20 11:48:41.989 +03:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1566290921,"exp":1566290981,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","afcpayroll"],"client_id":"mvc","sub":"1","auth_time":1566290868,"idp":"local","name":"alice","email":"alice@email.com","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-08-20 11:48:41.993 +03:00 [DBG] Creating userinfo response
2019-08-20 11:48:41.993 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:48:41.994 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:48:41.994 +03:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 11:48:41.995 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:48:41.995 +03:00 [INF] Profile service returned the following claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 11:48:41.996 +03:00 [DBG] End userinfo request
2019-08-20 11:48:42.053 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-08-20 11:48:42.055 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-08-20 11:48:42.055 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-08-20 11:48:42.056 +03:00 [DBG] Start authorize request
2019-08-20 11:48:42.056 +03:00 [DBG] User in authorize request: 1
2019-08-20 11:48:42.057 +03:00 [DBG] Start authorize request protocol validation
2019-08-20 11:48:42.057 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:42.058 +03:00 [DBG] Checking for PKCE parameters
2019-08-20 11:48:42.058 +03:00 [DBG] No PKCE used.
2019-08-20 11:48:42.059 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-20 11:48:42.062 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/home/signin-oidc","AllowedRedirectUris":["http://localhost:5002/home/signin-oidc"],"SubjectId":"1","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9PcTsxw-dqq_0vobk2BkbR-9y5A9jPP54eL5O0_yF1-eVq5wt8G25sk6q43a8T_3rfnicvXLrBeUyj5XAA1zgArSpWasr9H3Aej8PQxflr3sICz6NZo23EbV0ZJJAE-YJLG_jJghN32Pa-o976g_Mo1kkwd6UoC_D80-HanjXwCywxnWSS9aHpjN8xYDAFBT1Hr8U0hsSow1rOOx28b82d-8DQmFmJ5IPlEb78qcd--ETgYrqb9WtPWHEeRSXHRG2-qe9_AFnZkpIpMUjjy-fm72fTh3MtEi_TVyBGSComWxKlo2l79g2XPlQwE7S6dx9o","UiLocales":null,"Nonce":"637018877220240732.OTRiZWJhMGUtN2FhZS00MmI3LWE4ZTUtZmY2YTFkYWFiYTRhNTBhMjBmMGEtZmY2YS00YjA4LWExNzItOWY4ZWRjODNlNDlm","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"e74d8cbe5a0a3326c07e4e0a82ece454","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/home/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637018877220240732.OTRiZWJhMGUtN2FhZS00MmI3LWE4ZTUtZmY2YTFkYWFiYTRhNTBhMjBmMGEtZmY2YS00YjA4LWExNzItOWY4ZWRjODNlNDlm","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9PcTsxw-dqq_0vobk2BkbR-9y5A9jPP54eL5O0_yF1-eVq5wt8G25sk6q43a8T_3rfnicvXLrBeUyj5XAA1zgArSpWasr9H3Aej8PQxflr3sICz6NZo23EbV0ZJJAE-YJLG_jJghN32Pa-o976g_Mo1kkwd6UoC_D80-HanjXwCywxnWSS9aHpjN8xYDAFBT1Hr8U0hsSow1rOOx28b82d-8DQmFmJ5IPlEb78qcd--ETgYrqb9WtPWHEeRSXHRG2-qe9_AFnZkpIpMUjjy-fm72fTh3MtEi_TVyBGSComWxKlo2l79g2XPlQwE7S6dx9o","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-20 11:48:42.070 +03:00 [DBG] Client is configured to not require consent, no consent is required
2019-08-20 11:48:42.071 +03:00 [DBG] Creating Hybrid Flow response.
2019-08-20 11:48:42.072 +03:00 [DBG] Creating Implicit Flow response.
2019-08-20 11:48:42.074 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 11:48:42.074 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 11:48:42.079 +03:00 [DBG] Authorize endpoint response
{"SubjectId":"1","ClientId":"mvc","RedirectUri":"http://localhost:5002/home/signin-oidc","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9PcTsxw-dqq_0vobk2BkbR-9y5A9jPP54eL5O0_yF1-eVq5wt8G25sk6q43a8T_3rfnicvXLrBeUyj5XAA1zgArSpWasr9H3Aej8PQxflr3sICz6NZo23EbV0ZJJAE-YJLG_jJghN32Pa-o976g_Mo1kkwd6UoC_D80-HanjXwCywxnWSS9aHpjN8xYDAFBT1Hr8U0hsSow1rOOx28b82d-8DQmFmJ5IPlEb78qcd--ETgYrqb9WtPWHEeRSXHRG2-qe9_AFnZkpIpMUjjy-fm72fTh3MtEi_TVyBGSComWxKlo2l79g2XPlQwE7S6dx9o","Scope":"openid profile afcpayroll offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-08-20 11:48:42.316 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-20 11:48:42.318 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-20 11:48:42.319 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-20 11:48:42.319 +03:00 [DBG] Start token request.
2019-08-20 11:48:42.320 +03:00 [DBG] Start client validation
2019-08-20 11:48:42.320 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-20 11:48:42.320 +03:00 [DBG] Start parsing for secret in post body
2019-08-20 11:48:42.321 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-20 11:48:42.321 +03:00 [DBG] Secret id found: mvc
2019-08-20 11:48:42.322 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:42.322 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-20 11:48:42.323 +03:00 [DBG] Client validation success
2019-08-20 11:48:42.323 +03:00 [DBG] Start token request validation
2019-08-20 11:48:42.323 +03:00 [DBG] Start validation of authorization code token request
2019-08-20 11:48:42.324 +03:00 [DBG] Validation of authorization code token request success
2019-08-20 11:48:42.325 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"f43f3c382bad4fd7e6c8ac928c81d59774033946a20179b75f526664c3b93d5b","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"mvc","client_secret":"***REDACTED***","code":"f43f3c382bad4fd7e6c8ac928c81d59774033946a20179b75f526664c3b93d5b","grant_type":"authorization_code","redirect_uri":"http://localhost:5002/home/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-08-20 11:48:42.330 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:42.331 +03:00 [DBG] Getting claims for access token for client: mvc
2019-08-20 11:48:42.331 +03:00 [DBG] Getting claims for access token for subject: 1
2019-08-20 11:48:42.335 +03:00 [DBG] Creating refresh token
2019-08-20 11:48:42.336 +03:00 [DBG] Setting an absolute lifetime: 2592000
2019-08-20 11:48:42.337 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:42.337 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 11:48:42.338 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 11:48:42.344 +03:00 [DBG] Token request success.
2019-08-20 11:48:42.347 +03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-08-20 11:48:42.348 +03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-08-20 11:48:42.348 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-08-20 11:48:42.349 +03:00 [DBG] Start userinfo request
2019-08-20 11:48:42.349 +03:00 [DBG] Bearer token found in header
2019-08-20 11:48:42.352 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:42.352 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:42.353 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-08-20 11:48:42.353 +03:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1566290922,"exp":1566290982,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","afcpayroll"],"client_id":"mvc","sub":"1","auth_time":1566290868,"idp":"local","name":"alice","email":"alice@email.com","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-08-20 11:48:42.359 +03:00 [DBG] Creating userinfo response
2019-08-20 11:48:42.359 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:48:42.360 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:48:42.360 +03:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 11:48:42.361 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:48:42.362 +03:00 [INF] Profile service returned the following claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 11:48:42.362 +03:00 [DBG] End userinfo request
2019-08-20 11:48:42.411 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-08-20 11:48:42.413 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-08-20 11:48:42.413 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-08-20 11:48:42.414 +03:00 [DBG] Start authorize request
2019-08-20 11:48:42.415 +03:00 [DBG] User in authorize request: 1
2019-08-20 11:48:42.415 +03:00 [DBG] Start authorize request protocol validation
2019-08-20 11:48:42.416 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:42.416 +03:00 [DBG] Checking for PKCE parameters
2019-08-20 11:48:42.417 +03:00 [DBG] No PKCE used.
2019-08-20 11:48:42.418 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-20 11:48:42.419 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/home/signin-oidc","AllowedRedirectUris":["http://localhost:5002/home/signin-oidc"],"SubjectId":"1","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9PRrFmp0adTVS34NMOtUrLhEaW2JObCM2sXs_ibH_WnZciho6XF95G0yq26D6cX8wZf2W-HHs8UAj338D0FCXa83ymdvbAH3XRlyXsUdpJr8EdfI3N59yr89WVBRkHkvim2PEcit1p8knCqPoWHellQCKaT3yedjyImArmquR1avGBbRsdbwSlc79L6JiRdoIrYnnXzqPa6vB6yzBqMH6g8bFU2D9UEBAR1khf2y_noJCzuXGe0XW-M2ghM_KkLTeTG3WFhdYig5qerue0vYmRLfcYIhiuNNQcMN3rMrL-WBSMLf1h_nwsTG6wqUvXdm04","UiLocales":null,"Nonce":"637018877223930751.MDI2NDUxZWQtM2JiYS00ZWNiLWJjY2MtMzhlNmNiMzIwMzhmYmZmZmY0MDUtOGMxNy00MjA5LTgwYWMtOTExMDk5YTk2N2M1","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"e74d8cbe5a0a3326c07e4e0a82ece454","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/home/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637018877223930751.MDI2NDUxZWQtM2JiYS00ZWNiLWJjY2MtMzhlNmNiMzIwMzhmYmZmZmY0MDUtOGMxNy00MjA5LTgwYWMtOTExMDk5YTk2N2M1","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9PRrFmp0adTVS34NMOtUrLhEaW2JObCM2sXs_ibH_WnZciho6XF95G0yq26D6cX8wZf2W-HHs8UAj338D0FCXa83ymdvbAH3XRlyXsUdpJr8EdfI3N59yr89WVBRkHkvim2PEcit1p8knCqPoWHellQCKaT3yedjyImArmquR1avGBbRsdbwSlc79L6JiRdoIrYnnXzqPa6vB6yzBqMH6g8bFU2D9UEBAR1khf2y_noJCzuXGe0XW-M2ghM_KkLTeTG3WFhdYig5qerue0vYmRLfcYIhiuNNQcMN3rMrL-WBSMLf1h_nwsTG6wqUvXdm04","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-20 11:48:42.425 +03:00 [DBG] Client is configured to not require consent, no consent is required
2019-08-20 11:48:42.426 +03:00 [DBG] Creating Hybrid Flow response.
2019-08-20 11:48:42.427 +03:00 [DBG] Creating Implicit Flow response.
2019-08-20 11:48:42.427 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 11:48:42.428 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 11:48:42.432 +03:00 [DBG] Authorize endpoint response
{"SubjectId":"1","ClientId":"mvc","RedirectUri":"http://localhost:5002/home/signin-oidc","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9PRrFmp0adTVS34NMOtUrLhEaW2JObCM2sXs_ibH_WnZciho6XF95G0yq26D6cX8wZf2W-HHs8UAj338D0FCXa83ymdvbAH3XRlyXsUdpJr8EdfI3N59yr89WVBRkHkvim2PEcit1p8knCqPoWHellQCKaT3yedjyImArmquR1avGBbRsdbwSlc79L6JiRdoIrYnnXzqPa6vB6yzBqMH6g8bFU2D9UEBAR1khf2y_noJCzuXGe0XW-M2ghM_KkLTeTG3WFhdYig5qerue0vYmRLfcYIhiuNNQcMN3rMrL-WBSMLf1h_nwsTG6wqUvXdm04","Scope":"openid profile afcpayroll offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-08-20 11:48:42.703 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-20 11:48:42.705 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-20 11:48:42.706 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-20 11:48:42.707 +03:00 [DBG] Start token request.
2019-08-20 11:48:42.707 +03:00 [DBG] Start client validation
2019-08-20 11:48:42.708 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-20 11:48:42.708 +03:00 [DBG] Start parsing for secret in post body
2019-08-20 11:48:42.709 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-20 11:48:42.711 +03:00 [DBG] Secret id found: mvc
2019-08-20 11:48:42.712 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:42.712 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-20 11:48:42.713 +03:00 [DBG] Client validation success
2019-08-20 11:48:42.713 +03:00 [DBG] Start token request validation
2019-08-20 11:48:42.714 +03:00 [DBG] Start validation of authorization code token request
2019-08-20 11:48:42.714 +03:00 [DBG] Validation of authorization code token request success
2019-08-20 11:48:42.715 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"658301f172b79e543ffb780a92ee875abbe7ee05e903480815b76363e220210a","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"mvc","client_secret":"***REDACTED***","code":"658301f172b79e543ffb780a92ee875abbe7ee05e903480815b76363e220210a","grant_type":"authorization_code","redirect_uri":"http://localhost:5002/home/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-08-20 11:48:42.718 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:42.735 +03:00 [DBG] Getting claims for access token for client: mvc
2019-08-20 11:48:42.736 +03:00 [DBG] Getting claims for access token for subject: 1
2019-08-20 11:48:42.741 +03:00 [DBG] Creating refresh token
2019-08-20 11:48:42.742 +03:00 [DBG] Setting an absolute lifetime: 2592000
2019-08-20 11:48:42.743 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:42.744 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 11:48:42.745 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 11:48:42.749 +03:00 [DBG] Token request success.
2019-08-20 11:48:42.753 +03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-08-20 11:48:42.754 +03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-08-20 11:48:42.755 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-08-20 11:48:42.756 +03:00 [DBG] Start userinfo request
2019-08-20 11:48:42.756 +03:00 [DBG] Bearer token found in header
2019-08-20 11:48:42.759 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:42.761 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:42.764 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-08-20 11:48:42.766 +03:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1566290922,"exp":1566290982,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","afcpayroll"],"client_id":"mvc","sub":"1","auth_time":1566290868,"idp":"local","name":"alice","email":"alice@email.com","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-08-20 11:48:42.771 +03:00 [DBG] Creating userinfo response
2019-08-20 11:48:42.772 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:48:42.772 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:48:42.773 +03:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 11:48:42.774 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:48:42.774 +03:00 [INF] Profile service returned the following claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 11:48:42.775 +03:00 [DBG] End userinfo request
2019-08-20 11:48:42.861 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-08-20 11:48:42.862 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-08-20 11:48:42.863 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-08-20 11:48:42.864 +03:00 [DBG] Start authorize request
2019-08-20 11:48:42.864 +03:00 [DBG] User in authorize request: 1
2019-08-20 11:48:42.865 +03:00 [DBG] Start authorize request protocol validation
2019-08-20 11:48:42.865 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:42.866 +03:00 [DBG] Checking for PKCE parameters
2019-08-20 11:48:42.866 +03:00 [DBG] No PKCE used.
2019-08-20 11:48:42.867 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-20 11:48:42.867 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/home/signin-oidc","AllowedRedirectUris":["http://localhost:5002/home/signin-oidc"],"SubjectId":"1","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9PCAAaKq_P_If4nDEg_GhUJPnkH7pYufA0Axc3dsrcJyuNfcOzFRWOomH3rkLui3m3Mcfx3G2BSGpiW3gkQi4PKGPbqs4TefARBMVeFUVY0oOTi40Ys0G5EiDhGIYWHzqEoPadkAZXReQQ2rSRYmA9jyZ5r1_5n8Y3SBmTrX3n8O2G77IAYrr2BycwgCm4ivQFCwq1so3d_BL4-D-s6-O5UIq8_47-Jr__wkGOeBbl2Jyj5YUL0_5yOeZkvXdbgyTkNkVkfoGys5U75m2J9lbK3U8HoHMPY0TCVLEF5if7JmOT9LzUiEQXhd35vBMj6NPc","UiLocales":null,"Nonce":"637018877228389354.ZjM2OWFmM2UtZjA5Zi00ZGY1LTk5YTMtODgwM2IzYzVhNTJlZWI2NTNjMWYtODYwNy00YWI0LWExZmItMGI5Yjg2MDYxZWQw","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"e74d8cbe5a0a3326c07e4e0a82ece454","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/home/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637018877228389354.ZjM2OWFmM2UtZjA5Zi00ZGY1LTk5YTMtODgwM2IzYzVhNTJlZWI2NTNjMWYtODYwNy00YWI0LWExZmItMGI5Yjg2MDYxZWQw","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9PCAAaKq_P_If4nDEg_GhUJPnkH7pYufA0Axc3dsrcJyuNfcOzFRWOomH3rkLui3m3Mcfx3G2BSGpiW3gkQi4PKGPbqs4TefARBMVeFUVY0oOTi40Ys0G5EiDhGIYWHzqEoPadkAZXReQQ2rSRYmA9jyZ5r1_5n8Y3SBmTrX3n8O2G77IAYrr2BycwgCm4ivQFCwq1so3d_BL4-D-s6-O5UIq8_47-Jr__wkGOeBbl2Jyj5YUL0_5yOeZkvXdbgyTkNkVkfoGys5U75m2J9lbK3U8HoHMPY0TCVLEF5if7JmOT9LzUiEQXhd35vBMj6NPc","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-20 11:48:42.874 +03:00 [DBG] Client is configured to not require consent, no consent is required
2019-08-20 11:48:42.875 +03:00 [DBG] Creating Hybrid Flow response.
2019-08-20 11:48:42.875 +03:00 [DBG] Creating Implicit Flow response.
2019-08-20 11:48:42.876 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 11:48:42.877 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 11:48:42.881 +03:00 [DBG] Authorize endpoint response
{"SubjectId":"1","ClientId":"mvc","RedirectUri":"http://localhost:5002/home/signin-oidc","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9PCAAaKq_P_If4nDEg_GhUJPnkH7pYufA0Axc3dsrcJyuNfcOzFRWOomH3rkLui3m3Mcfx3G2BSGpiW3gkQi4PKGPbqs4TefARBMVeFUVY0oOTi40Ys0G5EiDhGIYWHzqEoPadkAZXReQQ2rSRYmA9jyZ5r1_5n8Y3SBmTrX3n8O2G77IAYrr2BycwgCm4ivQFCwq1so3d_BL4-D-s6-O5UIq8_47-Jr__wkGOeBbl2Jyj5YUL0_5yOeZkvXdbgyTkNkVkfoGys5U75m2J9lbK3U8HoHMPY0TCVLEF5if7JmOT9LzUiEQXhd35vBMj6NPc","Scope":"openid profile afcpayroll offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-08-20 11:48:43.114 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-20 11:48:43.115 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-20 11:48:43.116 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-20 11:48:43.117 +03:00 [DBG] Start token request.
2019-08-20 11:48:43.117 +03:00 [DBG] Start client validation
2019-08-20 11:48:43.117 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-20 11:48:43.118 +03:00 [DBG] Start parsing for secret in post body
2019-08-20 11:48:43.118 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-20 11:48:43.120 +03:00 [DBG] Secret id found: mvc
2019-08-20 11:48:43.122 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:43.122 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-20 11:48:43.123 +03:00 [DBG] Client validation success
2019-08-20 11:48:43.123 +03:00 [DBG] Start token request validation
2019-08-20 11:48:43.124 +03:00 [DBG] Start validation of authorization code token request
2019-08-20 11:48:43.125 +03:00 [DBG] Validation of authorization code token request success
2019-08-20 11:48:43.125 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"a3495153aecdc4c905f3b3ae94acfe885be019f53a0a1a6f694e9ab00bb975c3","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"mvc","client_secret":"***REDACTED***","code":"a3495153aecdc4c905f3b3ae94acfe885be019f53a0a1a6f694e9ab00bb975c3","grant_type":"authorization_code","redirect_uri":"http://localhost:5002/home/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-08-20 11:48:43.129 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:43.129 +03:00 [DBG] Getting claims for access token for client: mvc
2019-08-20 11:48:43.130 +03:00 [DBG] Getting claims for access token for subject: 1
2019-08-20 11:48:43.134 +03:00 [DBG] Creating refresh token
2019-08-20 11:48:43.134 +03:00 [DBG] Setting an absolute lifetime: 2592000
2019-08-20 11:48:43.135 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:43.137 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 11:48:43.138 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 11:48:43.142 +03:00 [DBG] Token request success.
2019-08-20 11:48:43.145 +03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-08-20 11:48:43.145 +03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-08-20 11:48:43.146 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-08-20 11:48:43.147 +03:00 [DBG] Start userinfo request
2019-08-20 11:48:43.147 +03:00 [DBG] Bearer token found in header
2019-08-20 11:48:43.150 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:43.151 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:43.151 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-08-20 11:48:43.152 +03:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1566290923,"exp":1566290983,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","afcpayroll"],"client_id":"mvc","sub":"1","auth_time":1566290868,"idp":"local","name":"alice","email":"alice@email.com","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-08-20 11:48:43.158 +03:00 [DBG] Creating userinfo response
2019-08-20 11:48:43.158 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:48:43.159 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:48:43.160 +03:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 11:48:43.161 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:48:43.161 +03:00 [INF] Profile service returned the following claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 11:48:43.162 +03:00 [DBG] End userinfo request
2019-08-20 11:48:43.212 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-08-20 11:48:43.214 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-08-20 11:48:43.215 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-08-20 11:48:43.215 +03:00 [DBG] Start authorize request
2019-08-20 11:48:43.216 +03:00 [DBG] User in authorize request: 1
2019-08-20 11:48:43.217 +03:00 [DBG] Start authorize request protocol validation
2019-08-20 11:48:43.219 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:43.221 +03:00 [DBG] Checking for PKCE parameters
2019-08-20 11:48:43.221 +03:00 [DBG] No PKCE used.
2019-08-20 11:48:43.222 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-20 11:48:43.223 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/home/signin-oidc","AllowedRedirectUris":["http://localhost:5002/home/signin-oidc"],"SubjectId":"1","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9M4GyuLJ5kp_Svhc4X3w5Alicq3zT9Q6hxuDlOWCVe_I9NBLmAD15xiYxouRzajw4kXTyd-9wAPxrjddYEQJce8XoVpfwrkslS84bmG409c0YORhxgci9j4Wz1E_HoD1wsbWCWA3YPruX2obUZaSfoF5dA8lMTe8PfhEKpcAmDoJU5lI8LbjNs9NHnVlMY8RtFVvDtkU3GQDpLrHDlawvryHr70Sf_ZXYqgms8NFQLE337E_zEiuBMXCGX0Lc9WA7ZO8HQdb0AJuI-aF0lsRZTFRMPqs43gBB5tpv3oVOCkRvze2Jwm2R75hbfh0MpDAng","UiLocales":null,"Nonce":"637018877231948087.Nzc2NTA4ZjctNDkwNC00NWYyLTgzMGEtZWU2NzQ4ZTlkMDBiM2ZiZjRmY2ItYzMzMS00OThjLWI3MjQtZmI3NWJjZjY0ZDNj","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"e74d8cbe5a0a3326c07e4e0a82ece454","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/home/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637018877231948087.Nzc2NTA4ZjctNDkwNC00NWYyLTgzMGEtZWU2NzQ4ZTlkMDBiM2ZiZjRmY2ItYzMzMS00OThjLWI3MjQtZmI3NWJjZjY0ZDNj","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9M4GyuLJ5kp_Svhc4X3w5Alicq3zT9Q6hxuDlOWCVe_I9NBLmAD15xiYxouRzajw4kXTyd-9wAPxrjddYEQJce8XoVpfwrkslS84bmG409c0YORhxgci9j4Wz1E_HoD1wsbWCWA3YPruX2obUZaSfoF5dA8lMTe8PfhEKpcAmDoJU5lI8LbjNs9NHnVlMY8RtFVvDtkU3GQDpLrHDlawvryHr70Sf_ZXYqgms8NFQLE337E_zEiuBMXCGX0Lc9WA7ZO8HQdb0AJuI-aF0lsRZTFRMPqs43gBB5tpv3oVOCkRvze2Jwm2R75hbfh0MpDAng","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-20 11:48:43.228 +03:00 [DBG] Client is configured to not require consent, no consent is required
2019-08-20 11:48:43.229 +03:00 [DBG] Creating Hybrid Flow response.
2019-08-20 11:48:43.230 +03:00 [DBG] Creating Implicit Flow response.
2019-08-20 11:48:43.230 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 11:48:43.231 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 11:48:43.235 +03:00 [DBG] Authorize endpoint response
{"SubjectId":"1","ClientId":"mvc","RedirectUri":"http://localhost:5002/home/signin-oidc","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9M4GyuLJ5kp_Svhc4X3w5Alicq3zT9Q6hxuDlOWCVe_I9NBLmAD15xiYxouRzajw4kXTyd-9wAPxrjddYEQJce8XoVpfwrkslS84bmG409c0YORhxgci9j4Wz1E_HoD1wsbWCWA3YPruX2obUZaSfoF5dA8lMTe8PfhEKpcAmDoJU5lI8LbjNs9NHnVlMY8RtFVvDtkU3GQDpLrHDlawvryHr70Sf_ZXYqgms8NFQLE337E_zEiuBMXCGX0Lc9WA7ZO8HQdb0AJuI-aF0lsRZTFRMPqs43gBB5tpv3oVOCkRvze2Jwm2R75hbfh0MpDAng","Scope":"openid profile afcpayroll offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-08-20 11:48:43.440 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-20 11:48:43.441 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-20 11:48:43.441 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-20 11:48:43.442 +03:00 [DBG] Start token request.
2019-08-20 11:48:43.442 +03:00 [DBG] Start client validation
2019-08-20 11:48:43.444 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-20 11:48:43.445 +03:00 [DBG] Start parsing for secret in post body
2019-08-20 11:48:43.446 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-20 11:48:43.447 +03:00 [DBG] Secret id found: mvc
2019-08-20 11:48:43.448 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:43.449 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-20 11:48:43.450 +03:00 [DBG] Client validation success
2019-08-20 11:48:43.450 +03:00 [DBG] Start token request validation
2019-08-20 11:48:43.450 +03:00 [DBG] Start validation of authorization code token request
2019-08-20 11:48:43.451 +03:00 [DBG] Validation of authorization code token request success
2019-08-20 11:48:43.451 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"bc716e0dc5ffa489c9029958cd7be785563316e1c032ebcee7fb33e8cd3d06ea","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"mvc","client_secret":"***REDACTED***","code":"bc716e0dc5ffa489c9029958cd7be785563316e1c032ebcee7fb33e8cd3d06ea","grant_type":"authorization_code","redirect_uri":"http://localhost:5002/home/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-08-20 11:48:43.455 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:43.455 +03:00 [DBG] Getting claims for access token for client: mvc
2019-08-20 11:48:43.456 +03:00 [DBG] Getting claims for access token for subject: 1
2019-08-20 11:48:43.460 +03:00 [DBG] Creating refresh token
2019-08-20 11:48:43.461 +03:00 [DBG] Setting an absolute lifetime: 2592000
2019-08-20 11:48:43.461 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:43.462 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 11:48:43.463 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 11:48:43.467 +03:00 [DBG] Token request success.
2019-08-20 11:48:43.470 +03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-08-20 11:48:43.471 +03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-08-20 11:48:43.472 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-08-20 11:48:43.472 +03:00 [DBG] Start userinfo request
2019-08-20 11:48:43.472 +03:00 [DBG] Bearer token found in header
2019-08-20 11:48:43.475 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:43.476 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:43.478 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-08-20 11:48:43.479 +03:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1566290923,"exp":1566290983,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","afcpayroll"],"client_id":"mvc","sub":"1","auth_time":1566290868,"idp":"local","name":"alice","email":"alice@email.com","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-08-20 11:48:43.484 +03:00 [DBG] Creating userinfo response
2019-08-20 11:48:43.484 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:48:43.485 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:48:43.485 +03:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 11:48:43.486 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:48:43.487 +03:00 [INF] Profile service returned the following claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 11:48:43.487 +03:00 [DBG] End userinfo request
2019-08-20 11:48:43.531 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-08-20 11:48:43.532 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-08-20 11:48:43.533 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-08-20 11:48:43.533 +03:00 [DBG] Start authorize request
2019-08-20 11:48:43.534 +03:00 [DBG] User in authorize request: 1
2019-08-20 11:48:43.534 +03:00 [DBG] Start authorize request protocol validation
2019-08-20 11:48:43.535 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:43.535 +03:00 [DBG] Checking for PKCE parameters
2019-08-20 11:48:43.535 +03:00 [DBG] No PKCE used.
2019-08-20 11:48:43.536 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-20 11:48:43.537 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/home/signin-oidc","AllowedRedirectUris":["http://localhost:5002/home/signin-oidc"],"SubjectId":"1","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9MAgV4FpncIPKLhr1RerXC5QvB_5Tt2cOD_EK7rb7r9oQG1UYNlWXRVThA-kjUK3ObT4jiHE_-ajlmVCZjZKqfOvXXSdO_rHLKBSan1KOGXqeLsUjdcDc4kx7BACbvwlaQQ3bm4fqiGRONGfwoscLc7p2E3BJWa7wFzmhc4rePRQuD5KQM2MvRVB-D21RZaNMuopXxKMUE4gDrHvPBz03qJjoSp-xkn8SLFdiAGrkA_gTFtvwfIcnd27ZUmjzUMe64XbOXUSSbmANMuS3OJ7owbNz1aGEOkCJJlo9EoY6XJbCEUsydnX7rICqrPNX8oSkQ","UiLocales":null,"Nonce":"637018877235159370.MDcxZTMxMWUtNmI2NC00ZDQyLTllZDQtY2Y1YmMxYWZjNWQ0MjFhZDUxOWItNTQ3Ny00YmUxLWJmNTctZTVjN2NkNDZjNjdm","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"e74d8cbe5a0a3326c07e4e0a82ece454","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/home/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637018877235159370.MDcxZTMxMWUtNmI2NC00ZDQyLTllZDQtY2Y1YmMxYWZjNWQ0MjFhZDUxOWItNTQ3Ny00YmUxLWJmNTctZTVjN2NkNDZjNjdm","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9MAgV4FpncIPKLhr1RerXC5QvB_5Tt2cOD_EK7rb7r9oQG1UYNlWXRVThA-kjUK3ObT4jiHE_-ajlmVCZjZKqfOvXXSdO_rHLKBSan1KOGXqeLsUjdcDc4kx7BACbvwlaQQ3bm4fqiGRONGfwoscLc7p2E3BJWa7wFzmhc4rePRQuD5KQM2MvRVB-D21RZaNMuopXxKMUE4gDrHvPBz03qJjoSp-xkn8SLFdiAGrkA_gTFtvwfIcnd27ZUmjzUMe64XbOXUSSbmANMuS3OJ7owbNz1aGEOkCJJlo9EoY6XJbCEUsydnX7rICqrPNX8oSkQ","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-20 11:48:43.542 +03:00 [DBG] Client is configured to not require consent, no consent is required
2019-08-20 11:48:43.542 +03:00 [DBG] Creating Hybrid Flow response.
2019-08-20 11:48:43.543 +03:00 [DBG] Creating Implicit Flow response.
2019-08-20 11:48:43.543 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 11:48:43.544 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 11:48:43.548 +03:00 [DBG] Authorize endpoint response
{"SubjectId":"1","ClientId":"mvc","RedirectUri":"http://localhost:5002/home/signin-oidc","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9MAgV4FpncIPKLhr1RerXC5QvB_5Tt2cOD_EK7rb7r9oQG1UYNlWXRVThA-kjUK3ObT4jiHE_-ajlmVCZjZKqfOvXXSdO_rHLKBSan1KOGXqeLsUjdcDc4kx7BACbvwlaQQ3bm4fqiGRONGfwoscLc7p2E3BJWa7wFzmhc4rePRQuD5KQM2MvRVB-D21RZaNMuopXxKMUE4gDrHvPBz03qJjoSp-xkn8SLFdiAGrkA_gTFtvwfIcnd27ZUmjzUMe64XbOXUSSbmANMuS3OJ7owbNz1aGEOkCJJlo9EoY6XJbCEUsydnX7rICqrPNX8oSkQ","Scope":"openid profile afcpayroll offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-08-20 11:48:43.732 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-20 11:48:43.733 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-20 11:48:43.734 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-20 11:48:43.734 +03:00 [DBG] Start token request.
2019-08-20 11:48:43.735 +03:00 [DBG] Start client validation
2019-08-20 11:48:43.735 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-20 11:48:43.736 +03:00 [DBG] Start parsing for secret in post body
2019-08-20 11:48:43.737 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-20 11:48:43.737 +03:00 [DBG] Secret id found: mvc
2019-08-20 11:48:43.738 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:43.740 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-20 11:48:43.741 +03:00 [DBG] Client validation success
2019-08-20 11:48:43.742 +03:00 [DBG] Start token request validation
2019-08-20 11:48:43.742 +03:00 [DBG] Start validation of authorization code token request
2019-08-20 11:48:43.743 +03:00 [DBG] Validation of authorization code token request success
2019-08-20 11:48:43.743 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"594fdfda358c4de45743b1fd63c272b0b5a7ace24222f3e4ffd0efe2da87233d","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"mvc","client_secret":"***REDACTED***","code":"594fdfda358c4de45743b1fd63c272b0b5a7ace24222f3e4ffd0efe2da87233d","grant_type":"authorization_code","redirect_uri":"http://localhost:5002/home/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-08-20 11:48:43.748 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:43.748 +03:00 [DBG] Getting claims for access token for client: mvc
2019-08-20 11:48:43.749 +03:00 [DBG] Getting claims for access token for subject: 1
2019-08-20 11:48:43.754 +03:00 [DBG] Creating refresh token
2019-08-20 11:48:43.754 +03:00 [DBG] Setting an absolute lifetime: 2592000
2019-08-20 11:48:43.755 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:43.756 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 11:48:43.756 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 11:48:43.761 +03:00 [DBG] Token request success.
2019-08-20 11:48:43.764 +03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-08-20 11:48:43.765 +03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-08-20 11:48:43.766 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-08-20 11:48:43.766 +03:00 [DBG] Start userinfo request
2019-08-20 11:48:43.767 +03:00 [DBG] Bearer token found in header
2019-08-20 11:48:43.769 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:43.770 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:43.771 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-08-20 11:48:43.772 +03:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1566290923,"exp":1566290983,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","afcpayroll"],"client_id":"mvc","sub":"1","auth_time":1566290868,"idp":"local","name":"alice","email":"alice@email.com","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-08-20 11:48:43.776 +03:00 [DBG] Creating userinfo response
2019-08-20 11:48:43.777 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:48:43.778 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:48:43.779 +03:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 11:48:43.780 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:48:43.781 +03:00 [INF] Profile service returned the following claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 11:48:43.782 +03:00 [DBG] End userinfo request
2019-08-20 11:48:43.830 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-08-20 11:48:43.831 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-08-20 11:48:43.832 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-08-20 11:48:43.833 +03:00 [DBG] Start authorize request
2019-08-20 11:48:43.833 +03:00 [DBG] User in authorize request: 1
2019-08-20 11:48:43.834 +03:00 [DBG] Start authorize request protocol validation
2019-08-20 11:48:43.834 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:43.835 +03:00 [DBG] Checking for PKCE parameters
2019-08-20 11:48:43.835 +03:00 [DBG] No PKCE used.
2019-08-20 11:48:43.836 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-20 11:48:43.836 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/home/signin-oidc","AllowedRedirectUris":["http://localhost:5002/home/signin-oidc"],"SubjectId":"1","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9M6iXgCTsBMdEW-2uz0y9EHFOCoQE8VtRgDO8bkWl-ufP2BOl605zDcRAxIZvMlzpEmwYGSumHis84Ix1yH8yekxHzbfgoFLtGpXT4PBe666JZTkLpsLlFHyaLluT0S22cg_nL3joFvkXkbvbFPAz9IAnsfAt4AeORbIZZs__47lTp5QQwSh9_xs9NRxVUC0cAQFcWwHSgTL5kemSz-W1z3Fji6zsEIscEc-NUgUKe42QCChPKdltaI9ZjBfESnssnaKicRdFGkTxVF0My3vrfnjWj30x3O_44QCe8_eCus9Vmn2AxxYiDDJzGJEkayKoU","UiLocales":null,"Nonce":"637018877238119619.NDA5OGY3OGYtZGI2NC00N2FlLThkOGMtNjE0MjFjN2Y3MGQwMGU5OTg4YTgtYzg0MC00ZGU0LWFhYWQtOGY5YTIzOTRiMTli","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"e74d8cbe5a0a3326c07e4e0a82ece454","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/home/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637018877238119619.NDA5OGY3OGYtZGI2NC00N2FlLThkOGMtNjE0MjFjN2Y3MGQwMGU5OTg4YTgtYzg0MC00ZGU0LWFhYWQtOGY5YTIzOTRiMTli","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9M6iXgCTsBMdEW-2uz0y9EHFOCoQE8VtRgDO8bkWl-ufP2BOl605zDcRAxIZvMlzpEmwYGSumHis84Ix1yH8yekxHzbfgoFLtGpXT4PBe666JZTkLpsLlFHyaLluT0S22cg_nL3joFvkXkbvbFPAz9IAnsfAt4AeORbIZZs__47lTp5QQwSh9_xs9NRxVUC0cAQFcWwHSgTL5kemSz-W1z3Fji6zsEIscEc-NUgUKe42QCChPKdltaI9ZjBfESnssnaKicRdFGkTxVF0My3vrfnjWj30x3O_44QCe8_eCus9Vmn2AxxYiDDJzGJEkayKoU","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-20 11:48:43.842 +03:00 [DBG] Client is configured to not require consent, no consent is required
2019-08-20 11:48:43.842 +03:00 [DBG] Creating Hybrid Flow response.
2019-08-20 11:48:43.843 +03:00 [DBG] Creating Implicit Flow response.
2019-08-20 11:48:43.843 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 11:48:43.844 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 11:48:43.848 +03:00 [DBG] Authorize endpoint response
{"SubjectId":"1","ClientId":"mvc","RedirectUri":"http://localhost:5002/home/signin-oidc","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9M6iXgCTsBMdEW-2uz0y9EHFOCoQE8VtRgDO8bkWl-ufP2BOl605zDcRAxIZvMlzpEmwYGSumHis84Ix1yH8yekxHzbfgoFLtGpXT4PBe666JZTkLpsLlFHyaLluT0S22cg_nL3joFvkXkbvbFPAz9IAnsfAt4AeORbIZZs__47lTp5QQwSh9_xs9NRxVUC0cAQFcWwHSgTL5kemSz-W1z3Fji6zsEIscEc-NUgUKe42QCChPKdltaI9ZjBfESnssnaKicRdFGkTxVF0My3vrfnjWj30x3O_44QCe8_eCus9Vmn2AxxYiDDJzGJEkayKoU","Scope":"openid profile afcpayroll offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-08-20 11:48:44.039 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-20 11:48:44.040 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-20 11:48:44.041 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-20 11:48:44.042 +03:00 [DBG] Start token request.
2019-08-20 11:48:44.045 +03:00 [DBG] Start client validation
2019-08-20 11:48:44.046 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-20 11:48:44.047 +03:00 [DBG] Start parsing for secret in post body
2019-08-20 11:48:44.047 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-20 11:48:44.048 +03:00 [DBG] Secret id found: mvc
2019-08-20 11:48:44.049 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:44.049 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-20 11:48:44.050 +03:00 [DBG] Client validation success
2019-08-20 11:48:44.050 +03:00 [DBG] Start token request validation
2019-08-20 11:48:44.050 +03:00 [DBG] Start validation of authorization code token request
2019-08-20 11:48:44.051 +03:00 [DBG] Validation of authorization code token request success
2019-08-20 11:48:44.051 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"117ba8bc109422d284466236daed23ba82fb1c413f1aeb222809a326a0ee6bc3","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"mvc","client_secret":"***REDACTED***","code":"117ba8bc109422d284466236daed23ba82fb1c413f1aeb222809a326a0ee6bc3","grant_type":"authorization_code","redirect_uri":"http://localhost:5002/home/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-08-20 11:48:44.054 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:44.055 +03:00 [DBG] Getting claims for access token for client: mvc
2019-08-20 11:48:44.055 +03:00 [DBG] Getting claims for access token for subject: 1
2019-08-20 11:48:44.060 +03:00 [DBG] Creating refresh token
2019-08-20 11:48:44.060 +03:00 [DBG] Setting an absolute lifetime: 2592000
2019-08-20 11:48:44.061 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:44.062 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 11:48:44.062 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 11:48:44.066 +03:00 [DBG] Token request success.
2019-08-20 11:48:44.069 +03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-08-20 11:48:44.069 +03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-08-20 11:48:44.070 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-08-20 11:48:44.070 +03:00 [DBG] Start userinfo request
2019-08-20 11:48:44.071 +03:00 [DBG] Bearer token found in header
2019-08-20 11:48:44.074 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:44.074 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:44.075 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-08-20 11:48:44.078 +03:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1566290924,"exp":1566290984,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","afcpayroll"],"client_id":"mvc","sub":"1","auth_time":1566290868,"idp":"local","name":"alice","email":"alice@email.com","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-08-20 11:48:44.083 +03:00 [DBG] Creating userinfo response
2019-08-20 11:48:44.083 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:48:44.084 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:48:44.084 +03:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 11:48:44.085 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:48:44.085 +03:00 [INF] Profile service returned the following claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 11:48:44.086 +03:00 [DBG] End userinfo request
2019-08-20 11:48:44.129 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-08-20 11:48:44.130 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-08-20 11:48:44.131 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-08-20 11:48:44.131 +03:00 [DBG] Start authorize request
2019-08-20 11:48:44.132 +03:00 [DBG] User in authorize request: 1
2019-08-20 11:48:44.132 +03:00 [DBG] Start authorize request protocol validation
2019-08-20 11:48:44.133 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:44.133 +03:00 [DBG] Checking for PKCE parameters
2019-08-20 11:48:44.134 +03:00 [DBG] No PKCE used.
2019-08-20 11:48:44.134 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-20 11:48:44.135 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/home/signin-oidc","AllowedRedirectUris":["http://localhost:5002/home/signin-oidc"],"SubjectId":"1","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9NsCMfxjhxrBm5oIazJE4P2ww4mL2SWzwIaTykmmD0Akt-KiHoOMgrxes1duL2i9q4lvkNX4MGqiADwpe-AaSVLHPYnWFFU49km01VYdCL8Hji_zCzUFOwtafEklScNeehdm8ALU3QLscoPBtjs5MDzJcK-2LZ8IMt0LkJ2hjNDL0ekaGz3U_rkizifISDPEH4CxVg7jc1eUE_3uV7lCpOP1FUs5shJ5eW1qt7XXWLAgRw4QEg7mKNC3CUC-G3EpktN5nY5tnSCeruWdS8djLC_7uzmp-Q6GZjxTCqTFfLM3vM964CxV_polI5T2k6WHs8","UiLocales":null,"Nonce":"637018877241126745.MjEwMzRiNDYtM2NlYy00MTI2LTljYTMtNDlmODE0YTEyMmJkMTNiMDRmNWQtODZhZi00ODdmLWE2NDMtZjlhNjYzMmQxNTNi","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"e74d8cbe5a0a3326c07e4e0a82ece454","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/home/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637018877241126745.MjEwMzRiNDYtM2NlYy00MTI2LTljYTMtNDlmODE0YTEyMmJkMTNiMDRmNWQtODZhZi00ODdmLWE2NDMtZjlhNjYzMmQxNTNi","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9NsCMfxjhxrBm5oIazJE4P2ww4mL2SWzwIaTykmmD0Akt-KiHoOMgrxes1duL2i9q4lvkNX4MGqiADwpe-AaSVLHPYnWFFU49km01VYdCL8Hji_zCzUFOwtafEklScNeehdm8ALU3QLscoPBtjs5MDzJcK-2LZ8IMt0LkJ2hjNDL0ekaGz3U_rkizifISDPEH4CxVg7jc1eUE_3uV7lCpOP1FUs5shJ5eW1qt7XXWLAgRw4QEg7mKNC3CUC-G3EpktN5nY5tnSCeruWdS8djLC_7uzmp-Q6GZjxTCqTFfLM3vM964CxV_polI5T2k6WHs8","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-20 11:48:44.141 +03:00 [DBG] Client is configured to not require consent, no consent is required
2019-08-20 11:48:44.142 +03:00 [DBG] Creating Hybrid Flow response.
2019-08-20 11:48:44.142 +03:00 [DBG] Creating Implicit Flow response.
2019-08-20 11:48:44.143 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 11:48:44.143 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 11:48:44.147 +03:00 [DBG] Authorize endpoint response
{"SubjectId":"1","ClientId":"mvc","RedirectUri":"http://localhost:5002/home/signin-oidc","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9NsCMfxjhxrBm5oIazJE4P2ww4mL2SWzwIaTykmmD0Akt-KiHoOMgrxes1duL2i9q4lvkNX4MGqiADwpe-AaSVLHPYnWFFU49km01VYdCL8Hji_zCzUFOwtafEklScNeehdm8ALU3QLscoPBtjs5MDzJcK-2LZ8IMt0LkJ2hjNDL0ekaGz3U_rkizifISDPEH4CxVg7jc1eUE_3uV7lCpOP1FUs5shJ5eW1qt7XXWLAgRw4QEg7mKNC3CUC-G3EpktN5nY5tnSCeruWdS8djLC_7uzmp-Q6GZjxTCqTFfLM3vM964CxV_polI5T2k6WHs8","Scope":"openid profile afcpayroll offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-08-20 11:48:44.332 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-20 11:48:44.333 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-20 11:48:44.334 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-20 11:48:44.334 +03:00 [DBG] Start token request.
2019-08-20 11:48:44.335 +03:00 [DBG] Start client validation
2019-08-20 11:48:44.336 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-20 11:48:44.336 +03:00 [DBG] Start parsing for secret in post body
2019-08-20 11:48:44.337 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-20 11:48:44.337 +03:00 [DBG] Secret id found: mvc
2019-08-20 11:48:44.338 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:44.338 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-20 11:48:44.339 +03:00 [DBG] Client validation success
2019-08-20 11:48:44.339 +03:00 [DBG] Start token request validation
2019-08-20 11:48:44.340 +03:00 [DBG] Start validation of authorization code token request
2019-08-20 11:48:44.340 +03:00 [DBG] Validation of authorization code token request success
2019-08-20 11:48:44.341 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"0884c45de61672370c79e4b50fbd902cb3ebc77368ee8fb1de81e277247aa25c","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"mvc","client_secret":"***REDACTED***","code":"0884c45de61672370c79e4b50fbd902cb3ebc77368ee8fb1de81e277247aa25c","grant_type":"authorization_code","redirect_uri":"http://localhost:5002/home/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-08-20 11:48:44.348 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:44.348 +03:00 [DBG] Getting claims for access token for client: mvc
2019-08-20 11:48:44.349 +03:00 [DBG] Getting claims for access token for subject: 1
2019-08-20 11:48:44.353 +03:00 [DBG] Creating refresh token
2019-08-20 11:48:44.355 +03:00 [DBG] Setting an absolute lifetime: 2592000
2019-08-20 11:48:44.356 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:44.356 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 11:48:44.357 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 11:48:44.361 +03:00 [DBG] Token request success.
2019-08-20 11:48:44.364 +03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-08-20 11:48:44.365 +03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-08-20 11:48:44.365 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-08-20 11:48:44.366 +03:00 [DBG] Start userinfo request
2019-08-20 11:48:44.366 +03:00 [DBG] Bearer token found in header
2019-08-20 11:48:44.369 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:44.372 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:44.373 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-08-20 11:48:44.374 +03:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1566290924,"exp":1566290984,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","afcpayroll"],"client_id":"mvc","sub":"1","auth_time":1566290868,"idp":"local","name":"alice","email":"alice@email.com","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-08-20 11:48:44.379 +03:00 [DBG] Creating userinfo response
2019-08-20 11:48:44.380 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:48:44.380 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:48:44.381 +03:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 11:48:44.382 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:48:44.382 +03:00 [INF] Profile service returned the following claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 11:48:44.383 +03:00 [DBG] End userinfo request
2019-08-20 11:48:44.431 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-08-20 11:48:44.433 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-08-20 11:48:44.435 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-08-20 11:48:44.436 +03:00 [DBG] Start authorize request
2019-08-20 11:48:44.437 +03:00 [DBG] User in authorize request: 1
2019-08-20 11:48:44.437 +03:00 [DBG] Start authorize request protocol validation
2019-08-20 11:48:44.437 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:44.438 +03:00 [DBG] Checking for PKCE parameters
2019-08-20 11:48:44.438 +03:00 [DBG] No PKCE used.
2019-08-20 11:48:44.439 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-20 11:48:44.440 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/home/signin-oidc","AllowedRedirectUris":["http://localhost:5002/home/signin-oidc"],"SubjectId":"1","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9OjzwJU_SoXYHmRXyFOuzYFmYedttScPx68v0bP76ERICDWqjqShFiayJ5e_NqQIcwWOH1Sh7e_H_upqPvVNwaPbv0AfDctzmJEnAKEud6D2Ct121Cs6j810-JibdDL9VmRDSeFsP_WuGQ9HOzUZ-1bsRI5A7R2s9WGaDDkwTgOpDwp8YddOpvfWn_U85GjKbY5VEWinfizGwbm389o8rYWazqKw4gKgo0PM6XtDZ2e8cP5QyiwH-m7JKMsSbKbeJO_elSsuPsQiuAbqYO4aO6SPa1GPg1zD9q8WBoUFLU8hwfOVYH0aaCL3QITfky8veQ","UiLocales":null,"Nonce":"637018877244154326.OGYwYTk2MWQtMjQ2My00OGViLWJlYjItM2FkYzQzNjVlMmMzZjIzNzlmNWMtN2E5MS00MWM3LThhZTUtNjU0YTBmNDE5NTZi","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"e74d8cbe5a0a3326c07e4e0a82ece454","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/home/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637018877244154326.OGYwYTk2MWQtMjQ2My00OGViLWJlYjItM2FkYzQzNjVlMmMzZjIzNzlmNWMtN2E5MS00MWM3LThhZTUtNjU0YTBmNDE5NTZi","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9OjzwJU_SoXYHmRXyFOuzYFmYedttScPx68v0bP76ERICDWqjqShFiayJ5e_NqQIcwWOH1Sh7e_H_upqPvVNwaPbv0AfDctzmJEnAKEud6D2Ct121Cs6j810-JibdDL9VmRDSeFsP_WuGQ9HOzUZ-1bsRI5A7R2s9WGaDDkwTgOpDwp8YddOpvfWn_U85GjKbY5VEWinfizGwbm389o8rYWazqKw4gKgo0PM6XtDZ2e8cP5QyiwH-m7JKMsSbKbeJO_elSsuPsQiuAbqYO4aO6SPa1GPg1zD9q8WBoUFLU8hwfOVYH0aaCL3QITfky8veQ","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-20 11:48:44.445 +03:00 [DBG] Client is configured to not require consent, no consent is required
2019-08-20 11:48:44.446 +03:00 [DBG] Creating Hybrid Flow response.
2019-08-20 11:48:44.446 +03:00 [DBG] Creating Implicit Flow response.
2019-08-20 11:48:44.447 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 11:48:44.447 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 11:48:44.452 +03:00 [DBG] Authorize endpoint response
{"SubjectId":"1","ClientId":"mvc","RedirectUri":"http://localhost:5002/home/signin-oidc","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9OjzwJU_SoXYHmRXyFOuzYFmYedttScPx68v0bP76ERICDWqjqShFiayJ5e_NqQIcwWOH1Sh7e_H_upqPvVNwaPbv0AfDctzmJEnAKEud6D2Ct121Cs6j810-JibdDL9VmRDSeFsP_WuGQ9HOzUZ-1bsRI5A7R2s9WGaDDkwTgOpDwp8YddOpvfWn_U85GjKbY5VEWinfizGwbm389o8rYWazqKw4gKgo0PM6XtDZ2e8cP5QyiwH-m7JKMsSbKbeJO_elSsuPsQiuAbqYO4aO6SPa1GPg1zD9q8WBoUFLU8hwfOVYH0aaCL3QITfky8veQ","Scope":"openid profile afcpayroll offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-08-20 11:48:44.652 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-20 11:48:44.655 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-20 11:48:44.655 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-20 11:48:44.656 +03:00 [DBG] Start token request.
2019-08-20 11:48:44.656 +03:00 [DBG] Start client validation
2019-08-20 11:48:44.657 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-20 11:48:44.657 +03:00 [DBG] Start parsing for secret in post body
2019-08-20 11:48:44.658 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-20 11:48:44.658 +03:00 [DBG] Secret id found: mvc
2019-08-20 11:48:44.659 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:44.659 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-20 11:48:44.660 +03:00 [DBG] Client validation success
2019-08-20 11:48:44.661 +03:00 [DBG] Start token request validation
2019-08-20 11:48:44.662 +03:00 [DBG] Start validation of authorization code token request
2019-08-20 11:48:44.663 +03:00 [DBG] Validation of authorization code token request success
2019-08-20 11:48:44.664 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"cf4e709c930947bf0f60c737fbc167520661a157e5263f27083943ed05af8dd2","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"mvc","client_secret":"***REDACTED***","code":"cf4e709c930947bf0f60c737fbc167520661a157e5263f27083943ed05af8dd2","grant_type":"authorization_code","redirect_uri":"http://localhost:5002/home/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-08-20 11:48:44.667 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:44.668 +03:00 [DBG] Getting claims for access token for client: mvc
2019-08-20 11:48:44.668 +03:00 [DBG] Getting claims for access token for subject: 1
2019-08-20 11:48:44.672 +03:00 [DBG] Creating refresh token
2019-08-20 11:48:44.673 +03:00 [DBG] Setting an absolute lifetime: 2592000
2019-08-20 11:48:44.674 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:44.674 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 11:48:44.675 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 11:48:44.680 +03:00 [DBG] Token request success.
2019-08-20 11:48:44.683 +03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-08-20 11:48:44.685 +03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-08-20 11:48:44.686 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-08-20 11:48:44.687 +03:00 [DBG] Start userinfo request
2019-08-20 11:48:44.688 +03:00 [DBG] Bearer token found in header
2019-08-20 11:48:44.690 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:44.691 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:44.692 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-08-20 11:48:44.692 +03:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1566290924,"exp":1566290984,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","afcpayroll"],"client_id":"mvc","sub":"1","auth_time":1566290868,"idp":"local","name":"alice","email":"alice@email.com","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-08-20 11:48:44.700 +03:00 [DBG] Creating userinfo response
2019-08-20 11:48:44.700 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:48:44.701 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:48:44.701 +03:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 11:48:44.702 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:48:44.703 +03:00 [INF] Profile service returned the following claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 11:48:44.703 +03:00 [DBG] End userinfo request
2019-08-20 11:48:44.752 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-08-20 11:48:44.755 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-08-20 11:48:44.756 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-08-20 11:48:44.757 +03:00 [DBG] Start authorize request
2019-08-20 11:48:44.757 +03:00 [DBG] User in authorize request: 1
2019-08-20 11:48:44.758 +03:00 [DBG] Start authorize request protocol validation
2019-08-20 11:48:44.758 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:44.758 +03:00 [DBG] Checking for PKCE parameters
2019-08-20 11:48:44.759 +03:00 [DBG] No PKCE used.
2019-08-20 11:48:44.759 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-20 11:48:44.760 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/home/signin-oidc","AllowedRedirectUris":["http://localhost:5002/home/signin-oidc"],"SubjectId":"1","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9MfvOeRV1K92MFYpj92BrkBdsyDmkbQboSAYrpVAyZRmcl0vrUS-514U_651nKUBvbYfu95CSRnaOEXZwTV_KWRjsI1Fd3pSVeEmapoEwpHjFH9WSLe_hDyCWchf3mZBesQ4aOIubic59gy3f4kEGd4VuLgk5cl9MEXdPkrzbNbnSV42y6wxG3PhisdJfSu00WN9SOxCZ_Nnox-CYR3shda2Q2VAFOSpzCftbjtT9WTTqvUFhFjW2ehzJpel2DPnz0PAfEYsJIdUL-OzUlXbQ1jul4fWbWIeu38BR8KlvW34KSNqSWwz85eTOBLPtPU09Y","UiLocales":null,"Nonce":"637018877247345309.NGRjNGQxN2YtODJjMC00MjNjLWI1YTktZGYwNzhkMjdiODFmZmQ1MTRlN2YtZjEyMi00ZjkwLTk0MWMtYmJlYmZhMmUzYmUw","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"e74d8cbe5a0a3326c07e4e0a82ece454","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/home/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637018877247345309.NGRjNGQxN2YtODJjMC00MjNjLWI1YTktZGYwNzhkMjdiODFmZmQ1MTRlN2YtZjEyMi00ZjkwLTk0MWMtYmJlYmZhMmUzYmUw","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9MfvOeRV1K92MFYpj92BrkBdsyDmkbQboSAYrpVAyZRmcl0vrUS-514U_651nKUBvbYfu95CSRnaOEXZwTV_KWRjsI1Fd3pSVeEmapoEwpHjFH9WSLe_hDyCWchf3mZBesQ4aOIubic59gy3f4kEGd4VuLgk5cl9MEXdPkrzbNbnSV42y6wxG3PhisdJfSu00WN9SOxCZ_Nnox-CYR3shda2Q2VAFOSpzCftbjtT9WTTqvUFhFjW2ehzJpel2DPnz0PAfEYsJIdUL-OzUlXbQ1jul4fWbWIeu38BR8KlvW34KSNqSWwz85eTOBLPtPU09Y","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-20 11:48:44.767 +03:00 [DBG] Client is configured to not require consent, no consent is required
2019-08-20 11:48:44.768 +03:00 [DBG] Creating Hybrid Flow response.
2019-08-20 11:48:44.768 +03:00 [DBG] Creating Implicit Flow response.
2019-08-20 11:48:44.769 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 11:48:44.769 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 11:48:44.773 +03:00 [DBG] Authorize endpoint response
{"SubjectId":"1","ClientId":"mvc","RedirectUri":"http://localhost:5002/home/signin-oidc","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9MfvOeRV1K92MFYpj92BrkBdsyDmkbQboSAYrpVAyZRmcl0vrUS-514U_651nKUBvbYfu95CSRnaOEXZwTV_KWRjsI1Fd3pSVeEmapoEwpHjFH9WSLe_hDyCWchf3mZBesQ4aOIubic59gy3f4kEGd4VuLgk5cl9MEXdPkrzbNbnSV42y6wxG3PhisdJfSu00WN9SOxCZ_Nnox-CYR3shda2Q2VAFOSpzCftbjtT9WTTqvUFhFjW2ehzJpel2DPnz0PAfEYsJIdUL-OzUlXbQ1jul4fWbWIeu38BR8KlvW34KSNqSWwz85eTOBLPtPU09Y","Scope":"openid profile afcpayroll offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-08-20 11:48:45.004 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-20 11:48:45.005 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-20 11:48:45.006 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-20 11:48:45.006 +03:00 [DBG] Start token request.
2019-08-20 11:48:45.007 +03:00 [DBG] Start client validation
2019-08-20 11:48:45.007 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-20 11:48:45.008 +03:00 [DBG] Start parsing for secret in post body
2019-08-20 11:48:45.008 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-20 11:48:45.008 +03:00 [DBG] Secret id found: mvc
2019-08-20 11:48:45.009 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:45.010 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-20 11:48:45.011 +03:00 [DBG] Client validation success
2019-08-20 11:48:45.012 +03:00 [DBG] Start token request validation
2019-08-20 11:48:45.012 +03:00 [DBG] Start validation of authorization code token request
2019-08-20 11:48:45.013 +03:00 [DBG] Validation of authorization code token request success
2019-08-20 11:48:45.014 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"25b243ac98e786f5479ababce42b96c39edff0e5a38a77282de5d21d5ab6c43d","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"mvc","client_secret":"***REDACTED***","code":"25b243ac98e786f5479ababce42b96c39edff0e5a38a77282de5d21d5ab6c43d","grant_type":"authorization_code","redirect_uri":"http://localhost:5002/home/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-08-20 11:48:45.019 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:45.019 +03:00 [DBG] Getting claims for access token for client: mvc
2019-08-20 11:48:45.020 +03:00 [DBG] Getting claims for access token for subject: 1
2019-08-20 11:48:45.024 +03:00 [DBG] Creating refresh token
2019-08-20 11:48:45.024 +03:00 [DBG] Setting an absolute lifetime: 2592000
2019-08-20 11:48:45.025 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:48:45.026 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 11:48:45.027 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 11:48:45.031 +03:00 [DBG] Token request success.
2019-08-20 11:49:47.272 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-20 11:49:47.274 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-20 11:49:47.275 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-20 11:49:47.280 +03:00 [DBG] Start discovery request
2019-08-20 11:49:47.320 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-20 11:49:47.322 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-20 11:49:47.322 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-20 11:49:47.323 +03:00 [DBG] Start key discovery request
2019-08-20 11:49:49.648 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-20 11:49:49.649 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-20 11:49:49.650 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-20 11:49:49.651 +03:00 [DBG] Start token request.
2019-08-20 11:49:49.651 +03:00 [DBG] Start client validation
2019-08-20 11:49:49.651 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-20 11:49:49.652 +03:00 [DBG] Start parsing for secret in post body
2019-08-20 11:49:49.654 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-20 11:49:49.655 +03:00 [DBG] Secret id found: mvc
2019-08-20 11:49:49.656 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:49:49.656 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-20 11:49:49.657 +03:00 [DBG] Client validation success
2019-08-20 11:49:49.658 +03:00 [DBG] Start token request validation
2019-08-20 11:49:49.658 +03:00 [DBG] Start validation of refresh token request
2019-08-20 11:49:49.660 +03:00 [DBG] Token validation success
{"ClientId":"mvc","ClientName":"MVC Client","ValidateLifetime":false,"AccessTokenType":null,"ExpectedScope":null,"TokenHandle":null,"JwtId":null,"Claims":{"sub":"1","client_id":"mvc","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"auth_time":1566290868,"idp":"local","amr":"pwd","name":"alice","email":"alice@email.com"},"$type":"TokenValidationLog"}
2019-08-20 11:49:49.664 +03:00 [DBG] Validation of refresh token request success
2019-08-20 11:49:49.665 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"refresh_token","Scopes":null,"AuthorizationCode":null,"RefreshToken":"78d8e83f931428b7573af259e75821a6203ff5f8cc0b9271044d811afa2c996b","UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"refresh_token","refresh_token":"***REDACTED***","client_id":"mvc","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2019-08-20 11:49:49.672 +03:00 [DBG] Updating refresh token
2019-08-20 11:49:49.672 +03:00 [DBG] Token usage is one-time only. Generating new handle
2019-08-20 11:49:49.673 +03:00 [DBG] Created refresh token in store
2019-08-20 11:49:49.675 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 11:49:49.676 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 11:49:49.681 +03:00 [DBG] Token request success.
2019-08-20 11:50:16.285 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-20 11:50:16.286 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-20 11:50:16.287 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-20 11:50:16.287 +03:00 [DBG] Start discovery request
2019-08-20 11:50:16.330 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-20 11:50:16.331 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-20 11:50:16.331 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-20 11:50:16.332 +03:00 [DBG] Start key discovery request
2019-08-20 11:50:16.387 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-08-20 11:50:16.388 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-08-20 11:50:16.389 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-08-20 11:50:16.389 +03:00 [DBG] Start authorize request
2019-08-20 11:50:16.391 +03:00 [DBG] No user present in authorize request
2019-08-20 11:50:16.391 +03:00 [DBG] Start authorize request protocol validation
2019-08-20 11:50:16.392 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:50:16.393 +03:00 [DBG] Checking for PKCE parameters
2019-08-20 11:50:16.393 +03:00 [DBG] No PKCE used.
2019-08-20 11:50:16.394 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-20 11:50:16.395 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/home/signin-oidc","AllowedRedirectUris":["http://localhost:5002/home/signin-oidc"],"SubjectId":"anonymous","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9OWk4MY3BB5jUgYMDutclLa0fjiRFqwDJxartylYUPTHDRUk9PiOMRT9kkCRgZlhhgJB7JlmcqdfucN5vqF6z3TKh999O41vNsl3VU-oTbTOp19BZCdx5cQDTS_mQXyHzkmGOwFQx33wyf2X6eXuaKHudrqZXMBJgHSiXYju8L7IqZFUUdXcIToA2uoAyHzkira8C6Y5P-ZQxsQX_UF6GG7glDC23he8x-VSBZt04tn6FpOfyKHbiT07EwbKoQ3jxe6Fs1alLbNEId8xygR62VefjCdMyF7lRpREbqblJbuk7ZCdB1wEH6IPwDgh-fqDhM","UiLocales":null,"Nonce":"637018878163507235.NTYwMDFiZTQtOTk5NS00MmI5LTk4YTktYzJlZTRiYTU3MDNjNzk4MDhjMTctMDVkZS00MTVkLTg2M2QtODUxMGUxZGZlNTZi","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/home/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637018878163507235.NTYwMDFiZTQtOTk5NS00MmI5LTk4YTktYzJlZTRiYTU3MDNjNzk4MDhjMTctMDVkZS00MTVkLTg2M2QtODUxMGUxZGZlNTZi","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9OWk4MY3BB5jUgYMDutclLa0fjiRFqwDJxartylYUPTHDRUk9PiOMRT9kkCRgZlhhgJB7JlmcqdfucN5vqF6z3TKh999O41vNsl3VU-oTbTOp19BZCdx5cQDTS_mQXyHzkmGOwFQx33wyf2X6eXuaKHudrqZXMBJgHSiXYju8L7IqZFUUdXcIToA2uoAyHzkira8C6Y5P-ZQxsQX_UF6GG7glDC23he8x-VSBZt04tn6FpOfyKHbiT07EwbKoQ3jxe6Fs1alLbNEId8xygR62VefjCdMyF7lRpREbqblJbuk7ZCdB1wEH6IPwDgh-fqDhM","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-20 11:50:16.403 +03:00 [INF] Showing login: User is not authenticated
2019-08-20 11:50:16.418 +03:00 [DBG] Start authorize request protocol validation
2019-08-20 11:50:16.419 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:50:16.419 +03:00 [DBG] Checking for PKCE parameters
2019-08-20 11:50:16.420 +03:00 [DBG] No PKCE used.
2019-08-20 11:50:16.420 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-20 11:50:16.421 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:50:23.936 +03:00 [DBG] CORS request made for path: /account/login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-08-20 11:50:23.938 +03:00 [DBG] Start authorize request protocol validation
2019-08-20 11:50:23.940 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:50:23.943 +03:00 [DBG] Checking for PKCE parameters
2019-08-20 11:50:23.944 +03:00 [DBG] No PKCE used.
2019-08-20 11:50:23.945 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-20 11:50:23.946 +03:00 [DBG] Augmenting SignInContext
2019-08-20 11:50:23.946 +03:00 [DBG] Adding idp claim with value: local
2019-08-20 11:50:23.947 +03:00 [DBG] Adding amr claim with value: pwd
2019-08-20 11:50:23.948 +03:00 [INF] AuthenticationScheme: idsrv signed in.
2019-08-20 11:50:23.948 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:50:23.965 +03:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-08-20 11:50:23.966 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-08-20 11:50:23.967 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-08-20 11:50:23.967 +03:00 [DBG] Start authorize callback request
2019-08-20 11:50:23.968 +03:00 [DBG] User in authorize request: 1
2019-08-20 11:50:23.968 +03:00 [DBG] Start authorize request protocol validation
2019-08-20 11:50:23.969 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:50:23.970 +03:00 [DBG] Checking for PKCE parameters
2019-08-20 11:50:23.970 +03:00 [DBG] No PKCE used.
2019-08-20 11:50:23.971 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-20 11:50:23.971 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/home/signin-oidc","AllowedRedirectUris":["http://localhost:5002/home/signin-oidc"],"SubjectId":"1","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9OWk4MY3BB5jUgYMDutclLa0fjiRFqwDJxartylYUPTHDRUk9PiOMRT9kkCRgZlhhgJB7JlmcqdfucN5vqF6z3TKh999O41vNsl3VU-oTbTOp19BZCdx5cQDTS_mQXyHzkmGOwFQx33wyf2X6eXuaKHudrqZXMBJgHSiXYju8L7IqZFUUdXcIToA2uoAyHzkira8C6Y5P-ZQxsQX_UF6GG7glDC23he8x-VSBZt04tn6FpOfyKHbiT07EwbKoQ3jxe6Fs1alLbNEId8xygR62VefjCdMyF7lRpREbqblJbuk7ZCdB1wEH6IPwDgh-fqDhM","UiLocales":null,"Nonce":"637018878163507235.NTYwMDFiZTQtOTk5NS00MmI5LTk4YTktYzJlZTRiYTU3MDNjNzk4MDhjMTctMDVkZS00MTVkLTg2M2QtODUxMGUxZGZlNTZi","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"3ff3265fcad8e2c46e85bec92424ed39","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/home/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637018878163507235.NTYwMDFiZTQtOTk5NS00MmI5LTk4YTktYzJlZTRiYTU3MDNjNzk4MDhjMTctMDVkZS00MTVkLTg2M2QtODUxMGUxZGZlNTZi","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9OWk4MY3BB5jUgYMDutclLa0fjiRFqwDJxartylYUPTHDRUk9PiOMRT9kkCRgZlhhgJB7JlmcqdfucN5vqF6z3TKh999O41vNsl3VU-oTbTOp19BZCdx5cQDTS_mQXyHzkmGOwFQx33wyf2X6eXuaKHudrqZXMBJgHSiXYju8L7IqZFUUdXcIToA2uoAyHzkira8C6Y5P-ZQxsQX_UF6GG7glDC23he8x-VSBZt04tn6FpOfyKHbiT07EwbKoQ3jxe6Fs1alLbNEId8xygR62VefjCdMyF7lRpREbqblJbuk7ZCdB1wEH6IPwDgh-fqDhM","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-20 11:50:23.980 +03:00 [DBG] Client is configured to not require consent, no consent is required
2019-08-20 11:50:23.980 +03:00 [DBG] Creating Hybrid Flow response.
2019-08-20 11:50:23.981 +03:00 [DBG] Creating Implicit Flow response.
2019-08-20 11:50:23.982 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 11:50:23.982 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 11:50:23.987 +03:00 [DBG] Authorize endpoint response
{"SubjectId":"1","ClientId":"mvc","RedirectUri":"http://localhost:5002/home/signin-oidc","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9OWk4MY3BB5jUgYMDutclLa0fjiRFqwDJxartylYUPTHDRUk9PiOMRT9kkCRgZlhhgJB7JlmcqdfucN5vqF6z3TKh999O41vNsl3VU-oTbTOp19BZCdx5cQDTS_mQXyHzkmGOwFQx33wyf2X6eXuaKHudrqZXMBJgHSiXYju8L7IqZFUUdXcIToA2uoAyHzkira8C6Y5P-ZQxsQX_UF6GG7glDC23he8x-VSBZt04tn6FpOfyKHbiT07EwbKoQ3jxe6Fs1alLbNEId8xygR62VefjCdMyF7lRpREbqblJbuk7ZCdB1wEH6IPwDgh-fqDhM","Scope":"openid profile afcpayroll offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-08-20 11:50:23.989 +03:00 [DBG] Augmenting SignInContext
2019-08-20 11:50:23.991 +03:00 [INF] AuthenticationScheme: idsrv signed in.
2019-08-20 11:50:24.301 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-20 11:50:24.303 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-20 11:50:24.303 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-20 11:50:24.304 +03:00 [DBG] Start token request.
2019-08-20 11:50:24.304 +03:00 [DBG] Start client validation
2019-08-20 11:50:24.305 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-20 11:50:24.305 +03:00 [DBG] Start parsing for secret in post body
2019-08-20 11:50:24.306 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-20 11:50:24.306 +03:00 [DBG] Secret id found: mvc
2019-08-20 11:50:24.307 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:50:24.307 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-20 11:50:24.308 +03:00 [DBG] Client validation success
2019-08-20 11:50:24.308 +03:00 [DBG] Start token request validation
2019-08-20 11:50:24.308 +03:00 [DBG] Start validation of authorization code token request
2019-08-20 11:50:24.309 +03:00 [DBG] Validation of authorization code token request success
2019-08-20 11:50:24.310 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"f8f772b03f7e6ca12073d6281275cdb443b5e738764dccca91e5bbd5a734461a","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"mvc","client_secret":"***REDACTED***","code":"f8f772b03f7e6ca12073d6281275cdb443b5e738764dccca91e5bbd5a734461a","grant_type":"authorization_code","redirect_uri":"http://localhost:5002/home/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-08-20 11:50:24.317 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:50:24.318 +03:00 [DBG] Getting claims for access token for client: mvc
2019-08-20 11:50:24.318 +03:00 [DBG] Getting claims for access token for subject: 1
2019-08-20 11:50:24.322 +03:00 [DBG] Creating refresh token
2019-08-20 11:50:24.323 +03:00 [DBG] Setting an absolute lifetime: 2592000
2019-08-20 11:50:24.323 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:50:24.324 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 11:50:24.326 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 11:50:24.330 +03:00 [DBG] Token request success.
2019-08-20 11:50:24.338 +03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-08-20 11:50:24.339 +03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-08-20 11:50:24.340 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-08-20 11:50:24.340 +03:00 [DBG] Start userinfo request
2019-08-20 11:50:24.341 +03:00 [DBG] Bearer token found in header
2019-08-20 11:50:24.343 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:50:24.344 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:50:24.345 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-08-20 11:50:24.346 +03:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1566291024,"exp":1566291084,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","afcpayroll"],"client_id":"mvc","sub":"1","auth_time":1566291023,"idp":"local","name":"alice","email":"alice@email.com","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-08-20 11:50:24.351 +03:00 [DBG] Creating userinfo response
2019-08-20 11:50:24.351 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:50:24.352 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:50:24.352 +03:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 11:50:24.353 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:50:24.353 +03:00 [INF] Profile service returned the following claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 11:50:24.354 +03:00 [DBG] End userinfo request
2019-08-20 11:50:48.165 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-08-20 11:50:48.166 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-08-20 11:50:48.167 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-08-20 11:50:48.167 +03:00 [DBG] Start authorize request
2019-08-20 11:50:48.168 +03:00 [DBG] User in authorize request: 1
2019-08-20 11:50:48.168 +03:00 [DBG] Start authorize request protocol validation
2019-08-20 11:50:48.169 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:50:48.169 +03:00 [DBG] Checking for PKCE parameters
2019-08-20 11:50:48.170 +03:00 [DBG] No PKCE used.
2019-08-20 11:50:48.172 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-20 11:50:48.173 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/home/signin-oidc","AllowedRedirectUris":["http://localhost:5002/home/signin-oidc"],"SubjectId":"1","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9MnnC9gG6OW0fhEHGk78IF1i4rsgmNjHqgW0OLaxs_CF7uRsA51XOiJsB4cKFwSAfOILskYTwpxdh6gFyuwT3nhXriLSttyVWqQLVv94GJuzIRj6hA_4XjOlXUoVfUH2K0lhVLJRg-tmZ605cwCq3DOEuS_Pdp85mgv0sbQvyUHHtRoa_ygbXg5s-26qwXyB7LHaphuMb9gkoACBED_eg9LVkagaiKN1FTIn8mpFNmhrnQm6HnWQ_97mbi558DvYPhHVSFsQRWbwJSejm4tU-a9ICoyyeQ1KnKMqjdAhCZfBaH93Y-14Xd3HbzDtbIIDJs","UiLocales":null,"Nonce":"637018878481479371.MmY2NDEyZDEtNWFjMC00YTQ4LWJkN2ItNmVmZjA1YTJkZGQ4NzA0Yjk3YWEtOTc0ZS00MTJiLTg4YTktNDQ1ZmUxYTA1M2I2","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"3ff3265fcad8e2c46e85bec92424ed39","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/home/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637018878481479371.MmY2NDEyZDEtNWFjMC00YTQ4LWJkN2ItNmVmZjA1YTJkZGQ4NzA0Yjk3YWEtOTc0ZS00MTJiLTg4YTktNDQ1ZmUxYTA1M2I2","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9MnnC9gG6OW0fhEHGk78IF1i4rsgmNjHqgW0OLaxs_CF7uRsA51XOiJsB4cKFwSAfOILskYTwpxdh6gFyuwT3nhXriLSttyVWqQLVv94GJuzIRj6hA_4XjOlXUoVfUH2K0lhVLJRg-tmZ605cwCq3DOEuS_Pdp85mgv0sbQvyUHHtRoa_ygbXg5s-26qwXyB7LHaphuMb9gkoACBED_eg9LVkagaiKN1FTIn8mpFNmhrnQm6HnWQ_97mbi558DvYPhHVSFsQRWbwJSejm4tU-a9ICoyyeQ1KnKMqjdAhCZfBaH93Y-14Xd3HbzDtbIIDJs","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-20 11:50:48.180 +03:00 [DBG] Client is configured to not require consent, no consent is required
2019-08-20 11:50:48.180 +03:00 [DBG] Creating Hybrid Flow response.
2019-08-20 11:50:48.181 +03:00 [DBG] Creating Implicit Flow response.
2019-08-20 11:50:48.183 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 11:50:48.185 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 11:50:48.189 +03:00 [DBG] Authorize endpoint response
{"SubjectId":"1","ClientId":"mvc","RedirectUri":"http://localhost:5002/home/signin-oidc","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9MnnC9gG6OW0fhEHGk78IF1i4rsgmNjHqgW0OLaxs_CF7uRsA51XOiJsB4cKFwSAfOILskYTwpxdh6gFyuwT3nhXriLSttyVWqQLVv94GJuzIRj6hA_4XjOlXUoVfUH2K0lhVLJRg-tmZ605cwCq3DOEuS_Pdp85mgv0sbQvyUHHtRoa_ygbXg5s-26qwXyB7LHaphuMb9gkoACBED_eg9LVkagaiKN1FTIn8mpFNmhrnQm6HnWQ_97mbi558DvYPhHVSFsQRWbwJSejm4tU-a9ICoyyeQ1KnKMqjdAhCZfBaH93Y-14Xd3HbzDtbIIDJs","Scope":"openid profile afcpayroll offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-08-20 11:50:48.407 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-20 11:50:48.408 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-20 11:50:48.409 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-20 11:50:48.409 +03:00 [DBG] Start token request.
2019-08-20 11:50:48.410 +03:00 [DBG] Start client validation
2019-08-20 11:50:48.410 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-20 11:50:48.411 +03:00 [DBG] Start parsing for secret in post body
2019-08-20 11:50:48.411 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-20 11:50:48.412 +03:00 [DBG] Secret id found: mvc
2019-08-20 11:50:48.412 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:50:48.413 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-20 11:50:48.414 +03:00 [DBG] Client validation success
2019-08-20 11:50:48.414 +03:00 [DBG] Start token request validation
2019-08-20 11:50:48.414 +03:00 [DBG] Start validation of authorization code token request
2019-08-20 11:50:48.415 +03:00 [DBG] Validation of authorization code token request success
2019-08-20 11:50:48.416 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"845221f3ae3497b2793e0814db37d53cb13c6c499f31518a83f075426bf1cef7","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"mvc","client_secret":"***REDACTED***","code":"845221f3ae3497b2793e0814db37d53cb13c6c499f31518a83f075426bf1cef7","grant_type":"authorization_code","redirect_uri":"http://localhost:5002/home/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-08-20 11:50:48.419 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:50:48.420 +03:00 [DBG] Getting claims for access token for client: mvc
2019-08-20 11:50:48.420 +03:00 [DBG] Getting claims for access token for subject: 1
2019-08-20 11:50:48.425 +03:00 [DBG] Creating refresh token
2019-08-20 11:50:48.426 +03:00 [DBG] Setting an absolute lifetime: 2592000
2019-08-20 11:50:48.427 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:50:48.427 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 11:50:48.428 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 11:50:48.432 +03:00 [DBG] Token request success.
2019-08-20 11:50:48.438 +03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-08-20 11:50:48.439 +03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-08-20 11:50:48.440 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-08-20 11:50:48.440 +03:00 [DBG] Start userinfo request
2019-08-20 11:50:48.441 +03:00 [DBG] Bearer token found in header
2019-08-20 11:50:48.443 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:50:48.444 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:50:48.444 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-08-20 11:50:48.445 +03:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1566291048,"exp":1566291108,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","afcpayroll"],"client_id":"mvc","sub":"1","auth_time":1566291023,"idp":"local","name":"alice","email":"alice@email.com","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-08-20 11:50:48.451 +03:00 [DBG] Creating userinfo response
2019-08-20 11:50:48.451 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:50:48.452 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:50:48.452 +03:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 11:50:48.453 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:50:48.453 +03:00 [INF] Profile service returned the following claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 11:50:48.454 +03:00 [DBG] End userinfo request
2019-08-20 11:51:07.792 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-08-20 11:51:07.794 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-08-20 11:51:07.795 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-08-20 11:51:07.796 +03:00 [DBG] Start authorize request
2019-08-20 11:51:07.797 +03:00 [DBG] User in authorize request: 1
2019-08-20 11:51:07.797 +03:00 [DBG] Start authorize request protocol validation
2019-08-20 11:51:07.798 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:51:07.798 +03:00 [DBG] Checking for PKCE parameters
2019-08-20 11:51:07.799 +03:00 [DBG] No PKCE used.
2019-08-20 11:51:07.799 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-20 11:51:07.800 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/home/signin-oidc","AllowedRedirectUris":["http://localhost:5002/home/signin-oidc"],"SubjectId":"1","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9Px6ygU-j88LiXAan3wpyXKFkWAOwJkBKnLbmGrIbWVXUeio60Xre7ThOteCk53Kk7Ya9I0vPFWm86yLqxXmA5T0iGfKmWIHHE2xWbGeu-5DgCiMHui_LsczbL4YYLlA0C0dK1xgrgW20b79l7JUfzwTjAwnifeZdIDr2nRAz-mz968oSz7aMOe-hR45XOFfPIEasSl-ob1pMyvMOvkk4DkrkNPBkzXMQPZIQ4dPu2szX_tnygJMlksyuR4ZgP_fOwZnoxVbz-NSl7N8L9EVEyoSDByBrUdjEDvTZSyhyfkUUSHMiC_lL27XQNOWJkX0t8","UiLocales":null,"Nonce":"637018878677747598.YjJlODNhNjUtMjVkYi00OTM0LTk4MmUtNzIwOGZkZmIwZjk0MGY1ZDZiYWQtZDI0ZS00NjM2LWJiODQtZWIzYzAzYmQxMjlm","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"3ff3265fcad8e2c46e85bec92424ed39","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/home/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637018878677747598.YjJlODNhNjUtMjVkYi00OTM0LTk4MmUtNzIwOGZkZmIwZjk0MGY1ZDZiYWQtZDI0ZS00NjM2LWJiODQtZWIzYzAzYmQxMjlm","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9Px6ygU-j88LiXAan3wpyXKFkWAOwJkBKnLbmGrIbWVXUeio60Xre7ThOteCk53Kk7Ya9I0vPFWm86yLqxXmA5T0iGfKmWIHHE2xWbGeu-5DgCiMHui_LsczbL4YYLlA0C0dK1xgrgW20b79l7JUfzwTjAwnifeZdIDr2nRAz-mz968oSz7aMOe-hR45XOFfPIEasSl-ob1pMyvMOvkk4DkrkNPBkzXMQPZIQ4dPu2szX_tnygJMlksyuR4ZgP_fOwZnoxVbz-NSl7N8L9EVEyoSDByBrUdjEDvTZSyhyfkUUSHMiC_lL27XQNOWJkX0t8","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-20 11:51:07.808 +03:00 [DBG] Client is configured to not require consent, no consent is required
2019-08-20 11:51:07.808 +03:00 [DBG] Creating Hybrid Flow response.
2019-08-20 11:51:07.809 +03:00 [DBG] Creating Implicit Flow response.
2019-08-20 11:51:07.810 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 11:51:07.810 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 11:51:07.815 +03:00 [DBG] Authorize endpoint response
{"SubjectId":"1","ClientId":"mvc","RedirectUri":"http://localhost:5002/home/signin-oidc","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9Px6ygU-j88LiXAan3wpyXKFkWAOwJkBKnLbmGrIbWVXUeio60Xre7ThOteCk53Kk7Ya9I0vPFWm86yLqxXmA5T0iGfKmWIHHE2xWbGeu-5DgCiMHui_LsczbL4YYLlA0C0dK1xgrgW20b79l7JUfzwTjAwnifeZdIDr2nRAz-mz968oSz7aMOe-hR45XOFfPIEasSl-ob1pMyvMOvkk4DkrkNPBkzXMQPZIQ4dPu2szX_tnygJMlksyuR4ZgP_fOwZnoxVbz-NSl7N8L9EVEyoSDByBrUdjEDvTZSyhyfkUUSHMiC_lL27XQNOWJkX0t8","Scope":"openid profile afcpayroll offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-08-20 11:51:08.030 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-20 11:51:08.032 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-20 11:51:08.033 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-20 11:51:08.033 +03:00 [DBG] Start token request.
2019-08-20 11:51:08.034 +03:00 [DBG] Start client validation
2019-08-20 11:51:08.034 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-20 11:51:08.035 +03:00 [DBG] Start parsing for secret in post body
2019-08-20 11:51:08.036 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-20 11:51:08.036 +03:00 [DBG] Secret id found: mvc
2019-08-20 11:51:08.037 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:51:08.037 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-20 11:51:08.038 +03:00 [DBG] Client validation success
2019-08-20 11:51:08.038 +03:00 [DBG] Start token request validation
2019-08-20 11:51:08.039 +03:00 [DBG] Start validation of authorization code token request
2019-08-20 11:51:08.039 +03:00 [DBG] Validation of authorization code token request success
2019-08-20 11:51:08.040 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"1d139da8a95a5d9dd6f1c56a58ce435771e573958364d41c5ecfaea9a6495f0a","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"mvc","client_secret":"***REDACTED***","code":"1d139da8a95a5d9dd6f1c56a58ce435771e573958364d41c5ecfaea9a6495f0a","grant_type":"authorization_code","redirect_uri":"http://localhost:5002/home/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-08-20 11:51:08.045 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:51:08.046 +03:00 [DBG] Getting claims for access token for client: mvc
2019-08-20 11:51:08.047 +03:00 [DBG] Getting claims for access token for subject: 1
2019-08-20 11:51:08.051 +03:00 [DBG] Creating refresh token
2019-08-20 11:51:08.051 +03:00 [DBG] Setting an absolute lifetime: 2592000
2019-08-20 11:51:08.052 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:51:08.053 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 11:51:08.053 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 11:51:08.057 +03:00 [DBG] Token request success.
2019-08-20 11:51:08.060 +03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-08-20 11:51:08.062 +03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-08-20 11:51:08.063 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-08-20 11:51:08.063 +03:00 [DBG] Start userinfo request
2019-08-20 11:51:08.064 +03:00 [DBG] Bearer token found in header
2019-08-20 11:51:08.066 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:51:08.067 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:51:08.067 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-08-20 11:51:08.068 +03:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1566291068,"exp":1566291128,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","afcpayroll"],"client_id":"mvc","sub":"1","auth_time":1566291023,"idp":"local","name":"alice","email":"alice@email.com","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-08-20 11:51:08.072 +03:00 [DBG] Creating userinfo response
2019-08-20 11:51:08.073 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:51:08.073 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:51:08.074 +03:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 11:51:08.075 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:51:08.076 +03:00 [INF] Profile service returned the following claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 11:51:08.077 +03:00 [DBG] End userinfo request
2019-08-20 11:51:36.429 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-08-20 11:51:36.431 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-08-20 11:51:36.431 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-08-20 11:51:36.432 +03:00 [DBG] Start authorize request
2019-08-20 11:51:36.432 +03:00 [DBG] No user present in authorize request
2019-08-20 11:51:36.433 +03:00 [DBG] Start authorize request protocol validation
2019-08-20 11:51:36.434 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:51:36.436 +03:00 [DBG] Checking for PKCE parameters
2019-08-20 11:51:36.437 +03:00 [DBG] No PKCE used.
2019-08-20 11:51:36.437 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-20 11:51:36.438 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/home/signin-oidc","AllowedRedirectUris":["http://localhost:5002/home/signin-oidc"],"SubjectId":"anonymous","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9Nrzr3fwCFLq4qeaHbKrkYM84wlMYDwMmjNqK7RaW5oYDQLKoavsULxdf5PTdq9_BdeIHlzIyXMi4jkAEGmjMVValjIWkgRdOUaNvuJeVZ7spi250DpLOSOCJgYYz7gUP9pxNjH4KjICo0Z2N3NkiFmldio71cP9F7eXmtAanXpSa3utT9aBrW6x005fnNw7X-vNXkAdnIG9-fodTpgpXU5UlD2bVO61fA_9c_RQd1bAZRZAZgdET5KYzH3nomqhmbATusqMxhQX-c289sZDs6py63mnbDMpDdre0S6jxJ51VvC64XilzpI31DvjMVGphU","UiLocales":null,"Nonce":"637018878963683466.MzhjNWE1NTQtNTE1ZS00N2FmLWE0MzItZjBkM2NhODEzZDk3OGRlNDY3ODktMGY1Yi00NjExLTgwMjEtMjY3ZjQxZWU4NTEy","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/home/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637018878963683466.MzhjNWE1NTQtNTE1ZS00N2FmLWE0MzItZjBkM2NhODEzZDk3OGRlNDY3ODktMGY1Yi00NjExLTgwMjEtMjY3ZjQxZWU4NTEy","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9Nrzr3fwCFLq4qeaHbKrkYM84wlMYDwMmjNqK7RaW5oYDQLKoavsULxdf5PTdq9_BdeIHlzIyXMi4jkAEGmjMVValjIWkgRdOUaNvuJeVZ7spi250DpLOSOCJgYYz7gUP9pxNjH4KjICo0Z2N3NkiFmldio71cP9F7eXmtAanXpSa3utT9aBrW6x005fnNw7X-vNXkAdnIG9-fodTpgpXU5UlD2bVO61fA_9c_RQd1bAZRZAZgdET5KYzH3nomqhmbATusqMxhQX-c289sZDs6py63mnbDMpDdre0S6jxJ51VvC64XilzpI31DvjMVGphU","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-20 11:51:36.446 +03:00 [INF] Showing login: User is not authenticated
2019-08-20 11:51:36.457 +03:00 [DBG] Start authorize request protocol validation
2019-08-20 11:51:36.459 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:51:36.460 +03:00 [DBG] Checking for PKCE parameters
2019-08-20 11:51:36.460 +03:00 [DBG] No PKCE used.
2019-08-20 11:51:36.461 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-20 11:51:36.461 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:53:26.412 +03:00 [DBG] CORS request made for path: /account/login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-08-20 11:53:26.417 +03:00 [DBG] Start authorize request protocol validation
2019-08-20 11:53:26.419 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:53:26.421 +03:00 [DBG] Checking for PKCE parameters
2019-08-20 11:53:26.422 +03:00 [DBG] No PKCE used.
2019-08-20 11:53:26.422 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-20 11:53:26.423 +03:00 [DBG] Augmenting SignInContext
2019-08-20 11:53:26.424 +03:00 [DBG] Adding idp claim with value: local
2019-08-20 11:53:26.425 +03:00 [DBG] Adding amr claim with value: pwd
2019-08-20 11:53:26.426 +03:00 [INF] AuthenticationScheme: idsrv signed in.
2019-08-20 11:53:26.427 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:53:26.442 +03:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-08-20 11:53:26.443 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-08-20 11:53:26.444 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-08-20 11:53:26.445 +03:00 [DBG] Start authorize callback request
2019-08-20 11:53:26.446 +03:00 [DBG] User in authorize request: 1
2019-08-20 11:53:26.446 +03:00 [DBG] Start authorize request protocol validation
2019-08-20 11:53:26.447 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:53:26.447 +03:00 [DBG] Checking for PKCE parameters
2019-08-20 11:53:26.448 +03:00 [DBG] No PKCE used.
2019-08-20 11:53:26.448 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-20 11:53:26.449 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/home/signin-oidc","AllowedRedirectUris":["http://localhost:5002/home/signin-oidc"],"SubjectId":"1","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9Nrzr3fwCFLq4qeaHbKrkYM84wlMYDwMmjNqK7RaW5oYDQLKoavsULxdf5PTdq9_BdeIHlzIyXMi4jkAEGmjMVValjIWkgRdOUaNvuJeVZ7spi250DpLOSOCJgYYz7gUP9pxNjH4KjICo0Z2N3NkiFmldio71cP9F7eXmtAanXpSa3utT9aBrW6x005fnNw7X-vNXkAdnIG9-fodTpgpXU5UlD2bVO61fA_9c_RQd1bAZRZAZgdET5KYzH3nomqhmbATusqMxhQX-c289sZDs6py63mnbDMpDdre0S6jxJ51VvC64XilzpI31DvjMVGphU","UiLocales":null,"Nonce":"637018878963683466.MzhjNWE1NTQtNTE1ZS00N2FmLWE0MzItZjBkM2NhODEzZDk3OGRlNDY3ODktMGY1Yi00NjExLTgwMjEtMjY3ZjQxZWU4NTEy","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"0b5dc8ee77d9c4c7c2f92d1d23ba7b3a","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/home/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637018878963683466.MzhjNWE1NTQtNTE1ZS00N2FmLWE0MzItZjBkM2NhODEzZDk3OGRlNDY3ODktMGY1Yi00NjExLTgwMjEtMjY3ZjQxZWU4NTEy","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9Nrzr3fwCFLq4qeaHbKrkYM84wlMYDwMmjNqK7RaW5oYDQLKoavsULxdf5PTdq9_BdeIHlzIyXMi4jkAEGmjMVValjIWkgRdOUaNvuJeVZ7spi250DpLOSOCJgYYz7gUP9pxNjH4KjICo0Z2N3NkiFmldio71cP9F7eXmtAanXpSa3utT9aBrW6x005fnNw7X-vNXkAdnIG9-fodTpgpXU5UlD2bVO61fA_9c_RQd1bAZRZAZgdET5KYzH3nomqhmbATusqMxhQX-c289sZDs6py63mnbDMpDdre0S6jxJ51VvC64XilzpI31DvjMVGphU","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-20 11:53:26.464 +03:00 [DBG] Client is configured to not require consent, no consent is required
2019-08-20 11:53:26.464 +03:00 [DBG] Creating Hybrid Flow response.
2019-08-20 11:53:26.465 +03:00 [DBG] Creating Implicit Flow response.
2019-08-20 11:53:26.466 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 11:53:26.466 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 11:53:26.471 +03:00 [DBG] Authorize endpoint response
{"SubjectId":"1","ClientId":"mvc","RedirectUri":"http://localhost:5002/home/signin-oidc","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9Nrzr3fwCFLq4qeaHbKrkYM84wlMYDwMmjNqK7RaW5oYDQLKoavsULxdf5PTdq9_BdeIHlzIyXMi4jkAEGmjMVValjIWkgRdOUaNvuJeVZ7spi250DpLOSOCJgYYz7gUP9pxNjH4KjICo0Z2N3NkiFmldio71cP9F7eXmtAanXpSa3utT9aBrW6x005fnNw7X-vNXkAdnIG9-fodTpgpXU5UlD2bVO61fA_9c_RQd1bAZRZAZgdET5KYzH3nomqhmbATusqMxhQX-c289sZDs6py63mnbDMpDdre0S6jxJ51VvC64XilzpI31DvjMVGphU","Scope":"openid profile afcpayroll offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-08-20 11:53:26.474 +03:00 [DBG] Augmenting SignInContext
2019-08-20 11:53:26.475 +03:00 [INF] AuthenticationScheme: idsrv signed in.
2019-08-20 11:53:26.714 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-20 11:53:26.715 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-20 11:53:26.716 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-20 11:53:26.717 +03:00 [DBG] Start token request.
2019-08-20 11:53:26.717 +03:00 [DBG] Start client validation
2019-08-20 11:53:26.717 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-20 11:53:26.718 +03:00 [DBG] Start parsing for secret in post body
2019-08-20 11:53:26.718 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-20 11:53:26.719 +03:00 [DBG] Secret id found: mvc
2019-08-20 11:53:26.719 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:53:26.720 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-20 11:53:26.720 +03:00 [DBG] Client validation success
2019-08-20 11:53:26.721 +03:00 [DBG] Start token request validation
2019-08-20 11:53:26.721 +03:00 [DBG] Start validation of authorization code token request
2019-08-20 11:53:26.722 +03:00 [DBG] Validation of authorization code token request success
2019-08-20 11:53:26.722 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"5b50e179bce12330598882bcae8c4abf07b038038b47ed557811d7997ad700bc","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"mvc","client_secret":"***REDACTED***","code":"5b50e179bce12330598882bcae8c4abf07b038038b47ed557811d7997ad700bc","grant_type":"authorization_code","redirect_uri":"http://localhost:5002/home/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-08-20 11:53:26.726 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:53:26.726 +03:00 [DBG] Getting claims for access token for client: mvc
2019-08-20 11:53:26.727 +03:00 [DBG] Getting claims for access token for subject: 1
2019-08-20 11:53:26.731 +03:00 [DBG] Creating refresh token
2019-08-20 11:53:26.731 +03:00 [DBG] Setting an absolute lifetime: 2592000
2019-08-20 11:53:26.731 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:53:26.732 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 11:53:26.733 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 11:53:26.736 +03:00 [DBG] Token request success.
2019-08-20 11:53:26.739 +03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-08-20 11:53:26.740 +03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-08-20 11:53:26.740 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-08-20 11:53:26.741 +03:00 [DBG] Start userinfo request
2019-08-20 11:53:26.742 +03:00 [DBG] Bearer token found in header
2019-08-20 11:53:26.744 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:53:26.745 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:53:26.745 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-08-20 11:53:26.746 +03:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1566291206,"exp":1566291266,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","afcpayroll"],"client_id":"mvc","sub":"1","auth_time":1566291206,"idp":"local","name":"alice","email":"alice@email.com","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-08-20 11:53:26.751 +03:00 [DBG] Creating userinfo response
2019-08-20 11:53:26.752 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:53:26.752 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:53:26.753 +03:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 11:53:26.753 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:53:26.754 +03:00 [INF] Profile service returned the following claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 11:53:26.754 +03:00 [DBG] End userinfo request
2019-08-20 11:55:44.640 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-20 11:55:44.641 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-20 11:55:44.641 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-20 11:55:44.642 +03:00 [DBG] Start discovery request
2019-08-20 11:55:44.678 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-20 11:55:44.679 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-20 11:55:44.680 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-20 11:55:44.680 +03:00 [DBG] Start key discovery request
2019-08-20 11:55:44.710 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-20 11:55:44.711 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-20 11:55:44.711 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-20 11:55:44.712 +03:00 [DBG] Start token request.
2019-08-20 11:55:44.714 +03:00 [DBG] Start client validation
2019-08-20 11:55:44.715 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-20 11:55:44.715 +03:00 [DBG] Start parsing for secret in post body
2019-08-20 11:55:44.716 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-20 11:55:44.716 +03:00 [DBG] Secret id found: mvc
2019-08-20 11:55:44.717 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:55:44.718 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-20 11:55:44.718 +03:00 [DBG] Client validation success
2019-08-20 11:55:44.718 +03:00 [DBG] Start token request validation
2019-08-20 11:55:44.719 +03:00 [DBG] Start validation of refresh token request
2019-08-20 11:55:44.719 +03:00 [DBG] Token validation success
{"ClientId":"mvc","ClientName":"MVC Client","ValidateLifetime":false,"AccessTokenType":null,"ExpectedScope":null,"TokenHandle":null,"JwtId":null,"Claims":{"sub":"1","client_id":"mvc","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"auth_time":1566291023,"idp":"local","amr":"pwd","name":"alice","email":"alice@email.com"},"$type":"TokenValidationLog"}
2019-08-20 11:55:44.723 +03:00 [DBG] Validation of refresh token request success
2019-08-20 11:55:44.724 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"refresh_token","Scopes":null,"AuthorizationCode":null,"RefreshToken":"13d8683257d90e807c681fa0e39ac473f62dc8f5311921d94f73a7216c78147d","UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"refresh_token","refresh_token":"***REDACTED***","client_id":"mvc","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2019-08-20 11:55:44.730 +03:00 [DBG] Updating refresh token
2019-08-20 11:55:44.731 +03:00 [DBG] Token usage is one-time only. Generating new handle
2019-08-20 11:55:44.731 +03:00 [DBG] Created refresh token in store
2019-08-20 11:55:44.732 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 11:55:44.733 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 11:55:44.736 +03:00 [DBG] Token request success.
2019-08-20 11:55:45.893 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-20 11:55:45.894 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-20 11:55:45.894 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-20 11:55:45.895 +03:00 [DBG] Start discovery request
2019-08-20 11:55:45.940 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-20 11:55:45.941 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-20 11:55:45.942 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-20 11:55:45.943 +03:00 [DBG] Start key discovery request
2019-08-20 11:55:46.031 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-08-20 11:55:46.032 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-08-20 11:55:46.033 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-08-20 11:55:46.033 +03:00 [DBG] Start authorize request
2019-08-20 11:55:46.034 +03:00 [DBG] No user present in authorize request
2019-08-20 11:55:46.034 +03:00 [DBG] Start authorize request protocol validation
2019-08-20 11:55:46.035 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:55:46.035 +03:00 [DBG] Checking for PKCE parameters
2019-08-20 11:55:46.036 +03:00 [DBG] No PKCE used.
2019-08-20 11:55:46.036 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-20 11:55:46.038 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/home/signin-oidc","AllowedRedirectUris":["http://localhost:5002/home/signin-oidc"],"SubjectId":"anonymous","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9O37a5OPAwQxLg2xyIkwJT2kXfMDC3_px6E-n-zi53WeVcmNB4FrqMfP3TCbqBRp6OX9UifFDbCc-TOHG5V78-KyEcRX3aNnqbfIIyDae5jfyvPeb3XhW95IJWh9_zin-zJnegckjp-e_9vT0uDloj3l1s6DDvXiuXjDt86Af_YySva2DZiTGtAhWT8x6Bx84Cs3JInQIpZh1qW-EkWwiUZgLCWxGZ14wNNNcamTxciS-kRlKAYCPE-baUSNU6CZ5f2Hm7hZkUnattp-YrmRJmgG5grrxCEVha_cDZxj3TSB8z1E8THT2YJ29oj6I2393g","UiLocales":null,"Nonce":"637018881459652665.MzUwZDkwZjktYTMzMC00YTViLWFlODktYmIwZDg3NGNhMmQ4ZTU5ZWU2MTMtZGRhNC00MTU5LWE1MmMtM2NlYjcwNDk1NTdh","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/home/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637018881459652665.MzUwZDkwZjktYTMzMC00YTViLWFlODktYmIwZDg3NGNhMmQ4ZTU5ZWU2MTMtZGRhNC00MTU5LWE1MmMtM2NlYjcwNDk1NTdh","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9O37a5OPAwQxLg2xyIkwJT2kXfMDC3_px6E-n-zi53WeVcmNB4FrqMfP3TCbqBRp6OX9UifFDbCc-TOHG5V78-KyEcRX3aNnqbfIIyDae5jfyvPeb3XhW95IJWh9_zin-zJnegckjp-e_9vT0uDloj3l1s6DDvXiuXjDt86Af_YySva2DZiTGtAhWT8x6Bx84Cs3JInQIpZh1qW-EkWwiUZgLCWxGZ14wNNNcamTxciS-kRlKAYCPE-baUSNU6CZ5f2Hm7hZkUnattp-YrmRJmgG5grrxCEVha_cDZxj3TSB8z1E8THT2YJ29oj6I2393g","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-20 11:55:46.046 +03:00 [INF] Showing login: User is not authenticated
2019-08-20 11:55:46.059 +03:00 [DBG] Start authorize request protocol validation
2019-08-20 11:55:46.060 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:55:46.060 +03:00 [DBG] Checking for PKCE parameters
2019-08-20 11:55:46.061 +03:00 [DBG] No PKCE used.
2019-08-20 11:55:46.061 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-20 11:55:46.062 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:55:48.836 +03:00 [DBG] CORS request made for path: /account/login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-08-20 11:55:48.841 +03:00 [DBG] Start authorize request protocol validation
2019-08-20 11:55:48.841 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:55:48.842 +03:00 [DBG] Checking for PKCE parameters
2019-08-20 11:55:48.843 +03:00 [DBG] No PKCE used.
2019-08-20 11:55:48.843 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-20 11:55:48.844 +03:00 [DBG] Augmenting SignInContext
2019-08-20 11:55:48.844 +03:00 [DBG] Adding idp claim with value: local
2019-08-20 11:55:48.845 +03:00 [DBG] Adding amr claim with value: pwd
2019-08-20 11:55:48.846 +03:00 [INF] AuthenticationScheme: idsrv signed in.
2019-08-20 11:55:48.846 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:55:48.860 +03:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-08-20 11:55:48.861 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-08-20 11:55:48.861 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-08-20 11:55:48.862 +03:00 [DBG] Start authorize callback request
2019-08-20 11:55:48.863 +03:00 [DBG] User in authorize request: 1
2019-08-20 11:55:48.863 +03:00 [DBG] Start authorize request protocol validation
2019-08-20 11:55:48.864 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:55:48.864 +03:00 [DBG] Checking for PKCE parameters
2019-08-20 11:55:48.865 +03:00 [DBG] No PKCE used.
2019-08-20 11:55:48.866 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-20 11:55:48.867 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/home/signin-oidc","AllowedRedirectUris":["http://localhost:5002/home/signin-oidc"],"SubjectId":"1","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9O37a5OPAwQxLg2xyIkwJT2kXfMDC3_px6E-n-zi53WeVcmNB4FrqMfP3TCbqBRp6OX9UifFDbCc-TOHG5V78-KyEcRX3aNnqbfIIyDae5jfyvPeb3XhW95IJWh9_zin-zJnegckjp-e_9vT0uDloj3l1s6DDvXiuXjDt86Af_YySva2DZiTGtAhWT8x6Bx84Cs3JInQIpZh1qW-EkWwiUZgLCWxGZ14wNNNcamTxciS-kRlKAYCPE-baUSNU6CZ5f2Hm7hZkUnattp-YrmRJmgG5grrxCEVha_cDZxj3TSB8z1E8THT2YJ29oj6I2393g","UiLocales":null,"Nonce":"637018881459652665.MzUwZDkwZjktYTMzMC00YTViLWFlODktYmIwZDg3NGNhMmQ4ZTU5ZWU2MTMtZGRhNC00MTU5LWE1MmMtM2NlYjcwNDk1NTdh","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"543dbf5888b66464f8fe4d706a4e3911","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/home/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637018881459652665.MzUwZDkwZjktYTMzMC00YTViLWFlODktYmIwZDg3NGNhMmQ4ZTU5ZWU2MTMtZGRhNC00MTU5LWE1MmMtM2NlYjcwNDk1NTdh","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9O37a5OPAwQxLg2xyIkwJT2kXfMDC3_px6E-n-zi53WeVcmNB4FrqMfP3TCbqBRp6OX9UifFDbCc-TOHG5V78-KyEcRX3aNnqbfIIyDae5jfyvPeb3XhW95IJWh9_zin-zJnegckjp-e_9vT0uDloj3l1s6DDvXiuXjDt86Af_YySva2DZiTGtAhWT8x6Bx84Cs3JInQIpZh1qW-EkWwiUZgLCWxGZ14wNNNcamTxciS-kRlKAYCPE-baUSNU6CZ5f2Hm7hZkUnattp-YrmRJmgG5grrxCEVha_cDZxj3TSB8z1E8THT2YJ29oj6I2393g","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-20 11:55:48.879 +03:00 [DBG] Client is configured to not require consent, no consent is required
2019-08-20 11:55:48.880 +03:00 [DBG] Creating Hybrid Flow response.
2019-08-20 11:55:48.881 +03:00 [DBG] Creating Implicit Flow response.
2019-08-20 11:55:48.882 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 11:55:48.883 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 11:55:48.888 +03:00 [DBG] Authorize endpoint response
{"SubjectId":"1","ClientId":"mvc","RedirectUri":"http://localhost:5002/home/signin-oidc","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9O37a5OPAwQxLg2xyIkwJT2kXfMDC3_px6E-n-zi53WeVcmNB4FrqMfP3TCbqBRp6OX9UifFDbCc-TOHG5V78-KyEcRX3aNnqbfIIyDae5jfyvPeb3XhW95IJWh9_zin-zJnegckjp-e_9vT0uDloj3l1s6DDvXiuXjDt86Af_YySva2DZiTGtAhWT8x6Bx84Cs3JInQIpZh1qW-EkWwiUZgLCWxGZ14wNNNcamTxciS-kRlKAYCPE-baUSNU6CZ5f2Hm7hZkUnattp-YrmRJmgG5grrxCEVha_cDZxj3TSB8z1E8THT2YJ29oj6I2393g","Scope":"openid profile afcpayroll offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-08-20 11:55:48.893 +03:00 [DBG] Augmenting SignInContext
2019-08-20 11:55:48.893 +03:00 [INF] AuthenticationScheme: idsrv signed in.
2019-08-20 11:55:49.260 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-20 11:55:49.261 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-20 11:55:49.262 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-20 11:55:49.262 +03:00 [DBG] Start token request.
2019-08-20 11:55:49.263 +03:00 [DBG] Start client validation
2019-08-20 11:55:49.263 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-20 11:55:49.263 +03:00 [DBG] Start parsing for secret in post body
2019-08-20 11:55:49.264 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-20 11:55:49.264 +03:00 [DBG] Secret id found: mvc
2019-08-20 11:55:49.266 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:55:49.266 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-20 11:55:49.267 +03:00 [DBG] Client validation success
2019-08-20 11:55:49.267 +03:00 [DBG] Start token request validation
2019-08-20 11:55:49.268 +03:00 [DBG] Start validation of authorization code token request
2019-08-20 11:55:49.268 +03:00 [DBG] Validation of authorization code token request success
2019-08-20 11:55:49.269 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"b2bdd0e881b55b08d8ab4b178073df54814756e0b254a94d8205e689a01b2813","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"mvc","client_secret":"***REDACTED***","code":"b2bdd0e881b55b08d8ab4b178073df54814756e0b254a94d8205e689a01b2813","grant_type":"authorization_code","redirect_uri":"http://localhost:5002/home/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-08-20 11:55:49.272 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:55:49.273 +03:00 [DBG] Getting claims for access token for client: mvc
2019-08-20 11:55:49.274 +03:00 [DBG] Getting claims for access token for subject: 1
2019-08-20 11:55:49.278 +03:00 [DBG] Creating refresh token
2019-08-20 11:55:49.278 +03:00 [DBG] Setting an absolute lifetime: 2592000
2019-08-20 11:55:49.279 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:55:49.279 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 11:55:49.280 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 11:55:49.284 +03:00 [DBG] Token request success.
2019-08-20 11:55:49.295 +03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-08-20 11:55:49.295 +03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-08-20 11:55:49.296 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-08-20 11:55:49.297 +03:00 [DBG] Start userinfo request
2019-08-20 11:55:49.297 +03:00 [DBG] Bearer token found in header
2019-08-20 11:55:49.300 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:55:49.300 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:55:49.301 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-08-20 11:55:49.301 +03:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1566291349,"exp":1566291409,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","afcpayroll"],"client_id":"mvc","sub":"1","auth_time":1566291348,"idp":"local","name":"alice","email":"alice@email.com","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-08-20 11:55:49.306 +03:00 [DBG] Creating userinfo response
2019-08-20 11:55:49.307 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:55:49.307 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:55:49.308 +03:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 11:55:49.308 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:55:49.309 +03:00 [INF] Profile service returned the following claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 11:55:49.309 +03:00 [DBG] End userinfo request
2019-08-20 11:55:52.163 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-08-20 11:55:52.164 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-08-20 11:55:52.164 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-08-20 11:55:52.166 +03:00 [DBG] Start authorize request
2019-08-20 11:55:52.167 +03:00 [DBG] User in authorize request: 1
2019-08-20 11:55:52.168 +03:00 [DBG] Start authorize request protocol validation
2019-08-20 11:55:52.169 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:55:52.171 +03:00 [DBG] Checking for PKCE parameters
2019-08-20 11:55:52.172 +03:00 [DBG] No PKCE used.
2019-08-20 11:55:52.173 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-20 11:55:52.174 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/home/signin-oidc","AllowedRedirectUris":["http://localhost:5002/home/signin-oidc"],"SubjectId":"1","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9PPfbQV2Idm5KyiWyCM95cbXMJZrkJ4GKQ6k7FUVsV6euCI8HtD3wZPrDNrg4Pw2EPnmzS3AtGBw6d3PgshvYKDocU8y-RIf-exHlQWU5B0NaRH8Ft9bnaUi9vBHKw2Q9RiLQGAqbKOnx8SWN_cTJ3vMaA2XSCptD4_WtvlZx_dUi9wLSVcm4LCds-U9whu2ZFCLzIpo39TOjOx2zctWioL8swB0T8jo2QlhbUfmjFEDF_MpvEEtlvBo2kf9Q9cKSBS70VrpnabghtRM8yFTZPZcECuBfAeR01g_scr04KB3Yc2pIjTR6W7q6QdoSw_OwQ","UiLocales":null,"Nonce":"637018881521436203.MzE4NmE2N2UtNTFhMC00MGM1LTg0YWEtN2QzZDVkMDg0MzQ0MmMxMzA0ODAtZmU1MS00ZTNiLTgwMzEtNWY0OWNlN2RjMmVm","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"543dbf5888b66464f8fe4d706a4e3911","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/home/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637018881521436203.MzE4NmE2N2UtNTFhMC00MGM1LTg0YWEtN2QzZDVkMDg0MzQ0MmMxMzA0ODAtZmU1MS00ZTNiLTgwMzEtNWY0OWNlN2RjMmVm","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9PPfbQV2Idm5KyiWyCM95cbXMJZrkJ4GKQ6k7FUVsV6euCI8HtD3wZPrDNrg4Pw2EPnmzS3AtGBw6d3PgshvYKDocU8y-RIf-exHlQWU5B0NaRH8Ft9bnaUi9vBHKw2Q9RiLQGAqbKOnx8SWN_cTJ3vMaA2XSCptD4_WtvlZx_dUi9wLSVcm4LCds-U9whu2ZFCLzIpo39TOjOx2zctWioL8swB0T8jo2QlhbUfmjFEDF_MpvEEtlvBo2kf9Q9cKSBS70VrpnabghtRM8yFTZPZcECuBfAeR01g_scr04KB3Yc2pIjTR6W7q6QdoSw_OwQ","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-20 11:55:52.181 +03:00 [DBG] Client is configured to not require consent, no consent is required
2019-08-20 11:55:52.182 +03:00 [DBG] Creating Hybrid Flow response.
2019-08-20 11:55:52.183 +03:00 [DBG] Creating Implicit Flow response.
2019-08-20 11:55:52.183 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 11:55:52.184 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 11:55:52.189 +03:00 [DBG] Authorize endpoint response
{"SubjectId":"1","ClientId":"mvc","RedirectUri":"http://localhost:5002/home/signin-oidc","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9PPfbQV2Idm5KyiWyCM95cbXMJZrkJ4GKQ6k7FUVsV6euCI8HtD3wZPrDNrg4Pw2EPnmzS3AtGBw6d3PgshvYKDocU8y-RIf-exHlQWU5B0NaRH8Ft9bnaUi9vBHKw2Q9RiLQGAqbKOnx8SWN_cTJ3vMaA2XSCptD4_WtvlZx_dUi9wLSVcm4LCds-U9whu2ZFCLzIpo39TOjOx2zctWioL8swB0T8jo2QlhbUfmjFEDF_MpvEEtlvBo2kf9Q9cKSBS70VrpnabghtRM8yFTZPZcECuBfAeR01g_scr04KB3Yc2pIjTR6W7q6QdoSw_OwQ","Scope":"openid profile afcpayroll offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-08-20 11:55:52.429 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-20 11:55:52.433 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-20 11:55:52.434 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-20 11:55:52.434 +03:00 [DBG] Start token request.
2019-08-20 11:55:52.435 +03:00 [DBG] Start client validation
2019-08-20 11:55:52.435 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-20 11:55:52.436 +03:00 [DBG] Start parsing for secret in post body
2019-08-20 11:55:52.436 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-20 11:55:52.437 +03:00 [DBG] Secret id found: mvc
2019-08-20 11:55:52.437 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:55:52.439 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-20 11:55:52.440 +03:00 [DBG] Client validation success
2019-08-20 11:55:52.441 +03:00 [DBG] Start token request validation
2019-08-20 11:55:52.442 +03:00 [DBG] Start validation of authorization code token request
2019-08-20 11:55:52.443 +03:00 [DBG] Validation of authorization code token request success
2019-08-20 11:55:52.445 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"f9677c8b03494caa3afaa09ce8b291533934a171bb658ebf5299eda819842027","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"mvc","client_secret":"***REDACTED***","code":"f9677c8b03494caa3afaa09ce8b291533934a171bb658ebf5299eda819842027","grant_type":"authorization_code","redirect_uri":"http://localhost:5002/home/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-08-20 11:55:52.448 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:55:52.449 +03:00 [DBG] Getting claims for access token for client: mvc
2019-08-20 11:55:52.449 +03:00 [DBG] Getting claims for access token for subject: 1
2019-08-20 11:55:52.454 +03:00 [DBG] Creating refresh token
2019-08-20 11:55:52.455 +03:00 [DBG] Setting an absolute lifetime: 2592000
2019-08-20 11:55:52.456 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:55:52.457 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 11:55:52.457 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 11:55:52.462 +03:00 [DBG] Token request success.
2019-08-20 11:55:52.467 +03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-08-20 11:55:52.467 +03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-08-20 11:55:52.468 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-08-20 11:55:52.468 +03:00 [DBG] Start userinfo request
2019-08-20 11:55:52.469 +03:00 [DBG] Bearer token found in header
2019-08-20 11:55:52.472 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:55:52.473 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:55:52.474 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-08-20 11:55:52.474 +03:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1566291352,"exp":1566291412,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","afcpayroll"],"client_id":"mvc","sub":"1","auth_time":1566291348,"idp":"local","name":"alice","email":"alice@email.com","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-08-20 11:55:52.480 +03:00 [DBG] Creating userinfo response
2019-08-20 11:55:52.480 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:55:52.481 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:55:52.481 +03:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 11:55:52.482 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:55:52.483 +03:00 [INF] Profile service returned the following claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 11:55:52.483 +03:00 [DBG] End userinfo request
2019-08-20 11:55:55.279 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-08-20 11:55:55.283 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-08-20 11:55:55.285 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-08-20 11:55:55.286 +03:00 [DBG] Start authorize request
2019-08-20 11:55:55.288 +03:00 [DBG] User in authorize request: 1
2019-08-20 11:55:55.290 +03:00 [DBG] Start authorize request protocol validation
2019-08-20 11:55:55.290 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:55:55.291 +03:00 [DBG] Checking for PKCE parameters
2019-08-20 11:55:55.291 +03:00 [DBG] No PKCE used.
2019-08-20 11:55:55.292 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-20 11:55:55.292 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/home/signin-oidc","AllowedRedirectUris":["http://localhost:5002/home/signin-oidc"],"SubjectId":"1","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9O_jpKUJz3YfZB9pGyFXq9uwiDyTcs-HkdntR9CWVduOwDD03NHXc3u_T2QPWxrap2ow6GxiAl9SqBv_lLrtCmVN5085hqq09xzZqTA12N6Kb4Ecv1ia1DIUT3CSnLX8pEr-oNV6fztQyrDDEVslv8B49mLPWlmwLiLQwCwwxOsKYLFwEqnBSku2PIolmCZnaJvIoe6sDQ2rFneIMIAqoZ2B1A6XUwwX9OCNWApiHYLD30fjDuwy1uu8uZyNsrUHmyBd7hTuOmQv6eQGPvoVwdTDwPQzqAF9mPAJGPlOm73V5mx2WJH24svlFCf4lbOZi0","UiLocales":null,"Nonce":"637018881552618708.OWE3MTQ1NWEtZDY1OC00MmFlLTljNzYtMDZlMGY5MzI1MjRkODRjNzYwYzMtNGI4Mi00NzE5LWIxNTQtMzg5YWM0N2I2ODYw","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"543dbf5888b66464f8fe4d706a4e3911","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/home/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637018881552618708.OWE3MTQ1NWEtZDY1OC00MmFlLTljNzYtMDZlMGY5MzI1MjRkODRjNzYwYzMtNGI4Mi00NzE5LWIxNTQtMzg5YWM0N2I2ODYw","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9O_jpKUJz3YfZB9pGyFXq9uwiDyTcs-HkdntR9CWVduOwDD03NHXc3u_T2QPWxrap2ow6GxiAl9SqBv_lLrtCmVN5085hqq09xzZqTA12N6Kb4Ecv1ia1DIUT3CSnLX8pEr-oNV6fztQyrDDEVslv8B49mLPWlmwLiLQwCwwxOsKYLFwEqnBSku2PIolmCZnaJvIoe6sDQ2rFneIMIAqoZ2B1A6XUwwX9OCNWApiHYLD30fjDuwy1uu8uZyNsrUHmyBd7hTuOmQv6eQGPvoVwdTDwPQzqAF9mPAJGPlOm73V5mx2WJH24svlFCf4lbOZi0","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-20 11:55:55.298 +03:00 [DBG] Client is configured to not require consent, no consent is required
2019-08-20 11:55:55.298 +03:00 [DBG] Creating Hybrid Flow response.
2019-08-20 11:55:55.300 +03:00 [DBG] Creating Implicit Flow response.
2019-08-20 11:55:55.301 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 11:55:55.302 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 11:55:55.306 +03:00 [DBG] Authorize endpoint response
{"SubjectId":"1","ClientId":"mvc","RedirectUri":"http://localhost:5002/home/signin-oidc","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9O_jpKUJz3YfZB9pGyFXq9uwiDyTcs-HkdntR9CWVduOwDD03NHXc3u_T2QPWxrap2ow6GxiAl9SqBv_lLrtCmVN5085hqq09xzZqTA12N6Kb4Ecv1ia1DIUT3CSnLX8pEr-oNV6fztQyrDDEVslv8B49mLPWlmwLiLQwCwwxOsKYLFwEqnBSku2PIolmCZnaJvIoe6sDQ2rFneIMIAqoZ2B1A6XUwwX9OCNWApiHYLD30fjDuwy1uu8uZyNsrUHmyBd7hTuOmQv6eQGPvoVwdTDwPQzqAF9mPAJGPlOm73V5mx2WJH24svlFCf4lbOZi0","Scope":"openid profile afcpayroll offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-08-20 11:55:55.568 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-20 11:55:55.569 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-20 11:55:55.569 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-20 11:55:55.570 +03:00 [DBG] Start token request.
2019-08-20 11:55:55.571 +03:00 [DBG] Start client validation
2019-08-20 11:55:55.572 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-20 11:55:55.572 +03:00 [DBG] Start parsing for secret in post body
2019-08-20 11:55:55.577 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-20 11:55:55.578 +03:00 [DBG] Secret id found: mvc
2019-08-20 11:55:55.579 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:55:55.580 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-20 11:55:55.580 +03:00 [DBG] Client validation success
2019-08-20 11:55:55.580 +03:00 [DBG] Start token request validation
2019-08-20 11:55:55.581 +03:00 [DBG] Start validation of authorization code token request
2019-08-20 11:55:55.582 +03:00 [DBG] Validation of authorization code token request success
2019-08-20 11:55:55.582 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"2bfe9a74fe495c079c50c8dc7a243cfced70a5e85045a2722734151a6121b205","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"mvc","client_secret":"***REDACTED***","code":"2bfe9a74fe495c079c50c8dc7a243cfced70a5e85045a2722734151a6121b205","grant_type":"authorization_code","redirect_uri":"http://localhost:5002/home/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-08-20 11:55:55.585 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:55:55.586 +03:00 [DBG] Getting claims for access token for client: mvc
2019-08-20 11:55:55.587 +03:00 [DBG] Getting claims for access token for subject: 1
2019-08-20 11:55:55.591 +03:00 [DBG] Creating refresh token
2019-08-20 11:55:55.592 +03:00 [DBG] Setting an absolute lifetime: 2592000
2019-08-20 11:55:55.592 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:55:55.593 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 11:55:55.595 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 11:55:55.600 +03:00 [DBG] Token request success.
2019-08-20 11:55:55.603 +03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-08-20 11:55:55.604 +03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-08-20 11:55:55.605 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-08-20 11:55:55.606 +03:00 [DBG] Start userinfo request
2019-08-20 11:55:55.606 +03:00 [DBG] Bearer token found in header
2019-08-20 11:55:55.609 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:55:55.610 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:55:55.610 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-08-20 11:55:55.611 +03:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1566291355,"exp":1566291415,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","afcpayroll"],"client_id":"mvc","sub":"1","auth_time":1566291348,"idp":"local","name":"alice","email":"alice@email.com","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-08-20 11:55:55.615 +03:00 [DBG] Creating userinfo response
2019-08-20 11:55:55.615 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:55:55.616 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:55:55.616 +03:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 11:55:55.617 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:55:55.618 +03:00 [INF] Profile service returned the following claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 11:55:55.619 +03:00 [DBG] End userinfo request
2019-08-20 11:56:00.067 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-08-20 11:56:00.073 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-08-20 11:56:00.076 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-08-20 11:56:00.078 +03:00 [DBG] Start authorize request
2019-08-20 11:56:00.079 +03:00 [DBG] User in authorize request: 1
2019-08-20 11:56:00.080 +03:00 [DBG] Start authorize request protocol validation
2019-08-20 11:56:00.080 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:56:00.081 +03:00 [DBG] Checking for PKCE parameters
2019-08-20 11:56:00.081 +03:00 [DBG] No PKCE used.
2019-08-20 11:56:00.082 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-20 11:56:00.083 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/home/signin-oidc","AllowedRedirectUris":["http://localhost:5002/home/signin-oidc"],"SubjectId":"1","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9OKvnly6jLLdaep46cnDHKJDdASTlbwDR8oWr3Iof_xI0IQCDsMF0kMD_4DscVaP6ht0R5x2yruRXvd1UcNR_G8zvvcphoBORDJn9r25ZEC_c2By3nExHeO8MGIXu-KneZbcxUxNrHtLnMSBLaV8VH6DbwrKLPluJkVtOATdA2I-t422CZYQ8pQjF4AD2Tp4kwOcru_A4pcfwo3dOkLXwYFIb4h_TqtEpCo1GJYe_zmQZMeAdxfV-GlhvFQPSt22CZSDg6kBhbkAtV7RJMbXF2ndjpEJPXaE-yfVpoxaNnlrRW3SD2Pd9Pn2vuTIz1xxQI","UiLocales":null,"Nonce":"637018881600471922.Zjc2MGZhMzktYTI3OS00MjE3LTkzMTgtMzdkZWE4NmRhMDc1YmUwZDdkNDAtNzNmZC00Yzk4LWJlNGMtMGYyZjU3MjczN2Ez","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"543dbf5888b66464f8fe4d706a4e3911","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/home/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637018881600471922.Zjc2MGZhMzktYTI3OS00MjE3LTkzMTgtMzdkZWE4NmRhMDc1YmUwZDdkNDAtNzNmZC00Yzk4LWJlNGMtMGYyZjU3MjczN2Ez","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9OKvnly6jLLdaep46cnDHKJDdASTlbwDR8oWr3Iof_xI0IQCDsMF0kMD_4DscVaP6ht0R5x2yruRXvd1UcNR_G8zvvcphoBORDJn9r25ZEC_c2By3nExHeO8MGIXu-KneZbcxUxNrHtLnMSBLaV8VH6DbwrKLPluJkVtOATdA2I-t422CZYQ8pQjF4AD2Tp4kwOcru_A4pcfwo3dOkLXwYFIb4h_TqtEpCo1GJYe_zmQZMeAdxfV-GlhvFQPSt22CZSDg6kBhbkAtV7RJMbXF2ndjpEJPXaE-yfVpoxaNnlrRW3SD2Pd9Pn2vuTIz1xxQI","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-20 11:56:00.092 +03:00 [DBG] Client is configured to not require consent, no consent is required
2019-08-20 11:56:00.093 +03:00 [DBG] Creating Hybrid Flow response.
2019-08-20 11:56:00.093 +03:00 [DBG] Creating Implicit Flow response.
2019-08-20 11:56:00.094 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 11:56:00.094 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 11:56:00.099 +03:00 [DBG] Authorize endpoint response
{"SubjectId":"1","ClientId":"mvc","RedirectUri":"http://localhost:5002/home/signin-oidc","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9OKvnly6jLLdaep46cnDHKJDdASTlbwDR8oWr3Iof_xI0IQCDsMF0kMD_4DscVaP6ht0R5x2yruRXvd1UcNR_G8zvvcphoBORDJn9r25ZEC_c2By3nExHeO8MGIXu-KneZbcxUxNrHtLnMSBLaV8VH6DbwrKLPluJkVtOATdA2I-t422CZYQ8pQjF4AD2Tp4kwOcru_A4pcfwo3dOkLXwYFIb4h_TqtEpCo1GJYe_zmQZMeAdxfV-GlhvFQPSt22CZSDg6kBhbkAtV7RJMbXF2ndjpEJPXaE-yfVpoxaNnlrRW3SD2Pd9Pn2vuTIz1xxQI","Scope":"openid profile afcpayroll offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-08-20 11:56:00.335 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-20 11:56:00.336 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-20 11:56:00.336 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-20 11:56:00.337 +03:00 [DBG] Start token request.
2019-08-20 11:56:00.337 +03:00 [DBG] Start client validation
2019-08-20 11:56:00.338 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-20 11:56:00.338 +03:00 [DBG] Start parsing for secret in post body
2019-08-20 11:56:00.339 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-20 11:56:00.339 +03:00 [DBG] Secret id found: mvc
2019-08-20 11:56:00.340 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:56:00.342 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-20 11:56:00.342 +03:00 [DBG] Client validation success
2019-08-20 11:56:00.343 +03:00 [DBG] Start token request validation
2019-08-20 11:56:00.343 +03:00 [DBG] Start validation of authorization code token request
2019-08-20 11:56:00.343 +03:00 [DBG] Validation of authorization code token request success
2019-08-20 11:56:00.344 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"cad15c28d1139027eed7f29296ff9449dac2c2cdb3aedcbd928c23c2461f62f1","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"mvc","client_secret":"***REDACTED***","code":"cad15c28d1139027eed7f29296ff9449dac2c2cdb3aedcbd928c23c2461f62f1","grant_type":"authorization_code","redirect_uri":"http://localhost:5002/home/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-08-20 11:56:00.347 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:56:00.348 +03:00 [DBG] Getting claims for access token for client: mvc
2019-08-20 11:56:00.348 +03:00 [DBG] Getting claims for access token for subject: 1
2019-08-20 11:56:00.352 +03:00 [DBG] Creating refresh token
2019-08-20 11:56:00.353 +03:00 [DBG] Setting an absolute lifetime: 2592000
2019-08-20 11:56:00.354 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:56:00.354 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 11:56:00.355 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 11:56:00.359 +03:00 [DBG] Token request success.
2019-08-20 11:56:00.363 +03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-08-20 11:56:00.364 +03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-08-20 11:56:00.364 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-08-20 11:56:00.365 +03:00 [DBG] Start userinfo request
2019-08-20 11:56:00.365 +03:00 [DBG] Bearer token found in header
2019-08-20 11:56:00.368 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:56:00.369 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:56:00.369 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-08-20 11:56:00.372 +03:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1566291360,"exp":1566291420,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","afcpayroll"],"client_id":"mvc","sub":"1","auth_time":1566291348,"idp":"local","name":"alice","email":"alice@email.com","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-08-20 11:56:00.376 +03:00 [DBG] Creating userinfo response
2019-08-20 11:56:00.376 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:56:00.377 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:56:00.378 +03:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 11:56:00.378 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:56:00.379 +03:00 [INF] Profile service returned the following claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 11:56:00.379 +03:00 [DBG] End userinfo request
2019-08-20 11:56:00.440 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-08-20 11:56:00.441 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-08-20 11:56:00.442 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-08-20 11:56:00.443 +03:00 [DBG] Start authorize request
2019-08-20 11:56:00.444 +03:00 [DBG] User in authorize request: 1
2019-08-20 11:56:00.444 +03:00 [DBG] Start authorize request protocol validation
2019-08-20 11:56:00.445 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:56:00.445 +03:00 [DBG] Checking for PKCE parameters
2019-08-20 11:56:00.446 +03:00 [DBG] No PKCE used.
2019-08-20 11:56:00.447 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-20 11:56:00.448 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/home/signin-oidc","AllowedRedirectUris":["http://localhost:5002/home/signin-oidc"],"SubjectId":"1","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9PDoRQyT2rbT4SHa2x4m7hqezJlu4C7Akm-RvvFkm5bnPeYUMLdxzLDBrYVQmpY5zUBLCoa4PQEcpsWCAEunMFMC-JxX25i06Uo1PTqOTmeLlRItZP-LzqJknNIRIZPMUTyolGN3rz6am8rbnLVY9PLJ9bDliccfZEy4_rKgSdkPh_PAZkR7wc1VNtHRGiOTEbuRknTvDCKSigRoBkWJ1CgvmRxDMOOzUrE4yGNel71Z6JsYmWbqPwfr__eZSsP7eVN2WPcGYvCUyuDzrGMiM26lZHWyo0tW8XB8oe2i45CtY45IRhIacTogMF41sSPUBs","UiLocales":null,"Nonce":"637018881604103502.MDMzMjlmODEtNTM2NC00NDZhLWJkMTAtZGUwZjE1ZjQ2NWJhMDRmNmVmNGQtNGQwOS00YTQyLWI1YjgtNGRkNGU1ODY0N2Zi","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"543dbf5888b66464f8fe4d706a4e3911","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/home/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637018881604103502.MDMzMjlmODEtNTM2NC00NDZhLWJkMTAtZGUwZjE1ZjQ2NWJhMDRmNmVmNGQtNGQwOS00YTQyLWI1YjgtNGRkNGU1ODY0N2Zi","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9PDoRQyT2rbT4SHa2x4m7hqezJlu4C7Akm-RvvFkm5bnPeYUMLdxzLDBrYVQmpY5zUBLCoa4PQEcpsWCAEunMFMC-JxX25i06Uo1PTqOTmeLlRItZP-LzqJknNIRIZPMUTyolGN3rz6am8rbnLVY9PLJ9bDliccfZEy4_rKgSdkPh_PAZkR7wc1VNtHRGiOTEbuRknTvDCKSigRoBkWJ1CgvmRxDMOOzUrE4yGNel71Z6JsYmWbqPwfr__eZSsP7eVN2WPcGYvCUyuDzrGMiM26lZHWyo0tW8XB8oe2i45CtY45IRhIacTogMF41sSPUBs","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-20 11:56:00.456 +03:00 [DBG] Client is configured to not require consent, no consent is required
2019-08-20 11:56:00.456 +03:00 [DBG] Creating Hybrid Flow response.
2019-08-20 11:56:00.457 +03:00 [DBG] Creating Implicit Flow response.
2019-08-20 11:56:00.458 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 11:56:00.458 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 11:56:00.464 +03:00 [DBG] Authorize endpoint response
{"SubjectId":"1","ClientId":"mvc","RedirectUri":"http://localhost:5002/home/signin-oidc","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9PDoRQyT2rbT4SHa2x4m7hqezJlu4C7Akm-RvvFkm5bnPeYUMLdxzLDBrYVQmpY5zUBLCoa4PQEcpsWCAEunMFMC-JxX25i06Uo1PTqOTmeLlRItZP-LzqJknNIRIZPMUTyolGN3rz6am8rbnLVY9PLJ9bDliccfZEy4_rKgSdkPh_PAZkR7wc1VNtHRGiOTEbuRknTvDCKSigRoBkWJ1CgvmRxDMOOzUrE4yGNel71Z6JsYmWbqPwfr__eZSsP7eVN2WPcGYvCUyuDzrGMiM26lZHWyo0tW8XB8oe2i45CtY45IRhIacTogMF41sSPUBs","Scope":"openid profile afcpayroll offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-08-20 11:56:00.705 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-20 11:56:00.707 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-20 11:56:00.707 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-20 11:56:00.708 +03:00 [DBG] Start token request.
2019-08-20 11:56:00.708 +03:00 [DBG] Start client validation
2019-08-20 11:56:00.709 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-20 11:56:00.709 +03:00 [DBG] Start parsing for secret in post body
2019-08-20 11:56:00.709 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-20 11:56:00.710 +03:00 [DBG] Secret id found: mvc
2019-08-20 11:56:00.710 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:56:00.711 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-20 11:56:00.712 +03:00 [DBG] Client validation success
2019-08-20 11:56:00.713 +03:00 [DBG] Start token request validation
2019-08-20 11:56:00.713 +03:00 [DBG] Start validation of authorization code token request
2019-08-20 11:56:00.714 +03:00 [DBG] Validation of authorization code token request success
2019-08-20 11:56:00.715 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"daccd9c96500654d6b7a7c13a6bfb3f5c205bc8806371411b0e49ee9a784867f","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"mvc","client_secret":"***REDACTED***","code":"daccd9c96500654d6b7a7c13a6bfb3f5c205bc8806371411b0e49ee9a784867f","grant_type":"authorization_code","redirect_uri":"http://localhost:5002/home/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-08-20 11:56:00.718 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:56:00.719 +03:00 [DBG] Getting claims for access token for client: mvc
2019-08-20 11:56:00.719 +03:00 [DBG] Getting claims for access token for subject: 1
2019-08-20 11:56:00.723 +03:00 [DBG] Creating refresh token
2019-08-20 11:56:00.724 +03:00 [DBG] Setting an absolute lifetime: 2592000
2019-08-20 11:56:00.724 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:56:00.725 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 11:56:00.725 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 11:56:00.729 +03:00 [DBG] Token request success.
2019-08-20 11:56:00.733 +03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-08-20 11:56:00.734 +03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-08-20 11:56:00.735 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-08-20 11:56:00.736 +03:00 [DBG] Start userinfo request
2019-08-20 11:56:00.736 +03:00 [DBG] Bearer token found in header
2019-08-20 11:56:00.740 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:56:00.740 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:56:00.741 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-08-20 11:56:00.741 +03:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1566291360,"exp":1566291420,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","afcpayroll"],"client_id":"mvc","sub":"1","auth_time":1566291348,"idp":"local","name":"alice","email":"alice@email.com","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-08-20 11:56:00.746 +03:00 [DBG] Creating userinfo response
2019-08-20 11:56:00.747 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:56:00.747 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:56:00.748 +03:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 11:56:00.748 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:56:00.749 +03:00 [INF] Profile service returned the following claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 11:56:00.750 +03:00 [DBG] End userinfo request
2019-08-20 11:56:00.800 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-08-20 11:56:00.801 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-08-20 11:56:00.802 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-08-20 11:56:00.802 +03:00 [DBG] Start authorize request
2019-08-20 11:56:00.803 +03:00 [DBG] User in authorize request: 1
2019-08-20 11:56:00.803 +03:00 [DBG] Start authorize request protocol validation
2019-08-20 11:56:00.804 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:56:00.806 +03:00 [DBG] Checking for PKCE parameters
2019-08-20 11:56:00.806 +03:00 [DBG] No PKCE used.
2019-08-20 11:56:00.807 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-20 11:56:00.807 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/home/signin-oidc","AllowedRedirectUris":["http://localhost:5002/home/signin-oidc"],"SubjectId":"1","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9PzKJLh8MYizy_uQlHfirrJiwdD0pPUbzkkz2qkK633EfVRkcCMEmRsAfC2E3vXbz2e3EUSXTu5fumrdz9vx11rjSYEHlW9GbbWsOR2Rrm6s5hY-kZUqfDVZcyg6I6j2uwK_PVjSOH2BLui-3Ba_SDDwdwGcCWnwDV515wJf1UeIB-BHoO5nRM534vYJN_pYxu3Jar1cNSB_191kqDzkIFBHH8P8emA6CLMFhSTk0jlBVEraLFSeq4h0XK9ThDMwmoSwXRDL1wcylP03TnWzf9SE8JbSixwfMiSIyv-GtKrYDkTpuC7kS-1Cbiwy-K96GI","UiLocales":null,"Nonce":"637018881607798909.YWFlODk4YzgtODU4MS00MjBmLWE1MzYtYTkzZTBhZDdmYzI0MTMyNWM5MzMtMmVmNS00NmM3LTk3ZjAtOTIyNWQ2MzZkZGQ4","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"543dbf5888b66464f8fe4d706a4e3911","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/home/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637018881607798909.YWFlODk4YzgtODU4MS00MjBmLWE1MzYtYTkzZTBhZDdmYzI0MTMyNWM5MzMtMmVmNS00NmM3LTk3ZjAtOTIyNWQ2MzZkZGQ4","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9PzKJLh8MYizy_uQlHfirrJiwdD0pPUbzkkz2qkK633EfVRkcCMEmRsAfC2E3vXbz2e3EUSXTu5fumrdz9vx11rjSYEHlW9GbbWsOR2Rrm6s5hY-kZUqfDVZcyg6I6j2uwK_PVjSOH2BLui-3Ba_SDDwdwGcCWnwDV515wJf1UeIB-BHoO5nRM534vYJN_pYxu3Jar1cNSB_191kqDzkIFBHH8P8emA6CLMFhSTk0jlBVEraLFSeq4h0XK9ThDMwmoSwXRDL1wcylP03TnWzf9SE8JbSixwfMiSIyv-GtKrYDkTpuC7kS-1Cbiwy-K96GI","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-20 11:56:00.812 +03:00 [DBG] Client is configured to not require consent, no consent is required
2019-08-20 11:56:00.813 +03:00 [DBG] Creating Hybrid Flow response.
2019-08-20 11:56:00.813 +03:00 [DBG] Creating Implicit Flow response.
2019-08-20 11:56:00.814 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 11:56:00.814 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 11:56:00.818 +03:00 [DBG] Authorize endpoint response
{"SubjectId":"1","ClientId":"mvc","RedirectUri":"http://localhost:5002/home/signin-oidc","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9PzKJLh8MYizy_uQlHfirrJiwdD0pPUbzkkz2qkK633EfVRkcCMEmRsAfC2E3vXbz2e3EUSXTu5fumrdz9vx11rjSYEHlW9GbbWsOR2Rrm6s5hY-kZUqfDVZcyg6I6j2uwK_PVjSOH2BLui-3Ba_SDDwdwGcCWnwDV515wJf1UeIB-BHoO5nRM534vYJN_pYxu3Jar1cNSB_191kqDzkIFBHH8P8emA6CLMFhSTk0jlBVEraLFSeq4h0XK9ThDMwmoSwXRDL1wcylP03TnWzf9SE8JbSixwfMiSIyv-GtKrYDkTpuC7kS-1Cbiwy-K96GI","Scope":"openid profile afcpayroll offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-08-20 11:56:01.050 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-20 11:56:01.052 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-20 11:56:01.052 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-20 11:56:01.053 +03:00 [DBG] Start token request.
2019-08-20 11:56:01.055 +03:00 [DBG] Start client validation
2019-08-20 11:56:01.058 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-20 11:56:01.059 +03:00 [DBG] Start parsing for secret in post body
2019-08-20 11:56:01.060 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-20 11:56:01.060 +03:00 [DBG] Secret id found: mvc
2019-08-20 11:56:01.061 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:56:01.061 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-20 11:56:01.062 +03:00 [DBG] Client validation success
2019-08-20 11:56:01.062 +03:00 [DBG] Start token request validation
2019-08-20 11:56:01.063 +03:00 [DBG] Start validation of authorization code token request
2019-08-20 11:56:01.063 +03:00 [DBG] Validation of authorization code token request success
2019-08-20 11:56:01.064 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"24b0a448a875886c72908cb30e313e91cbcaecc5b0e914b049f558f1e2b25233","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"mvc","client_secret":"***REDACTED***","code":"24b0a448a875886c72908cb30e313e91cbcaecc5b0e914b049f558f1e2b25233","grant_type":"authorization_code","redirect_uri":"http://localhost:5002/home/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-08-20 11:56:01.070 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:56:01.075 +03:00 [DBG] Getting claims for access token for client: mvc
2019-08-20 11:56:01.076 +03:00 [DBG] Getting claims for access token for subject: 1
2019-08-20 11:56:01.080 +03:00 [DBG] Creating refresh token
2019-08-20 11:56:01.081 +03:00 [DBG] Setting an absolute lifetime: 2592000
2019-08-20 11:56:01.081 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:56:01.082 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 11:56:01.083 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 11:56:01.089 +03:00 [DBG] Token request success.
2019-08-20 11:56:01.095 +03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-08-20 11:56:01.096 +03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-08-20 11:56:01.097 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-08-20 11:56:01.097 +03:00 [DBG] Start userinfo request
2019-08-20 11:56:01.098 +03:00 [DBG] Bearer token found in header
2019-08-20 11:56:01.101 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:56:01.101 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:56:01.102 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-08-20 11:56:01.102 +03:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1566291361,"exp":1566291421,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","afcpayroll"],"client_id":"mvc","sub":"1","auth_time":1566291348,"idp":"local","name":"alice","email":"alice@email.com","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-08-20 11:56:01.113 +03:00 [DBG] Creating userinfo response
2019-08-20 11:56:01.113 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:56:01.114 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:56:01.114 +03:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 11:56:01.115 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:56:01.115 +03:00 [INF] Profile service returned the following claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 11:56:01.116 +03:00 [DBG] End userinfo request
2019-08-20 11:56:01.172 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-08-20 11:56:01.173 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-08-20 11:56:01.174 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-08-20 11:56:01.174 +03:00 [DBG] Start authorize request
2019-08-20 11:56:01.175 +03:00 [DBG] User in authorize request: 1
2019-08-20 11:56:01.175 +03:00 [DBG] Start authorize request protocol validation
2019-08-20 11:56:01.176 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:56:01.176 +03:00 [DBG] Checking for PKCE parameters
2019-08-20 11:56:01.177 +03:00 [DBG] No PKCE used.
2019-08-20 11:56:01.177 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-20 11:56:01.178 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/home/signin-oidc","AllowedRedirectUris":["http://localhost:5002/home/signin-oidc"],"SubjectId":"1","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9PzPa0cx6nNgNaEhRplxaVEdsRPmyOEMyj-jKdgwPdeg2pAQW_pzMn-6SG6Q142EzqTqAfg2llRUhS4bAEDT8THpKC8kU17OuobYhozoJilXFkP4T5vCOYF4huHdxDPaeXHnA9GLeZ6vWTdPoprdn1iHdc2A24iD_zdjj7S3pVI2jPyaQC-VzQZA7VyKYFpDMlg-ALt1iBo_QfFpwITBfGexgMaA__DlORTxT3W6o87HxZusqo4YCYBe_f56Dpz9VcbzrrecSBA0dVpB3tk_Ip_OAshJ5dLaURiDICH_CglehsnwHUqzphtdluEVz7qpLk","UiLocales":null,"Nonce":"637018881611519268.NGIxYTQ3MzgtNzEzZS00NmNiLTlkNmEtZDUyYWIyYTcyNDYxOTM1ZmE3NmEtMDc1MC00OWY5LWE3MjctYmJkMTA0OWNlN2Nh","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"543dbf5888b66464f8fe4d706a4e3911","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/home/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637018881611519268.NGIxYTQ3MzgtNzEzZS00NmNiLTlkNmEtZDUyYWIyYTcyNDYxOTM1ZmE3NmEtMDc1MC00OWY5LWE3MjctYmJkMTA0OWNlN2Nh","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9PzPa0cx6nNgNaEhRplxaVEdsRPmyOEMyj-jKdgwPdeg2pAQW_pzMn-6SG6Q142EzqTqAfg2llRUhS4bAEDT8THpKC8kU17OuobYhozoJilXFkP4T5vCOYF4huHdxDPaeXHnA9GLeZ6vWTdPoprdn1iHdc2A24iD_zdjj7S3pVI2jPyaQC-VzQZA7VyKYFpDMlg-ALt1iBo_QfFpwITBfGexgMaA__DlORTxT3W6o87HxZusqo4YCYBe_f56Dpz9VcbzrrecSBA0dVpB3tk_Ip_OAshJ5dLaURiDICH_CglehsnwHUqzphtdluEVz7qpLk","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-20 11:56:01.185 +03:00 [DBG] Client is configured to not require consent, no consent is required
2019-08-20 11:56:01.185 +03:00 [DBG] Creating Hybrid Flow response.
2019-08-20 11:56:01.186 +03:00 [DBG] Creating Implicit Flow response.
2019-08-20 11:56:01.186 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 11:56:01.187 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 11:56:01.191 +03:00 [DBG] Authorize endpoint response
{"SubjectId":"1","ClientId":"mvc","RedirectUri":"http://localhost:5002/home/signin-oidc","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9PzPa0cx6nNgNaEhRplxaVEdsRPmyOEMyj-jKdgwPdeg2pAQW_pzMn-6SG6Q142EzqTqAfg2llRUhS4bAEDT8THpKC8kU17OuobYhozoJilXFkP4T5vCOYF4huHdxDPaeXHnA9GLeZ6vWTdPoprdn1iHdc2A24iD_zdjj7S3pVI2jPyaQC-VzQZA7VyKYFpDMlg-ALt1iBo_QfFpwITBfGexgMaA__DlORTxT3W6o87HxZusqo4YCYBe_f56Dpz9VcbzrrecSBA0dVpB3tk_Ip_OAshJ5dLaURiDICH_CglehsnwHUqzphtdluEVz7qpLk","Scope":"openid profile afcpayroll offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-08-20 11:56:01.390 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-20 11:56:01.391 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-20 11:56:01.392 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-20 11:56:01.393 +03:00 [DBG] Start token request.
2019-08-20 11:56:01.393 +03:00 [DBG] Start client validation
2019-08-20 11:56:01.394 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-20 11:56:01.395 +03:00 [DBG] Start parsing for secret in post body
2019-08-20 11:56:01.396 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-20 11:56:01.396 +03:00 [DBG] Secret id found: mvc
2019-08-20 11:56:01.397 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:56:01.397 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-20 11:56:01.398 +03:00 [DBG] Client validation success
2019-08-20 11:56:01.398 +03:00 [DBG] Start token request validation
2019-08-20 11:56:01.400 +03:00 [DBG] Start validation of authorization code token request
2019-08-20 11:56:01.401 +03:00 [DBG] Validation of authorization code token request success
2019-08-20 11:56:01.401 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"4a7ca95c6d864606031c0f861c7ebd65f30d72bdb074db70ed0c241c9c7436a1","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"mvc","client_secret":"***REDACTED***","code":"4a7ca95c6d864606031c0f861c7ebd65f30d72bdb074db70ed0c241c9c7436a1","grant_type":"authorization_code","redirect_uri":"http://localhost:5002/home/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-08-20 11:56:01.405 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:56:01.406 +03:00 [DBG] Getting claims for access token for client: mvc
2019-08-20 11:56:01.406 +03:00 [DBG] Getting claims for access token for subject: 1
2019-08-20 11:56:01.410 +03:00 [DBG] Creating refresh token
2019-08-20 11:56:01.411 +03:00 [DBG] Setting an absolute lifetime: 2592000
2019-08-20 11:56:01.411 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:56:01.412 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 11:56:01.413 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 11:56:01.417 +03:00 [DBG] Token request success.
2019-08-20 11:56:01.421 +03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-08-20 11:56:01.421 +03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-08-20 11:56:01.422 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-08-20 11:56:01.423 +03:00 [DBG] Start userinfo request
2019-08-20 11:56:01.423 +03:00 [DBG] Bearer token found in header
2019-08-20 11:56:01.426 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:56:01.427 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:56:01.427 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-08-20 11:56:01.428 +03:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1566291361,"exp":1566291421,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","afcpayroll"],"client_id":"mvc","sub":"1","auth_time":1566291348,"idp":"local","name":"alice","email":"alice@email.com","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-08-20 11:56:01.432 +03:00 [DBG] Creating userinfo response
2019-08-20 11:56:01.433 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:56:01.433 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:56:01.434 +03:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 11:56:01.435 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:56:01.436 +03:00 [INF] Profile service returned the following claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 11:56:01.436 +03:00 [DBG] End userinfo request
2019-08-20 11:56:01.490 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-08-20 11:56:01.491 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-08-20 11:56:01.492 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-08-20 11:56:01.494 +03:00 [DBG] Start authorize request
2019-08-20 11:56:01.495 +03:00 [DBG] User in authorize request: 1
2019-08-20 11:56:01.495 +03:00 [DBG] Start authorize request protocol validation
2019-08-20 11:56:01.496 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:56:01.496 +03:00 [DBG] Checking for PKCE parameters
2019-08-20 11:56:01.497 +03:00 [DBG] No PKCE used.
2019-08-20 11:56:01.498 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-20 11:56:01.499 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/home/signin-oidc","AllowedRedirectUris":["http://localhost:5002/home/signin-oidc"],"SubjectId":"1","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9PHAD-3eYkTgyn9-AndWzSiV9W4XFte5WU2OZZmHq3uvaiMaNkIKMAompm2cFvItbly5sCMxtZ-7fbzWqpJJigVGANtEA8CQwD1MPIpjgl7Eqi0nTd4ZWZkLGny7jiSjqr3iw_gOwgD-Lh21EmcGue9NQ-Y43s1TvSivsFd9U_NtuAFu3SM2ZT0dizAlB1tM0r8v6_1z6roNcDeoj-ppYuxbui5dRir8QSjsL83xZ5WNqUI24peazrB_G7LUtmEDGeMG7bkvM_yWks3JutIH9YQQ2JFuI5aPd7U5V6-jSau7K1Y3JKU0R1nRrlWwV8C_kI","UiLocales":null,"Nonce":"637018881614705530.ODg5NzM3ZDgtYzMxNC00NzI1LWFkODQtMzg4MDFmOTEzYWQ1NDNhMjIyOTUtYTFlZS00MGZjLTk4MjQtMWYxYTEzYzBkY2U4","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"543dbf5888b66464f8fe4d706a4e3911","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/home/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637018881614705530.ODg5NzM3ZDgtYzMxNC00NzI1LWFkODQtMzg4MDFmOTEzYWQ1NDNhMjIyOTUtYTFlZS00MGZjLTk4MjQtMWYxYTEzYzBkY2U4","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9PHAD-3eYkTgyn9-AndWzSiV9W4XFte5WU2OZZmHq3uvaiMaNkIKMAompm2cFvItbly5sCMxtZ-7fbzWqpJJigVGANtEA8CQwD1MPIpjgl7Eqi0nTd4ZWZkLGny7jiSjqr3iw_gOwgD-Lh21EmcGue9NQ-Y43s1TvSivsFd9U_NtuAFu3SM2ZT0dizAlB1tM0r8v6_1z6roNcDeoj-ppYuxbui5dRir8QSjsL83xZ5WNqUI24peazrB_G7LUtmEDGeMG7bkvM_yWks3JutIH9YQQ2JFuI5aPd7U5V6-jSau7K1Y3JKU0R1nRrlWwV8C_kI","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-20 11:56:01.505 +03:00 [DBG] Client is configured to not require consent, no consent is required
2019-08-20 11:56:01.506 +03:00 [DBG] Creating Hybrid Flow response.
2019-08-20 11:56:01.506 +03:00 [DBG] Creating Implicit Flow response.
2019-08-20 11:56:01.507 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 11:56:01.508 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 11:56:01.512 +03:00 [DBG] Authorize endpoint response
{"SubjectId":"1","ClientId":"mvc","RedirectUri":"http://localhost:5002/home/signin-oidc","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9PHAD-3eYkTgyn9-AndWzSiV9W4XFte5WU2OZZmHq3uvaiMaNkIKMAompm2cFvItbly5sCMxtZ-7fbzWqpJJigVGANtEA8CQwD1MPIpjgl7Eqi0nTd4ZWZkLGny7jiSjqr3iw_gOwgD-Lh21EmcGue9NQ-Y43s1TvSivsFd9U_NtuAFu3SM2ZT0dizAlB1tM0r8v6_1z6roNcDeoj-ppYuxbui5dRir8QSjsL83xZ5WNqUI24peazrB_G7LUtmEDGeMG7bkvM_yWks3JutIH9YQQ2JFuI5aPd7U5V6-jSau7K1Y3JKU0R1nRrlWwV8C_kI","Scope":"openid profile afcpayroll offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-08-20 11:56:01.744 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-20 11:56:01.747 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-20 11:56:01.749 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-20 11:56:01.750 +03:00 [DBG] Start token request.
2019-08-20 11:56:01.750 +03:00 [DBG] Start client validation
2019-08-20 11:56:01.751 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-20 11:56:01.751 +03:00 [DBG] Start parsing for secret in post body
2019-08-20 11:56:01.752 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-20 11:56:01.752 +03:00 [DBG] Secret id found: mvc
2019-08-20 11:56:01.753 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:56:01.753 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-20 11:56:01.756 +03:00 [DBG] Client validation success
2019-08-20 11:56:01.757 +03:00 [DBG] Start token request validation
2019-08-20 11:56:01.758 +03:00 [DBG] Start validation of authorization code token request
2019-08-20 11:56:01.760 +03:00 [DBG] Validation of authorization code token request success
2019-08-20 11:56:01.760 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"eb279e1b90a617e8952b803a00d7ebf4fb064fcb990277ae2a824a8fe4d3a4b2","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"mvc","client_secret":"***REDACTED***","code":"eb279e1b90a617e8952b803a00d7ebf4fb064fcb990277ae2a824a8fe4d3a4b2","grant_type":"authorization_code","redirect_uri":"http://localhost:5002/home/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-08-20 11:56:01.766 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:56:01.767 +03:00 [DBG] Getting claims for access token for client: mvc
2019-08-20 11:56:01.767 +03:00 [DBG] Getting claims for access token for subject: 1
2019-08-20 11:56:01.772 +03:00 [DBG] Creating refresh token
2019-08-20 11:56:01.773 +03:00 [DBG] Setting an absolute lifetime: 2592000
2019-08-20 11:56:01.773 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:56:01.774 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 11:56:01.775 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 11:56:01.780 +03:00 [DBG] Token request success.
2019-08-20 11:56:01.783 +03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-08-20 11:56:01.784 +03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-08-20 11:56:01.785 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-08-20 11:56:01.785 +03:00 [DBG] Start userinfo request
2019-08-20 11:56:01.786 +03:00 [DBG] Bearer token found in header
2019-08-20 11:56:01.789 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:56:01.791 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:56:01.792 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-08-20 11:56:01.793 +03:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1566291361,"exp":1566291421,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","afcpayroll"],"client_id":"mvc","sub":"1","auth_time":1566291348,"idp":"local","name":"alice","email":"alice@email.com","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-08-20 11:56:01.799 +03:00 [DBG] Creating userinfo response
2019-08-20 11:56:01.799 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:56:01.800 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:56:01.800 +03:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 11:56:01.801 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:56:01.801 +03:00 [INF] Profile service returned the following claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 11:56:01.802 +03:00 [DBG] End userinfo request
2019-08-20 11:56:01.894 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-08-20 11:56:01.895 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-08-20 11:56:01.896 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-08-20 11:56:01.896 +03:00 [DBG] Start authorize request
2019-08-20 11:56:01.897 +03:00 [DBG] User in authorize request: 1
2019-08-20 11:56:01.897 +03:00 [DBG] Start authorize request protocol validation
2019-08-20 11:56:01.898 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:56:01.899 +03:00 [DBG] Checking for PKCE parameters
2019-08-20 11:56:01.900 +03:00 [DBG] No PKCE used.
2019-08-20 11:56:01.900 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-20 11:56:01.901 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/home/signin-oidc","AllowedRedirectUris":["http://localhost:5002/home/signin-oidc"],"SubjectId":"1","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9NcoT-RAa-E3nuDkTuh1LBVyO0zZGZy9RYqGVrwPLEoz_fkIxoxm7AmYjuh5s5Q6JIIWFNqxiPkvG7vGYCBSUbD-TAr9UW_8PS_tOBF2EjtB99zccfN5NA_gIAwFP3HXXcL32Y8_vVzX0MjegLuP6yfPHeKzBloAibUwEb-LClz8EQfcOMFDo_Unmm0iOqkfab9OS0ek_7gL1jWlvMJ1csAEy3gQMuiljZ8lbHRVuxr-EaEg8t7W8YfcfkH_74mHHFFRmoaTQFQlTGCfrq_L_YK2f5ny8-DNW36QqsuqM6XDxuQ46orHKUDhxTjdHUW61Y","UiLocales":null,"Nonce":"637018881618605726.MDY0NGZiMDktOGY1Ni00MDg4LWIyNWQtY2VkMDExZmM3YWRiN2I5OGQyOTctYjQ2ZS00ZGY2LTg2NWEtMGU0NTFkYWE0NDFk","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"543dbf5888b66464f8fe4d706a4e3911","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/home/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637018881618605726.MDY0NGZiMDktOGY1Ni00MDg4LWIyNWQtY2VkMDExZmM3YWRiN2I5OGQyOTctYjQ2ZS00ZGY2LTg2NWEtMGU0NTFkYWE0NDFk","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9NcoT-RAa-E3nuDkTuh1LBVyO0zZGZy9RYqGVrwPLEoz_fkIxoxm7AmYjuh5s5Q6JIIWFNqxiPkvG7vGYCBSUbD-TAr9UW_8PS_tOBF2EjtB99zccfN5NA_gIAwFP3HXXcL32Y8_vVzX0MjegLuP6yfPHeKzBloAibUwEb-LClz8EQfcOMFDo_Unmm0iOqkfab9OS0ek_7gL1jWlvMJ1csAEy3gQMuiljZ8lbHRVuxr-EaEg8t7W8YfcfkH_74mHHFFRmoaTQFQlTGCfrq_L_YK2f5ny8-DNW36QqsuqM6XDxuQ46orHKUDhxTjdHUW61Y","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-20 11:56:01.909 +03:00 [DBG] Client is configured to not require consent, no consent is required
2019-08-20 11:56:01.909 +03:00 [DBG] Creating Hybrid Flow response.
2019-08-20 11:56:01.910 +03:00 [DBG] Creating Implicit Flow response.
2019-08-20 11:56:01.910 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 11:56:01.911 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 11:56:01.916 +03:00 [DBG] Authorize endpoint response
{"SubjectId":"1","ClientId":"mvc","RedirectUri":"http://localhost:5002/home/signin-oidc","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9NcoT-RAa-E3nuDkTuh1LBVyO0zZGZy9RYqGVrwPLEoz_fkIxoxm7AmYjuh5s5Q6JIIWFNqxiPkvG7vGYCBSUbD-TAr9UW_8PS_tOBF2EjtB99zccfN5NA_gIAwFP3HXXcL32Y8_vVzX0MjegLuP6yfPHeKzBloAibUwEb-LClz8EQfcOMFDo_Unmm0iOqkfab9OS0ek_7gL1jWlvMJ1csAEy3gQMuiljZ8lbHRVuxr-EaEg8t7W8YfcfkH_74mHHFFRmoaTQFQlTGCfrq_L_YK2f5ny8-DNW36QqsuqM6XDxuQ46orHKUDhxTjdHUW61Y","Scope":"openid profile afcpayroll offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-08-20 11:56:02.130 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-20 11:56:02.131 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-20 11:56:02.133 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-20 11:56:02.134 +03:00 [DBG] Start token request.
2019-08-20 11:56:02.134 +03:00 [DBG] Start client validation
2019-08-20 11:56:02.135 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-20 11:56:02.135 +03:00 [DBG] Start parsing for secret in post body
2019-08-20 11:56:02.136 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-20 11:56:02.136 +03:00 [DBG] Secret id found: mvc
2019-08-20 11:56:02.137 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:56:02.137 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-20 11:56:02.138 +03:00 [DBG] Client validation success
2019-08-20 11:56:02.139 +03:00 [DBG] Start token request validation
2019-08-20 11:56:02.139 +03:00 [DBG] Start validation of authorization code token request
2019-08-20 11:56:02.140 +03:00 [DBG] Validation of authorization code token request success
2019-08-20 11:56:02.140 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"dbbbd32cc50be50a48c22cd4f96ee12763ecf1154b2c4a9dc59f3f212dbaea6e","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"mvc","client_secret":"***REDACTED***","code":"dbbbd32cc50be50a48c22cd4f96ee12763ecf1154b2c4a9dc59f3f212dbaea6e","grant_type":"authorization_code","redirect_uri":"http://localhost:5002/home/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-08-20 11:56:02.144 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:56:02.145 +03:00 [DBG] Getting claims for access token for client: mvc
2019-08-20 11:56:02.145 +03:00 [DBG] Getting claims for access token for subject: 1
2019-08-20 11:56:02.149 +03:00 [DBG] Creating refresh token
2019-08-20 11:56:02.150 +03:00 [DBG] Setting an absolute lifetime: 2592000
2019-08-20 11:56:02.151 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:56:02.152 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 11:56:02.152 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 11:56:02.158 +03:00 [DBG] Token request success.
2019-08-20 11:56:02.162 +03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-08-20 11:56:02.162 +03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-08-20 11:56:02.163 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-08-20 11:56:02.164 +03:00 [DBG] Start userinfo request
2019-08-20 11:56:02.164 +03:00 [DBG] Bearer token found in header
2019-08-20 11:56:02.167 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:56:02.167 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:56:02.168 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-08-20 11:56:02.168 +03:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1566291362,"exp":1566291422,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","afcpayroll"],"client_id":"mvc","sub":"1","auth_time":1566291348,"idp":"local","name":"alice","email":"alice@email.com","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-08-20 11:56:02.173 +03:00 [DBG] Creating userinfo response
2019-08-20 11:56:02.174 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:56:02.174 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:56:02.175 +03:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 11:56:02.175 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:56:02.176 +03:00 [INF] Profile service returned the following claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 11:56:02.176 +03:00 [DBG] End userinfo request
2019-08-20 11:56:02.230 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-08-20 11:56:02.233 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-08-20 11:56:02.234 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-08-20 11:56:02.234 +03:00 [DBG] Start authorize request
2019-08-20 11:56:02.235 +03:00 [DBG] User in authorize request: 1
2019-08-20 11:56:02.235 +03:00 [DBG] Start authorize request protocol validation
2019-08-20 11:56:02.236 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:56:02.236 +03:00 [DBG] Checking for PKCE parameters
2019-08-20 11:56:02.236 +03:00 [DBG] No PKCE used.
2019-08-20 11:56:02.237 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-20 11:56:02.238 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/home/signin-oidc","AllowedRedirectUris":["http://localhost:5002/home/signin-oidc"],"SubjectId":"1","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9MgOuU4q5PSoP3vxCssn3ypTqigfkVnhWEDvbuD4rX8yM-FvkFgRaKgY0TqsFph3_rthabaVobHGardEgXUcNzZxslSTvLAjjFEcYFbOJ1I9hz80QNdNLQlMsfTGbYknKH70bPdj6mYWUBi0CjK5F3m-wqCzAoFFSu1-cEYT0DvZWLoXHUcJCvB8lvRjtnXqLKGF7THEfLWj7ia_I5t0dylWZ_zBmzyVgrKsjuolna1GvxekG73Nv57oMutMvM7zV1mInC331UJ-ajQSd1rEdrnKkmoiWl2x06xfx68OHQvLWUEaaDJyOAiiz4jCmO6uIw","UiLocales":null,"Nonce":"637018881622123690.YWYzYzc4ODYtYzU4Mi00MWEzLWFmMDMtYmYwMjA1ZmIwMDk1YjRhM2E1NWItZjJkMC00ZjYzLWEwZmYtM2Y5Y2U2NjM5OWUx","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"543dbf5888b66464f8fe4d706a4e3911","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/home/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637018881622123690.YWYzYzc4ODYtYzU4Mi00MWEzLWFmMDMtYmYwMjA1ZmIwMDk1YjRhM2E1NWItZjJkMC00ZjYzLWEwZmYtM2Y5Y2U2NjM5OWUx","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9MgOuU4q5PSoP3vxCssn3ypTqigfkVnhWEDvbuD4rX8yM-FvkFgRaKgY0TqsFph3_rthabaVobHGardEgXUcNzZxslSTvLAjjFEcYFbOJ1I9hz80QNdNLQlMsfTGbYknKH70bPdj6mYWUBi0CjK5F3m-wqCzAoFFSu1-cEYT0DvZWLoXHUcJCvB8lvRjtnXqLKGF7THEfLWj7ia_I5t0dylWZ_zBmzyVgrKsjuolna1GvxekG73Nv57oMutMvM7zV1mInC331UJ-ajQSd1rEdrnKkmoiWl2x06xfx68OHQvLWUEaaDJyOAiiz4jCmO6uIw","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-20 11:56:02.243 +03:00 [DBG] Client is configured to not require consent, no consent is required
2019-08-20 11:56:02.244 +03:00 [DBG] Creating Hybrid Flow response.
2019-08-20 11:56:02.244 +03:00 [DBG] Creating Implicit Flow response.
2019-08-20 11:56:02.245 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 11:56:02.248 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 11:56:02.253 +03:00 [DBG] Authorize endpoint response
{"SubjectId":"1","ClientId":"mvc","RedirectUri":"http://localhost:5002/home/signin-oidc","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9MgOuU4q5PSoP3vxCssn3ypTqigfkVnhWEDvbuD4rX8yM-FvkFgRaKgY0TqsFph3_rthabaVobHGardEgXUcNzZxslSTvLAjjFEcYFbOJ1I9hz80QNdNLQlMsfTGbYknKH70bPdj6mYWUBi0CjK5F3m-wqCzAoFFSu1-cEYT0DvZWLoXHUcJCvB8lvRjtnXqLKGF7THEfLWj7ia_I5t0dylWZ_zBmzyVgrKsjuolna1GvxekG73Nv57oMutMvM7zV1mInC331UJ-ajQSd1rEdrnKkmoiWl2x06xfx68OHQvLWUEaaDJyOAiiz4jCmO6uIw","Scope":"openid profile afcpayroll offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-08-20 11:56:02.466 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-20 11:56:02.468 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-20 11:56:02.469 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-20 11:56:02.470 +03:00 [DBG] Start token request.
2019-08-20 11:56:02.471 +03:00 [DBG] Start client validation
2019-08-20 11:56:02.471 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-20 11:56:02.472 +03:00 [DBG] Start parsing for secret in post body
2019-08-20 11:56:02.473 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-20 11:56:02.473 +03:00 [DBG] Secret id found: mvc
2019-08-20 11:56:02.474 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:56:02.474 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-20 11:56:02.475 +03:00 [DBG] Client validation success
2019-08-20 11:56:02.475 +03:00 [DBG] Start token request validation
2019-08-20 11:56:02.477 +03:00 [DBG] Start validation of authorization code token request
2019-08-20 11:56:02.478 +03:00 [DBG] Validation of authorization code token request success
2019-08-20 11:56:02.479 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"4a25be2730b9d85b158ec61a4655b5195796c95c7691a5a0f209bf9f94745cd1","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"mvc","client_secret":"***REDACTED***","code":"4a25be2730b9d85b158ec61a4655b5195796c95c7691a5a0f209bf9f94745cd1","grant_type":"authorization_code","redirect_uri":"http://localhost:5002/home/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-08-20 11:56:02.488 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:56:02.489 +03:00 [DBG] Getting claims for access token for client: mvc
2019-08-20 11:56:02.489 +03:00 [DBG] Getting claims for access token for subject: 1
2019-08-20 11:56:02.493 +03:00 [DBG] Creating refresh token
2019-08-20 11:56:02.494 +03:00 [DBG] Setting an absolute lifetime: 2592000
2019-08-20 11:56:02.495 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:56:02.496 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 11:56:02.498 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 11:56:02.502 +03:00 [DBG] Token request success.
2019-08-20 11:56:02.511 +03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-08-20 11:56:02.513 +03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-08-20 11:56:02.514 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-08-20 11:56:02.515 +03:00 [DBG] Start userinfo request
2019-08-20 11:56:02.516 +03:00 [DBG] Bearer token found in header
2019-08-20 11:56:02.519 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:56:02.520 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:56:02.520 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-08-20 11:56:02.522 +03:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1566291362,"exp":1566291422,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","afcpayroll"],"client_id":"mvc","sub":"1","auth_time":1566291348,"idp":"local","name":"alice","email":"alice@email.com","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-08-20 11:56:02.526 +03:00 [DBG] Creating userinfo response
2019-08-20 11:56:02.527 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:56:02.528 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:56:02.530 +03:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 11:56:02.531 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:56:02.532 +03:00 [INF] Profile service returned the following claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 11:56:02.532 +03:00 [DBG] End userinfo request
2019-08-20 11:56:02.583 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-08-20 11:56:02.584 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-08-20 11:56:02.584 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-08-20 11:56:02.585 +03:00 [DBG] Start authorize request
2019-08-20 11:56:02.585 +03:00 [DBG] User in authorize request: 1
2019-08-20 11:56:02.586 +03:00 [DBG] Start authorize request protocol validation
2019-08-20 11:56:02.586 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:56:02.587 +03:00 [DBG] Checking for PKCE parameters
2019-08-20 11:56:02.587 +03:00 [DBG] No PKCE used.
2019-08-20 11:56:02.588 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-20 11:56:02.590 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/home/signin-oidc","AllowedRedirectUris":["http://localhost:5002/home/signin-oidc"],"SubjectId":"1","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9MuZ7htfo2Ouw1bsKwoeXoVswp3_GywwU0Y90zHHlXFQbAF1l4Vnbj9X1WCT-Yt5goNAlJM9IxAQz118omjScPliemRM2GV4xDWu7VccEsjXhnfeVhjADSR0c-cCqD40pDal-4w1SgtvXMasbwO_YWzBRpdxVlWqb7qQVBac5e3ZIBB2fuu3Al160du5g-04OWTmueCEb7Me1oqJoZtpmGSY7Lb9YhguUoAwuD-qM1W-qY_P95Nqynx9_ZQ1vTCFAfcqyzMsF6ZzjX-DpNLfmDW_JQT_8bEeeAuWjoQ1ZGgPiUHHJu455FZ0aJlwXLpHBs","UiLocales":null,"Nonce":"637018881625653315.ZjkxMWI1MzEtYjNiZS00YWEzLThiYzUtN2RkNDJlZjgwMWE2ZWEzMjRlZmYtMGQ5MS00NTRmLTgwZjQtZWNkNWQyYjNkOGU4","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"543dbf5888b66464f8fe4d706a4e3911","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/home/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637018881625653315.ZjkxMWI1MzEtYjNiZS00YWEzLThiYzUtN2RkNDJlZjgwMWE2ZWEzMjRlZmYtMGQ5MS00NTRmLTgwZjQtZWNkNWQyYjNkOGU4","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9MuZ7htfo2Ouw1bsKwoeXoVswp3_GywwU0Y90zHHlXFQbAF1l4Vnbj9X1WCT-Yt5goNAlJM9IxAQz118omjScPliemRM2GV4xDWu7VccEsjXhnfeVhjADSR0c-cCqD40pDal-4w1SgtvXMasbwO_YWzBRpdxVlWqb7qQVBac5e3ZIBB2fuu3Al160du5g-04OWTmueCEb7Me1oqJoZtpmGSY7Lb9YhguUoAwuD-qM1W-qY_P95Nqynx9_ZQ1vTCFAfcqyzMsF6ZzjX-DpNLfmDW_JQT_8bEeeAuWjoQ1ZGgPiUHHJu455FZ0aJlwXLpHBs","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-20 11:56:02.597 +03:00 [DBG] Client is configured to not require consent, no consent is required
2019-08-20 11:56:02.597 +03:00 [DBG] Creating Hybrid Flow response.
2019-08-20 11:56:02.598 +03:00 [DBG] Creating Implicit Flow response.
2019-08-20 11:56:02.598 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 11:56:02.599 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 11:56:02.603 +03:00 [DBG] Authorize endpoint response
{"SubjectId":"1","ClientId":"mvc","RedirectUri":"http://localhost:5002/home/signin-oidc","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9MuZ7htfo2Ouw1bsKwoeXoVswp3_GywwU0Y90zHHlXFQbAF1l4Vnbj9X1WCT-Yt5goNAlJM9IxAQz118omjScPliemRM2GV4xDWu7VccEsjXhnfeVhjADSR0c-cCqD40pDal-4w1SgtvXMasbwO_YWzBRpdxVlWqb7qQVBac5e3ZIBB2fuu3Al160du5g-04OWTmueCEb7Me1oqJoZtpmGSY7Lb9YhguUoAwuD-qM1W-qY_P95Nqynx9_ZQ1vTCFAfcqyzMsF6ZzjX-DpNLfmDW_JQT_8bEeeAuWjoQ1ZGgPiUHHJu455FZ0aJlwXLpHBs","Scope":"openid profile afcpayroll offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-08-20 11:56:02.819 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-20 11:56:02.820 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-20 11:56:02.821 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-20 11:56:02.822 +03:00 [DBG] Start token request.
2019-08-20 11:56:02.823 +03:00 [DBG] Start client validation
2019-08-20 11:56:02.824 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-20 11:56:02.824 +03:00 [DBG] Start parsing for secret in post body
2019-08-20 11:56:02.825 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-20 11:56:02.825 +03:00 [DBG] Secret id found: mvc
2019-08-20 11:56:02.826 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:56:02.826 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-20 11:56:02.827 +03:00 [DBG] Client validation success
2019-08-20 11:56:02.827 +03:00 [DBG] Start token request validation
2019-08-20 11:56:02.827 +03:00 [DBG] Start validation of authorization code token request
2019-08-20 11:56:02.828 +03:00 [DBG] Validation of authorization code token request success
2019-08-20 11:56:02.828 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"3ea112020f48ac32eca83482fa9c2c523ec2d9478ad567088a7f44c8f2111d0e","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"mvc","client_secret":"***REDACTED***","code":"3ea112020f48ac32eca83482fa9c2c523ec2d9478ad567088a7f44c8f2111d0e","grant_type":"authorization_code","redirect_uri":"http://localhost:5002/home/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-08-20 11:56:02.832 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:56:02.832 +03:00 [DBG] Getting claims for access token for client: mvc
2019-08-20 11:56:02.833 +03:00 [DBG] Getting claims for access token for subject: 1
2019-08-20 11:56:02.837 +03:00 [DBG] Creating refresh token
2019-08-20 11:56:02.837 +03:00 [DBG] Setting an absolute lifetime: 2592000
2019-08-20 11:56:02.838 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:56:02.838 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 11:56:02.839 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 11:56:02.843 +03:00 [DBG] Token request success.
2019-08-20 11:56:02.848 +03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-08-20 11:56:02.848 +03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-08-20 11:56:02.849 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-08-20 11:56:02.850 +03:00 [DBG] Start userinfo request
2019-08-20 11:56:02.850 +03:00 [DBG] Bearer token found in header
2019-08-20 11:56:02.853 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:56:02.857 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:56:02.859 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-08-20 11:56:02.861 +03:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1566291362,"exp":1566291422,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","afcpayroll"],"client_id":"mvc","sub":"1","auth_time":1566291348,"idp":"local","name":"alice","email":"alice@email.com","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-08-20 11:56:02.866 +03:00 [DBG] Creating userinfo response
2019-08-20 11:56:02.868 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:56:02.869 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:56:02.870 +03:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 11:56:02.871 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:56:02.872 +03:00 [INF] Profile service returned the following claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 11:56:02.873 +03:00 [DBG] End userinfo request
2019-08-20 11:56:02.919 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-08-20 11:56:02.921 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-08-20 11:56:02.921 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-08-20 11:56:02.922 +03:00 [DBG] Start authorize request
2019-08-20 11:56:02.922 +03:00 [DBG] User in authorize request: 1
2019-08-20 11:56:02.923 +03:00 [DBG] Start authorize request protocol validation
2019-08-20 11:56:02.923 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:56:02.924 +03:00 [DBG] Checking for PKCE parameters
2019-08-20 11:56:02.924 +03:00 [DBG] No PKCE used.
2019-08-20 11:56:02.925 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-20 11:56:02.925 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/home/signin-oidc","AllowedRedirectUris":["http://localhost:5002/home/signin-oidc"],"SubjectId":"1","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9NmUwbJs2onaaFt7rSfk1vSdJNwiDpkSvoQsSD5NiuzxwUr1bYb15UaJFPUE7nZhkyY6KqsgXr9RnDoeQXOzUJTQVFvkZwMOjqzKSU4Hv2x6U6-RmvVR3SgTjShokiaszt7_7X9JJO3x8cgRfG6snnavPAbXgCbH7A65UepTpZerPBMPqWvDuiKwUFE0mT7kOQ-ko1ioiFnuZFvml_8NqWlLll4WFscUR7OIJTXqgvZKBju_-2PMvWSwrVPShHsJBy0JnhpZAaJgwhCzS2QBGrY5DDQf2vWR6AvUqrT00HuWTtmDwHhkIZ47GG4F-9exT4","UiLocales":null,"Nonce":"637018881629022867.YTY4ZTBmZjgtYmIwNC00YmYwLThkZWYtNGNkZDBmZTNlNzFlNGYzNGNmNjMtNGJkOS00YWEyLTlmY2UtYjk0OTEzZjlhNTJl","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"543dbf5888b66464f8fe4d706a4e3911","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/home/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637018881629022867.YTY4ZTBmZjgtYmIwNC00YmYwLThkZWYtNGNkZDBmZTNlNzFlNGYzNGNmNjMtNGJkOS00YWEyLTlmY2UtYjk0OTEzZjlhNTJl","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9NmUwbJs2onaaFt7rSfk1vSdJNwiDpkSvoQsSD5NiuzxwUr1bYb15UaJFPUE7nZhkyY6KqsgXr9RnDoeQXOzUJTQVFvkZwMOjqzKSU4Hv2x6U6-RmvVR3SgTjShokiaszt7_7X9JJO3x8cgRfG6snnavPAbXgCbH7A65UepTpZerPBMPqWvDuiKwUFE0mT7kOQ-ko1ioiFnuZFvml_8NqWlLll4WFscUR7OIJTXqgvZKBju_-2PMvWSwrVPShHsJBy0JnhpZAaJgwhCzS2QBGrY5DDQf2vWR6AvUqrT00HuWTtmDwHhkIZ47GG4F-9exT4","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-20 11:56:02.930 +03:00 [DBG] Client is configured to not require consent, no consent is required
2019-08-20 11:56:02.931 +03:00 [DBG] Creating Hybrid Flow response.
2019-08-20 11:56:02.931 +03:00 [DBG] Creating Implicit Flow response.
2019-08-20 11:56:02.932 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 11:56:02.932 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 11:56:02.936 +03:00 [DBG] Authorize endpoint response
{"SubjectId":"1","ClientId":"mvc","RedirectUri":"http://localhost:5002/home/signin-oidc","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9NmUwbJs2onaaFt7rSfk1vSdJNwiDpkSvoQsSD5NiuzxwUr1bYb15UaJFPUE7nZhkyY6KqsgXr9RnDoeQXOzUJTQVFvkZwMOjqzKSU4Hv2x6U6-RmvVR3SgTjShokiaszt7_7X9JJO3x8cgRfG6snnavPAbXgCbH7A65UepTpZerPBMPqWvDuiKwUFE0mT7kOQ-ko1ioiFnuZFvml_8NqWlLll4WFscUR7OIJTXqgvZKBju_-2PMvWSwrVPShHsJBy0JnhpZAaJgwhCzS2QBGrY5DDQf2vWR6AvUqrT00HuWTtmDwHhkIZ47GG4F-9exT4","Scope":"openid profile afcpayroll offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-08-20 11:56:03.146 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-20 11:56:03.147 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-20 11:56:03.148 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-20 11:56:03.148 +03:00 [DBG] Start token request.
2019-08-20 11:56:03.149 +03:00 [DBG] Start client validation
2019-08-20 11:56:03.149 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-20 11:56:03.149 +03:00 [DBG] Start parsing for secret in post body
2019-08-20 11:56:03.150 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-20 11:56:03.150 +03:00 [DBG] Secret id found: mvc
2019-08-20 11:56:03.151 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:56:03.152 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-20 11:56:03.153 +03:00 [DBG] Client validation success
2019-08-20 11:56:03.153 +03:00 [DBG] Start token request validation
2019-08-20 11:56:03.153 +03:00 [DBG] Start validation of authorization code token request
2019-08-20 11:56:03.156 +03:00 [DBG] Validation of authorization code token request success
2019-08-20 11:56:03.157 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"ab826e61048bec3b94107b81098f91e0f2944c0f745bfcbe96228bcb537c1634","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"mvc","client_secret":"***REDACTED***","code":"ab826e61048bec3b94107b81098f91e0f2944c0f745bfcbe96228bcb537c1634","grant_type":"authorization_code","redirect_uri":"http://localhost:5002/home/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-08-20 11:56:03.160 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:56:03.161 +03:00 [DBG] Getting claims for access token for client: mvc
2019-08-20 11:56:03.161 +03:00 [DBG] Getting claims for access token for subject: 1
2019-08-20 11:56:03.166 +03:00 [DBG] Creating refresh token
2019-08-20 11:56:03.167 +03:00 [DBG] Setting an absolute lifetime: 2592000
2019-08-20 11:56:03.167 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:56:03.168 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 11:56:03.168 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 11:56:03.173 +03:00 [DBG] Token request success.
2019-08-20 11:56:03.177 +03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-08-20 11:56:03.177 +03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-08-20 11:56:03.178 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-08-20 11:56:03.179 +03:00 [DBG] Start userinfo request
2019-08-20 11:56:03.179 +03:00 [DBG] Bearer token found in header
2019-08-20 11:56:03.182 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:56:03.182 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:56:03.183 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-08-20 11:56:03.184 +03:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1566291363,"exp":1566291423,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","afcpayroll"],"client_id":"mvc","sub":"1","auth_time":1566291348,"idp":"local","name":"alice","email":"alice@email.com","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-08-20 11:56:03.189 +03:00 [DBG] Creating userinfo response
2019-08-20 11:56:03.190 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:56:03.190 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:56:03.191 +03:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 11:56:03.192 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:56:03.193 +03:00 [INF] Profile service returned the following claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 11:56:03.193 +03:00 [DBG] End userinfo request
2019-08-20 11:56:03.247 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-08-20 11:56:03.248 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-08-20 11:56:03.249 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-08-20 11:56:03.249 +03:00 [DBG] Start authorize request
2019-08-20 11:56:03.250 +03:00 [DBG] User in authorize request: 1
2019-08-20 11:56:03.250 +03:00 [DBG] Start authorize request protocol validation
2019-08-20 11:56:03.251 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:56:03.251 +03:00 [DBG] Checking for PKCE parameters
2019-08-20 11:56:03.252 +03:00 [DBG] No PKCE used.
2019-08-20 11:56:03.252 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-20 11:56:03.253 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/home/signin-oidc","AllowedRedirectUris":["http://localhost:5002/home/signin-oidc"],"SubjectId":"1","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9Oi0FQp4AT_hS-OVWFKlZCXX_VLp7FByKlg8oZDFPPOW3pWSRtRzuZv2mDf3gU6B-CqIgucvc7rU-mNElH57N05uK4Oxu2yprf_kyi-kFl5YaytYI75JvxD5cjU59GxDKp6i0o5SeV9zyAw-jvHmovhfk2WIH5-ObiT9yqLMV9htadtxmAGytsTChR4jlDK76EOImzNh033LWI8HixN0U8x4J_VNxZDdWCczpCEIXxuIkVWbxOEQMHmv-Wlz9ive6ril5is44yRBNu8ZszxC9menRIntmecmCaZAjtILdFglt3-bpw985XH9sH5Vxy6VMY","UiLocales":null,"Nonce":"637018881632245735.MmFjZDcyNjYtNzBkZi00MDBkLTliYWUtZGU1YjVmMDYzMGUzMmUyNWNjMTEtOTI5ZC00YTBlLWE3ZjEtN2M4MmI2ODUwNzNk","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"543dbf5888b66464f8fe4d706a4e3911","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/home/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637018881632245735.MmFjZDcyNjYtNzBkZi00MDBkLTliYWUtZGU1YjVmMDYzMGUzMmUyNWNjMTEtOTI5ZC00YTBlLWE3ZjEtN2M4MmI2ODUwNzNk","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9Oi0FQp4AT_hS-OVWFKlZCXX_VLp7FByKlg8oZDFPPOW3pWSRtRzuZv2mDf3gU6B-CqIgucvc7rU-mNElH57N05uK4Oxu2yprf_kyi-kFl5YaytYI75JvxD5cjU59GxDKp6i0o5SeV9zyAw-jvHmovhfk2WIH5-ObiT9yqLMV9htadtxmAGytsTChR4jlDK76EOImzNh033LWI8HixN0U8x4J_VNxZDdWCczpCEIXxuIkVWbxOEQMHmv-Wlz9ive6ril5is44yRBNu8ZszxC9menRIntmecmCaZAjtILdFglt3-bpw985XH9sH5Vxy6VMY","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-20 11:56:03.258 +03:00 [DBG] Client is configured to not require consent, no consent is required
2019-08-20 11:56:03.259 +03:00 [DBG] Creating Hybrid Flow response.
2019-08-20 11:56:03.259 +03:00 [DBG] Creating Implicit Flow response.
2019-08-20 11:56:03.261 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 11:56:03.262 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 11:56:03.266 +03:00 [DBG] Authorize endpoint response
{"SubjectId":"1","ClientId":"mvc","RedirectUri":"http://localhost:5002/home/signin-oidc","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9Oi0FQp4AT_hS-OVWFKlZCXX_VLp7FByKlg8oZDFPPOW3pWSRtRzuZv2mDf3gU6B-CqIgucvc7rU-mNElH57N05uK4Oxu2yprf_kyi-kFl5YaytYI75JvxD5cjU59GxDKp6i0o5SeV9zyAw-jvHmovhfk2WIH5-ObiT9yqLMV9htadtxmAGytsTChR4jlDK76EOImzNh033LWI8HixN0U8x4J_VNxZDdWCczpCEIXxuIkVWbxOEQMHmv-Wlz9ive6ril5is44yRBNu8ZszxC9menRIntmecmCaZAjtILdFglt3-bpw985XH9sH5Vxy6VMY","Scope":"openid profile afcpayroll offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-08-20 11:56:03.542 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-20 11:56:03.544 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-20 11:56:03.545 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-20 11:56:03.546 +03:00 [DBG] Start token request.
2019-08-20 11:56:03.547 +03:00 [DBG] Start client validation
2019-08-20 11:56:03.551 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-20 11:56:03.551 +03:00 [DBG] Start parsing for secret in post body
2019-08-20 11:56:03.552 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-20 11:56:03.553 +03:00 [DBG] Secret id found: mvc
2019-08-20 11:56:03.554 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:56:03.555 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-20 11:56:03.556 +03:00 [DBG] Client validation success
2019-08-20 11:56:03.558 +03:00 [DBG] Start token request validation
2019-08-20 11:56:03.559 +03:00 [DBG] Start validation of authorization code token request
2019-08-20 11:56:03.559 +03:00 [DBG] Validation of authorization code token request success
2019-08-20 11:56:03.560 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"2430c10c15ca35c8f39225f86da1d1e9c5880da481e28461c1391bd16ba13e38","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"mvc","client_secret":"***REDACTED***","code":"2430c10c15ca35c8f39225f86da1d1e9c5880da481e28461c1391bd16ba13e38","grant_type":"authorization_code","redirect_uri":"http://localhost:5002/home/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-08-20 11:56:03.564 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:56:03.564 +03:00 [DBG] Getting claims for access token for client: mvc
2019-08-20 11:56:03.565 +03:00 [DBG] Getting claims for access token for subject: 1
2019-08-20 11:56:03.569 +03:00 [DBG] Creating refresh token
2019-08-20 11:56:03.570 +03:00 [DBG] Setting an absolute lifetime: 2592000
2019-08-20 11:56:03.571 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:56:03.572 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 11:56:03.573 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 11:56:03.577 +03:00 [DBG] Token request success.
2019-08-20 11:56:03.582 +03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-08-20 11:56:03.583 +03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-08-20 11:56:03.584 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-08-20 11:56:03.584 +03:00 [DBG] Start userinfo request
2019-08-20 11:56:03.585 +03:00 [DBG] Bearer token found in header
2019-08-20 11:56:03.589 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:56:03.590 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:56:03.591 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-08-20 11:56:03.591 +03:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1566291363,"exp":1566291423,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","afcpayroll"],"client_id":"mvc","sub":"1","auth_time":1566291348,"idp":"local","name":"alice","email":"alice@email.com","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-08-20 11:56:03.596 +03:00 [DBG] Creating userinfo response
2019-08-20 11:56:03.596 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:56:03.597 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:56:03.597 +03:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 11:56:03.598 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:56:03.599 +03:00 [INF] Profile service returned the following claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 11:56:03.599 +03:00 [DBG] End userinfo request
2019-08-20 11:56:03.653 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-08-20 11:56:03.654 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-08-20 11:56:03.655 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-08-20 11:56:03.655 +03:00 [DBG] Start authorize request
2019-08-20 11:56:03.656 +03:00 [DBG] User in authorize request: 1
2019-08-20 11:56:03.657 +03:00 [DBG] Start authorize request protocol validation
2019-08-20 11:56:03.657 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:56:03.658 +03:00 [DBG] Checking for PKCE parameters
2019-08-20 11:56:03.658 +03:00 [DBG] No PKCE used.
2019-08-20 11:56:03.659 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-20 11:56:03.659 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/home/signin-oidc","AllowedRedirectUris":["http://localhost:5002/home/signin-oidc"],"SubjectId":"1","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9OD_7RgAaUv5_bWcH3QtWNvJTu5bmTiHLrbkmbk64BMgbPNHWzxRv4NhK0um8e9YyI_Dd6nxaXMiIR9MNVQiVjZMaRjHVXI2zNaIWBygPG3cQF-W6w72RX1qAvxA7zgwSPAOoIvoo0ghtkBjDsAlxXyem7ldqcwURnjCQ1zZDzf3k2l60Vwt072GtUvU9vIotLKcFSqyLEUIuc7P7an2i9evG6wlE3Q-aJLfgsARenxA-ROj2UYBAPXS-yUV1_idSZtv91cMrIXvWiAOQW6Fv-6SbstSvO_aVdY1exMM24jWop-xymufC0iWhMtmSF5TPY","UiLocales":null,"Nonce":"637018881636322722.ZWU3ZDE0MzctMDg4OC00NzViLTljNWEtMzJjNWI0Y2RmOTI0OWI2MjFiODktMzA2Ny00NTBkLWJhNTYtOWFiZGVmZDdmMjQ0","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"543dbf5888b66464f8fe4d706a4e3911","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/home/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637018881636322722.ZWU3ZDE0MzctMDg4OC00NzViLTljNWEtMzJjNWI0Y2RmOTI0OWI2MjFiODktMzA2Ny00NTBkLWJhNTYtOWFiZGVmZDdmMjQ0","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9OD_7RgAaUv5_bWcH3QtWNvJTu5bmTiHLrbkmbk64BMgbPNHWzxRv4NhK0um8e9YyI_Dd6nxaXMiIR9MNVQiVjZMaRjHVXI2zNaIWBygPG3cQF-W6w72RX1qAvxA7zgwSPAOoIvoo0ghtkBjDsAlxXyem7ldqcwURnjCQ1zZDzf3k2l60Vwt072GtUvU9vIotLKcFSqyLEUIuc7P7an2i9evG6wlE3Q-aJLfgsARenxA-ROj2UYBAPXS-yUV1_idSZtv91cMrIXvWiAOQW6Fv-6SbstSvO_aVdY1exMM24jWop-xymufC0iWhMtmSF5TPY","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-20 11:56:03.664 +03:00 [DBG] Client is configured to not require consent, no consent is required
2019-08-20 11:56:03.665 +03:00 [DBG] Creating Hybrid Flow response.
2019-08-20 11:56:03.665 +03:00 [DBG] Creating Implicit Flow response.
2019-08-20 11:56:03.666 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 11:56:03.666 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 11:56:03.671 +03:00 [DBG] Authorize endpoint response
{"SubjectId":"1","ClientId":"mvc","RedirectUri":"http://localhost:5002/home/signin-oidc","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9OD_7RgAaUv5_bWcH3QtWNvJTu5bmTiHLrbkmbk64BMgbPNHWzxRv4NhK0um8e9YyI_Dd6nxaXMiIR9MNVQiVjZMaRjHVXI2zNaIWBygPG3cQF-W6w72RX1qAvxA7zgwSPAOoIvoo0ghtkBjDsAlxXyem7ldqcwURnjCQ1zZDzf3k2l60Vwt072GtUvU9vIotLKcFSqyLEUIuc7P7an2i9evG6wlE3Q-aJLfgsARenxA-ROj2UYBAPXS-yUV1_idSZtv91cMrIXvWiAOQW6Fv-6SbstSvO_aVdY1exMM24jWop-xymufC0iWhMtmSF5TPY","Scope":"openid profile afcpayroll offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-08-20 11:56:03.935 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-20 11:56:03.937 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-20 11:56:03.937 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-20 11:56:03.938 +03:00 [DBG] Start token request.
2019-08-20 11:56:03.940 +03:00 [DBG] Start client validation
2019-08-20 11:56:03.940 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-20 11:56:03.941 +03:00 [DBG] Start parsing for secret in post body
2019-08-20 11:56:03.941 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-20 11:56:03.942 +03:00 [DBG] Secret id found: mvc
2019-08-20 11:56:03.942 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:56:03.943 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-20 11:56:03.943 +03:00 [DBG] Client validation success
2019-08-20 11:56:03.944 +03:00 [DBG] Start token request validation
2019-08-20 11:56:03.944 +03:00 [DBG] Start validation of authorization code token request
2019-08-20 11:56:03.945 +03:00 [DBG] Validation of authorization code token request success
2019-08-20 11:56:03.946 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"10a21fd0060f6f4215e7278b3f87d8e197be0d9ba5f23b218664c78485727454","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"mvc","client_secret":"***REDACTED***","code":"10a21fd0060f6f4215e7278b3f87d8e197be0d9ba5f23b218664c78485727454","grant_type":"authorization_code","redirect_uri":"http://localhost:5002/home/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-08-20 11:56:03.949 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:56:03.950 +03:00 [DBG] Getting claims for access token for client: mvc
2019-08-20 11:56:03.950 +03:00 [DBG] Getting claims for access token for subject: 1
2019-08-20 11:56:03.954 +03:00 [DBG] Creating refresh token
2019-08-20 11:56:03.955 +03:00 [DBG] Setting an absolute lifetime: 2592000
2019-08-20 11:56:03.955 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:56:03.956 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 11:56:03.957 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 11:56:03.961 +03:00 [DBG] Token request success.
2019-08-20 11:56:03.964 +03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-08-20 11:56:03.965 +03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-08-20 11:56:03.966 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-08-20 11:56:03.966 +03:00 [DBG] Start userinfo request
2019-08-20 11:56:03.967 +03:00 [DBG] Bearer token found in header
2019-08-20 11:56:03.969 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:56:03.970 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:56:03.971 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-08-20 11:56:03.971 +03:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1566291363,"exp":1566291423,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","afcpayroll"],"client_id":"mvc","sub":"1","auth_time":1566291348,"idp":"local","name":"alice","email":"alice@email.com","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-08-20 11:56:03.975 +03:00 [DBG] Creating userinfo response
2019-08-20 11:56:03.976 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:56:03.976 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:56:03.977 +03:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 11:56:03.978 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:56:03.978 +03:00 [INF] Profile service returned the following claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 11:56:03.979 +03:00 [DBG] End userinfo request
2019-08-20 11:56:04.030 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-08-20 11:56:04.033 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-08-20 11:56:04.034 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-08-20 11:56:04.035 +03:00 [DBG] Start authorize request
2019-08-20 11:56:04.036 +03:00 [DBG] User in authorize request: 1
2019-08-20 11:56:04.036 +03:00 [DBG] Start authorize request protocol validation
2019-08-20 11:56:04.037 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:56:04.037 +03:00 [DBG] Checking for PKCE parameters
2019-08-20 11:56:04.038 +03:00 [DBG] No PKCE used.
2019-08-20 11:56:04.038 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-20 11:56:04.039 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/home/signin-oidc","AllowedRedirectUris":["http://localhost:5002/home/signin-oidc"],"SubjectId":"1","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9Pxc9DlTpeiXzCPTtoo_Mj5WNo6juQDLZv12GTZ6MeuqW2edYG6Zms6iZPztBxmmAI5geB97wY2Cg9OlX59k5Pr5Y3NxB2u3UPhOHBoAr6YoDAfNXAKf3TzWRFVxWuOXM8gRaDXvXspjFnP_jrSFkiw7QNMPpd6Z5FDzOnaZPNS6M5542jJ2v8RmUzJCPoqaG0aC2gPXu8p73rPIrmAM5I1mF5clMyXdcXu0J0eS8PfnLJ2iDfXkgbAa9_4c9yZCciJEhDE3ExGWzztDzd_em7xTB2BOZzihf4ExKLcntcdx_ql2TMmOrM3GQ8tAGA8Gx4","UiLocales":null,"Nonce":"637018881640131152.NTJmYjJmMTMtYWMwMy00MjkxLTgxZDctMGUzNDFiN2VkYjEwN2Q3ZjM0N2YtZGQ5My00NDkwLThkNTMtOWZjMDgyMDcwYjY4","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"543dbf5888b66464f8fe4d706a4e3911","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/home/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637018881640131152.NTJmYjJmMTMtYWMwMy00MjkxLTgxZDctMGUzNDFiN2VkYjEwN2Q3ZjM0N2YtZGQ5My00NDkwLThkNTMtOWZjMDgyMDcwYjY4","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9Pxc9DlTpeiXzCPTtoo_Mj5WNo6juQDLZv12GTZ6MeuqW2edYG6Zms6iZPztBxmmAI5geB97wY2Cg9OlX59k5Pr5Y3NxB2u3UPhOHBoAr6YoDAfNXAKf3TzWRFVxWuOXM8gRaDXvXspjFnP_jrSFkiw7QNMPpd6Z5FDzOnaZPNS6M5542jJ2v8RmUzJCPoqaG0aC2gPXu8p73rPIrmAM5I1mF5clMyXdcXu0J0eS8PfnLJ2iDfXkgbAa9_4c9yZCciJEhDE3ExGWzztDzd_em7xTB2BOZzihf4ExKLcntcdx_ql2TMmOrM3GQ8tAGA8Gx4","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-20 11:56:04.047 +03:00 [DBG] Client is configured to not require consent, no consent is required
2019-08-20 11:56:04.047 +03:00 [DBG] Creating Hybrid Flow response.
2019-08-20 11:56:04.048 +03:00 [DBG] Creating Implicit Flow response.
2019-08-20 11:56:04.048 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 11:56:04.049 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 11:56:04.053 +03:00 [DBG] Authorize endpoint response
{"SubjectId":"1","ClientId":"mvc","RedirectUri":"http://localhost:5002/home/signin-oidc","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9Pxc9DlTpeiXzCPTtoo_Mj5WNo6juQDLZv12GTZ6MeuqW2edYG6Zms6iZPztBxmmAI5geB97wY2Cg9OlX59k5Pr5Y3NxB2u3UPhOHBoAr6YoDAfNXAKf3TzWRFVxWuOXM8gRaDXvXspjFnP_jrSFkiw7QNMPpd6Z5FDzOnaZPNS6M5542jJ2v8RmUzJCPoqaG0aC2gPXu8p73rPIrmAM5I1mF5clMyXdcXu0J0eS8PfnLJ2iDfXkgbAa9_4c9yZCciJEhDE3ExGWzztDzd_em7xTB2BOZzihf4ExKLcntcdx_ql2TMmOrM3GQ8tAGA8Gx4","Scope":"openid profile afcpayroll offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-08-20 11:56:04.264 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-20 11:56:04.266 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-20 11:56:04.266 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-20 11:56:04.267 +03:00 [DBG] Start token request.
2019-08-20 11:56:04.267 +03:00 [DBG] Start client validation
2019-08-20 11:56:04.268 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-20 11:56:04.268 +03:00 [DBG] Start parsing for secret in post body
2019-08-20 11:56:04.269 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-20 11:56:04.269 +03:00 [DBG] Secret id found: mvc
2019-08-20 11:56:04.270 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:56:04.270 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-20 11:56:04.271 +03:00 [DBG] Client validation success
2019-08-20 11:56:04.272 +03:00 [DBG] Start token request validation
2019-08-20 11:56:04.272 +03:00 [DBG] Start validation of authorization code token request
2019-08-20 11:56:04.273 +03:00 [DBG] Validation of authorization code token request success
2019-08-20 11:56:04.273 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"6211ad40f93824fcdf6bf7548c896bcea9970df36a1e1c33f827a0b1b04fc6ea","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"mvc","client_secret":"***REDACTED***","code":"6211ad40f93824fcdf6bf7548c896bcea9970df36a1e1c33f827a0b1b04fc6ea","grant_type":"authorization_code","redirect_uri":"http://localhost:5002/home/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-08-20 11:56:04.277 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:56:04.280 +03:00 [DBG] Getting claims for access token for client: mvc
2019-08-20 11:56:04.280 +03:00 [DBG] Getting claims for access token for subject: 1
2019-08-20 11:56:04.285 +03:00 [DBG] Creating refresh token
2019-08-20 11:56:04.285 +03:00 [DBG] Setting an absolute lifetime: 2592000
2019-08-20 11:56:04.286 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:56:04.286 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 11:56:04.287 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 11:56:04.293 +03:00 [DBG] Token request success.
2019-08-20 11:56:04.298 +03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-08-20 11:56:04.299 +03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-08-20 11:56:04.300 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-08-20 11:56:04.300 +03:00 [DBG] Start userinfo request
2019-08-20 11:56:04.301 +03:00 [DBG] Bearer token found in header
2019-08-20 11:56:04.304 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:56:04.305 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:56:04.306 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-08-20 11:56:04.307 +03:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1566291364,"exp":1566291424,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","afcpayroll"],"client_id":"mvc","sub":"1","auth_time":1566291348,"idp":"local","name":"alice","email":"alice@email.com","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-08-20 11:56:04.314 +03:00 [DBG] Creating userinfo response
2019-08-20 11:56:04.315 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:56:04.315 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:56:04.316 +03:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 11:56:04.317 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:56:04.317 +03:00 [INF] Profile service returned the following claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 11:56:04.318 +03:00 [DBG] End userinfo request
2019-08-20 11:56:04.373 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-08-20 11:56:04.376 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-08-20 11:56:04.376 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-08-20 11:56:04.377 +03:00 [DBG] Start authorize request
2019-08-20 11:56:04.377 +03:00 [DBG] User in authorize request: 1
2019-08-20 11:56:04.378 +03:00 [DBG] Start authorize request protocol validation
2019-08-20 11:56:04.378 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:56:04.379 +03:00 [DBG] Checking for PKCE parameters
2019-08-20 11:56:04.379 +03:00 [DBG] No PKCE used.
2019-08-20 11:56:04.380 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-20 11:56:04.380 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/home/signin-oidc","AllowedRedirectUris":["http://localhost:5002/home/signin-oidc"],"SubjectId":"1","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9NNasaFbfBCodrUR1p03Yfz_w1x8zVEbgPgfrt7BeWItpQJube5dt_Ps-AdZAvanNQIgqPnb9agk3xjDqDDIqCZhEtNNOAEjtuRqD3DTyvZ6ze5YKir5jL6RmlVxutBI7pM26NmBFxAkvnbha0T7L-xofxbevFs_8YVoL_DRDUiQYAvxxiV7d7lWe8kx2ctzDEJS_ZJnWfqhz02jrLFqmmOGs5d-kMxfM43yTdOHpQ44bh2KgvQsrxpwgJHvMM99v5Z0Rd9pTSsZZg2r_f7YTcH5c4ZDaHr5wm0C27H4ZvURF8cld1mw5wzagAGM57tzic","UiLocales":null,"Nonce":"637018881643539860.MTk1ZTc1NWUtMjAzZC00OGFiLWJmMmQtZWE1MWZiOGY5ZTc5NTZlYjM5MmYtOTk1OS00MzlhLTgyNzktZjAwNDg3YzYxY2Vi","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"543dbf5888b66464f8fe4d706a4e3911","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/home/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637018881643539860.MTk1ZTc1NWUtMjAzZC00OGFiLWJmMmQtZWE1MWZiOGY5ZTc5NTZlYjM5MmYtOTk1OS00MzlhLTgyNzktZjAwNDg3YzYxY2Vi","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9NNasaFbfBCodrUR1p03Yfz_w1x8zVEbgPgfrt7BeWItpQJube5dt_Ps-AdZAvanNQIgqPnb9agk3xjDqDDIqCZhEtNNOAEjtuRqD3DTyvZ6ze5YKir5jL6RmlVxutBI7pM26NmBFxAkvnbha0T7L-xofxbevFs_8YVoL_DRDUiQYAvxxiV7d7lWe8kx2ctzDEJS_ZJnWfqhz02jrLFqmmOGs5d-kMxfM43yTdOHpQ44bh2KgvQsrxpwgJHvMM99v5Z0Rd9pTSsZZg2r_f7YTcH5c4ZDaHr5wm0C27H4ZvURF8cld1mw5wzagAGM57tzic","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-20 11:56:04.391 +03:00 [DBG] Client is configured to not require consent, no consent is required
2019-08-20 11:56:04.391 +03:00 [DBG] Creating Hybrid Flow response.
2019-08-20 11:56:04.392 +03:00 [DBG] Creating Implicit Flow response.
2019-08-20 11:56:04.392 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 11:56:04.393 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 11:56:04.397 +03:00 [DBG] Authorize endpoint response
{"SubjectId":"1","ClientId":"mvc","RedirectUri":"http://localhost:5002/home/signin-oidc","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9NNasaFbfBCodrUR1p03Yfz_w1x8zVEbgPgfrt7BeWItpQJube5dt_Ps-AdZAvanNQIgqPnb9agk3xjDqDDIqCZhEtNNOAEjtuRqD3DTyvZ6ze5YKir5jL6RmlVxutBI7pM26NmBFxAkvnbha0T7L-xofxbevFs_8YVoL_DRDUiQYAvxxiV7d7lWe8kx2ctzDEJS_ZJnWfqhz02jrLFqmmOGs5d-kMxfM43yTdOHpQ44bh2KgvQsrxpwgJHvMM99v5Z0Rd9pTSsZZg2r_f7YTcH5c4ZDaHr5wm0C27H4ZvURF8cld1mw5wzagAGM57tzic","Scope":"openid profile afcpayroll offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-08-20 11:56:04.625 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-20 11:56:04.627 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-20 11:56:04.627 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-20 11:56:04.628 +03:00 [DBG] Start token request.
2019-08-20 11:56:04.629 +03:00 [DBG] Start client validation
2019-08-20 11:56:04.629 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-20 11:56:04.630 +03:00 [DBG] Start parsing for secret in post body
2019-08-20 11:56:04.630 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-20 11:56:04.630 +03:00 [DBG] Secret id found: mvc
2019-08-20 11:56:04.631 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:56:04.631 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-20 11:56:04.632 +03:00 [DBG] Client validation success
2019-08-20 11:56:04.632 +03:00 [DBG] Start token request validation
2019-08-20 11:56:04.633 +03:00 [DBG] Start validation of authorization code token request
2019-08-20 11:56:04.634 +03:00 [DBG] Validation of authorization code token request success
2019-08-20 11:56:04.636 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"757e09af70e88c1a08928495b31989f60dc0292037b45b63a24fbdaa98da5ec9","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"mvc","client_secret":"***REDACTED***","code":"757e09af70e88c1a08928495b31989f60dc0292037b45b63a24fbdaa98da5ec9","grant_type":"authorization_code","redirect_uri":"http://localhost:5002/home/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-08-20 11:56:04.646 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:56:04.647 +03:00 [DBG] Getting claims for access token for client: mvc
2019-08-20 11:56:04.647 +03:00 [DBG] Getting claims for access token for subject: 1
2019-08-20 11:56:04.653 +03:00 [DBG] Creating refresh token
2019-08-20 11:56:04.654 +03:00 [DBG] Setting an absolute lifetime: 2592000
2019-08-20 11:56:04.655 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:56:04.656 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 11:56:04.657 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 11:56:04.661 +03:00 [DBG] Token request success.
2019-08-20 11:56:04.664 +03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-08-20 11:56:04.665 +03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-08-20 11:56:04.666 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-08-20 11:56:04.667 +03:00 [DBG] Start userinfo request
2019-08-20 11:56:04.667 +03:00 [DBG] Bearer token found in header
2019-08-20 11:56:04.673 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:56:04.675 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:56:04.676 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-08-20 11:56:04.676 +03:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1566291364,"exp":1566291424,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","afcpayroll"],"client_id":"mvc","sub":"1","auth_time":1566291348,"idp":"local","name":"alice","email":"alice@email.com","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-08-20 11:56:04.681 +03:00 [DBG] Creating userinfo response
2019-08-20 11:56:04.681 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:56:04.682 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:56:04.682 +03:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 11:56:04.683 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:56:04.683 +03:00 [INF] Profile service returned the following claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 11:56:04.684 +03:00 [DBG] End userinfo request
2019-08-20 11:56:04.740 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-08-20 11:56:04.741 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-08-20 11:56:04.742 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-08-20 11:56:04.742 +03:00 [DBG] Start authorize request
2019-08-20 11:56:04.743 +03:00 [DBG] User in authorize request: 1
2019-08-20 11:56:04.743 +03:00 [DBG] Start authorize request protocol validation
2019-08-20 11:56:04.744 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:56:04.744 +03:00 [DBG] Checking for PKCE parameters
2019-08-20 11:56:04.745 +03:00 [DBG] No PKCE used.
2019-08-20 11:56:04.745 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-20 11:56:04.746 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/home/signin-oidc","AllowedRedirectUris":["http://localhost:5002/home/signin-oidc"],"SubjectId":"1","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9NiYAxnwxp2Usky_yFVtBuwYwn894lj2_CPTToN_W1teakgOuMxuxcGaE7BuGUtBA83UhMDrjDnCEjkmxxRqoZ7v_eFZbcFwyYoemA6f1NA-O3A9pdPEQaK-WK01yMyNXXEmEBHd4xRmTSwVuCWZQIdgsB86xIjVb-3A2rTc-J00aF6Ph9eU73HYzDGELKr1i1FnGubsJiMX21CCKthO5IQyH1F1tgcIhfmaQULrLpn5OGcC-4pOVJCKyI576t8fRKwc7ujMrTZFBsNqAHfPP0-wLryqX2F8yGoq1-L9xjJAB1Hz80x9a4jXC4w7BVYvQU","UiLocales":null,"Nonce":"637018881647205775.Mzk3MTc5MWItZGU0OC00NTFlLTgxNGUtODM3YTUwMmQzM2MyM2VlYTlhZTctZjExZi00YjU5LTliZWItMmMzOTcyNjcyMjg5","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"543dbf5888b66464f8fe4d706a4e3911","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/home/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637018881647205775.Mzk3MTc5MWItZGU0OC00NTFlLTgxNGUtODM3YTUwMmQzM2MyM2VlYTlhZTctZjExZi00YjU5LTliZWItMmMzOTcyNjcyMjg5","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9NiYAxnwxp2Usky_yFVtBuwYwn894lj2_CPTToN_W1teakgOuMxuxcGaE7BuGUtBA83UhMDrjDnCEjkmxxRqoZ7v_eFZbcFwyYoemA6f1NA-O3A9pdPEQaK-WK01yMyNXXEmEBHd4xRmTSwVuCWZQIdgsB86xIjVb-3A2rTc-J00aF6Ph9eU73HYzDGELKr1i1FnGubsJiMX21CCKthO5IQyH1F1tgcIhfmaQULrLpn5OGcC-4pOVJCKyI576t8fRKwc7ujMrTZFBsNqAHfPP0-wLryqX2F8yGoq1-L9xjJAB1Hz80x9a4jXC4w7BVYvQU","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-20 11:56:04.752 +03:00 [DBG] Client is configured to not require consent, no consent is required
2019-08-20 11:56:04.753 +03:00 [DBG] Creating Hybrid Flow response.
2019-08-20 11:56:04.753 +03:00 [DBG] Creating Implicit Flow response.
2019-08-20 11:56:04.754 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 11:56:04.754 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 11:56:04.759 +03:00 [DBG] Authorize endpoint response
{"SubjectId":"1","ClientId":"mvc","RedirectUri":"http://localhost:5002/home/signin-oidc","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9NiYAxnwxp2Usky_yFVtBuwYwn894lj2_CPTToN_W1teakgOuMxuxcGaE7BuGUtBA83UhMDrjDnCEjkmxxRqoZ7v_eFZbcFwyYoemA6f1NA-O3A9pdPEQaK-WK01yMyNXXEmEBHd4xRmTSwVuCWZQIdgsB86xIjVb-3A2rTc-J00aF6Ph9eU73HYzDGELKr1i1FnGubsJiMX21CCKthO5IQyH1F1tgcIhfmaQULrLpn5OGcC-4pOVJCKyI576t8fRKwc7ujMrTZFBsNqAHfPP0-wLryqX2F8yGoq1-L9xjJAB1Hz80x9a4jXC4w7BVYvQU","Scope":"openid profile afcpayroll offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-08-20 11:56:04.968 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-20 11:56:04.970 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-20 11:56:04.970 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-20 11:56:04.971 +03:00 [DBG] Start token request.
2019-08-20 11:56:04.971 +03:00 [DBG] Start client validation
2019-08-20 11:56:04.972 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-20 11:56:04.972 +03:00 [DBG] Start parsing for secret in post body
2019-08-20 11:56:04.973 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-20 11:56:04.974 +03:00 [DBG] Secret id found: mvc
2019-08-20 11:56:04.975 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:56:04.975 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-20 11:56:04.976 +03:00 [DBG] Client validation success
2019-08-20 11:56:04.976 +03:00 [DBG] Start token request validation
2019-08-20 11:56:04.977 +03:00 [DBG] Start validation of authorization code token request
2019-08-20 11:56:04.977 +03:00 [DBG] Validation of authorization code token request success
2019-08-20 11:56:04.978 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"e9535887f40d7a8234f22f1da655e90143f6cef52d9669ab77ef890d24a3dfb3","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"mvc","client_secret":"***REDACTED***","code":"e9535887f40d7a8234f22f1da655e90143f6cef52d9669ab77ef890d24a3dfb3","grant_type":"authorization_code","redirect_uri":"http://localhost:5002/home/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-08-20 11:56:04.981 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:56:04.982 +03:00 [DBG] Getting claims for access token for client: mvc
2019-08-20 11:56:04.982 +03:00 [DBG] Getting claims for access token for subject: 1
2019-08-20 11:56:04.986 +03:00 [DBG] Creating refresh token
2019-08-20 11:56:04.987 +03:00 [DBG] Setting an absolute lifetime: 2592000
2019-08-20 11:56:04.988 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:56:04.989 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 11:56:04.989 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 11:56:04.994 +03:00 [DBG] Token request success.
2019-08-20 11:56:04.998 +03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-08-20 11:56:04.999 +03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-08-20 11:56:04.999 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-08-20 11:56:05.000 +03:00 [DBG] Start userinfo request
2019-08-20 11:56:05.000 +03:00 [DBG] Bearer token found in header
2019-08-20 11:56:05.004 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:56:05.004 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:56:05.005 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-08-20 11:56:05.006 +03:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1566291364,"exp":1566291424,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","afcpayroll"],"client_id":"mvc","sub":"1","auth_time":1566291348,"idp":"local","name":"alice","email":"alice@email.com","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-08-20 11:56:05.010 +03:00 [DBG] Creating userinfo response
2019-08-20 11:56:05.011 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:56:05.011 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:56:05.012 +03:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 11:56:05.014 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:56:05.015 +03:00 [INF] Profile service returned the following claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 11:56:05.016 +03:00 [DBG] End userinfo request
2019-08-20 11:56:05.067 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-08-20 11:56:05.069 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-08-20 11:56:05.069 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-08-20 11:56:05.071 +03:00 [DBG] Start authorize request
2019-08-20 11:56:05.072 +03:00 [DBG] User in authorize request: 1
2019-08-20 11:56:05.073 +03:00 [DBG] Start authorize request protocol validation
2019-08-20 11:56:05.074 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:56:05.074 +03:00 [DBG] Checking for PKCE parameters
2019-08-20 11:56:05.075 +03:00 [DBG] No PKCE used.
2019-08-20 11:56:05.075 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-20 11:56:05.076 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/home/signin-oidc","AllowedRedirectUris":["http://localhost:5002/home/signin-oidc"],"SubjectId":"1","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9PNtUkwwpzp2yP_IhWy-Rb6mPbc1Wf0N_lvwVqVBh-mRVLy8-4pePKzdYdFhtw8Nn3aoJ8zkb_87q-e1xeopivLgXPL2rn1HMcGCIucE2l55mKXKyWFaModPKX9SRTUl7OJHvFAnYxyGCbkFW-0JngdY9kXsA7SmffKURy5pMA-muGosDyxTz00ybbyL7MGZeFjUOpO8iknmPh9EKHKRYpsAhTFEHXXcahi6DHt3EqXVE2hp8rjMzvdhmopaZkJC4TlFtAEgJYg2Y-837PJf_Udy1Zs4Pu6dhUhyD13kFHI-OSTcRKcFpAq6X00JoQf0uM","UiLocales":null,"Nonce":"637018881650475818.OWZiZTU4MzktMjdjMy00NGViLWE4YWItYzMxZTcwNjdmNWYyZTFhM2MwODQtOTM1OS00YmQ4LWJkZDYtZDM0YmE1YTBiOTkx","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"543dbf5888b66464f8fe4d706a4e3911","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/home/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637018881650475818.OWZiZTU4MzktMjdjMy00NGViLWE4YWItYzMxZTcwNjdmNWYyZTFhM2MwODQtOTM1OS00YmQ4LWJkZDYtZDM0YmE1YTBiOTkx","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9PNtUkwwpzp2yP_IhWy-Rb6mPbc1Wf0N_lvwVqVBh-mRVLy8-4pePKzdYdFhtw8Nn3aoJ8zkb_87q-e1xeopivLgXPL2rn1HMcGCIucE2l55mKXKyWFaModPKX9SRTUl7OJHvFAnYxyGCbkFW-0JngdY9kXsA7SmffKURy5pMA-muGosDyxTz00ybbyL7MGZeFjUOpO8iknmPh9EKHKRYpsAhTFEHXXcahi6DHt3EqXVE2hp8rjMzvdhmopaZkJC4TlFtAEgJYg2Y-837PJf_Udy1Zs4Pu6dhUhyD13kFHI-OSTcRKcFpAq6X00JoQf0uM","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-20 11:56:05.082 +03:00 [DBG] Client is configured to not require consent, no consent is required
2019-08-20 11:56:05.083 +03:00 [DBG] Creating Hybrid Flow response.
2019-08-20 11:56:05.083 +03:00 [DBG] Creating Implicit Flow response.
2019-08-20 11:56:05.084 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 11:56:05.085 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 11:56:05.092 +03:00 [DBG] Authorize endpoint response
{"SubjectId":"1","ClientId":"mvc","RedirectUri":"http://localhost:5002/home/signin-oidc","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9PNtUkwwpzp2yP_IhWy-Rb6mPbc1Wf0N_lvwVqVBh-mRVLy8-4pePKzdYdFhtw8Nn3aoJ8zkb_87q-e1xeopivLgXPL2rn1HMcGCIucE2l55mKXKyWFaModPKX9SRTUl7OJHvFAnYxyGCbkFW-0JngdY9kXsA7SmffKURy5pMA-muGosDyxTz00ybbyL7MGZeFjUOpO8iknmPh9EKHKRYpsAhTFEHXXcahi6DHt3EqXVE2hp8rjMzvdhmopaZkJC4TlFtAEgJYg2Y-837PJf_Udy1Zs4Pu6dhUhyD13kFHI-OSTcRKcFpAq6X00JoQf0uM","Scope":"openid profile afcpayroll offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-08-20 11:56:05.350 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-20 11:56:05.353 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-20 11:56:05.357 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-20 11:56:05.361 +03:00 [DBG] Start token request.
2019-08-20 11:56:05.362 +03:00 [DBG] Start client validation
2019-08-20 11:56:05.362 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-20 11:56:05.363 +03:00 [DBG] Start parsing for secret in post body
2019-08-20 11:56:05.363 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-20 11:56:05.364 +03:00 [DBG] Secret id found: mvc
2019-08-20 11:56:05.364 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:56:05.365 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-20 11:56:05.366 +03:00 [DBG] Client validation success
2019-08-20 11:56:05.366 +03:00 [DBG] Start token request validation
2019-08-20 11:56:05.367 +03:00 [DBG] Start validation of authorization code token request
2019-08-20 11:56:05.367 +03:00 [DBG] Validation of authorization code token request success
2019-08-20 11:56:05.368 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"b78388598ce487bd79cb78c0ef854a84f795b77d2244d3cafa062c2c87011053","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"mvc","client_secret":"***REDACTED***","code":"b78388598ce487bd79cb78c0ef854a84f795b77d2244d3cafa062c2c87011053","grant_type":"authorization_code","redirect_uri":"http://localhost:5002/home/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-08-20 11:56:05.374 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:56:05.375 +03:00 [DBG] Getting claims for access token for client: mvc
2019-08-20 11:56:05.376 +03:00 [DBG] Getting claims for access token for subject: 1
2019-08-20 11:56:05.380 +03:00 [DBG] Creating refresh token
2019-08-20 11:56:05.380 +03:00 [DBG] Setting an absolute lifetime: 2592000
2019-08-20 11:56:05.381 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:56:05.382 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 11:56:05.382 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 11:56:05.387 +03:00 [DBG] Token request success.
2019-08-20 11:56:05.390 +03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-08-20 11:56:05.391 +03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-08-20 11:56:05.392 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-08-20 11:56:05.392 +03:00 [DBG] Start userinfo request
2019-08-20 11:56:05.393 +03:00 [DBG] Bearer token found in header
2019-08-20 11:56:05.395 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:56:05.396 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:56:05.397 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-08-20 11:56:05.397 +03:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1566291365,"exp":1566291425,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","afcpayroll"],"client_id":"mvc","sub":"1","auth_time":1566291348,"idp":"local","name":"alice","email":"alice@email.com","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-08-20 11:56:05.402 +03:00 [DBG] Creating userinfo response
2019-08-20 11:56:05.403 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:56:05.403 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:56:05.404 +03:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 11:56:05.404 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:56:05.405 +03:00 [INF] Profile service returned the following claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 11:56:05.406 +03:00 [DBG] End userinfo request
2019-08-20 11:56:05.460 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-08-20 11:56:05.462 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-08-20 11:56:05.463 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-08-20 11:56:05.463 +03:00 [DBG] Start authorize request
2019-08-20 11:56:05.464 +03:00 [DBG] User in authorize request: 1
2019-08-20 11:56:05.464 +03:00 [DBG] Start authorize request protocol validation
2019-08-20 11:56:05.465 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:56:05.465 +03:00 [DBG] Checking for PKCE parameters
2019-08-20 11:56:05.465 +03:00 [DBG] No PKCE used.
2019-08-20 11:56:05.466 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-20 11:56:05.467 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/home/signin-oidc","AllowedRedirectUris":["http://localhost:5002/home/signin-oidc"],"SubjectId":"1","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9P0Ly37xW3-1f_su-zQBjU_PVlZrcuS4G1-T9KSZbU5ogEGs3-HOxQ-9DyLrvMHlA_MGEIQOkuhtO9tv8_2eD_FNQD2KMFgSSAra3Wn1jc5nfybJqOliN3BIt-C6dATJMszsmOcEmBmL8jq5_VNplq0CxygiHz2ARidkKYvXSRnuWUKSan8Dmw5FGkH14eVkIF-wkyptqENta1KmPvbEcViXa98qqVV67JvZMuI-tbgiv1GqxpYVYJfyh2CnhGhjzPMm_ObS9G2AXv23UsGm8DU3YZL1XGLQzwYGKB5QTrVmxN8bzGvtXZ_orSo73Epdmg","UiLocales":null,"Nonce":"637018881654424897.NWFkYTg3MjAtOWZhZC00N2M1LWEzMmEtYmRhZTA0Mjk3ZmUyYjE0ZGU5YzgtZmQzYS00MjY4LTk4NDQtODA5ZDJiZTljMzM0","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"543dbf5888b66464f8fe4d706a4e3911","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/home/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637018881654424897.NWFkYTg3MjAtOWZhZC00N2M1LWEzMmEtYmRhZTA0Mjk3ZmUyYjE0ZGU5YzgtZmQzYS00MjY4LTk4NDQtODA5ZDJiZTljMzM0","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9P0Ly37xW3-1f_su-zQBjU_PVlZrcuS4G1-T9KSZbU5ogEGs3-HOxQ-9DyLrvMHlA_MGEIQOkuhtO9tv8_2eD_FNQD2KMFgSSAra3Wn1jc5nfybJqOliN3BIt-C6dATJMszsmOcEmBmL8jq5_VNplq0CxygiHz2ARidkKYvXSRnuWUKSan8Dmw5FGkH14eVkIF-wkyptqENta1KmPvbEcViXa98qqVV67JvZMuI-tbgiv1GqxpYVYJfyh2CnhGhjzPMm_ObS9G2AXv23UsGm8DU3YZL1XGLQzwYGKB5QTrVmxN8bzGvtXZ_orSo73Epdmg","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-20 11:56:05.472 +03:00 [DBG] Client is configured to not require consent, no consent is required
2019-08-20 11:56:05.473 +03:00 [DBG] Creating Hybrid Flow response.
2019-08-20 11:56:05.473 +03:00 [DBG] Creating Implicit Flow response.
2019-08-20 11:56:05.474 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 11:56:05.474 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 11:56:05.478 +03:00 [DBG] Authorize endpoint response
{"SubjectId":"1","ClientId":"mvc","RedirectUri":"http://localhost:5002/home/signin-oidc","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9P0Ly37xW3-1f_su-zQBjU_PVlZrcuS4G1-T9KSZbU5ogEGs3-HOxQ-9DyLrvMHlA_MGEIQOkuhtO9tv8_2eD_FNQD2KMFgSSAra3Wn1jc5nfybJqOliN3BIt-C6dATJMszsmOcEmBmL8jq5_VNplq0CxygiHz2ARidkKYvXSRnuWUKSan8Dmw5FGkH14eVkIF-wkyptqENta1KmPvbEcViXa98qqVV67JvZMuI-tbgiv1GqxpYVYJfyh2CnhGhjzPMm_ObS9G2AXv23UsGm8DU3YZL1XGLQzwYGKB5QTrVmxN8bzGvtXZ_orSo73Epdmg","Scope":"openid profile afcpayroll offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-08-20 11:56:05.703 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-20 11:56:05.706 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-20 11:56:05.708 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-20 11:56:05.709 +03:00 [DBG] Start token request.
2019-08-20 11:56:05.709 +03:00 [DBG] Start client validation
2019-08-20 11:56:05.710 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-20 11:56:05.711 +03:00 [DBG] Start parsing for secret in post body
2019-08-20 11:56:05.711 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-20 11:56:05.713 +03:00 [DBG] Secret id found: mvc
2019-08-20 11:56:05.714 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:56:05.715 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-20 11:56:05.716 +03:00 [DBG] Client validation success
2019-08-20 11:56:05.716 +03:00 [DBG] Start token request validation
2019-08-20 11:56:05.717 +03:00 [DBG] Start validation of authorization code token request
2019-08-20 11:56:05.718 +03:00 [DBG] Validation of authorization code token request success
2019-08-20 11:56:05.718 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"f73290f7d29d0212fc856e8aa150a8eedf5b60686ea63c6ac2476f7c10795296","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"mvc","client_secret":"***REDACTED***","code":"f73290f7d29d0212fc856e8aa150a8eedf5b60686ea63c6ac2476f7c10795296","grant_type":"authorization_code","redirect_uri":"http://localhost:5002/home/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-08-20 11:56:05.727 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:56:05.728 +03:00 [DBG] Getting claims for access token for client: mvc
2019-08-20 11:56:05.729 +03:00 [DBG] Getting claims for access token for subject: 1
2019-08-20 11:56:05.735 +03:00 [DBG] Creating refresh token
2019-08-20 11:56:05.736 +03:00 [DBG] Setting an absolute lifetime: 2592000
2019-08-20 11:56:05.737 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:56:05.738 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 11:56:05.739 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 11:56:05.745 +03:00 [DBG] Token request success.
2019-08-20 11:56:05.749 +03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-08-20 11:56:05.750 +03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-08-20 11:56:05.750 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-08-20 11:56:05.751 +03:00 [DBG] Start userinfo request
2019-08-20 11:56:05.751 +03:00 [DBG] Bearer token found in header
2019-08-20 11:56:05.755 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:56:05.756 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:56:05.757 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-08-20 11:56:05.759 +03:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1566291365,"exp":1566291425,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","afcpayroll"],"client_id":"mvc","sub":"1","auth_time":1566291348,"idp":"local","name":"alice","email":"alice@email.com","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-08-20 11:56:05.768 +03:00 [DBG] Creating userinfo response
2019-08-20 11:56:05.769 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:56:05.770 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:56:05.772 +03:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 11:56:05.773 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:56:05.775 +03:00 [INF] Profile service returned the following claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 11:56:05.779 +03:00 [DBG] End userinfo request
2019-08-20 11:56:05.848 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-08-20 11:56:05.849 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-08-20 11:56:05.850 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-08-20 11:56:05.851 +03:00 [DBG] Start authorize request
2019-08-20 11:56:05.851 +03:00 [DBG] User in authorize request: 1
2019-08-20 11:56:05.851 +03:00 [DBG] Start authorize request protocol validation
2019-08-20 11:56:05.852 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:56:05.852 +03:00 [DBG] Checking for PKCE parameters
2019-08-20 11:56:05.853 +03:00 [DBG] No PKCE used.
2019-08-20 11:56:05.853 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-20 11:56:05.854 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/home/signin-oidc","AllowedRedirectUris":["http://localhost:5002/home/signin-oidc"],"SubjectId":"1","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9PuAoSCGi9mc_VJ3yBpBo5033CF1TS15jgvYC_oOukA0Uu4ah4M3AlDuBPIF1pG3GMbJ5Mh_QJ5SmRLfR7t-xG8D8a4oTixtyKxVUAGA6sfTJiADdiq43LV9q10OJre6PNqZ96KaAKw5CyMPXckU57N3CguU9CU9b2fzjnSioocYr32xbignWsUl5YcQyxN11zmdj_hOxDKNyWNLhz4vxzlMPgj5vrJpVwDjX3_3P-ee0KlMN7TIlyZZu1y7mopxu7WYGU9NNFu2ano0r9g2_Vc4O-CJpAb00yxF9IYnBEkY_EyEnleOYerah-RpAiJaHU","UiLocales":null,"Nonce":"637018881658305311.OTE5YWZiZDctOTAwZC00YjM2LWIyMDYtYWMxZDJkZjcwMzI2YmZlNDNjMjEtNmRjZS00YWFmLWI2ZWEtOGNmZjY4ZjI5YmZi","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"543dbf5888b66464f8fe4d706a4e3911","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/home/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637018881658305311.OTE5YWZiZDctOTAwZC00YjM2LWIyMDYtYWMxZDJkZjcwMzI2YmZlNDNjMjEtNmRjZS00YWFmLWI2ZWEtOGNmZjY4ZjI5YmZi","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9PuAoSCGi9mc_VJ3yBpBo5033CF1TS15jgvYC_oOukA0Uu4ah4M3AlDuBPIF1pG3GMbJ5Mh_QJ5SmRLfR7t-xG8D8a4oTixtyKxVUAGA6sfTJiADdiq43LV9q10OJre6PNqZ96KaAKw5CyMPXckU57N3CguU9CU9b2fzjnSioocYr32xbignWsUl5YcQyxN11zmdj_hOxDKNyWNLhz4vxzlMPgj5vrJpVwDjX3_3P-ee0KlMN7TIlyZZu1y7mopxu7WYGU9NNFu2ano0r9g2_Vc4O-CJpAb00yxF9IYnBEkY_EyEnleOYerah-RpAiJaHU","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-20 11:56:05.860 +03:00 [DBG] Client is configured to not require consent, no consent is required
2019-08-20 11:56:05.861 +03:00 [DBG] Creating Hybrid Flow response.
2019-08-20 11:56:05.861 +03:00 [DBG] Creating Implicit Flow response.
2019-08-20 11:56:05.862 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 11:56:05.864 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 11:56:05.869 +03:00 [DBG] Authorize endpoint response
{"SubjectId":"1","ClientId":"mvc","RedirectUri":"http://localhost:5002/home/signin-oidc","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9PuAoSCGi9mc_VJ3yBpBo5033CF1TS15jgvYC_oOukA0Uu4ah4M3AlDuBPIF1pG3GMbJ5Mh_QJ5SmRLfR7t-xG8D8a4oTixtyKxVUAGA6sfTJiADdiq43LV9q10OJre6PNqZ96KaAKw5CyMPXckU57N3CguU9CU9b2fzjnSioocYr32xbignWsUl5YcQyxN11zmdj_hOxDKNyWNLhz4vxzlMPgj5vrJpVwDjX3_3P-ee0KlMN7TIlyZZu1y7mopxu7WYGU9NNFu2ano0r9g2_Vc4O-CJpAb00yxF9IYnBEkY_EyEnleOYerah-RpAiJaHU","Scope":"openid profile afcpayroll offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-08-20 11:56:06.064 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-20 11:56:06.065 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-20 11:56:06.065 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-20 11:56:06.066 +03:00 [DBG] Start token request.
2019-08-20 11:56:06.066 +03:00 [DBG] Start client validation
2019-08-20 11:56:06.067 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-20 11:56:06.067 +03:00 [DBG] Start parsing for secret in post body
2019-08-20 11:56:06.068 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-20 11:56:06.068 +03:00 [DBG] Secret id found: mvc
2019-08-20 11:56:06.068 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:56:06.069 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-20 11:56:06.069 +03:00 [DBG] Client validation success
2019-08-20 11:56:06.070 +03:00 [DBG] Start token request validation
2019-08-20 11:56:06.071 +03:00 [DBG] Start validation of authorization code token request
2019-08-20 11:56:06.072 +03:00 [DBG] Validation of authorization code token request success
2019-08-20 11:56:06.073 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"2d5894afb569005bdadc3719e6b6a893b5aa24fe7d28501d1075ca4a2a14b6d2","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"mvc","client_secret":"***REDACTED***","code":"2d5894afb569005bdadc3719e6b6a893b5aa24fe7d28501d1075ca4a2a14b6d2","grant_type":"authorization_code","redirect_uri":"http://localhost:5002/home/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-08-20 11:56:06.077 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:56:06.078 +03:00 [DBG] Getting claims for access token for client: mvc
2019-08-20 11:56:06.078 +03:00 [DBG] Getting claims for access token for subject: 1
2019-08-20 11:56:06.082 +03:00 [DBG] Creating refresh token
2019-08-20 11:56:06.083 +03:00 [DBG] Setting an absolute lifetime: 2592000
2019-08-20 11:56:06.083 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:56:06.084 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 11:56:06.084 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 11:56:06.089 +03:00 [DBG] Token request success.
2019-08-20 11:56:06.092 +03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-08-20 11:56:06.093 +03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-08-20 11:56:06.093 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-08-20 11:56:06.094 +03:00 [DBG] Start userinfo request
2019-08-20 11:56:06.094 +03:00 [DBG] Bearer token found in header
2019-08-20 11:56:06.097 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:56:06.097 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:56:06.098 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-08-20 11:56:06.099 +03:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1566291366,"exp":1566291426,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","afcpayroll"],"client_id":"mvc","sub":"1","auth_time":1566291348,"idp":"local","name":"alice","email":"alice@email.com","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-08-20 11:56:06.104 +03:00 [DBG] Creating userinfo response
2019-08-20 11:56:06.104 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:56:06.105 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:56:06.106 +03:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 11:56:06.106 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:56:06.107 +03:00 [INF] Profile service returned the following claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 11:56:06.107 +03:00 [DBG] End userinfo request
2019-08-20 11:56:06.160 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-08-20 11:56:06.162 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-08-20 11:56:06.163 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-08-20 11:56:06.164 +03:00 [DBG] Start authorize request
2019-08-20 11:56:06.164 +03:00 [DBG] User in authorize request: 1
2019-08-20 11:56:06.164 +03:00 [DBG] Start authorize request protocol validation
2019-08-20 11:56:06.165 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:56:06.166 +03:00 [DBG] Checking for PKCE parameters
2019-08-20 11:56:06.167 +03:00 [DBG] No PKCE used.
2019-08-20 11:56:06.168 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-20 11:56:06.169 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/home/signin-oidc","AllowedRedirectUris":["http://localhost:5002/home/signin-oidc"],"SubjectId":"1","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9MOHXMuMx-lxfLCq_AmSH43Bpst5EWQwdSjRwIXZ7sbUjZKR63BD7S7lEOIxdO6ZZikMkB9HsU8kP5MEkPs8TygpHxm5oufVWABEtMXcgA2LymVCA1AxcY9e2eqTtLxrVc25gOOaqVgYS29uWMmvUeaoBBzhPH7UiddYmwy0W4YfjvV-JQ-fy-Uhhk0anePblndeuDIjBx2X__gJn5r0yZMftepGj-ErxN-gjRMIYptL3snge90ipkhJo09nWqtCUb6eHo7axirQ14XNNzjMlm1zuIU_mnroCV8SlPixIptamutMkMmW9WkXOjDKJjMNM0","UiLocales":null,"Nonce":"637018881661396150.M2QyZTZlYWMtZDc1YS00M2MyLWE4NzctODY3ZDMzN2Y0MGY1NzBmNGFmYTktZWYzNC00ZTM5LTljNGUtNTRiMTk2NmNiYjUy","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"543dbf5888b66464f8fe4d706a4e3911","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/home/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637018881661396150.M2QyZTZlYWMtZDc1YS00M2MyLWE4NzctODY3ZDMzN2Y0MGY1NzBmNGFmYTktZWYzNC00ZTM5LTljNGUtNTRiMTk2NmNiYjUy","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9MOHXMuMx-lxfLCq_AmSH43Bpst5EWQwdSjRwIXZ7sbUjZKR63BD7S7lEOIxdO6ZZikMkB9HsU8kP5MEkPs8TygpHxm5oufVWABEtMXcgA2LymVCA1AxcY9e2eqTtLxrVc25gOOaqVgYS29uWMmvUeaoBBzhPH7UiddYmwy0W4YfjvV-JQ-fy-Uhhk0anePblndeuDIjBx2X__gJn5r0yZMftepGj-ErxN-gjRMIYptL3snge90ipkhJo09nWqtCUb6eHo7axirQ14XNNzjMlm1zuIU_mnroCV8SlPixIptamutMkMmW9WkXOjDKJjMNM0","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-20 11:56:06.178 +03:00 [DBG] Client is configured to not require consent, no consent is required
2019-08-20 11:56:06.179 +03:00 [DBG] Creating Hybrid Flow response.
2019-08-20 11:56:06.179 +03:00 [DBG] Creating Implicit Flow response.
2019-08-20 11:56:06.180 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 11:56:06.180 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 11:56:06.185 +03:00 [DBG] Authorize endpoint response
{"SubjectId":"1","ClientId":"mvc","RedirectUri":"http://localhost:5002/home/signin-oidc","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9MOHXMuMx-lxfLCq_AmSH43Bpst5EWQwdSjRwIXZ7sbUjZKR63BD7S7lEOIxdO6ZZikMkB9HsU8kP5MEkPs8TygpHxm5oufVWABEtMXcgA2LymVCA1AxcY9e2eqTtLxrVc25gOOaqVgYS29uWMmvUeaoBBzhPH7UiddYmwy0W4YfjvV-JQ-fy-Uhhk0anePblndeuDIjBx2X__gJn5r0yZMftepGj-ErxN-gjRMIYptL3snge90ipkhJo09nWqtCUb6eHo7axirQ14XNNzjMlm1zuIU_mnroCV8SlPixIptamutMkMmW9WkXOjDKJjMNM0","Scope":"openid profile afcpayroll offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-08-20 11:56:06.442 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-20 11:56:06.444 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-20 11:56:06.447 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-20 11:56:06.448 +03:00 [DBG] Start token request.
2019-08-20 11:56:06.448 +03:00 [DBG] Start client validation
2019-08-20 11:56:06.449 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-20 11:56:06.449 +03:00 [DBG] Start parsing for secret in post body
2019-08-20 11:56:06.450 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-20 11:56:06.450 +03:00 [DBG] Secret id found: mvc
2019-08-20 11:56:06.451 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:56:06.452 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-20 11:56:06.452 +03:00 [DBG] Client validation success
2019-08-20 11:56:06.453 +03:00 [DBG] Start token request validation
2019-08-20 11:56:06.454 +03:00 [DBG] Start validation of authorization code token request
2019-08-20 11:56:06.457 +03:00 [DBG] Validation of authorization code token request success
2019-08-20 11:56:06.457 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"0c30222537b3c70f6438accb33d3cee5496f5ac5e290ca6091e0a52c4b2d8998","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"mvc","client_secret":"***REDACTED***","code":"0c30222537b3c70f6438accb33d3cee5496f5ac5e290ca6091e0a52c4b2d8998","grant_type":"authorization_code","redirect_uri":"http://localhost:5002/home/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-08-20 11:56:06.461 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:56:06.461 +03:00 [DBG] Getting claims for access token for client: mvc
2019-08-20 11:56:06.462 +03:00 [DBG] Getting claims for access token for subject: 1
2019-08-20 11:56:06.466 +03:00 [DBG] Creating refresh token
2019-08-20 11:56:06.467 +03:00 [DBG] Setting an absolute lifetime: 2592000
2019-08-20 11:56:06.468 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:56:06.468 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 11:56:06.469 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 11:56:06.473 +03:00 [DBG] Token request success.
2019-08-20 11:56:06.477 +03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-08-20 11:56:06.478 +03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-08-20 11:56:06.479 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-08-20 11:56:06.481 +03:00 [DBG] Start userinfo request
2019-08-20 11:56:06.482 +03:00 [DBG] Bearer token found in header
2019-08-20 11:56:06.485 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:56:06.485 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:56:06.486 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-08-20 11:56:06.487 +03:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1566291366,"exp":1566291426,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","afcpayroll"],"client_id":"mvc","sub":"1","auth_time":1566291348,"idp":"local","name":"alice","email":"alice@email.com","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-08-20 11:56:06.494 +03:00 [DBG] Creating userinfo response
2019-08-20 11:56:06.494 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:56:06.495 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:56:06.496 +03:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 11:56:06.497 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:56:06.497 +03:00 [INF] Profile service returned the following claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 11:56:06.498 +03:00 [DBG] End userinfo request
2019-08-20 11:56:06.552 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-08-20 11:56:06.554 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-08-20 11:56:06.555 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-08-20 11:56:06.556 +03:00 [DBG] Start authorize request
2019-08-20 11:56:06.556 +03:00 [DBG] User in authorize request: 1
2019-08-20 11:56:06.557 +03:00 [DBG] Start authorize request protocol validation
2019-08-20 11:56:06.557 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:56:06.558 +03:00 [DBG] Checking for PKCE parameters
2019-08-20 11:56:06.558 +03:00 [DBG] No PKCE used.
2019-08-20 11:56:06.559 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-20 11:56:06.559 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/home/signin-oidc","AllowedRedirectUris":["http://localhost:5002/home/signin-oidc"],"SubjectId":"1","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9MlhZxZ9Lq7594SfyJ_HzvVH8cyNm53lwFR4HygtnQhw4TS5JeIUFNqyzVvFMXHcevpO6duxMM_OVYFGHWoSkhs0jtZh5EULAw3WPXZCubgHq9MOA6t6_yYthMfsooaaVsMaQcHfgmHs336TIOOG0rdqZNrtHvMgbcAJXgFUZAYMrS6O_-lHhbRpWjWc9eXpFe1ksbX1rhJ2WG620Mp_5UA1zCtdL2s8B2SIcc5kJX3dAQlwpHBHqpmqWuP29IVXB56-hehHeWovt4nYIHU8UjP7jbq6Aq-FqR1LbkgclLwrP2zkV0tTiZv2h1rSzni9JI","UiLocales":null,"Nonce":"637018881665336316.NzU2NDc4ZGEtMGExYy00YTdhLThiN2EtMDUzN2Q3Yjg1MjAxZjYyYWZlODItYWRjMC00ZmJiLWI4ZWQtNzViMDI5Yzg1MWFm","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"543dbf5888b66464f8fe4d706a4e3911","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/home/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637018881665336316.NzU2NDc4ZGEtMGExYy00YTdhLThiN2EtMDUzN2Q3Yjg1MjAxZjYyYWZlODItYWRjMC00ZmJiLWI4ZWQtNzViMDI5Yzg1MWFm","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9MlhZxZ9Lq7594SfyJ_HzvVH8cyNm53lwFR4HygtnQhw4TS5JeIUFNqyzVvFMXHcevpO6duxMM_OVYFGHWoSkhs0jtZh5EULAw3WPXZCubgHq9MOA6t6_yYthMfsooaaVsMaQcHfgmHs336TIOOG0rdqZNrtHvMgbcAJXgFUZAYMrS6O_-lHhbRpWjWc9eXpFe1ksbX1rhJ2WG620Mp_5UA1zCtdL2s8B2SIcc5kJX3dAQlwpHBHqpmqWuP29IVXB56-hehHeWovt4nYIHU8UjP7jbq6Aq-FqR1LbkgclLwrP2zkV0tTiZv2h1rSzni9JI","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-20 11:56:06.565 +03:00 [DBG] Client is configured to not require consent, no consent is required
2019-08-20 11:56:06.566 +03:00 [DBG] Creating Hybrid Flow response.
2019-08-20 11:56:06.567 +03:00 [DBG] Creating Implicit Flow response.
2019-08-20 11:56:06.568 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 11:56:06.569 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 11:56:06.574 +03:00 [DBG] Authorize endpoint response
{"SubjectId":"1","ClientId":"mvc","RedirectUri":"http://localhost:5002/home/signin-oidc","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9MlhZxZ9Lq7594SfyJ_HzvVH8cyNm53lwFR4HygtnQhw4TS5JeIUFNqyzVvFMXHcevpO6duxMM_OVYFGHWoSkhs0jtZh5EULAw3WPXZCubgHq9MOA6t6_yYthMfsooaaVsMaQcHfgmHs336TIOOG0rdqZNrtHvMgbcAJXgFUZAYMrS6O_-lHhbRpWjWc9eXpFe1ksbX1rhJ2WG620Mp_5UA1zCtdL2s8B2SIcc5kJX3dAQlwpHBHqpmqWuP29IVXB56-hehHeWovt4nYIHU8UjP7jbq6Aq-FqR1LbkgclLwrP2zkV0tTiZv2h1rSzni9JI","Scope":"openid profile afcpayroll offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-08-20 11:56:06.807 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-20 11:56:06.809 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-20 11:56:06.812 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-20 11:56:06.816 +03:00 [DBG] Start token request.
2019-08-20 11:56:06.819 +03:00 [DBG] Start client validation
2019-08-20 11:56:06.819 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-20 11:56:06.820 +03:00 [DBG] Start parsing for secret in post body
2019-08-20 11:56:06.824 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-20 11:56:06.827 +03:00 [DBG] Secret id found: mvc
2019-08-20 11:56:06.828 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:56:06.829 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-20 11:56:06.830 +03:00 [DBG] Client validation success
2019-08-20 11:56:06.830 +03:00 [DBG] Start token request validation
2019-08-20 11:56:06.830 +03:00 [DBG] Start validation of authorization code token request
2019-08-20 11:56:06.831 +03:00 [DBG] Validation of authorization code token request success
2019-08-20 11:56:06.833 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"62885e838f75714f13d8e32f4d306da5ef4260c2bd6744c528a600f47cbb14ce","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"mvc","client_secret":"***REDACTED***","code":"62885e838f75714f13d8e32f4d306da5ef4260c2bd6744c528a600f47cbb14ce","grant_type":"authorization_code","redirect_uri":"http://localhost:5002/home/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-08-20 11:56:06.841 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:56:06.842 +03:00 [DBG] Getting claims for access token for client: mvc
2019-08-20 11:56:06.842 +03:00 [DBG] Getting claims for access token for subject: 1
2019-08-20 11:56:06.847 +03:00 [DBG] Creating refresh token
2019-08-20 11:56:06.847 +03:00 [DBG] Setting an absolute lifetime: 2592000
2019-08-20 11:56:06.848 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:56:06.848 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 11:56:06.849 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 11:56:06.853 +03:00 [DBG] Token request success.
2019-08-20 11:56:06.861 +03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-08-20 11:56:06.862 +03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-08-20 11:56:06.862 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-08-20 11:56:06.863 +03:00 [DBG] Start userinfo request
2019-08-20 11:56:06.864 +03:00 [DBG] Bearer token found in header
2019-08-20 11:56:06.867 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:56:06.870 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:56:06.872 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-08-20 11:56:06.873 +03:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1566291366,"exp":1566291426,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","afcpayroll"],"client_id":"mvc","sub":"1","auth_time":1566291348,"idp":"local","name":"alice","email":"alice@email.com","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-08-20 11:56:06.879 +03:00 [DBG] Creating userinfo response
2019-08-20 11:56:06.879 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:56:06.880 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:56:06.880 +03:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 11:56:06.881 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:56:06.884 +03:00 [INF] Profile service returned the following claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 11:56:06.886 +03:00 [DBG] End userinfo request
2019-08-20 11:56:06.945 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-08-20 11:56:06.947 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-08-20 11:56:06.947 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-08-20 11:56:06.948 +03:00 [DBG] Start authorize request
2019-08-20 11:56:06.948 +03:00 [DBG] User in authorize request: 1
2019-08-20 11:56:06.949 +03:00 [DBG] Start authorize request protocol validation
2019-08-20 11:56:06.949 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:56:06.950 +03:00 [DBG] Checking for PKCE parameters
2019-08-20 11:56:06.950 +03:00 [DBG] No PKCE used.
2019-08-20 11:56:06.951 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-20 11:56:06.951 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/home/signin-oidc","AllowedRedirectUris":["http://localhost:5002/home/signin-oidc"],"SubjectId":"1","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9PDHcQc1gRjGhCT_pk1WVMTEyNga7-upeogIPAQDSupWS8x5UGpssU89Vsq5QX2wFQwt4UIJgx71wrdqMhIWi7RsuUwe8CMNw7yJbCjifUQV3jCFZ0QBNeR9vZYc58pTmGGVLm1ncSrpJxdsKdP4adKNRPQ90vS6MsyKmdi910Y5ohzbH4u7nCx5FsZCUh_SkuwWi39cVCVyKYi4_uln4OfqpaF7tUR_EMdRq39Zo5eA4Q-YrzjdWGAm5vCC49ap9MlyXUPE1SEe58VXzDVrBzRoAT6BgEO2pjypNX0Uuu-avDlO1gEs2S6OQkeVWKtYoA","UiLocales":null,"Nonce":"637018881669238286.OGJkMTdiZDMtZTQ1OS00NDJiLTgxMTAtOGRmY2ZmZDBiOGYwNzYzM2JlNWItNTg4NS00NzlhLWFlMGEtZDViYWFmMDg0NDcx","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"543dbf5888b66464f8fe4d706a4e3911","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/home/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637018881669238286.OGJkMTdiZDMtZTQ1OS00NDJiLTgxMTAtOGRmY2ZmZDBiOGYwNzYzM2JlNWItNTg4NS00NzlhLWFlMGEtZDViYWFmMDg0NDcx","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9PDHcQc1gRjGhCT_pk1WVMTEyNga7-upeogIPAQDSupWS8x5UGpssU89Vsq5QX2wFQwt4UIJgx71wrdqMhIWi7RsuUwe8CMNw7yJbCjifUQV3jCFZ0QBNeR9vZYc58pTmGGVLm1ncSrpJxdsKdP4adKNRPQ90vS6MsyKmdi910Y5ohzbH4u7nCx5FsZCUh_SkuwWi39cVCVyKYi4_uln4OfqpaF7tUR_EMdRq39Zo5eA4Q-YrzjdWGAm5vCC49ap9MlyXUPE1SEe58VXzDVrBzRoAT6BgEO2pjypNX0Uuu-avDlO1gEs2S6OQkeVWKtYoA","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-20 11:56:06.959 +03:00 [DBG] Client is configured to not require consent, no consent is required
2019-08-20 11:56:06.959 +03:00 [DBG] Creating Hybrid Flow response.
2019-08-20 11:56:06.960 +03:00 [DBG] Creating Implicit Flow response.
2019-08-20 11:56:06.960 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 11:56:06.961 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 11:56:06.965 +03:00 [DBG] Authorize endpoint response
{"SubjectId":"1","ClientId":"mvc","RedirectUri":"http://localhost:5002/home/signin-oidc","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9PDHcQc1gRjGhCT_pk1WVMTEyNga7-upeogIPAQDSupWS8x5UGpssU89Vsq5QX2wFQwt4UIJgx71wrdqMhIWi7RsuUwe8CMNw7yJbCjifUQV3jCFZ0QBNeR9vZYc58pTmGGVLm1ncSrpJxdsKdP4adKNRPQ90vS6MsyKmdi910Y5ohzbH4u7nCx5FsZCUh_SkuwWi39cVCVyKYi4_uln4OfqpaF7tUR_EMdRq39Zo5eA4Q-YrzjdWGAm5vCC49ap9MlyXUPE1SEe58VXzDVrBzRoAT6BgEO2pjypNX0Uuu-avDlO1gEs2S6OQkeVWKtYoA","Scope":"openid profile afcpayroll offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-08-20 11:56:07.226 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-20 11:56:07.227 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-20 11:56:07.228 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-20 11:56:07.230 +03:00 [DBG] Start token request.
2019-08-20 11:56:07.230 +03:00 [DBG] Start client validation
2019-08-20 11:56:07.231 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-20 11:56:07.232 +03:00 [DBG] Start parsing for secret in post body
2019-08-20 11:56:07.233 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-20 11:56:07.235 +03:00 [DBG] Secret id found: mvc
2019-08-20 11:56:07.236 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:56:07.236 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-20 11:56:07.237 +03:00 [DBG] Client validation success
2019-08-20 11:56:07.238 +03:00 [DBG] Start token request validation
2019-08-20 11:56:07.239 +03:00 [DBG] Start validation of authorization code token request
2019-08-20 11:56:07.240 +03:00 [DBG] Validation of authorization code token request success
2019-08-20 11:56:07.240 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"1b6f7d4f71453692f2b03640476d856955e088203e4342ae9bd54524f10450ef","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"mvc","client_secret":"***REDACTED***","code":"1b6f7d4f71453692f2b03640476d856955e088203e4342ae9bd54524f10450ef","grant_type":"authorization_code","redirect_uri":"http://localhost:5002/home/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-08-20 11:56:07.245 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:56:07.248 +03:00 [DBG] Getting claims for access token for client: mvc
2019-08-20 11:56:07.249 +03:00 [DBG] Getting claims for access token for subject: 1
2019-08-20 11:56:07.253 +03:00 [DBG] Creating refresh token
2019-08-20 11:56:07.254 +03:00 [DBG] Setting an absolute lifetime: 2592000
2019-08-20 11:56:07.255 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:56:07.256 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 11:56:07.257 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 11:56:07.262 +03:00 [DBG] Token request success.
2019-08-20 11:56:07.267 +03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-08-20 11:56:07.268 +03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-08-20 11:56:07.269 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-08-20 11:56:07.269 +03:00 [DBG] Start userinfo request
2019-08-20 11:56:07.270 +03:00 [DBG] Bearer token found in header
2019-08-20 11:56:07.273 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:56:07.274 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:56:07.274 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-08-20 11:56:07.275 +03:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1566291367,"exp":1566291427,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","afcpayroll"],"client_id":"mvc","sub":"1","auth_time":1566291348,"idp":"local","name":"alice","email":"alice@email.com","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-08-20 11:56:07.280 +03:00 [DBG] Creating userinfo response
2019-08-20 11:56:07.281 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:56:07.281 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:56:07.282 +03:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 11:56:07.282 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:56:07.283 +03:00 [INF] Profile service returned the following claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 11:56:07.284 +03:00 [DBG] End userinfo request
2019-08-20 11:56:07.335 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-08-20 11:56:07.338 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-08-20 11:56:07.338 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-08-20 11:56:07.339 +03:00 [DBG] Start authorize request
2019-08-20 11:56:07.340 +03:00 [DBG] User in authorize request: 1
2019-08-20 11:56:07.340 +03:00 [DBG] Start authorize request protocol validation
2019-08-20 11:56:07.341 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:56:07.341 +03:00 [DBG] Checking for PKCE parameters
2019-08-20 11:56:07.342 +03:00 [DBG] No PKCE used.
2019-08-20 11:56:07.342 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-20 11:56:07.343 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/home/signin-oidc","AllowedRedirectUris":["http://localhost:5002/home/signin-oidc"],"SubjectId":"1","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9PWpwuHdRSs7Ma6HT-czpwGJabgO3wXay-UjiFEygLgojhijaqY3CuICrSJidpqb60hvljf5Y4X9iUQ0JKO1z13qFdiupRqdiipzk93SlNAQKa9qn3zTDy_cyOeVP5-vCKttihQb_ooqkTIdsmOrGSQOvt6CWuYdCMmtXuVdzLuw1hThKZIzmg3L6qnUlgoLPrVz_qVevU9Vfg49SH0NB7U3WpjjMOxFhCwrkEWbv2AQc1PfpvnTRTBS7cfK5MmECJmE4UwLnAOmdTAnxIa3u7IdZB5RJoaourw9AjjAwjsx6sGJalbSlAIwYH6iXnpaAk","UiLocales":null,"Nonce":"637018881673158181.ZWJkODc3ODYtZWFhOS00N2FkLWIxNGItYTA0NDM0MzRhYjlmOGZmMzIzZTUtZDk2NS00Mzg5LThkYjUtMjFhOWQwMWEyYzNm","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"543dbf5888b66464f8fe4d706a4e3911","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/home/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637018881673158181.ZWJkODc3ODYtZWFhOS00N2FkLWIxNGItYTA0NDM0MzRhYjlmOGZmMzIzZTUtZDk2NS00Mzg5LThkYjUtMjFhOWQwMWEyYzNm","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9PWpwuHdRSs7Ma6HT-czpwGJabgO3wXay-UjiFEygLgojhijaqY3CuICrSJidpqb60hvljf5Y4X9iUQ0JKO1z13qFdiupRqdiipzk93SlNAQKa9qn3zTDy_cyOeVP5-vCKttihQb_ooqkTIdsmOrGSQOvt6CWuYdCMmtXuVdzLuw1hThKZIzmg3L6qnUlgoLPrVz_qVevU9Vfg49SH0NB7U3WpjjMOxFhCwrkEWbv2AQc1PfpvnTRTBS7cfK5MmECJmE4UwLnAOmdTAnxIa3u7IdZB5RJoaourw9AjjAwjsx6sGJalbSlAIwYH6iXnpaAk","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-20 11:56:07.348 +03:00 [DBG] Client is configured to not require consent, no consent is required
2019-08-20 11:56:07.348 +03:00 [DBG] Creating Hybrid Flow response.
2019-08-20 11:56:07.349 +03:00 [DBG] Creating Implicit Flow response.
2019-08-20 11:56:07.349 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 11:56:07.350 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 11:56:07.355 +03:00 [DBG] Authorize endpoint response
{"SubjectId":"1","ClientId":"mvc","RedirectUri":"http://localhost:5002/home/signin-oidc","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9PWpwuHdRSs7Ma6HT-czpwGJabgO3wXay-UjiFEygLgojhijaqY3CuICrSJidpqb60hvljf5Y4X9iUQ0JKO1z13qFdiupRqdiipzk93SlNAQKa9qn3zTDy_cyOeVP5-vCKttihQb_ooqkTIdsmOrGSQOvt6CWuYdCMmtXuVdzLuw1hThKZIzmg3L6qnUlgoLPrVz_qVevU9Vfg49SH0NB7U3WpjjMOxFhCwrkEWbv2AQc1PfpvnTRTBS7cfK5MmECJmE4UwLnAOmdTAnxIa3u7IdZB5RJoaourw9AjjAwjsx6sGJalbSlAIwYH6iXnpaAk","Scope":"openid profile afcpayroll offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-08-20 11:56:07.596 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-20 11:56:07.597 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-20 11:56:07.598 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-20 11:56:07.598 +03:00 [DBG] Start token request.
2019-08-20 11:56:07.599 +03:00 [DBG] Start client validation
2019-08-20 11:56:07.615 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-20 11:56:07.620 +03:00 [DBG] Start parsing for secret in post body
2019-08-20 11:56:07.621 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-20 11:56:07.622 +03:00 [DBG] Secret id found: mvc
2019-08-20 11:56:07.622 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:56:07.623 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-20 11:56:07.624 +03:00 [DBG] Client validation success
2019-08-20 11:56:07.624 +03:00 [DBG] Start token request validation
2019-08-20 11:56:07.625 +03:00 [DBG] Start validation of authorization code token request
2019-08-20 11:56:07.626 +03:00 [DBG] Validation of authorization code token request success
2019-08-20 11:56:07.626 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"853816cf3f03ce57c5897db1e9bb8a3047f55f2442c0c5c861024cb21479c4e6","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"mvc","client_secret":"***REDACTED***","code":"853816cf3f03ce57c5897db1e9bb8a3047f55f2442c0c5c861024cb21479c4e6","grant_type":"authorization_code","redirect_uri":"http://localhost:5002/home/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-08-20 11:56:07.629 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:56:07.630 +03:00 [DBG] Getting claims for access token for client: mvc
2019-08-20 11:56:07.630 +03:00 [DBG] Getting claims for access token for subject: 1
2019-08-20 11:56:07.634 +03:00 [DBG] Creating refresh token
2019-08-20 11:56:07.636 +03:00 [DBG] Setting an absolute lifetime: 2592000
2019-08-20 11:56:07.637 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:56:07.638 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 11:56:07.639 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 11:56:07.643 +03:00 [DBG] Token request success.
2019-08-20 11:56:07.647 +03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-08-20 11:56:07.647 +03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-08-20 11:56:07.648 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-08-20 11:56:07.649 +03:00 [DBG] Start userinfo request
2019-08-20 11:56:07.651 +03:00 [DBG] Bearer token found in header
2019-08-20 11:56:07.656 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:56:07.657 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:56:07.658 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-08-20 11:56:07.659 +03:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1566291367,"exp":1566291427,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","afcpayroll"],"client_id":"mvc","sub":"1","auth_time":1566291348,"idp":"local","name":"alice","email":"alice@email.com","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-08-20 11:56:07.663 +03:00 [DBG] Creating userinfo response
2019-08-20 11:56:07.664 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:56:07.664 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:56:07.670 +03:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 11:56:07.671 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:56:07.672 +03:00 [INF] Profile service returned the following claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 11:56:07.672 +03:00 [DBG] End userinfo request
2019-08-20 11:56:41.989 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-08-20 11:56:41.998 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-08-20 11:56:42.000 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-08-20 11:56:42.001 +03:00 [DBG] Start authorize request
2019-08-20 11:56:42.002 +03:00 [DBG] User in authorize request: 1
2019-08-20 11:56:42.002 +03:00 [DBG] Start authorize request protocol validation
2019-08-20 11:56:42.003 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:56:42.003 +03:00 [DBG] Checking for PKCE parameters
2019-08-20 11:56:42.004 +03:00 [DBG] No PKCE used.
2019-08-20 11:56:42.004 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-20 11:56:42.006 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/home/signin-oidc","AllowedRedirectUris":["http://localhost:5002/home/signin-oidc"],"SubjectId":"1","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9OEhCsDSdsG_EhTDrsTZWzIOFmj1Sx0XWz3CarfcBQpp71D38eer-b0MlQIUUSyB18Hk7KNXDkN_M-7nwWX0-FBFgLeGrATovIJHOBJZ_ODn77NKQkOZ5QpVInG2lJNck6acE3Dj_YnMQguMYGtO7l2uMN4Y6KRkPiOu292_0M9JkYj0UvLxU1EVAxIUtIfo67yaIVX5gZU_IAsVIG8aOBd9Q5JBSDO7Q0aJu_zT9Civ1CsYqogW95dEoVWU6v1J__S_4AgbUyHqJdln-cGVTgtvnTborgKVijvX9AiOf8oQky8GdSc9LdNFbndco65n9s","UiLocales":null,"Nonce":"637018882019728946.ZjdkZjk2ODktOTNiMi00NjRiLTg5OTktYTE0MjU5NzM2NTc4ZjVlMjQwM2ItODQ5MS00NjE4LThmYzgtMTA2YzQ5ZmI5MDdh","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"543dbf5888b66464f8fe4d706a4e3911","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/home/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637018882019728946.ZjdkZjk2ODktOTNiMi00NjRiLTg5OTktYTE0MjU5NzM2NTc4ZjVlMjQwM2ItODQ5MS00NjE4LThmYzgtMTA2YzQ5ZmI5MDdh","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9OEhCsDSdsG_EhTDrsTZWzIOFmj1Sx0XWz3CarfcBQpp71D38eer-b0MlQIUUSyB18Hk7KNXDkN_M-7nwWX0-FBFgLeGrATovIJHOBJZ_ODn77NKQkOZ5QpVInG2lJNck6acE3Dj_YnMQguMYGtO7l2uMN4Y6KRkPiOu292_0M9JkYj0UvLxU1EVAxIUtIfo67yaIVX5gZU_IAsVIG8aOBd9Q5JBSDO7Q0aJu_zT9Civ1CsYqogW95dEoVWU6v1J__S_4AgbUyHqJdln-cGVTgtvnTborgKVijvX9AiOf8oQky8GdSc9LdNFbndco65n9s","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-20 11:56:42.014 +03:00 [DBG] Client is configured to not require consent, no consent is required
2019-08-20 11:56:42.015 +03:00 [DBG] Creating Hybrid Flow response.
2019-08-20 11:56:42.016 +03:00 [DBG] Creating Implicit Flow response.
2019-08-20 11:56:42.016 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 11:56:42.017 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 11:56:42.022 +03:00 [DBG] Authorize endpoint response
{"SubjectId":"1","ClientId":"mvc","RedirectUri":"http://localhost:5002/home/signin-oidc","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9OEhCsDSdsG_EhTDrsTZWzIOFmj1Sx0XWz3CarfcBQpp71D38eer-b0MlQIUUSyB18Hk7KNXDkN_M-7nwWX0-FBFgLeGrATovIJHOBJZ_ODn77NKQkOZ5QpVInG2lJNck6acE3Dj_YnMQguMYGtO7l2uMN4Y6KRkPiOu292_0M9JkYj0UvLxU1EVAxIUtIfo67yaIVX5gZU_IAsVIG8aOBd9Q5JBSDO7Q0aJu_zT9Civ1CsYqogW95dEoVWU6v1J__S_4AgbUyHqJdln-cGVTgtvnTborgKVijvX9AiOf8oQky8GdSc9LdNFbndco65n9s","Scope":"openid profile afcpayroll offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-08-20 11:56:42.267 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-20 11:56:42.268 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-20 11:56:42.268 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-20 11:56:42.269 +03:00 [DBG] Start token request.
2019-08-20 11:56:42.269 +03:00 [DBG] Start client validation
2019-08-20 11:56:42.270 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-20 11:56:42.271 +03:00 [DBG] Start parsing for secret in post body
2019-08-20 11:56:42.271 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-20 11:56:42.272 +03:00 [DBG] Secret id found: mvc
2019-08-20 11:56:42.272 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:56:42.273 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-20 11:56:42.273 +03:00 [DBG] Client validation success
2019-08-20 11:56:42.273 +03:00 [DBG] Start token request validation
2019-08-20 11:56:42.274 +03:00 [DBG] Start validation of authorization code token request
2019-08-20 11:56:42.274 +03:00 [DBG] Validation of authorization code token request success
2019-08-20 11:56:42.275 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"cace6cd9956def5cc426ae3ffd11aeb899b27abfce0c19954f6a6f3e78757560","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"mvc","client_secret":"***REDACTED***","code":"cace6cd9956def5cc426ae3ffd11aeb899b27abfce0c19954f6a6f3e78757560","grant_type":"authorization_code","redirect_uri":"http://localhost:5002/home/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-08-20 11:56:42.278 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:56:42.279 +03:00 [DBG] Getting claims for access token for client: mvc
2019-08-20 11:56:42.280 +03:00 [DBG] Getting claims for access token for subject: 1
2019-08-20 11:56:42.284 +03:00 [DBG] Creating refresh token
2019-08-20 11:56:42.284 +03:00 [DBG] Setting an absolute lifetime: 2592000
2019-08-20 11:56:42.285 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:56:42.285 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 11:56:42.286 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 11:56:42.290 +03:00 [DBG] Token request success.
2019-08-20 11:56:42.294 +03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-08-20 11:56:42.295 +03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-08-20 11:56:42.296 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-08-20 11:56:42.296 +03:00 [DBG] Start userinfo request
2019-08-20 11:56:42.297 +03:00 [DBG] Bearer token found in header
2019-08-20 11:56:42.299 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:56:42.300 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:56:42.300 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-08-20 11:56:42.301 +03:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1566291402,"exp":1566291462,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","afcpayroll"],"client_id":"mvc","sub":"1","auth_time":1566291348,"idp":"local","name":"alice","email":"alice@email.com","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-08-20 11:56:42.305 +03:00 [DBG] Creating userinfo response
2019-08-20 11:56:42.306 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:56:42.306 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:56:42.307 +03:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 11:56:42.307 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:56:42.308 +03:00 [INF] Profile service returned the following claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 11:56:42.308 +03:00 [DBG] End userinfo request
2019-08-20 11:57:22.901 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-08-20 11:57:22.909 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-08-20 11:57:22.910 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-08-20 11:57:22.910 +03:00 [DBG] Start authorize request
2019-08-20 11:57:22.911 +03:00 [DBG] No user present in authorize request
2019-08-20 11:57:22.912 +03:00 [DBG] Start authorize request protocol validation
2019-08-20 11:57:22.914 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:57:22.915 +03:00 [DBG] Checking for PKCE parameters
2019-08-20 11:57:22.916 +03:00 [DBG] No PKCE used.
2019-08-20 11:57:22.916 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-20 11:57:22.917 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/home/signin-oidc","AllowedRedirectUris":["http://localhost:5002/home/signin-oidc"],"SubjectId":"anonymous","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9PooiZd4wmFlwktk2ba80vVRG0ONxBgYU7GymPLHBwLkAvK9IeIosJuudOXTDgy8TlxERwVOeGIu2jS8ERrETV1zeoeV_mCQLBHucJF3zk9fIcNQwLPNHQoI5yfT_QdNwcO9A4HjyJfFHdtST2AvSwbNYmhEkCCEa0ABboIUJWz_E4RMg0YwbRx1S2zbeRp-EB4r4XONPxmA-A6XPoW7-ECYjk_CEU9dX4UqOrf_f0Cyj8QSP8MFDJ9eKI6nMmGh_hRzHae6CFkDHYf2m11ToYZ85jFkvQknskmMnRVPKDA_DtEKBBvVdk4N7BfQNe8q0o","UiLocales":null,"Nonce":"637018882428790579.Mzg4NDgwY2QtNjZhYS00NzAxLTg4ODMtNmQ0MjhlZTk1ZDA3OTIwYjk3ZDktMjc4Mi00NWQ1LThjNjctZDJmN2MyN2FkOWEy","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/home/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637018882428790579.Mzg4NDgwY2QtNjZhYS00NzAxLTg4ODMtNmQ0MjhlZTk1ZDA3OTIwYjk3ZDktMjc4Mi00NWQ1LThjNjctZDJmN2MyN2FkOWEy","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9PooiZd4wmFlwktk2ba80vVRG0ONxBgYU7GymPLHBwLkAvK9IeIosJuudOXTDgy8TlxERwVOeGIu2jS8ERrETV1zeoeV_mCQLBHucJF3zk9fIcNQwLPNHQoI5yfT_QdNwcO9A4HjyJfFHdtST2AvSwbNYmhEkCCEa0ABboIUJWz_E4RMg0YwbRx1S2zbeRp-EB4r4XONPxmA-A6XPoW7-ECYjk_CEU9dX4UqOrf_f0Cyj8QSP8MFDJ9eKI6nMmGh_hRzHae6CFkDHYf2m11ToYZ85jFkvQknskmMnRVPKDA_DtEKBBvVdk4N7BfQNe8q0o","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-20 11:57:22.926 +03:00 [INF] Showing login: User is not authenticated
2019-08-20 11:57:22.938 +03:00 [DBG] Start authorize request protocol validation
2019-08-20 11:57:22.939 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:57:22.940 +03:00 [DBG] Checking for PKCE parameters
2019-08-20 11:57:22.940 +03:00 [DBG] No PKCE used.
2019-08-20 11:57:22.941 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-20 11:57:22.941 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:57:26.314 +03:00 [DBG] CORS request made for path: /account/login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-08-20 11:57:26.318 +03:00 [DBG] Start authorize request protocol validation
2019-08-20 11:57:26.319 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:57:26.321 +03:00 [DBG] Checking for PKCE parameters
2019-08-20 11:57:26.322 +03:00 [DBG] No PKCE used.
2019-08-20 11:57:26.323 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-20 11:57:26.324 +03:00 [DBG] Augmenting SignInContext
2019-08-20 11:57:26.324 +03:00 [DBG] Adding idp claim with value: local
2019-08-20 11:57:26.329 +03:00 [DBG] Adding amr claim with value: pwd
2019-08-20 11:57:26.331 +03:00 [INF] AuthenticationScheme: idsrv signed in.
2019-08-20 11:57:26.332 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:57:26.346 +03:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-08-20 11:57:26.347 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-08-20 11:57:26.347 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-08-20 11:57:26.348 +03:00 [DBG] Start authorize callback request
2019-08-20 11:57:26.349 +03:00 [DBG] User in authorize request: 1
2019-08-20 11:57:26.349 +03:00 [DBG] Start authorize request protocol validation
2019-08-20 11:57:26.350 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:57:26.350 +03:00 [DBG] Checking for PKCE parameters
2019-08-20 11:57:26.351 +03:00 [DBG] No PKCE used.
2019-08-20 11:57:26.351 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-20 11:57:26.352 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/home/signin-oidc","AllowedRedirectUris":["http://localhost:5002/home/signin-oidc"],"SubjectId":"1","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9PooiZd4wmFlwktk2ba80vVRG0ONxBgYU7GymPLHBwLkAvK9IeIosJuudOXTDgy8TlxERwVOeGIu2jS8ERrETV1zeoeV_mCQLBHucJF3zk9fIcNQwLPNHQoI5yfT_QdNwcO9A4HjyJfFHdtST2AvSwbNYmhEkCCEa0ABboIUJWz_E4RMg0YwbRx1S2zbeRp-EB4r4XONPxmA-A6XPoW7-ECYjk_CEU9dX4UqOrf_f0Cyj8QSP8MFDJ9eKI6nMmGh_hRzHae6CFkDHYf2m11ToYZ85jFkvQknskmMnRVPKDA_DtEKBBvVdk4N7BfQNe8q0o","UiLocales":null,"Nonce":"637018882428790579.Mzg4NDgwY2QtNjZhYS00NzAxLTg4ODMtNmQ0MjhlZTk1ZDA3OTIwYjk3ZDktMjc4Mi00NWQ1LThjNjctZDJmN2MyN2FkOWEy","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"91aefd42fcb7a7c3b8fb314ba55439ba","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/home/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637018882428790579.Mzg4NDgwY2QtNjZhYS00NzAxLTg4ODMtNmQ0MjhlZTk1ZDA3OTIwYjk3ZDktMjc4Mi00NWQ1LThjNjctZDJmN2MyN2FkOWEy","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9PooiZd4wmFlwktk2ba80vVRG0ONxBgYU7GymPLHBwLkAvK9IeIosJuudOXTDgy8TlxERwVOeGIu2jS8ERrETV1zeoeV_mCQLBHucJF3zk9fIcNQwLPNHQoI5yfT_QdNwcO9A4HjyJfFHdtST2AvSwbNYmhEkCCEa0ABboIUJWz_E4RMg0YwbRx1S2zbeRp-EB4r4XONPxmA-A6XPoW7-ECYjk_CEU9dX4UqOrf_f0Cyj8QSP8MFDJ9eKI6nMmGh_hRzHae6CFkDHYf2m11ToYZ85jFkvQknskmMnRVPKDA_DtEKBBvVdk4N7BfQNe8q0o","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-20 11:57:26.361 +03:00 [DBG] Client is configured to not require consent, no consent is required
2019-08-20 11:57:26.363 +03:00 [DBG] Creating Hybrid Flow response.
2019-08-20 11:57:26.365 +03:00 [DBG] Creating Implicit Flow response.
2019-08-20 11:57:26.366 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 11:57:26.366 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 11:57:26.371 +03:00 [DBG] Authorize endpoint response
{"SubjectId":"1","ClientId":"mvc","RedirectUri":"http://localhost:5002/home/signin-oidc","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9PooiZd4wmFlwktk2ba80vVRG0ONxBgYU7GymPLHBwLkAvK9IeIosJuudOXTDgy8TlxERwVOeGIu2jS8ERrETV1zeoeV_mCQLBHucJF3zk9fIcNQwLPNHQoI5yfT_QdNwcO9A4HjyJfFHdtST2AvSwbNYmhEkCCEa0ABboIUJWz_E4RMg0YwbRx1S2zbeRp-EB4r4XONPxmA-A6XPoW7-ECYjk_CEU9dX4UqOrf_f0Cyj8QSP8MFDJ9eKI6nMmGh_hRzHae6CFkDHYf2m11ToYZ85jFkvQknskmMnRVPKDA_DtEKBBvVdk4N7BfQNe8q0o","Scope":"openid profile afcpayroll offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-08-20 11:57:26.378 +03:00 [DBG] Augmenting SignInContext
2019-08-20 11:57:26.379 +03:00 [INF] AuthenticationScheme: idsrv signed in.
2019-08-20 11:57:26.674 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-20 11:57:26.675 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-20 11:57:26.676 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-20 11:57:26.676 +03:00 [DBG] Start token request.
2019-08-20 11:57:26.677 +03:00 [DBG] Start client validation
2019-08-20 11:57:26.677 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-20 11:57:26.678 +03:00 [DBG] Start parsing for secret in post body
2019-08-20 11:57:26.679 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-20 11:57:26.679 +03:00 [DBG] Secret id found: mvc
2019-08-20 11:57:26.680 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:57:26.680 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-20 11:57:26.681 +03:00 [DBG] Client validation success
2019-08-20 11:57:26.681 +03:00 [DBG] Start token request validation
2019-08-20 11:57:26.682 +03:00 [DBG] Start validation of authorization code token request
2019-08-20 11:57:26.683 +03:00 [DBG] Validation of authorization code token request success
2019-08-20 11:57:26.683 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"16596c51bf74220fa01e6ce8ce41f89d60a6712e0203ab819b60a2d89b837b1d","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"mvc","client_secret":"***REDACTED***","code":"16596c51bf74220fa01e6ce8ce41f89d60a6712e0203ab819b60a2d89b837b1d","grant_type":"authorization_code","redirect_uri":"http://localhost:5002/home/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-08-20 11:57:26.690 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:57:26.691 +03:00 [DBG] Getting claims for access token for client: mvc
2019-08-20 11:57:26.692 +03:00 [DBG] Getting claims for access token for subject: 1
2019-08-20 11:57:26.698 +03:00 [DBG] Creating refresh token
2019-08-20 11:57:26.698 +03:00 [DBG] Setting an absolute lifetime: 2592000
2019-08-20 11:57:26.699 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:57:26.700 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 11:57:26.700 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 11:57:26.706 +03:00 [DBG] Token request success.
2019-08-20 11:57:26.721 +03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-08-20 11:57:26.722 +03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-08-20 11:57:26.723 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-08-20 11:57:26.724 +03:00 [DBG] Start userinfo request
2019-08-20 11:57:26.724 +03:00 [DBG] Bearer token found in header
2019-08-20 11:57:26.728 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:57:26.729 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:57:26.729 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-08-20 11:57:26.730 +03:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1566291446,"exp":1566291506,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","afcpayroll"],"client_id":"mvc","sub":"1","auth_time":1566291446,"idp":"local","name":"alice","email":"alice@email.com","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-08-20 11:57:26.734 +03:00 [DBG] Creating userinfo response
2019-08-20 11:57:26.734 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:57:26.735 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:57:26.735 +03:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 11:57:26.736 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:57:26.737 +03:00 [INF] Profile service returned the following claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 11:57:26.738 +03:00 [DBG] End userinfo request
2019-08-20 11:57:31.873 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-08-20 11:57:31.876 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-08-20 11:57:31.877 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-08-20 11:57:31.877 +03:00 [DBG] Start authorize request
2019-08-20 11:57:31.878 +03:00 [DBG] User in authorize request: 1
2019-08-20 11:57:31.878 +03:00 [DBG] Start authorize request protocol validation
2019-08-20 11:57:31.879 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:57:31.880 +03:00 [DBG] Checking for PKCE parameters
2019-08-20 11:57:31.880 +03:00 [DBG] No PKCE used.
2019-08-20 11:57:31.881 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-20 11:57:31.881 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/home/signin-oidc","AllowedRedirectUris":["http://localhost:5002/home/signin-oidc"],"SubjectId":"1","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9MvWwcJ-9tB3Z1eTALBFXm0Z_w_k5DS8HH7RoVTzN3FhCmvVyQxwb42qqKXe21sH3b3MduoSzSY9nuQCPvLFkjY0xCKCGbY7w1bx8q450wiWzHhOCG-E-NHBMVg35PBzvnphhWIkYn0T-o56OpaZEYekj2OmBbvJReruzbCG8OUBXBju4toMd8YkWwMftQlWif8zgH_kYS_CBEE8LWw4CvS88pGyDYJcZIw6NAsUzp4EtJeZBLZwiMstY-X8bTYwUFreor_G3zCQ9KdQU9cLwGJGuxaNe9jtE78WR279mKWjyifJv3GmQmZM3W-dTtl2Ds","UiLocales":null,"Nonce":"637018882518576210.NzRhZTljY2MtZTY2Yi00ZmVmLTg3MjktN2IwOWE5Mzk2MTE0NDYzYzY5MDQtM2IyNi00NTVkLWE3MWQtNzkxN2RlYzVkNTQ0","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"91aefd42fcb7a7c3b8fb314ba55439ba","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/home/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637018882518576210.NzRhZTljY2MtZTY2Yi00ZmVmLTg3MjktN2IwOWE5Mzk2MTE0NDYzYzY5MDQtM2IyNi00NTVkLWE3MWQtNzkxN2RlYzVkNTQ0","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9MvWwcJ-9tB3Z1eTALBFXm0Z_w_k5DS8HH7RoVTzN3FhCmvVyQxwb42qqKXe21sH3b3MduoSzSY9nuQCPvLFkjY0xCKCGbY7w1bx8q450wiWzHhOCG-E-NHBMVg35PBzvnphhWIkYn0T-o56OpaZEYekj2OmBbvJReruzbCG8OUBXBju4toMd8YkWwMftQlWif8zgH_kYS_CBEE8LWw4CvS88pGyDYJcZIw6NAsUzp4EtJeZBLZwiMstY-X8bTYwUFreor_G3zCQ9KdQU9cLwGJGuxaNe9jtE78WR279mKWjyifJv3GmQmZM3W-dTtl2Ds","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-20 11:57:31.889 +03:00 [DBG] Client is configured to not require consent, no consent is required
2019-08-20 11:57:31.890 +03:00 [DBG] Creating Hybrid Flow response.
2019-08-20 11:57:31.892 +03:00 [DBG] Creating Implicit Flow response.
2019-08-20 11:57:31.893 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 11:57:31.894 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 11:57:31.899 +03:00 [DBG] Authorize endpoint response
{"SubjectId":"1","ClientId":"mvc","RedirectUri":"http://localhost:5002/home/signin-oidc","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9MvWwcJ-9tB3Z1eTALBFXm0Z_w_k5DS8HH7RoVTzN3FhCmvVyQxwb42qqKXe21sH3b3MduoSzSY9nuQCPvLFkjY0xCKCGbY7w1bx8q450wiWzHhOCG-E-NHBMVg35PBzvnphhWIkYn0T-o56OpaZEYekj2OmBbvJReruzbCG8OUBXBju4toMd8YkWwMftQlWif8zgH_kYS_CBEE8LWw4CvS88pGyDYJcZIw6NAsUzp4EtJeZBLZwiMstY-X8bTYwUFreor_G3zCQ9KdQU9cLwGJGuxaNe9jtE78WR279mKWjyifJv3GmQmZM3W-dTtl2Ds","Scope":"openid profile afcpayroll offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-08-20 11:57:32.188 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-20 11:57:32.189 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-20 11:57:32.189 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-20 11:57:32.190 +03:00 [DBG] Start token request.
2019-08-20 11:57:32.191 +03:00 [DBG] Start client validation
2019-08-20 11:57:32.191 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-20 11:57:32.192 +03:00 [DBG] Start parsing for secret in post body
2019-08-20 11:57:32.192 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-20 11:57:32.193 +03:00 [DBG] Secret id found: mvc
2019-08-20 11:57:32.194 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:57:32.194 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-20 11:57:32.195 +03:00 [DBG] Client validation success
2019-08-20 11:57:32.195 +03:00 [DBG] Start token request validation
2019-08-20 11:57:32.196 +03:00 [DBG] Start validation of authorization code token request
2019-08-20 11:57:32.196 +03:00 [DBG] Validation of authorization code token request success
2019-08-20 11:57:32.197 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"c556868361c5d71269d171e70e2175e2efbba50f175c94e10cb3b1f1aff92a5d","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"mvc","client_secret":"***REDACTED***","code":"c556868361c5d71269d171e70e2175e2efbba50f175c94e10cb3b1f1aff92a5d","grant_type":"authorization_code","redirect_uri":"http://localhost:5002/home/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-08-20 11:57:32.200 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:57:32.201 +03:00 [DBG] Getting claims for access token for client: mvc
2019-08-20 11:57:32.202 +03:00 [DBG] Getting claims for access token for subject: 1
2019-08-20 11:57:32.207 +03:00 [DBG] Creating refresh token
2019-08-20 11:57:32.208 +03:00 [DBG] Setting an absolute lifetime: 2592000
2019-08-20 11:57:32.209 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:57:32.209 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 11:57:32.210 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 11:57:32.214 +03:00 [DBG] Token request success.
2019-08-20 11:57:32.217 +03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-08-20 11:57:32.218 +03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-08-20 11:57:32.219 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-08-20 11:57:32.219 +03:00 [DBG] Start userinfo request
2019-08-20 11:57:32.220 +03:00 [DBG] Bearer token found in header
2019-08-20 11:57:32.222 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:57:32.223 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:57:32.224 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-08-20 11:57:32.224 +03:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1566291452,"exp":1566291512,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","afcpayroll"],"client_id":"mvc","sub":"1","auth_time":1566291446,"idp":"local","name":"alice","email":"alice@email.com","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-08-20 11:57:32.229 +03:00 [DBG] Creating userinfo response
2019-08-20 11:57:32.229 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:57:32.230 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:57:32.232 +03:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 11:57:32.233 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:57:32.234 +03:00 [INF] Profile service returned the following claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 11:57:32.235 +03:00 [DBG] End userinfo request
2019-08-20 11:57:39.621 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-08-20 11:57:39.623 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-08-20 11:57:39.624 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-08-20 11:57:39.626 +03:00 [DBG] Start authorize request
2019-08-20 11:57:39.627 +03:00 [DBG] User in authorize request: 1
2019-08-20 11:57:39.628 +03:00 [DBG] Start authorize request protocol validation
2019-08-20 11:57:39.628 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:57:39.629 +03:00 [DBG] Checking for PKCE parameters
2019-08-20 11:57:39.629 +03:00 [DBG] No PKCE used.
2019-08-20 11:57:39.630 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-20 11:57:39.631 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/home/signin-oidc","AllowedRedirectUris":["http://localhost:5002/home/signin-oidc"],"SubjectId":"1","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9NkM3liRUW81BKJFe4-JzldPORxuk9Pb74cz0hD40MQS6xw06oonuWBAQE4ty9STMGPbuBrdMq4-l0_SHtWDTJoVQ9RRnyGrPN8qQ5Z7jF6vtqnfPNw6LM02ZM5-Ae7vb9WSZxP1ipRk8dftlDEh5hShCnjkjS_c6eZmIrhqexvJctb0hl2tuky24XfZ64Sq3dDnX2KqwoC2c8s2B1N3WZ1x7DtqHIDGAzPK2eUv6fujucs5o0yB_VWxBDOOIdupAUS3XSkTK13uyweYDC07_Ho_xTKRYKaqa2z5LM2QkxhlGbqJn5e5nRerIz7BbmCnSE","UiLocales":null,"Nonce":"637018882596016737.MTczMTBkY2MtZWQ0Yi00MDdiLTk3OTItZjU2YzNlNTJmYTcwYjQ0MWFlNzgtYzg4Mi00NTM5LTlkMDUtZjgwMDIwOWM3NWUz","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"91aefd42fcb7a7c3b8fb314ba55439ba","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/home/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637018882596016737.MTczMTBkY2MtZWQ0Yi00MDdiLTk3OTItZjU2YzNlNTJmYTcwYjQ0MWFlNzgtYzg4Mi00NTM5LTlkMDUtZjgwMDIwOWM3NWUz","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9NkM3liRUW81BKJFe4-JzldPORxuk9Pb74cz0hD40MQS6xw06oonuWBAQE4ty9STMGPbuBrdMq4-l0_SHtWDTJoVQ9RRnyGrPN8qQ5Z7jF6vtqnfPNw6LM02ZM5-Ae7vb9WSZxP1ipRk8dftlDEh5hShCnjkjS_c6eZmIrhqexvJctb0hl2tuky24XfZ64Sq3dDnX2KqwoC2c8s2B1N3WZ1x7DtqHIDGAzPK2eUv6fujucs5o0yB_VWxBDOOIdupAUS3XSkTK13uyweYDC07_Ho_xTKRYKaqa2z5LM2QkxhlGbqJn5e5nRerIz7BbmCnSE","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-20 11:57:39.637 +03:00 [DBG] Client is configured to not require consent, no consent is required
2019-08-20 11:57:39.640 +03:00 [DBG] Creating Hybrid Flow response.
2019-08-20 11:57:39.641 +03:00 [DBG] Creating Implicit Flow response.
2019-08-20 11:57:39.641 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 11:57:39.642 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 11:57:39.646 +03:00 [DBG] Authorize endpoint response
{"SubjectId":"1","ClientId":"mvc","RedirectUri":"http://localhost:5002/home/signin-oidc","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9NkM3liRUW81BKJFe4-JzldPORxuk9Pb74cz0hD40MQS6xw06oonuWBAQE4ty9STMGPbuBrdMq4-l0_SHtWDTJoVQ9RRnyGrPN8qQ5Z7jF6vtqnfPNw6LM02ZM5-Ae7vb9WSZxP1ipRk8dftlDEh5hShCnjkjS_c6eZmIrhqexvJctb0hl2tuky24XfZ64Sq3dDnX2KqwoC2c8s2B1N3WZ1x7DtqHIDGAzPK2eUv6fujucs5o0yB_VWxBDOOIdupAUS3XSkTK13uyweYDC07_Ho_xTKRYKaqa2z5LM2QkxhlGbqJn5e5nRerIz7BbmCnSE","Scope":"openid profile afcpayroll offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-08-20 11:57:39.905 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-20 11:57:39.907 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-20 11:57:39.907 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-20 11:57:39.908 +03:00 [DBG] Start token request.
2019-08-20 11:57:39.909 +03:00 [DBG] Start client validation
2019-08-20 11:57:39.910 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-20 11:57:39.910 +03:00 [DBG] Start parsing for secret in post body
2019-08-20 11:57:39.911 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-20 11:57:39.911 +03:00 [DBG] Secret id found: mvc
2019-08-20 11:57:39.912 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:57:39.913 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-20 11:57:39.914 +03:00 [DBG] Client validation success
2019-08-20 11:57:39.915 +03:00 [DBG] Start token request validation
2019-08-20 11:57:39.915 +03:00 [DBG] Start validation of authorization code token request
2019-08-20 11:57:39.916 +03:00 [DBG] Validation of authorization code token request success
2019-08-20 11:57:39.917 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"82ea9e6d4dd74fa45f129a0581ec478676ddb9f27cae3b5d2a3a18757b7eab00","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"mvc","client_secret":"***REDACTED***","code":"82ea9e6d4dd74fa45f129a0581ec478676ddb9f27cae3b5d2a3a18757b7eab00","grant_type":"authorization_code","redirect_uri":"http://localhost:5002/home/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-08-20 11:57:39.921 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:57:39.922 +03:00 [DBG] Getting claims for access token for client: mvc
2019-08-20 11:57:39.922 +03:00 [DBG] Getting claims for access token for subject: 1
2019-08-20 11:57:39.926 +03:00 [DBG] Creating refresh token
2019-08-20 11:57:39.927 +03:00 [DBG] Setting an absolute lifetime: 2592000
2019-08-20 11:57:39.927 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:57:39.928 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 11:57:39.928 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 11:57:39.932 +03:00 [DBG] Token request success.
2019-08-20 11:57:39.937 +03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-08-20 11:57:39.937 +03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-08-20 11:57:39.938 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-08-20 11:57:39.939 +03:00 [DBG] Start userinfo request
2019-08-20 11:57:39.939 +03:00 [DBG] Bearer token found in header
2019-08-20 11:57:39.942 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:57:39.942 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:57:39.943 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-08-20 11:57:39.944 +03:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1566291459,"exp":1566291519,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","afcpayroll"],"client_id":"mvc","sub":"1","auth_time":1566291446,"idp":"local","name":"alice","email":"alice@email.com","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-08-20 11:57:39.949 +03:00 [DBG] Creating userinfo response
2019-08-20 11:57:39.949 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:57:39.950 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:57:39.950 +03:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 11:57:39.951 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:57:39.951 +03:00 [INF] Profile service returned the following claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 11:57:39.952 +03:00 [DBG] End userinfo request
2019-08-20 11:57:46.156 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-08-20 11:57:46.160 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-08-20 11:57:46.160 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-08-20 11:57:46.161 +03:00 [DBG] Start authorize request
2019-08-20 11:57:46.162 +03:00 [DBG] User in authorize request: 1
2019-08-20 11:57:46.162 +03:00 [DBG] Start authorize request protocol validation
2019-08-20 11:57:46.164 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:57:46.165 +03:00 [DBG] Checking for PKCE parameters
2019-08-20 11:57:46.165 +03:00 [DBG] No PKCE used.
2019-08-20 11:57:46.166 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-20 11:57:46.167 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/home/signin-oidc","AllowedRedirectUris":["http://localhost:5002/home/signin-oidc"],"SubjectId":"1","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9M8SrCbgmPppSQYpn2G_Lf-7v_KzGcfOSYzJfD3jW_awyTf9pdF7CBLk9CqN6QKXjvMnuTh29Qk2lUUtGGQ9cFF63X7_T7DxRP68Fis2VfHWkC2bG4ilfjgOIhXzW3Csx2HpQ7sHQr4nRjHbq6YHwj1SSSvck5qo42O2DUNvWw-bOWo2MhwqkwII54z9sy1yBBqJJpnYRlONk5qxAurQ8sVWIG09RGhbn6jWUTrGjR7zg8sGnqUjCzyg2Hkvy6RdyjD0VRogDSZPx4MOnJI8b4nIrtCt0maJfvtJOZskrujR2N6TW1QobMvq-iwSO1o2HU","UiLocales":null,"Nonce":"637018882661350231.OTAzNzE0Y2ItZjJlOC00ZTA3LWE0ZTAtNmI5NWE3YTlkMTFhN2ViM2FjYjQtY2I5Ni00OTZhLTk2ZjctMjlkZDY1YTliOWUz","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"91aefd42fcb7a7c3b8fb314ba55439ba","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/home/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637018882661350231.OTAzNzE0Y2ItZjJlOC00ZTA3LWE0ZTAtNmI5NWE3YTlkMTFhN2ViM2FjYjQtY2I5Ni00OTZhLTk2ZjctMjlkZDY1YTliOWUz","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9M8SrCbgmPppSQYpn2G_Lf-7v_KzGcfOSYzJfD3jW_awyTf9pdF7CBLk9CqN6QKXjvMnuTh29Qk2lUUtGGQ9cFF63X7_T7DxRP68Fis2VfHWkC2bG4ilfjgOIhXzW3Csx2HpQ7sHQr4nRjHbq6YHwj1SSSvck5qo42O2DUNvWw-bOWo2MhwqkwII54z9sy1yBBqJJpnYRlONk5qxAurQ8sVWIG09RGhbn6jWUTrGjR7zg8sGnqUjCzyg2Hkvy6RdyjD0VRogDSZPx4MOnJI8b4nIrtCt0maJfvtJOZskrujR2N6TW1QobMvq-iwSO1o2HU","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-20 11:57:46.173 +03:00 [DBG] Client is configured to not require consent, no consent is required
2019-08-20 11:57:46.173 +03:00 [DBG] Creating Hybrid Flow response.
2019-08-20 11:57:46.174 +03:00 [DBG] Creating Implicit Flow response.
2019-08-20 11:57:46.174 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 11:57:46.175 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 11:57:46.179 +03:00 [DBG] Authorize endpoint response
{"SubjectId":"1","ClientId":"mvc","RedirectUri":"http://localhost:5002/home/signin-oidc","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9M8SrCbgmPppSQYpn2G_Lf-7v_KzGcfOSYzJfD3jW_awyTf9pdF7CBLk9CqN6QKXjvMnuTh29Qk2lUUtGGQ9cFF63X7_T7DxRP68Fis2VfHWkC2bG4ilfjgOIhXzW3Csx2HpQ7sHQr4nRjHbq6YHwj1SSSvck5qo42O2DUNvWw-bOWo2MhwqkwII54z9sy1yBBqJJpnYRlONk5qxAurQ8sVWIG09RGhbn6jWUTrGjR7zg8sGnqUjCzyg2Hkvy6RdyjD0VRogDSZPx4MOnJI8b4nIrtCt0maJfvtJOZskrujR2N6TW1QobMvq-iwSO1o2HU","Scope":"openid profile afcpayroll offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-08-20 11:57:46.498 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-20 11:57:46.500 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-20 11:57:46.500 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-20 11:57:46.501 +03:00 [DBG] Start token request.
2019-08-20 11:57:46.501 +03:00 [DBG] Start client validation
2019-08-20 11:57:46.502 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-20 11:57:46.503 +03:00 [DBG] Start parsing for secret in post body
2019-08-20 11:57:46.504 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-20 11:57:46.505 +03:00 [DBG] Secret id found: mvc
2019-08-20 11:57:46.505 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:57:46.506 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-20 11:57:46.508 +03:00 [DBG] Client validation success
2019-08-20 11:57:46.509 +03:00 [DBG] Start token request validation
2019-08-20 11:57:46.510 +03:00 [DBG] Start validation of authorization code token request
2019-08-20 11:57:46.511 +03:00 [DBG] Validation of authorization code token request success
2019-08-20 11:57:46.511 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"e2c60cd62ec6df7cd274ced435fce37c4798ae63b37227d1ce10b1e7798b0735","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"mvc","client_secret":"***REDACTED***","code":"e2c60cd62ec6df7cd274ced435fce37c4798ae63b37227d1ce10b1e7798b0735","grant_type":"authorization_code","redirect_uri":"http://localhost:5002/home/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-08-20 11:57:46.515 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:57:46.516 +03:00 [DBG] Getting claims for access token for client: mvc
2019-08-20 11:57:46.516 +03:00 [DBG] Getting claims for access token for subject: 1
2019-08-20 11:57:46.522 +03:00 [DBG] Creating refresh token
2019-08-20 11:57:46.522 +03:00 [DBG] Setting an absolute lifetime: 2592000
2019-08-20 11:57:46.523 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:57:46.524 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 11:57:46.524 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 11:57:46.529 +03:00 [DBG] Token request success.
2019-08-20 11:57:46.533 +03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-08-20 11:57:46.533 +03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-08-20 11:57:46.534 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-08-20 11:57:46.535 +03:00 [DBG] Start userinfo request
2019-08-20 11:57:46.535 +03:00 [DBG] Bearer token found in header
2019-08-20 11:57:46.541 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:57:46.543 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:57:46.543 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-08-20 11:57:46.544 +03:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1566291466,"exp":1566291526,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","afcpayroll"],"client_id":"mvc","sub":"1","auth_time":1566291446,"idp":"local","name":"alice","email":"alice@email.com","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-08-20 11:57:46.548 +03:00 [DBG] Creating userinfo response
2019-08-20 11:57:46.548 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:57:46.549 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:57:46.549 +03:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 11:57:46.550 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:57:46.550 +03:00 [INF] Profile service returned the following claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 11:57:46.551 +03:00 [DBG] End userinfo request
2019-08-20 11:57:52.381 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-08-20 11:57:52.384 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-08-20 11:57:52.385 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-08-20 11:57:52.385 +03:00 [DBG] Start authorize request
2019-08-20 11:57:52.387 +03:00 [DBG] User in authorize request: 1
2019-08-20 11:57:52.391 +03:00 [DBG] Start authorize request protocol validation
2019-08-20 11:57:52.391 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:57:52.392 +03:00 [DBG] Checking for PKCE parameters
2019-08-20 11:57:52.393 +03:00 [DBG] No PKCE used.
2019-08-20 11:57:52.393 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-20 11:57:52.394 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/home/signin-oidc","AllowedRedirectUris":["http://localhost:5002/home/signin-oidc"],"SubjectId":"1","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9P3q-OevgBZg0MKV15kMKcnACJTesVpCmMwJ4R7-Y0V3J0K2LyA_Pt5htJRAhyfRWIZtc4wDWWRgD-7Hh18E_bZscctQIGBMqTI5W5gxdvgIApEqA7lbXpRuAFVf_ve9MmlhiPtv8_300HBXiTgwSKwgkFhFvEj2vj0kT9GE-vlxOrR-FQRR6Ubp-bX428cRyYBeLaghqmuTtmnlrfnF3vOG_6VVPxEH080szBaRwuqJDO1UajCP9yqjzJuX-sC5Eb6PE5OSC1_Gdpjtpms6-h-MWhpRPaX5e9drlYAVWYh9ry7ADCieAyAdOXOVc56ONc","UiLocales":null,"Nonce":"637018882723622625.M2JlNjBiZDctYWRjMi00YTNlLWEzZDctZGQxMWJhZWJmYmVhN2Y4MzkxZDAtMzFkOC00ZDI5LWJmMDYtNTY1NDhjNGM2OTcx","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"91aefd42fcb7a7c3b8fb314ba55439ba","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/home/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637018882723622625.M2JlNjBiZDctYWRjMi00YTNlLWEzZDctZGQxMWJhZWJmYmVhN2Y4MzkxZDAtMzFkOC00ZDI5LWJmMDYtNTY1NDhjNGM2OTcx","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9P3q-OevgBZg0MKV15kMKcnACJTesVpCmMwJ4R7-Y0V3J0K2LyA_Pt5htJRAhyfRWIZtc4wDWWRgD-7Hh18E_bZscctQIGBMqTI5W5gxdvgIApEqA7lbXpRuAFVf_ve9MmlhiPtv8_300HBXiTgwSKwgkFhFvEj2vj0kT9GE-vlxOrR-FQRR6Ubp-bX428cRyYBeLaghqmuTtmnlrfnF3vOG_6VVPxEH080szBaRwuqJDO1UajCP9yqjzJuX-sC5Eb6PE5OSC1_Gdpjtpms6-h-MWhpRPaX5e9drlYAVWYh9ry7ADCieAyAdOXOVc56ONc","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-20 11:57:52.404 +03:00 [DBG] Client is configured to not require consent, no consent is required
2019-08-20 11:57:52.404 +03:00 [DBG] Creating Hybrid Flow response.
2019-08-20 11:57:52.405 +03:00 [DBG] Creating Implicit Flow response.
2019-08-20 11:57:52.405 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 11:57:52.406 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 11:57:52.410 +03:00 [DBG] Authorize endpoint response
{"SubjectId":"1","ClientId":"mvc","RedirectUri":"http://localhost:5002/home/signin-oidc","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9P3q-OevgBZg0MKV15kMKcnACJTesVpCmMwJ4R7-Y0V3J0K2LyA_Pt5htJRAhyfRWIZtc4wDWWRgD-7Hh18E_bZscctQIGBMqTI5W5gxdvgIApEqA7lbXpRuAFVf_ve9MmlhiPtv8_300HBXiTgwSKwgkFhFvEj2vj0kT9GE-vlxOrR-FQRR6Ubp-bX428cRyYBeLaghqmuTtmnlrfnF3vOG_6VVPxEH080szBaRwuqJDO1UajCP9yqjzJuX-sC5Eb6PE5OSC1_Gdpjtpms6-h-MWhpRPaX5e9drlYAVWYh9ry7ADCieAyAdOXOVc56ONc","Scope":"openid profile afcpayroll offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-08-20 11:57:52.665 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-20 11:57:52.666 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-20 11:57:52.667 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-20 11:57:52.667 +03:00 [DBG] Start token request.
2019-08-20 11:57:52.668 +03:00 [DBG] Start client validation
2019-08-20 11:57:52.668 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-20 11:57:52.669 +03:00 [DBG] Start parsing for secret in post body
2019-08-20 11:57:52.669 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-20 11:57:52.671 +03:00 [DBG] Secret id found: mvc
2019-08-20 11:57:52.671 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:57:52.672 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-20 11:57:52.672 +03:00 [DBG] Client validation success
2019-08-20 11:57:52.673 +03:00 [DBG] Start token request validation
2019-08-20 11:57:52.674 +03:00 [DBG] Start validation of authorization code token request
2019-08-20 11:57:52.674 +03:00 [DBG] Validation of authorization code token request success
2019-08-20 11:57:52.675 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"4ae87c222b8c30bf65661c23a74d21ac30cd29dda66ae1680ca4ceb186ef4733","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"mvc","client_secret":"***REDACTED***","code":"4ae87c222b8c30bf65661c23a74d21ac30cd29dda66ae1680ca4ceb186ef4733","grant_type":"authorization_code","redirect_uri":"http://localhost:5002/home/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-08-20 11:57:52.678 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:57:52.678 +03:00 [DBG] Getting claims for access token for client: mvc
2019-08-20 11:57:52.679 +03:00 [DBG] Getting claims for access token for subject: 1
2019-08-20 11:57:52.683 +03:00 [DBG] Creating refresh token
2019-08-20 11:57:52.684 +03:00 [DBG] Setting an absolute lifetime: 2592000
2019-08-20 11:57:52.685 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:57:52.685 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 11:57:52.686 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 11:57:52.690 +03:00 [DBG] Token request success.
2019-08-20 11:57:52.693 +03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-08-20 11:57:52.694 +03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-08-20 11:57:52.694 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-08-20 11:57:52.695 +03:00 [DBG] Start userinfo request
2019-08-20 11:57:52.695 +03:00 [DBG] Bearer token found in header
2019-08-20 11:57:52.698 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:57:52.698 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:57:52.699 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-08-20 11:57:52.699 +03:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1566291472,"exp":1566291532,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","afcpayroll"],"client_id":"mvc","sub":"1","auth_time":1566291446,"idp":"local","name":"alice","email":"alice@email.com","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-08-20 11:57:52.706 +03:00 [DBG] Creating userinfo response
2019-08-20 11:57:52.706 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:57:52.707 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:57:52.707 +03:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 11:57:52.708 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:57:52.708 +03:00 [INF] Profile service returned the following claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 11:57:52.709 +03:00 [DBG] End userinfo request
2019-08-20 11:58:02.008 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-08-20 11:58:02.017 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-08-20 11:58:02.019 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-08-20 11:58:02.020 +03:00 [DBG] Start authorize request
2019-08-20 11:58:02.021 +03:00 [DBG] User in authorize request: 1
2019-08-20 11:58:02.021 +03:00 [DBG] Start authorize request protocol validation
2019-08-20 11:58:02.022 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:58:02.022 +03:00 [DBG] Checking for PKCE parameters
2019-08-20 11:58:02.023 +03:00 [DBG] No PKCE used.
2019-08-20 11:58:02.024 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-20 11:58:02.025 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/home/signin-oidc","AllowedRedirectUris":["http://localhost:5002/home/signin-oidc"],"SubjectId":"1","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9OuVTu48XM79RIkdptF8UwgWnakjeAZE9XAKkwrAElataQSgIdhn01M0NkTcn2cciHOR_CnTdsXK2Qh_1qzm7b7hcFtQZBYIIzdAw-j5NeGyINn6qkv0ygvZegFWuGNIMgDmEZOyIlBTa6TvAJerSFrv7aAu38Bz2WEgy2oz_h5qHVz40L3YHsaHw9yHFMT4fSMBHaRNZVuOyGFk1BcON5VzAwxTYS-Y5o1cVZ6UKOocW6UnneRG01Nqp7GDhFmyl8tr5sVN8-T5jYWzSa0QWgZoRCiko6WVmSf0jAVkUW2CVooOqBdNGF0Ba7PzMaivSQ","UiLocales":null,"Nonce":"637018882819902314.MWQ3OTM3OWYtNmVlMC00NGQzLWJhZjItNzFhYWM5NGMzN2M3ZjkzMWM5NTAtOTEzYS00YmY1LTgzZGEtYjk3MmU1MDRhYjll","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"91aefd42fcb7a7c3b8fb314ba55439ba","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/home/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637018882819902314.MWQ3OTM3OWYtNmVlMC00NGQzLWJhZjItNzFhYWM5NGMzN2M3ZjkzMWM5NTAtOTEzYS00YmY1LTgzZGEtYjk3MmU1MDRhYjll","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9OuVTu48XM79RIkdptF8UwgWnakjeAZE9XAKkwrAElataQSgIdhn01M0NkTcn2cciHOR_CnTdsXK2Qh_1qzm7b7hcFtQZBYIIzdAw-j5NeGyINn6qkv0ygvZegFWuGNIMgDmEZOyIlBTa6TvAJerSFrv7aAu38Bz2WEgy2oz_h5qHVz40L3YHsaHw9yHFMT4fSMBHaRNZVuOyGFk1BcON5VzAwxTYS-Y5o1cVZ6UKOocW6UnneRG01Nqp7GDhFmyl8tr5sVN8-T5jYWzSa0QWgZoRCiko6WVmSf0jAVkUW2CVooOqBdNGF0Ba7PzMaivSQ","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-20 11:58:02.034 +03:00 [DBG] Client is configured to not require consent, no consent is required
2019-08-20 11:58:02.035 +03:00 [DBG] Creating Hybrid Flow response.
2019-08-20 11:58:02.036 +03:00 [DBG] Creating Implicit Flow response.
2019-08-20 11:58:02.037 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 11:58:02.038 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 11:58:02.044 +03:00 [DBG] Authorize endpoint response
{"SubjectId":"1","ClientId":"mvc","RedirectUri":"http://localhost:5002/home/signin-oidc","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9OuVTu48XM79RIkdptF8UwgWnakjeAZE9XAKkwrAElataQSgIdhn01M0NkTcn2cciHOR_CnTdsXK2Qh_1qzm7b7hcFtQZBYIIzdAw-j5NeGyINn6qkv0ygvZegFWuGNIMgDmEZOyIlBTa6TvAJerSFrv7aAu38Bz2WEgy2oz_h5qHVz40L3YHsaHw9yHFMT4fSMBHaRNZVuOyGFk1BcON5VzAwxTYS-Y5o1cVZ6UKOocW6UnneRG01Nqp7GDhFmyl8tr5sVN8-T5jYWzSa0QWgZoRCiko6WVmSf0jAVkUW2CVooOqBdNGF0Ba7PzMaivSQ","Scope":"openid profile afcpayroll offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-08-20 11:58:02.334 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-20 11:58:02.336 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-20 11:58:02.336 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-20 11:58:02.338 +03:00 [DBG] Start token request.
2019-08-20 11:58:02.339 +03:00 [DBG] Start client validation
2019-08-20 11:58:02.339 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-20 11:58:02.341 +03:00 [DBG] Start parsing for secret in post body
2019-08-20 11:58:02.341 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-20 11:58:02.342 +03:00 [DBG] Secret id found: mvc
2019-08-20 11:58:02.343 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:58:02.343 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-20 11:58:02.344 +03:00 [DBG] Client validation success
2019-08-20 11:58:02.344 +03:00 [DBG] Start token request validation
2019-08-20 11:58:02.345 +03:00 [DBG] Start validation of authorization code token request
2019-08-20 11:58:02.345 +03:00 [DBG] Validation of authorization code token request success
2019-08-20 11:58:02.346 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"f87aa2007a55bdab3918c5e7885856e6fea4d23b3124e53df46abd528995625e","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"mvc","client_secret":"***REDACTED***","code":"f87aa2007a55bdab3918c5e7885856e6fea4d23b3124e53df46abd528995625e","grant_type":"authorization_code","redirect_uri":"http://localhost:5002/home/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-08-20 11:58:02.349 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:58:02.350 +03:00 [DBG] Getting claims for access token for client: mvc
2019-08-20 11:58:02.350 +03:00 [DBG] Getting claims for access token for subject: 1
2019-08-20 11:58:02.354 +03:00 [DBG] Creating refresh token
2019-08-20 11:58:02.355 +03:00 [DBG] Setting an absolute lifetime: 2592000
2019-08-20 11:58:02.355 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:58:02.356 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 11:58:02.357 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 11:58:02.361 +03:00 [DBG] Token request success.
2019-08-20 11:58:02.365 +03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-08-20 11:58:02.365 +03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-08-20 11:58:02.366 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-08-20 11:58:02.366 +03:00 [DBG] Start userinfo request
2019-08-20 11:58:02.367 +03:00 [DBG] Bearer token found in header
2019-08-20 11:58:02.370 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:58:02.371 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:58:02.372 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-08-20 11:58:02.372 +03:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1566291482,"exp":1566291542,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","afcpayroll"],"client_id":"mvc","sub":"1","auth_time":1566291446,"idp":"local","name":"alice","email":"alice@email.com","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-08-20 11:58:02.377 +03:00 [DBG] Creating userinfo response
2019-08-20 11:58:02.378 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:58:02.378 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:58:02.379 +03:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 11:58:02.379 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:58:02.380 +03:00 [INF] Profile service returned the following claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 11:58:02.381 +03:00 [DBG] End userinfo request
2019-08-20 11:58:04.104 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-08-20 11:58:04.109 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-08-20 11:58:04.110 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-08-20 11:58:04.110 +03:00 [DBG] Start authorize request
2019-08-20 11:58:04.111 +03:00 [DBG] User in authorize request: 1
2019-08-20 11:58:04.111 +03:00 [DBG] Start authorize request protocol validation
2019-08-20 11:58:04.112 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:58:04.112 +03:00 [DBG] Checking for PKCE parameters
2019-08-20 11:58:04.113 +03:00 [DBG] No PKCE used.
2019-08-20 11:58:04.113 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-20 11:58:04.114 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/home/signin-oidc","AllowedRedirectUris":["http://localhost:5002/home/signin-oidc"],"SubjectId":"1","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9M-99i9VPgt-Lsy6Bc4OPjWNOGeBqMAn0ejtxC56kx0tBUJMrKO2nMTY-5X_JS9Cu3PKOKxaiPBJLC02mnPsNfE0NU2sjLf3wJF3yaLJ0rav181SRXn8AgjJjNwfcBtD3ePQW8a1v-A8LfT0gSV_S5EUzygJZ4A4ies-JRkfzJFdltvOxET_vFRgcqrxlH0BhfO9hqEv5N_WkD3Vk_HKZ1DkFgFsoEeq1cyjvryzkxII38LoCwhWPJD9JZSIHuHQfcyEVALOPYf2Q8WHCZkheMFRGHRqzuDezv90hDNuX7Dj7p3zhhZv6x3BgsxqvT9bDc","UiLocales":null,"Nonce":"637018882840870190.ZjUwNWYyYWItY2Y2My00OTJmLWFhZGQtNTgzMGNiM2Q3YTQzMzM2ZjY1YzMtZDBmOC00YTI1LWI0ODUtMjBjYTViYThjY2M1","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"91aefd42fcb7a7c3b8fb314ba55439ba","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/home/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637018882840870190.ZjUwNWYyYWItY2Y2My00OTJmLWFhZGQtNTgzMGNiM2Q3YTQzMzM2ZjY1YzMtZDBmOC00YTI1LWI0ODUtMjBjYTViYThjY2M1","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9M-99i9VPgt-Lsy6Bc4OPjWNOGeBqMAn0ejtxC56kx0tBUJMrKO2nMTY-5X_JS9Cu3PKOKxaiPBJLC02mnPsNfE0NU2sjLf3wJF3yaLJ0rav181SRXn8AgjJjNwfcBtD3ePQW8a1v-A8LfT0gSV_S5EUzygJZ4A4ies-JRkfzJFdltvOxET_vFRgcqrxlH0BhfO9hqEv5N_WkD3Vk_HKZ1DkFgFsoEeq1cyjvryzkxII38LoCwhWPJD9JZSIHuHQfcyEVALOPYf2Q8WHCZkheMFRGHRqzuDezv90hDNuX7Dj7p3zhhZv6x3BgsxqvT9bDc","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-20 11:58:04.121 +03:00 [DBG] Client is configured to not require consent, no consent is required
2019-08-20 11:58:04.122 +03:00 [DBG] Creating Hybrid Flow response.
2019-08-20 11:58:04.122 +03:00 [DBG] Creating Implicit Flow response.
2019-08-20 11:58:04.123 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 11:58:04.123 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 11:58:04.127 +03:00 [DBG] Authorize endpoint response
{"SubjectId":"1","ClientId":"mvc","RedirectUri":"http://localhost:5002/home/signin-oidc","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9M-99i9VPgt-Lsy6Bc4OPjWNOGeBqMAn0ejtxC56kx0tBUJMrKO2nMTY-5X_JS9Cu3PKOKxaiPBJLC02mnPsNfE0NU2sjLf3wJF3yaLJ0rav181SRXn8AgjJjNwfcBtD3ePQW8a1v-A8LfT0gSV_S5EUzygJZ4A4ies-JRkfzJFdltvOxET_vFRgcqrxlH0BhfO9hqEv5N_WkD3Vk_HKZ1DkFgFsoEeq1cyjvryzkxII38LoCwhWPJD9JZSIHuHQfcyEVALOPYf2Q8WHCZkheMFRGHRqzuDezv90hDNuX7Dj7p3zhhZv6x3BgsxqvT9bDc","Scope":"openid profile afcpayroll offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-08-20 11:58:04.395 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-20 11:58:04.396 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-20 11:58:04.397 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-20 11:58:04.398 +03:00 [DBG] Start token request.
2019-08-20 11:58:04.398 +03:00 [DBG] Start client validation
2019-08-20 11:58:04.399 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-20 11:58:04.400 +03:00 [DBG] Start parsing for secret in post body
2019-08-20 11:58:04.403 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-20 11:58:04.404 +03:00 [DBG] Secret id found: mvc
2019-08-20 11:58:04.405 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:58:04.406 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-20 11:58:04.407 +03:00 [DBG] Client validation success
2019-08-20 11:58:04.408 +03:00 [DBG] Start token request validation
2019-08-20 11:58:04.408 +03:00 [DBG] Start validation of authorization code token request
2019-08-20 11:58:04.409 +03:00 [DBG] Validation of authorization code token request success
2019-08-20 11:58:04.409 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"f97ec72b8d2700553c21076424ae3ccef94012cbd0ef46790604fa702e084e08","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"mvc","client_secret":"***REDACTED***","code":"f97ec72b8d2700553c21076424ae3ccef94012cbd0ef46790604fa702e084e08","grant_type":"authorization_code","redirect_uri":"http://localhost:5002/home/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-08-20 11:58:04.413 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:58:04.414 +03:00 [DBG] Getting claims for access token for client: mvc
2019-08-20 11:58:04.415 +03:00 [DBG] Getting claims for access token for subject: 1
2019-08-20 11:58:04.419 +03:00 [DBG] Creating refresh token
2019-08-20 11:58:04.420 +03:00 [DBG] Setting an absolute lifetime: 2592000
2019-08-20 11:58:04.422 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:58:04.423 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 11:58:04.424 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 11:58:04.428 +03:00 [DBG] Token request success.
2019-08-20 11:58:04.437 +03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-08-20 11:58:04.439 +03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-08-20 11:58:04.440 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-08-20 11:58:04.441 +03:00 [DBG] Start userinfo request
2019-08-20 11:58:04.442 +03:00 [DBG] Bearer token found in header
2019-08-20 11:58:04.444 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:58:04.445 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 11:58:04.446 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-08-20 11:58:04.446 +03:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1566291484,"exp":1566291544,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","afcpayroll"],"client_id":"mvc","sub":"1","auth_time":1566291446,"idp":"local","name":"alice","email":"alice@email.com","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-08-20 11:58:04.451 +03:00 [DBG] Creating userinfo response
2019-08-20 11:58:04.452 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:58:04.452 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:58:04.453 +03:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 11:58:04.454 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 11:58:04.454 +03:00 [INF] Profile service returned the following claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 11:58:04.455 +03:00 [DBG] End userinfo request
2019-08-20 12:00:51.092 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-20 12:00:51.096 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-20 12:00:51.096 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-20 12:00:51.097 +03:00 [DBG] Start discovery request
2019-08-20 12:00:51.136 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-20 12:00:51.137 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-20 12:00:51.138 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-20 12:00:51.138 +03:00 [DBG] Start key discovery request
2019-08-20 12:00:51.171 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-20 12:00:51.172 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-20 12:00:51.173 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-20 12:00:51.174 +03:00 [DBG] Start token request.
2019-08-20 12:00:51.174 +03:00 [DBG] Start client validation
2019-08-20 12:00:51.175 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-20 12:00:51.175 +03:00 [DBG] Start parsing for secret in post body
2019-08-20 12:00:51.176 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-20 12:00:51.176 +03:00 [DBG] Secret id found: mvc
2019-08-20 12:00:51.177 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:00:51.178 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-20 12:00:51.179 +03:00 [DBG] Client validation success
2019-08-20 12:00:51.179 +03:00 [DBG] Start token request validation
2019-08-20 12:00:51.179 +03:00 [DBG] Start validation of refresh token request
2019-08-20 12:00:51.180 +03:00 [DBG] Token validation success
{"ClientId":"mvc","ClientName":"MVC Client","ValidateLifetime":false,"AccessTokenType":null,"ExpectedScope":null,"TokenHandle":null,"JwtId":null,"Claims":{"sub":"1","client_id":"mvc","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"auth_time":1566291446,"idp":"local","amr":"pwd","name":"alice","email":"alice@email.com"},"$type":"TokenValidationLog"}
2019-08-20 12:00:51.185 +03:00 [DBG] Validation of refresh token request success
2019-08-20 12:00:51.186 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"refresh_token","Scopes":null,"AuthorizationCode":null,"RefreshToken":"ac9f4984f450e3187bb48822dc6db7b796fd1280afaad066b54165e1d8d8d753","UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"refresh_token","refresh_token":"***REDACTED***","client_id":"mvc","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2019-08-20 12:00:51.192 +03:00 [DBG] Updating refresh token
2019-08-20 12:00:51.192 +03:00 [DBG] Token usage is one-time only. Generating new handle
2019-08-20 12:00:51.193 +03:00 [DBG] Created refresh token in store
2019-08-20 12:00:51.193 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 12:00:51.194 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 12:00:51.198 +03:00 [DBG] Token request success.
2019-08-20 12:00:53.246 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-20 12:00:53.248 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-20 12:00:53.248 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-20 12:00:53.249 +03:00 [DBG] Start discovery request
2019-08-20 12:00:53.287 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-20 12:00:53.289 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-20 12:00:53.289 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-20 12:00:53.290 +03:00 [DBG] Start key discovery request
2019-08-20 12:00:53.371 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-08-20 12:00:53.372 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-08-20 12:00:53.373 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-08-20 12:00:53.373 +03:00 [DBG] Start authorize request
2019-08-20 12:00:53.374 +03:00 [DBG] No user present in authorize request
2019-08-20 12:00:53.374 +03:00 [DBG] Start authorize request protocol validation
2019-08-20 12:00:53.375 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:00:53.375 +03:00 [DBG] Checking for PKCE parameters
2019-08-20 12:00:53.376 +03:00 [DBG] No PKCE used.
2019-08-20 12:00:53.376 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-20 12:00:53.377 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/home/signin-oidc","AllowedRedirectUris":["http://localhost:5002/home/signin-oidc"],"SubjectId":"anonymous","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9NO_tM6s6EK6owT9R-pCSTLPmGXTr7VV7uM_0RvGQqDuW7GffnsUO84MkaiZmJvfVirge75Kyd1JyGtlgBLrsfkzICM9NwjVSpiRZ2ZTd-e0nZsGkSOhVYiWhLj5y5XdnR922dDq7dF2mW-1h5mLhDjgONnBAMfvz7C4X7YZB3RVXvd7QYJHy7MXzex0Y291RVY3fPxiQzsi-3JPe3VvFsP6bsDELQ6KvS_qD8H27Nr8BCOpSLwrQshYW--MExmmqtr1Qvwo2EypKPhHemzLv5K2Z60tp_KBJJw5HSnoAjvmF5ClAvRHUjhAapUbvGKzWg","UiLocales":null,"Nonce":"637018884533101446.ODk5OTA1ZjYtMmI2Mi00ZmI3LWI2NmEtZDczYzdjZTU5NWQ0OWRhZTM3YzktOTVjOS00MzJlLWFjY2UtMWIyMTY5MDhhNmVm","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/home/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637018884533101446.ODk5OTA1ZjYtMmI2Mi00ZmI3LWI2NmEtZDczYzdjZTU5NWQ0OWRhZTM3YzktOTVjOS00MzJlLWFjY2UtMWIyMTY5MDhhNmVm","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9NO_tM6s6EK6owT9R-pCSTLPmGXTr7VV7uM_0RvGQqDuW7GffnsUO84MkaiZmJvfVirge75Kyd1JyGtlgBLrsfkzICM9NwjVSpiRZ2ZTd-e0nZsGkSOhVYiWhLj5y5XdnR922dDq7dF2mW-1h5mLhDjgONnBAMfvz7C4X7YZB3RVXvd7QYJHy7MXzex0Y291RVY3fPxiQzsi-3JPe3VvFsP6bsDELQ6KvS_qD8H27Nr8BCOpSLwrQshYW--MExmmqtr1Qvwo2EypKPhHemzLv5K2Z60tp_KBJJw5HSnoAjvmF5ClAvRHUjhAapUbvGKzWg","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-20 12:00:53.385 +03:00 [INF] Showing login: User is not authenticated
2019-08-20 12:00:53.395 +03:00 [DBG] Start authorize request protocol validation
2019-08-20 12:00:53.396 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:00:53.396 +03:00 [DBG] Checking for PKCE parameters
2019-08-20 12:00:53.397 +03:00 [DBG] No PKCE used.
2019-08-20 12:00:53.399 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-20 12:00:53.400 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:00:55.925 +03:00 [DBG] CORS request made for path: /account/login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-08-20 12:00:55.928 +03:00 [DBG] Start authorize request protocol validation
2019-08-20 12:00:55.929 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:00:55.934 +03:00 [DBG] Checking for PKCE parameters
2019-08-20 12:00:55.936 +03:00 [DBG] No PKCE used.
2019-08-20 12:00:55.936 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-20 12:00:55.937 +03:00 [DBG] Augmenting SignInContext
2019-08-20 12:00:55.938 +03:00 [DBG] Adding idp claim with value: local
2019-08-20 12:00:55.938 +03:00 [DBG] Adding amr claim with value: pwd
2019-08-20 12:00:55.939 +03:00 [INF] AuthenticationScheme: idsrv signed in.
2019-08-20 12:00:55.940 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:00:55.955 +03:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-08-20 12:00:55.957 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-08-20 12:00:55.960 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-08-20 12:00:55.964 +03:00 [DBG] Start authorize callback request
2019-08-20 12:00:55.965 +03:00 [DBG] User in authorize request: 1
2019-08-20 12:00:55.966 +03:00 [DBG] Start authorize request protocol validation
2019-08-20 12:00:55.967 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:00:55.968 +03:00 [DBG] Checking for PKCE parameters
2019-08-20 12:00:55.969 +03:00 [DBG] No PKCE used.
2019-08-20 12:00:55.969 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-20 12:00:55.970 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/home/signin-oidc","AllowedRedirectUris":["http://localhost:5002/home/signin-oidc"],"SubjectId":"1","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9NO_tM6s6EK6owT9R-pCSTLPmGXTr7VV7uM_0RvGQqDuW7GffnsUO84MkaiZmJvfVirge75Kyd1JyGtlgBLrsfkzICM9NwjVSpiRZ2ZTd-e0nZsGkSOhVYiWhLj5y5XdnR922dDq7dF2mW-1h5mLhDjgONnBAMfvz7C4X7YZB3RVXvd7QYJHy7MXzex0Y291RVY3fPxiQzsi-3JPe3VvFsP6bsDELQ6KvS_qD8H27Nr8BCOpSLwrQshYW--MExmmqtr1Qvwo2EypKPhHemzLv5K2Z60tp_KBJJw5HSnoAjvmF5ClAvRHUjhAapUbvGKzWg","UiLocales":null,"Nonce":"637018884533101446.ODk5OTA1ZjYtMmI2Mi00ZmI3LWI2NmEtZDczYzdjZTU5NWQ0OWRhZTM3YzktOTVjOS00MzJlLWFjY2UtMWIyMTY5MDhhNmVm","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"8a7f11d362fe2b6d0a970781023d5f73","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/home/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637018884533101446.ODk5OTA1ZjYtMmI2Mi00ZmI3LWI2NmEtZDczYzdjZTU5NWQ0OWRhZTM3YzktOTVjOS00MzJlLWFjY2UtMWIyMTY5MDhhNmVm","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9NO_tM6s6EK6owT9R-pCSTLPmGXTr7VV7uM_0RvGQqDuW7GffnsUO84MkaiZmJvfVirge75Kyd1JyGtlgBLrsfkzICM9NwjVSpiRZ2ZTd-e0nZsGkSOhVYiWhLj5y5XdnR922dDq7dF2mW-1h5mLhDjgONnBAMfvz7C4X7YZB3RVXvd7QYJHy7MXzex0Y291RVY3fPxiQzsi-3JPe3VvFsP6bsDELQ6KvS_qD8H27Nr8BCOpSLwrQshYW--MExmmqtr1Qvwo2EypKPhHemzLv5K2Z60tp_KBJJw5HSnoAjvmF5ClAvRHUjhAapUbvGKzWg","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-20 12:00:55.987 +03:00 [DBG] Client is configured to not require consent, no consent is required
2019-08-20 12:00:55.988 +03:00 [DBG] Creating Hybrid Flow response.
2019-08-20 12:00:55.988 +03:00 [DBG] Creating Implicit Flow response.
2019-08-20 12:00:55.990 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 12:00:55.991 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 12:00:55.995 +03:00 [DBG] Authorize endpoint response
{"SubjectId":"1","ClientId":"mvc","RedirectUri":"http://localhost:5002/home/signin-oidc","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9NO_tM6s6EK6owT9R-pCSTLPmGXTr7VV7uM_0RvGQqDuW7GffnsUO84MkaiZmJvfVirge75Kyd1JyGtlgBLrsfkzICM9NwjVSpiRZ2ZTd-e0nZsGkSOhVYiWhLj5y5XdnR922dDq7dF2mW-1h5mLhDjgONnBAMfvz7C4X7YZB3RVXvd7QYJHy7MXzex0Y291RVY3fPxiQzsi-3JPe3VvFsP6bsDELQ6KvS_qD8H27Nr8BCOpSLwrQshYW--MExmmqtr1Qvwo2EypKPhHemzLv5K2Z60tp_KBJJw5HSnoAjvmF5ClAvRHUjhAapUbvGKzWg","Scope":"openid profile afcpayroll offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-08-20 12:00:56.000 +03:00 [DBG] Augmenting SignInContext
2019-08-20 12:00:56.000 +03:00 [INF] AuthenticationScheme: idsrv signed in.
2019-08-20 12:00:56.304 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-20 12:00:56.305 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-20 12:00:56.306 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-20 12:00:56.306 +03:00 [DBG] Start token request.
2019-08-20 12:00:56.307 +03:00 [DBG] Start client validation
2019-08-20 12:00:56.307 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-20 12:00:56.308 +03:00 [DBG] Start parsing for secret in post body
2019-08-20 12:00:56.309 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-20 12:00:56.310 +03:00 [DBG] Secret id found: mvc
2019-08-20 12:00:56.310 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:00:56.311 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-20 12:00:56.312 +03:00 [DBG] Client validation success
2019-08-20 12:00:56.312 +03:00 [DBG] Start token request validation
2019-08-20 12:00:56.312 +03:00 [DBG] Start validation of authorization code token request
2019-08-20 12:00:56.313 +03:00 [DBG] Validation of authorization code token request success
2019-08-20 12:00:56.314 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"fa97880c2e63fa8f2b0c8bd4c33585391dcee4fc033fbcadaee50e69164b6152","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"mvc","client_secret":"***REDACTED***","code":"fa97880c2e63fa8f2b0c8bd4c33585391dcee4fc033fbcadaee50e69164b6152","grant_type":"authorization_code","redirect_uri":"http://localhost:5002/home/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-08-20 12:00:56.318 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:00:56.319 +03:00 [DBG] Getting claims for access token for client: mvc
2019-08-20 12:00:56.321 +03:00 [DBG] Getting claims for access token for subject: 1
2019-08-20 12:00:56.325 +03:00 [DBG] Creating refresh token
2019-08-20 12:00:56.326 +03:00 [DBG] Setting an absolute lifetime: 2592000
2019-08-20 12:00:56.326 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:00:56.327 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 12:00:56.328 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 12:00:56.332 +03:00 [DBG] Token request success.
2019-08-20 12:00:56.344 +03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-08-20 12:00:56.345 +03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-08-20 12:00:56.345 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-08-20 12:00:56.346 +03:00 [DBG] Start userinfo request
2019-08-20 12:00:56.347 +03:00 [DBG] Bearer token found in header
2019-08-20 12:00:56.349 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:00:56.355 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:00:56.355 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-08-20 12:00:56.356 +03:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1566291656,"exp":1566291716,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","afcpayroll"],"client_id":"mvc","sub":"1","auth_time":1566291655,"idp":"local","name":"alice","email":"alice@email.com","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-08-20 12:00:56.362 +03:00 [DBG] Creating userinfo response
2019-08-20 12:00:56.362 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 12:00:56.363 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 12:00:56.363 +03:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 12:00:56.364 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 12:00:56.364 +03:00 [INF] Profile service returned the following claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 12:00:56.365 +03:00 [DBG] End userinfo request
2019-08-20 12:00:56.417 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-08-20 12:00:56.418 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-08-20 12:00:56.418 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-08-20 12:00:56.419 +03:00 [DBG] Start authorize request
2019-08-20 12:00:56.419 +03:00 [DBG] User in authorize request: 1
2019-08-20 12:00:56.421 +03:00 [DBG] Start authorize request protocol validation
2019-08-20 12:00:56.421 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:00:56.422 +03:00 [DBG] Checking for PKCE parameters
2019-08-20 12:00:56.423 +03:00 [DBG] No PKCE used.
2019-08-20 12:00:56.423 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-20 12:00:56.424 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/home/signin-oidc","AllowedRedirectUris":["http://localhost:5002/home/signin-oidc"],"SubjectId":"1","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9NXvdKyGN9Cgq6vBtSLU8nDwQQbgaBZWZyWSryPeFxuDiPfKRzfeiYHwNyongofT2YMEP7Vsf7HCz4uEz66kzjkqzbHq0qRzEIfNkdcZG3NYeqxQoCHFYfJXHsVbiTKy3ZRgN8xrPVezaBv5YtDydv9k9IDD4Yg8MWyD3Qk7u8AQwMAQRhPpk-dNF3z9Pu7_-4HFlJGIDPpKzaPZVWm0LaVC9RV6ynaafk4FvckuzTFEIgeGDniTFWycnZsRjKuQrOy1-JadUxfwrEfFyL1ytABFBaQIUYhlz74OsUeGpFbCKTMpvJ8ZQRauPOnP9Z3qy8","UiLocales":null,"Nonce":"637018884563986097.MjQwM2VjYzEtNWU3Zi00MDQ1LTlmMTYtOTQ2YzZmOTg2ZThjNThlZGQ1ZDktYzFkNy00NTJiLWE5NDEtNDI0M2I5M2YzY2E4","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"8a7f11d362fe2b6d0a970781023d5f73","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/home/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637018884563986097.MjQwM2VjYzEtNWU3Zi00MDQ1LTlmMTYtOTQ2YzZmOTg2ZThjNThlZGQ1ZDktYzFkNy00NTJiLWE5NDEtNDI0M2I5M2YzY2E4","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9NXvdKyGN9Cgq6vBtSLU8nDwQQbgaBZWZyWSryPeFxuDiPfKRzfeiYHwNyongofT2YMEP7Vsf7HCz4uEz66kzjkqzbHq0qRzEIfNkdcZG3NYeqxQoCHFYfJXHsVbiTKy3ZRgN8xrPVezaBv5YtDydv9k9IDD4Yg8MWyD3Qk7u8AQwMAQRhPpk-dNF3z9Pu7_-4HFlJGIDPpKzaPZVWm0LaVC9RV6ynaafk4FvckuzTFEIgeGDniTFWycnZsRjKuQrOy1-JadUxfwrEfFyL1ytABFBaQIUYhlz74OsUeGpFbCKTMpvJ8ZQRauPOnP9Z3qy8","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-20 12:00:56.430 +03:00 [DBG] Client is configured to not require consent, no consent is required
2019-08-20 12:00:56.431 +03:00 [DBG] Creating Hybrid Flow response.
2019-08-20 12:00:56.431 +03:00 [DBG] Creating Implicit Flow response.
2019-08-20 12:00:56.432 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 12:00:56.432 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 12:00:56.437 +03:00 [DBG] Authorize endpoint response
{"SubjectId":"1","ClientId":"mvc","RedirectUri":"http://localhost:5002/home/signin-oidc","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9NXvdKyGN9Cgq6vBtSLU8nDwQQbgaBZWZyWSryPeFxuDiPfKRzfeiYHwNyongofT2YMEP7Vsf7HCz4uEz66kzjkqzbHq0qRzEIfNkdcZG3NYeqxQoCHFYfJXHsVbiTKy3ZRgN8xrPVezaBv5YtDydv9k9IDD4Yg8MWyD3Qk7u8AQwMAQRhPpk-dNF3z9Pu7_-4HFlJGIDPpKzaPZVWm0LaVC9RV6ynaafk4FvckuzTFEIgeGDniTFWycnZsRjKuQrOy1-JadUxfwrEfFyL1ytABFBaQIUYhlz74OsUeGpFbCKTMpvJ8ZQRauPOnP9Z3qy8","Scope":"openid profile afcpayroll offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-08-20 12:00:56.736 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-20 12:00:56.744 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-20 12:00:56.745 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-20 12:00:56.746 +03:00 [DBG] Start token request.
2019-08-20 12:00:56.747 +03:00 [DBG] Start client validation
2019-08-20 12:00:56.747 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-20 12:00:56.747 +03:00 [DBG] Start parsing for secret in post body
2019-08-20 12:00:56.748 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-20 12:00:56.749 +03:00 [DBG] Secret id found: mvc
2019-08-20 12:00:56.751 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:00:56.752 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-20 12:00:56.752 +03:00 [DBG] Client validation success
2019-08-20 12:00:56.753 +03:00 [DBG] Start token request validation
2019-08-20 12:00:56.753 +03:00 [DBG] Start validation of authorization code token request
2019-08-20 12:00:56.754 +03:00 [DBG] Validation of authorization code token request success
2019-08-20 12:00:56.754 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"1ea3f2cbe4c98ae1185b9d68126be4a0088d0439634c731a8685875d4dc8041c","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"mvc","client_secret":"***REDACTED***","code":"1ea3f2cbe4c98ae1185b9d68126be4a0088d0439634c731a8685875d4dc8041c","grant_type":"authorization_code","redirect_uri":"http://localhost:5002/home/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-08-20 12:00:56.759 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:00:56.760 +03:00 [DBG] Getting claims for access token for client: mvc
2019-08-20 12:00:56.760 +03:00 [DBG] Getting claims for access token for subject: 1
2019-08-20 12:00:56.766 +03:00 [DBG] Creating refresh token
2019-08-20 12:00:56.767 +03:00 [DBG] Setting an absolute lifetime: 2592000
2019-08-20 12:00:56.768 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:00:56.769 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 12:00:56.769 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 12:00:56.773 +03:00 [DBG] Token request success.
2019-08-20 12:00:56.777 +03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-08-20 12:00:56.778 +03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-08-20 12:00:56.779 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-08-20 12:00:56.779 +03:00 [DBG] Start userinfo request
2019-08-20 12:00:56.780 +03:00 [DBG] Bearer token found in header
2019-08-20 12:00:56.783 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:00:56.784 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:00:56.785 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-08-20 12:00:56.785 +03:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1566291656,"exp":1566291716,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","afcpayroll"],"client_id":"mvc","sub":"1","auth_time":1566291655,"idp":"local","name":"alice","email":"alice@email.com","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-08-20 12:00:56.796 +03:00 [DBG] Creating userinfo response
2019-08-20 12:00:56.796 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 12:00:56.797 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 12:00:56.798 +03:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 12:00:56.798 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 12:00:56.799 +03:00 [INF] Profile service returned the following claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 12:00:56.799 +03:00 [DBG] End userinfo request
2019-08-20 12:00:56.844 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-08-20 12:00:56.846 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-08-20 12:00:56.846 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-08-20 12:00:56.847 +03:00 [DBG] Start authorize request
2019-08-20 12:00:56.847 +03:00 [DBG] User in authorize request: 1
2019-08-20 12:00:56.848 +03:00 [DBG] Start authorize request protocol validation
2019-08-20 12:00:56.848 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:00:56.849 +03:00 [DBG] Checking for PKCE parameters
2019-08-20 12:00:56.850 +03:00 [DBG] No PKCE used.
2019-08-20 12:00:56.851 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-20 12:00:56.852 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/home/signin-oidc","AllowedRedirectUris":["http://localhost:5002/home/signin-oidc"],"SubjectId":"1","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9Ns4E-3jlnVTYQpYBFBav74MZNex9UHdLBDovYMC94v94H7yPup4e8QlhMctIEURzjAxuHXvEupF6VS5ZcMEJO74Z1YMA1Pt271yCviHEAzJPWmhfWMbxZZNQ00A5rmlE5TIG5zIJs-d8-gjQb0kUCNqLSAHqLiDEo6t3kipNJV3yBRHMjauGRxslqYvlhcV_jK0pjDxoPmDeMLcuNvQ0wG9TgVn9_WWTypcc_G5TUWm8vnys80Bb6eV4Ud3dkN91gSRbtz-EjPlwzEHvebSQKvXQ1kfg9yAfJGR53NLGw2YQJ0iuKcypz2O3H4N5EuB1Y","UiLocales":null,"Nonce":"637018884568282894.MWIzN2JmMzUtNjI5MS00MjZjLTg1OWMtYTc3MjRiZWUwMzQ2MDcyMGI0ODItOTg1Ny00YTcxLWIxYTgtNWFiY2EwOTAzOTll","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"8a7f11d362fe2b6d0a970781023d5f73","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/home/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637018884568282894.MWIzN2JmMzUtNjI5MS00MjZjLTg1OWMtYTc3MjRiZWUwMzQ2MDcyMGI0ODItOTg1Ny00YTcxLWIxYTgtNWFiY2EwOTAzOTll","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9Ns4E-3jlnVTYQpYBFBav74MZNex9UHdLBDovYMC94v94H7yPup4e8QlhMctIEURzjAxuHXvEupF6VS5ZcMEJO74Z1YMA1Pt271yCviHEAzJPWmhfWMbxZZNQ00A5rmlE5TIG5zIJs-d8-gjQb0kUCNqLSAHqLiDEo6t3kipNJV3yBRHMjauGRxslqYvlhcV_jK0pjDxoPmDeMLcuNvQ0wG9TgVn9_WWTypcc_G5TUWm8vnys80Bb6eV4Ud3dkN91gSRbtz-EjPlwzEHvebSQKvXQ1kfg9yAfJGR53NLGw2YQJ0iuKcypz2O3H4N5EuB1Y","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-20 12:00:56.857 +03:00 [DBG] Client is configured to not require consent, no consent is required
2019-08-20 12:00:56.858 +03:00 [DBG] Creating Hybrid Flow response.
2019-08-20 12:00:56.858 +03:00 [DBG] Creating Implicit Flow response.
2019-08-20 12:00:56.859 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 12:00:56.859 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 12:00:56.864 +03:00 [DBG] Authorize endpoint response
{"SubjectId":"1","ClientId":"mvc","RedirectUri":"http://localhost:5002/home/signin-oidc","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9Ns4E-3jlnVTYQpYBFBav74MZNex9UHdLBDovYMC94v94H7yPup4e8QlhMctIEURzjAxuHXvEupF6VS5ZcMEJO74Z1YMA1Pt271yCviHEAzJPWmhfWMbxZZNQ00A5rmlE5TIG5zIJs-d8-gjQb0kUCNqLSAHqLiDEo6t3kipNJV3yBRHMjauGRxslqYvlhcV_jK0pjDxoPmDeMLcuNvQ0wG9TgVn9_WWTypcc_G5TUWm8vnys80Bb6eV4Ud3dkN91gSRbtz-EjPlwzEHvebSQKvXQ1kfg9yAfJGR53NLGw2YQJ0iuKcypz2O3H4N5EuB1Y","Scope":"openid profile afcpayroll offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-08-20 12:00:57.078 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-20 12:00:57.079 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-20 12:00:57.079 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-20 12:00:57.080 +03:00 [DBG] Start token request.
2019-08-20 12:00:57.080 +03:00 [DBG] Start client validation
2019-08-20 12:00:57.081 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-20 12:00:57.081 +03:00 [DBG] Start parsing for secret in post body
2019-08-20 12:00:57.082 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-20 12:00:57.082 +03:00 [DBG] Secret id found: mvc
2019-08-20 12:00:57.083 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:00:57.084 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-20 12:00:57.085 +03:00 [DBG] Client validation success
2019-08-20 12:00:57.085 +03:00 [DBG] Start token request validation
2019-08-20 12:00:57.086 +03:00 [DBG] Start validation of authorization code token request
2019-08-20 12:00:57.086 +03:00 [DBG] Validation of authorization code token request success
2019-08-20 12:00:57.087 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"54216071b38a871cfc9f4f209c16cc8cde963f8b5d60abfb93b8fb6d9a42ca41","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"mvc","client_secret":"***REDACTED***","code":"54216071b38a871cfc9f4f209c16cc8cde963f8b5d60abfb93b8fb6d9a42ca41","grant_type":"authorization_code","redirect_uri":"http://localhost:5002/home/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-08-20 12:00:57.093 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:00:57.093 +03:00 [DBG] Getting claims for access token for client: mvc
2019-08-20 12:00:57.094 +03:00 [DBG] Getting claims for access token for subject: 1
2019-08-20 12:00:57.098 +03:00 [DBG] Creating refresh token
2019-08-20 12:00:57.098 +03:00 [DBG] Setting an absolute lifetime: 2592000
2019-08-20 12:00:57.099 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:00:57.103 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 12:00:57.104 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 12:00:57.108 +03:00 [DBG] Token request success.
2019-08-20 12:00:57.111 +03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-08-20 12:00:57.112 +03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-08-20 12:00:57.113 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-08-20 12:00:57.113 +03:00 [DBG] Start userinfo request
2019-08-20 12:00:57.114 +03:00 [DBG] Bearer token found in header
2019-08-20 12:00:57.116 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:00:57.119 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:00:57.122 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-08-20 12:00:57.123 +03:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1566291657,"exp":1566291717,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","afcpayroll"],"client_id":"mvc","sub":"1","auth_time":1566291655,"idp":"local","name":"alice","email":"alice@email.com","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-08-20 12:00:57.127 +03:00 [DBG] Creating userinfo response
2019-08-20 12:00:57.128 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 12:00:57.128 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 12:00:57.129 +03:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 12:00:57.130 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 12:00:57.130 +03:00 [INF] Profile service returned the following claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 12:00:57.131 +03:00 [DBG] End userinfo request
2019-08-20 12:00:57.174 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-08-20 12:00:57.175 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-08-20 12:00:57.176 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-08-20 12:00:57.177 +03:00 [DBG] Start authorize request
2019-08-20 12:00:57.177 +03:00 [DBG] User in authorize request: 1
2019-08-20 12:00:57.178 +03:00 [DBG] Start authorize request protocol validation
2019-08-20 12:00:57.178 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:00:57.179 +03:00 [DBG] Checking for PKCE parameters
2019-08-20 12:00:57.179 +03:00 [DBG] No PKCE used.
2019-08-20 12:00:57.180 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-20 12:00:57.181 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/home/signin-oidc","AllowedRedirectUris":["http://localhost:5002/home/signin-oidc"],"SubjectId":"1","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9P1_J6QsqUAkyX6Rhs_ubdiYXrTtRtZgI9LziOSHnVHEqB3q_pH4m5kL3cwjPj9nOFa1G6R9Sai2a0vi205u_uQTRFReH4l0s0kWgg75rBkZg8kC4DzvK0GZ5RU1hYSvBRHn-f-q7Pqr4WGJjFuyTALPTDgatoEanwQeZAJ2-w5mN4MghxRFdWazKJYkGzf_y4CXlYz5GZRo3RLw6siFm9NoeI9Yrldl8YhcciTnONyb-iBItzjiItqZ04_oV-rM660C_Fq6rIgzSVUxtc8L48OXShbQuNyyY_rPyUxwY-rgfiqpz2doCB3qp8ToShk-3Y","UiLocales":null,"Nonce":"637018884571585695.NzRkZDIyZmYtZmQ2YS00ZDMwLWFkYjQtNWU3ZjYyNGJjYjFlMjMxODZjYjQtN2Q2Yy00ZjhjLWI1OWMtMTg3MzA0NjljMzAz","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"8a7f11d362fe2b6d0a970781023d5f73","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/home/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637018884571585695.NzRkZDIyZmYtZmQ2YS00ZDMwLWFkYjQtNWU3ZjYyNGJjYjFlMjMxODZjYjQtN2Q2Yy00ZjhjLWI1OWMtMTg3MzA0NjljMzAz","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9P1_J6QsqUAkyX6Rhs_ubdiYXrTtRtZgI9LziOSHnVHEqB3q_pH4m5kL3cwjPj9nOFa1G6R9Sai2a0vi205u_uQTRFReH4l0s0kWgg75rBkZg8kC4DzvK0GZ5RU1hYSvBRHn-f-q7Pqr4WGJjFuyTALPTDgatoEanwQeZAJ2-w5mN4MghxRFdWazKJYkGzf_y4CXlYz5GZRo3RLw6siFm9NoeI9Yrldl8YhcciTnONyb-iBItzjiItqZ04_oV-rM660C_Fq6rIgzSVUxtc8L48OXShbQuNyyY_rPyUxwY-rgfiqpz2doCB3qp8ToShk-3Y","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-20 12:00:57.188 +03:00 [DBG] Client is configured to not require consent, no consent is required
2019-08-20 12:00:57.189 +03:00 [DBG] Creating Hybrid Flow response.
2019-08-20 12:00:57.189 +03:00 [DBG] Creating Implicit Flow response.
2019-08-20 12:00:57.190 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 12:00:57.190 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 12:00:57.194 +03:00 [DBG] Authorize endpoint response
{"SubjectId":"1","ClientId":"mvc","RedirectUri":"http://localhost:5002/home/signin-oidc","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9P1_J6QsqUAkyX6Rhs_ubdiYXrTtRtZgI9LziOSHnVHEqB3q_pH4m5kL3cwjPj9nOFa1G6R9Sai2a0vi205u_uQTRFReH4l0s0kWgg75rBkZg8kC4DzvK0GZ5RU1hYSvBRHn-f-q7Pqr4WGJjFuyTALPTDgatoEanwQeZAJ2-w5mN4MghxRFdWazKJYkGzf_y4CXlYz5GZRo3RLw6siFm9NoeI9Yrldl8YhcciTnONyb-iBItzjiItqZ04_oV-rM660C_Fq6rIgzSVUxtc8L48OXShbQuNyyY_rPyUxwY-rgfiqpz2doCB3qp8ToShk-3Y","Scope":"openid profile afcpayroll offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-08-20 12:00:57.413 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-20 12:00:57.414 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-20 12:00:57.415 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-20 12:00:57.416 +03:00 [DBG] Start token request.
2019-08-20 12:00:57.416 +03:00 [DBG] Start client validation
2019-08-20 12:00:57.416 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-20 12:00:57.419 +03:00 [DBG] Start parsing for secret in post body
2019-08-20 12:00:57.423 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-20 12:00:57.423 +03:00 [DBG] Secret id found: mvc
2019-08-20 12:00:57.424 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:00:57.425 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-20 12:00:57.425 +03:00 [DBG] Client validation success
2019-08-20 12:00:57.426 +03:00 [DBG] Start token request validation
2019-08-20 12:00:57.426 +03:00 [DBG] Start validation of authorization code token request
2019-08-20 12:00:57.427 +03:00 [DBG] Validation of authorization code token request success
2019-08-20 12:00:57.428 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"9039f82a3f9d81b46a07ee0158663221508085d8f01f3b6b0f5a7ad48c66d6c7","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"mvc","client_secret":"***REDACTED***","code":"9039f82a3f9d81b46a07ee0158663221508085d8f01f3b6b0f5a7ad48c66d6c7","grant_type":"authorization_code","redirect_uri":"http://localhost:5002/home/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-08-20 12:00:57.435 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:00:57.436 +03:00 [DBG] Getting claims for access token for client: mvc
2019-08-20 12:00:57.437 +03:00 [DBG] Getting claims for access token for subject: 1
2019-08-20 12:00:57.441 +03:00 [DBG] Creating refresh token
2019-08-20 12:00:57.442 +03:00 [DBG] Setting an absolute lifetime: 2592000
2019-08-20 12:00:57.442 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:00:57.443 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 12:00:57.443 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 12:00:57.447 +03:00 [DBG] Token request success.
2019-08-20 12:00:57.454 +03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-08-20 12:00:57.455 +03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-08-20 12:00:57.456 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-08-20 12:00:57.456 +03:00 [DBG] Start userinfo request
2019-08-20 12:00:57.457 +03:00 [DBG] Bearer token found in header
2019-08-20 12:00:57.461 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:00:57.462 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:00:57.463 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-08-20 12:00:57.463 +03:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1566291657,"exp":1566291717,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","afcpayroll"],"client_id":"mvc","sub":"1","auth_time":1566291655,"idp":"local","name":"alice","email":"alice@email.com","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-08-20 12:00:57.468 +03:00 [DBG] Creating userinfo response
2019-08-20 12:00:57.469 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 12:00:57.469 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 12:00:57.470 +03:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 12:00:57.471 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 12:00:57.471 +03:00 [INF] Profile service returned the following claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 12:00:57.472 +03:00 [DBG] End userinfo request
2019-08-20 12:00:57.530 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-08-20 12:00:57.532 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-08-20 12:00:57.534 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-08-20 12:00:57.535 +03:00 [DBG] Start authorize request
2019-08-20 12:00:57.536 +03:00 [DBG] User in authorize request: 1
2019-08-20 12:00:57.536 +03:00 [DBG] Start authorize request protocol validation
2019-08-20 12:00:57.537 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:00:57.540 +03:00 [DBG] Checking for PKCE parameters
2019-08-20 12:00:57.541 +03:00 [DBG] No PKCE used.
2019-08-20 12:00:57.542 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-20 12:00:57.543 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/home/signin-oidc","AllowedRedirectUris":["http://localhost:5002/home/signin-oidc"],"SubjectId":"1","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9NgXr9NpYrGRFV_dNaSo5oqMHwKZwwpIIZG8HwOTyJ_wbxIuH1QYHg_awWbXzDA4yk6e9zqzxHuDgXLkXkNND1l8ihRPeYeSSKhN95V2Valc6CKJKNadLHGBJvyKhuOiqjoKCD8aSMQ06bTqXHx3I-9V8BHELDDznhP3mSSF1xVceQYf1H6BO7QDQmKq98Xnktk_mQLxWTNyELyncR1fGj6GOKijEhlvc7at-0R9zAnV1ORKqQhWZ3v1SZlX9y7TlKPlY5scGH6jBjd9T01bJZVwFZZ0zcPw1TXw5_wAFDdbBxn5WBw30pif17zzCncAcw","UiLocales":null,"Nonce":"637018884575069262.NTliMWIxZWItZGUzYS00MTZiLTk5ZGQtNDc4Y2QxZjg0ZjEzMjk5OWFkZmEtN2IwNy00ODRlLWEzOGMtNWE2OTEyMWM1OTZl","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"8a7f11d362fe2b6d0a970781023d5f73","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/home/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637018884575069262.NTliMWIxZWItZGUzYS00MTZiLTk5ZGQtNDc4Y2QxZjg0ZjEzMjk5OWFkZmEtN2IwNy00ODRlLWEzOGMtNWE2OTEyMWM1OTZl","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9NgXr9NpYrGRFV_dNaSo5oqMHwKZwwpIIZG8HwOTyJ_wbxIuH1QYHg_awWbXzDA4yk6e9zqzxHuDgXLkXkNND1l8ihRPeYeSSKhN95V2Valc6CKJKNadLHGBJvyKhuOiqjoKCD8aSMQ06bTqXHx3I-9V8BHELDDznhP3mSSF1xVceQYf1H6BO7QDQmKq98Xnktk_mQLxWTNyELyncR1fGj6GOKijEhlvc7at-0R9zAnV1ORKqQhWZ3v1SZlX9y7TlKPlY5scGH6jBjd9T01bJZVwFZZ0zcPw1TXw5_wAFDdbBxn5WBw30pif17zzCncAcw","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-20 12:00:57.548 +03:00 [DBG] Client is configured to not require consent, no consent is required
2019-08-20 12:00:57.549 +03:00 [DBG] Creating Hybrid Flow response.
2019-08-20 12:00:57.549 +03:00 [DBG] Creating Implicit Flow response.
2019-08-20 12:00:57.550 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 12:00:57.551 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 12:00:57.556 +03:00 [DBG] Authorize endpoint response
{"SubjectId":"1","ClientId":"mvc","RedirectUri":"http://localhost:5002/home/signin-oidc","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9NgXr9NpYrGRFV_dNaSo5oqMHwKZwwpIIZG8HwOTyJ_wbxIuH1QYHg_awWbXzDA4yk6e9zqzxHuDgXLkXkNND1l8ihRPeYeSSKhN95V2Valc6CKJKNadLHGBJvyKhuOiqjoKCD8aSMQ06bTqXHx3I-9V8BHELDDznhP3mSSF1xVceQYf1H6BO7QDQmKq98Xnktk_mQLxWTNyELyncR1fGj6GOKijEhlvc7at-0R9zAnV1ORKqQhWZ3v1SZlX9y7TlKPlY5scGH6jBjd9T01bJZVwFZZ0zcPw1TXw5_wAFDdbBxn5WBw30pif17zzCncAcw","Scope":"openid profile afcpayroll offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-08-20 12:00:57.779 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-20 12:00:57.781 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-20 12:00:57.781 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-20 12:00:57.782 +03:00 [DBG] Start token request.
2019-08-20 12:00:57.782 +03:00 [DBG] Start client validation
2019-08-20 12:00:57.783 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-20 12:00:57.784 +03:00 [DBG] Start parsing for secret in post body
2019-08-20 12:00:57.785 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-20 12:00:57.787 +03:00 [DBG] Secret id found: mvc
2019-08-20 12:00:57.788 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:00:57.789 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-20 12:00:57.790 +03:00 [DBG] Client validation success
2019-08-20 12:00:57.791 +03:00 [DBG] Start token request validation
2019-08-20 12:00:57.791 +03:00 [DBG] Start validation of authorization code token request
2019-08-20 12:00:57.794 +03:00 [DBG] Validation of authorization code token request success
2019-08-20 12:00:57.795 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"c3d0c1460aec0d960f1288f90665bdb94bf486c10c1b4bf1c80c3739f7cb3a88","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"mvc","client_secret":"***REDACTED***","code":"c3d0c1460aec0d960f1288f90665bdb94bf486c10c1b4bf1c80c3739f7cb3a88","grant_type":"authorization_code","redirect_uri":"http://localhost:5002/home/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-08-20 12:00:57.798 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:00:57.799 +03:00 [DBG] Getting claims for access token for client: mvc
2019-08-20 12:00:57.799 +03:00 [DBG] Getting claims for access token for subject: 1
2019-08-20 12:00:57.804 +03:00 [DBG] Creating refresh token
2019-08-20 12:00:57.805 +03:00 [DBG] Setting an absolute lifetime: 2592000
2019-08-20 12:00:57.805 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:00:57.806 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 12:00:57.807 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 12:00:57.811 +03:00 [DBG] Token request success.
2019-08-20 12:00:57.815 +03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-08-20 12:00:57.816 +03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-08-20 12:00:57.817 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-08-20 12:00:57.818 +03:00 [DBG] Start userinfo request
2019-08-20 12:00:57.818 +03:00 [DBG] Bearer token found in header
2019-08-20 12:00:57.821 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:00:57.822 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:00:57.822 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-08-20 12:00:57.823 +03:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1566291657,"exp":1566291717,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","afcpayroll"],"client_id":"mvc","sub":"1","auth_time":1566291655,"idp":"local","name":"alice","email":"alice@email.com","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-08-20 12:00:57.829 +03:00 [DBG] Creating userinfo response
2019-08-20 12:00:57.829 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 12:00:57.830 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 12:00:57.830 +03:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 12:00:57.831 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 12:00:57.831 +03:00 [INF] Profile service returned the following claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 12:00:57.832 +03:00 [DBG] End userinfo request
2019-08-20 12:00:57.893 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-08-20 12:00:57.894 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-08-20 12:00:57.895 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-08-20 12:00:57.895 +03:00 [DBG] Start authorize request
2019-08-20 12:00:57.896 +03:00 [DBG] User in authorize request: 1
2019-08-20 12:00:57.896 +03:00 [DBG] Start authorize request protocol validation
2019-08-20 12:00:57.897 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:00:57.897 +03:00 [DBG] Checking for PKCE parameters
2019-08-20 12:00:57.897 +03:00 [DBG] No PKCE used.
2019-08-20 12:00:57.899 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-20 12:00:57.899 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/home/signin-oidc","AllowedRedirectUris":["http://localhost:5002/home/signin-oidc"],"SubjectId":"1","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9OjWeR3gVdMPSU7zBU6ACMb5MCx1dEnuchKNawL_2RuQd68_i6tumu9knsn37f2yMgm81ztgMwhkXMU3Up4CKVPWbtandsF8CrApnAG4HS1vqDS1Kh_Wv6vkjUfwyL46XaAa8VvIRuS-RR072_-VYwLt8RA0a9eC_7usO40JZedMeXW9QCfVltR2hhchvnODfBRqwKIWUVjzW1Fs2j4dB6hqq5ToAGJqJ4Oe-ripOIX0WzR9Me9As3JvhzLZrt3XoAOamoqfoTHXeLnkzpdF3Jdl69o3vDWx8b7SgRW1yFyOK9CW8X3MO7LzAnyIFiawW0","UiLocales":null,"Nonce":"637018884578706212.NDlkYjU0MzctZjZiNy00NjhjLWI3ZTAtNmYzYTljMGE5YjcwM2VjMjgxYWUtNGE0Ni00ZTdmLTkwM2UtOGE2YTcyYzMwYTUx","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"8a7f11d362fe2b6d0a970781023d5f73","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/home/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637018884578706212.NDlkYjU0MzctZjZiNy00NjhjLWI3ZTAtNmYzYTljMGE5YjcwM2VjMjgxYWUtNGE0Ni00ZTdmLTkwM2UtOGE2YTcyYzMwYTUx","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9OjWeR3gVdMPSU7zBU6ACMb5MCx1dEnuchKNawL_2RuQd68_i6tumu9knsn37f2yMgm81ztgMwhkXMU3Up4CKVPWbtandsF8CrApnAG4HS1vqDS1Kh_Wv6vkjUfwyL46XaAa8VvIRuS-RR072_-VYwLt8RA0a9eC_7usO40JZedMeXW9QCfVltR2hhchvnODfBRqwKIWUVjzW1Fs2j4dB6hqq5ToAGJqJ4Oe-ripOIX0WzR9Me9As3JvhzLZrt3XoAOamoqfoTHXeLnkzpdF3Jdl69o3vDWx8b7SgRW1yFyOK9CW8X3MO7LzAnyIFiawW0","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-20 12:00:57.907 +03:00 [DBG] Client is configured to not require consent, no consent is required
2019-08-20 12:00:57.908 +03:00 [DBG] Creating Hybrid Flow response.
2019-08-20 12:00:57.908 +03:00 [DBG] Creating Implicit Flow response.
2019-08-20 12:00:57.909 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 12:00:57.910 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 12:00:57.914 +03:00 [DBG] Authorize endpoint response
{"SubjectId":"1","ClientId":"mvc","RedirectUri":"http://localhost:5002/home/signin-oidc","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9OjWeR3gVdMPSU7zBU6ACMb5MCx1dEnuchKNawL_2RuQd68_i6tumu9knsn37f2yMgm81ztgMwhkXMU3Up4CKVPWbtandsF8CrApnAG4HS1vqDS1Kh_Wv6vkjUfwyL46XaAa8VvIRuS-RR072_-VYwLt8RA0a9eC_7usO40JZedMeXW9QCfVltR2hhchvnODfBRqwKIWUVjzW1Fs2j4dB6hqq5ToAGJqJ4Oe-ripOIX0WzR9Me9As3JvhzLZrt3XoAOamoqfoTHXeLnkzpdF3Jdl69o3vDWx8b7SgRW1yFyOK9CW8X3MO7LzAnyIFiawW0","Scope":"openid profile afcpayroll offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-08-20 12:00:58.128 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-20 12:00:58.130 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-20 12:00:58.130 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-20 12:00:58.131 +03:00 [DBG] Start token request.
2019-08-20 12:00:58.131 +03:00 [DBG] Start client validation
2019-08-20 12:00:58.131 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-20 12:00:58.132 +03:00 [DBG] Start parsing for secret in post body
2019-08-20 12:00:58.132 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-20 12:00:58.133 +03:00 [DBG] Secret id found: mvc
2019-08-20 12:00:58.136 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:00:58.136 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-20 12:00:58.137 +03:00 [DBG] Client validation success
2019-08-20 12:00:58.137 +03:00 [DBG] Start token request validation
2019-08-20 12:00:58.138 +03:00 [DBG] Start validation of authorization code token request
2019-08-20 12:00:58.138 +03:00 [DBG] Validation of authorization code token request success
2019-08-20 12:00:58.139 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"67e7c9a99b8380fd5bfe341f121903469b35f3371cb1f6e3f8f2197061f3692e","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"mvc","client_secret":"***REDACTED***","code":"67e7c9a99b8380fd5bfe341f121903469b35f3371cb1f6e3f8f2197061f3692e","grant_type":"authorization_code","redirect_uri":"http://localhost:5002/home/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-08-20 12:00:58.143 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:00:58.143 +03:00 [DBG] Getting claims for access token for client: mvc
2019-08-20 12:00:58.144 +03:00 [DBG] Getting claims for access token for subject: 1
2019-08-20 12:00:58.148 +03:00 [DBG] Creating refresh token
2019-08-20 12:00:58.148 +03:00 [DBG] Setting an absolute lifetime: 2592000
2019-08-20 12:00:58.149 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:00:58.149 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 12:00:58.151 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 12:00:58.156 +03:00 [DBG] Token request success.
2019-08-20 12:00:58.160 +03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-08-20 12:00:58.161 +03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-08-20 12:00:58.163 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-08-20 12:00:58.164 +03:00 [DBG] Start userinfo request
2019-08-20 12:00:58.164 +03:00 [DBG] Bearer token found in header
2019-08-20 12:00:58.168 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:00:58.168 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:00:58.169 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-08-20 12:00:58.169 +03:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1566291658,"exp":1566291718,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","afcpayroll"],"client_id":"mvc","sub":"1","auth_time":1566291655,"idp":"local","name":"alice","email":"alice@email.com","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-08-20 12:00:58.173 +03:00 [DBG] Creating userinfo response
2019-08-20 12:00:58.174 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 12:00:58.174 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 12:00:58.175 +03:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 12:00:58.175 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 12:00:58.176 +03:00 [INF] Profile service returned the following claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 12:00:58.176 +03:00 [DBG] End userinfo request
2019-08-20 12:00:58.225 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-08-20 12:00:58.226 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-08-20 12:00:58.226 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-08-20 12:00:58.227 +03:00 [DBG] Start authorize request
2019-08-20 12:00:58.227 +03:00 [DBG] User in authorize request: 1
2019-08-20 12:00:58.228 +03:00 [DBG] Start authorize request protocol validation
2019-08-20 12:00:58.228 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:00:58.229 +03:00 [DBG] Checking for PKCE parameters
2019-08-20 12:00:58.230 +03:00 [DBG] No PKCE used.
2019-08-20 12:00:58.231 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-20 12:00:58.232 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/home/signin-oidc","AllowedRedirectUris":["http://localhost:5002/home/signin-oidc"],"SubjectId":"1","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9MhbVoJmw90dPQLg1MZojDfjbSiWedxJ1fb5fSof2bgpsRgWwYfYYq7t0amuEFKxE4YFmDOl1xnrbDY4ROH-Y08PgTBwhy60Cgqz3kdzzpmb3xqfKYeZRXJciT6PJJgKGnCQaRiYoO4Aq9a1MIfTK2alSTCEZIz6NfU4lN1PGQ1ED4QSHspOw4kV1Xu6kYVOGG-xvWWQv8d9nytPBgO-V6Dfz4AHVGHKkkkLhDzaJ6wASiZ3f5zbzYwQlHm9nDji_yVLsXFWbduz9U4JuXM3Cwzeaw4LNGC_Ldu1jzgBFbQSk4EYtPK110qbsIQKeF5osQ","UiLocales":null,"Nonce":"637018884582055934.M2NiZjRjNDAtZmIyYy00NDFhLTgxYmItN2ZhYThjOWM1NmQ0NzU5MDQ3ZjMtYmU5Zi00MThkLThmZTctY2NjNDM1NzY5NDA0","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"8a7f11d362fe2b6d0a970781023d5f73","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/home/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637018884582055934.M2NiZjRjNDAtZmIyYy00NDFhLTgxYmItN2ZhYThjOWM1NmQ0NzU5MDQ3ZjMtYmU5Zi00MThkLThmZTctY2NjNDM1NzY5NDA0","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9MhbVoJmw90dPQLg1MZojDfjbSiWedxJ1fb5fSof2bgpsRgWwYfYYq7t0amuEFKxE4YFmDOl1xnrbDY4ROH-Y08PgTBwhy60Cgqz3kdzzpmb3xqfKYeZRXJciT6PJJgKGnCQaRiYoO4Aq9a1MIfTK2alSTCEZIz6NfU4lN1PGQ1ED4QSHspOw4kV1Xu6kYVOGG-xvWWQv8d9nytPBgO-V6Dfz4AHVGHKkkkLhDzaJ6wASiZ3f5zbzYwQlHm9nDji_yVLsXFWbduz9U4JuXM3Cwzeaw4LNGC_Ldu1jzgBFbQSk4EYtPK110qbsIQKeF5osQ","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-20 12:00:58.237 +03:00 [DBG] Client is configured to not require consent, no consent is required
2019-08-20 12:00:58.238 +03:00 [DBG] Creating Hybrid Flow response.
2019-08-20 12:00:58.238 +03:00 [DBG] Creating Implicit Flow response.
2019-08-20 12:00:58.239 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 12:00:58.240 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 12:00:58.245 +03:00 [DBG] Authorize endpoint response
{"SubjectId":"1","ClientId":"mvc","RedirectUri":"http://localhost:5002/home/signin-oidc","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9MhbVoJmw90dPQLg1MZojDfjbSiWedxJ1fb5fSof2bgpsRgWwYfYYq7t0amuEFKxE4YFmDOl1xnrbDY4ROH-Y08PgTBwhy60Cgqz3kdzzpmb3xqfKYeZRXJciT6PJJgKGnCQaRiYoO4Aq9a1MIfTK2alSTCEZIz6NfU4lN1PGQ1ED4QSHspOw4kV1Xu6kYVOGG-xvWWQv8d9nytPBgO-V6Dfz4AHVGHKkkkLhDzaJ6wASiZ3f5zbzYwQlHm9nDji_yVLsXFWbduz9U4JuXM3Cwzeaw4LNGC_Ldu1jzgBFbQSk4EYtPK110qbsIQKeF5osQ","Scope":"openid profile afcpayroll offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-08-20 12:00:58.474 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-20 12:00:58.475 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-20 12:00:58.476 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-20 12:00:58.476 +03:00 [DBG] Start token request.
2019-08-20 12:00:58.476 +03:00 [DBG] Start client validation
2019-08-20 12:00:58.477 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-20 12:00:58.477 +03:00 [DBG] Start parsing for secret in post body
2019-08-20 12:00:58.478 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-20 12:00:58.479 +03:00 [DBG] Secret id found: mvc
2019-08-20 12:00:58.479 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:00:58.480 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-20 12:00:58.481 +03:00 [DBG] Client validation success
2019-08-20 12:00:58.481 +03:00 [DBG] Start token request validation
2019-08-20 12:00:58.481 +03:00 [DBG] Start validation of authorization code token request
2019-08-20 12:00:58.482 +03:00 [DBG] Validation of authorization code token request success
2019-08-20 12:00:58.482 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"45a2f7832813d1ac7f904fa6b3add6ef404e6c62223fcd3da45ea7932426bb2c","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"mvc","client_secret":"***REDACTED***","code":"45a2f7832813d1ac7f904fa6b3add6ef404e6c62223fcd3da45ea7932426bb2c","grant_type":"authorization_code","redirect_uri":"http://localhost:5002/home/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-08-20 12:00:58.488 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:00:58.489 +03:00 [DBG] Getting claims for access token for client: mvc
2019-08-20 12:00:58.489 +03:00 [DBG] Getting claims for access token for subject: 1
2019-08-20 12:00:58.493 +03:00 [DBG] Creating refresh token
2019-08-20 12:00:58.495 +03:00 [DBG] Setting an absolute lifetime: 2592000
2019-08-20 12:00:58.496 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:00:58.497 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 12:00:58.497 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 12:00:58.502 +03:00 [DBG] Token request success.
2019-08-20 12:00:58.506 +03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-08-20 12:00:58.507 +03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-08-20 12:00:58.508 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-08-20 12:00:58.508 +03:00 [DBG] Start userinfo request
2019-08-20 12:00:58.509 +03:00 [DBG] Bearer token found in header
2019-08-20 12:00:58.514 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:00:58.515 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:00:58.515 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-08-20 12:00:58.516 +03:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1566291658,"exp":1566291718,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","afcpayroll"],"client_id":"mvc","sub":"1","auth_time":1566291655,"idp":"local","name":"alice","email":"alice@email.com","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-08-20 12:00:58.522 +03:00 [DBG] Creating userinfo response
2019-08-20 12:00:58.524 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 12:00:58.525 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 12:00:58.526 +03:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 12:00:58.526 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 12:00:58.527 +03:00 [INF] Profile service returned the following claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 12:00:58.527 +03:00 [DBG] End userinfo request
2019-08-20 12:00:58.587 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-08-20 12:00:58.590 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-08-20 12:00:58.591 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-08-20 12:00:58.592 +03:00 [DBG] Start authorize request
2019-08-20 12:00:58.592 +03:00 [DBG] User in authorize request: 1
2019-08-20 12:00:58.593 +03:00 [DBG] Start authorize request protocol validation
2019-08-20 12:00:58.593 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:00:58.594 +03:00 [DBG] Checking for PKCE parameters
2019-08-20 12:00:58.594 +03:00 [DBG] No PKCE used.
2019-08-20 12:00:58.595 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-20 12:00:58.595 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/home/signin-oidc","AllowedRedirectUris":["http://localhost:5002/home/signin-oidc"],"SubjectId":"1","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9PEjmuUWxQHmV77MGpR9zKjRQGq67ixfsFzgeSOemvnUCb1vcT_JyI6dih3ysVN881lcGCmOKxrZkb-iZ3n_S89R1uNTnNH7rCP3_NPwL_RffzgDfOojQ9rGoZS81HlE1dkbg5_9XCOUry2EFMoTt6X86qeQA8u-VxYYYe3KhDzmaiCDyXBeXAuak-YboSyVxU0XpIzm-6wvU6Tt1AU6JfNv5MCchX9yLUQjFcZ2mckuiv0CO2p19reWz4nQvTPRFk8rKAEAPeWEi0ZrH5WXJfE15Cz_tGQ4aun_GNlMNeEM7bIuan_Q3khN5IsXLKVRYw","UiLocales":null,"Nonce":"637018884585638644.NjVmOTdkMjgtMWY3Zi00YmQwLWEwMGEtYjRhYWFiY2MwMjViNjBjYmE4MmYtYzNjMC00MDM1LTg1NDktZWU3OTAxMTgwMDc4","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"8a7f11d362fe2b6d0a970781023d5f73","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/home/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637018884585638644.NjVmOTdkMjgtMWY3Zi00YmQwLWEwMGEtYjRhYWFiY2MwMjViNjBjYmE4MmYtYzNjMC00MDM1LTg1NDktZWU3OTAxMTgwMDc4","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9PEjmuUWxQHmV77MGpR9zKjRQGq67ixfsFzgeSOemvnUCb1vcT_JyI6dih3ysVN881lcGCmOKxrZkb-iZ3n_S89R1uNTnNH7rCP3_NPwL_RffzgDfOojQ9rGoZS81HlE1dkbg5_9XCOUry2EFMoTt6X86qeQA8u-VxYYYe3KhDzmaiCDyXBeXAuak-YboSyVxU0XpIzm-6wvU6Tt1AU6JfNv5MCchX9yLUQjFcZ2mckuiv0CO2p19reWz4nQvTPRFk8rKAEAPeWEi0ZrH5WXJfE15Cz_tGQ4aun_GNlMNeEM7bIuan_Q3khN5IsXLKVRYw","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-20 12:00:58.602 +03:00 [DBG] Client is configured to not require consent, no consent is required
2019-08-20 12:00:58.603 +03:00 [DBG] Creating Hybrid Flow response.
2019-08-20 12:00:58.604 +03:00 [DBG] Creating Implicit Flow response.
2019-08-20 12:00:58.604 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 12:00:58.605 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 12:00:58.609 +03:00 [DBG] Authorize endpoint response
{"SubjectId":"1","ClientId":"mvc","RedirectUri":"http://localhost:5002/home/signin-oidc","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9PEjmuUWxQHmV77MGpR9zKjRQGq67ixfsFzgeSOemvnUCb1vcT_JyI6dih3ysVN881lcGCmOKxrZkb-iZ3n_S89R1uNTnNH7rCP3_NPwL_RffzgDfOojQ9rGoZS81HlE1dkbg5_9XCOUry2EFMoTt6X86qeQA8u-VxYYYe3KhDzmaiCDyXBeXAuak-YboSyVxU0XpIzm-6wvU6Tt1AU6JfNv5MCchX9yLUQjFcZ2mckuiv0CO2p19reWz4nQvTPRFk8rKAEAPeWEi0ZrH5WXJfE15Cz_tGQ4aun_GNlMNeEM7bIuan_Q3khN5IsXLKVRYw","Scope":"openid profile afcpayroll offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-08-20 12:00:58.835 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-20 12:00:58.839 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-20 12:00:58.841 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-20 12:00:58.841 +03:00 [DBG] Start token request.
2019-08-20 12:00:58.842 +03:00 [DBG] Start client validation
2019-08-20 12:00:58.842 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-20 12:00:58.843 +03:00 [DBG] Start parsing for secret in post body
2019-08-20 12:00:58.843 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-20 12:00:58.844 +03:00 [DBG] Secret id found: mvc
2019-08-20 12:00:58.844 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:00:58.845 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-20 12:00:58.846 +03:00 [DBG] Client validation success
2019-08-20 12:00:58.846 +03:00 [DBG] Start token request validation
2019-08-20 12:00:58.847 +03:00 [DBG] Start validation of authorization code token request
2019-08-20 12:00:58.847 +03:00 [DBG] Validation of authorization code token request success
2019-08-20 12:00:58.848 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"40ceb939cf9674bb84766c2439e4f1f1034a4317ea994d67c0fccf91b3abb662","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"mvc","client_secret":"***REDACTED***","code":"40ceb939cf9674bb84766c2439e4f1f1034a4317ea994d67c0fccf91b3abb662","grant_type":"authorization_code","redirect_uri":"http://localhost:5002/home/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-08-20 12:00:58.858 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:00:58.859 +03:00 [DBG] Getting claims for access token for client: mvc
2019-08-20 12:00:58.859 +03:00 [DBG] Getting claims for access token for subject: 1
2019-08-20 12:00:58.864 +03:00 [DBG] Creating refresh token
2019-08-20 12:00:58.881 +03:00 [DBG] Setting an absolute lifetime: 2592000
2019-08-20 12:00:58.883 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:00:58.883 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 12:00:58.885 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 12:00:58.890 +03:00 [DBG] Token request success.
2019-08-20 12:00:58.894 +03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-08-20 12:00:58.895 +03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-08-20 12:00:58.895 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-08-20 12:00:58.896 +03:00 [DBG] Start userinfo request
2019-08-20 12:00:58.896 +03:00 [DBG] Bearer token found in header
2019-08-20 12:00:58.899 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:00:58.900 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:00:58.903 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-08-20 12:00:58.904 +03:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1566291658,"exp":1566291718,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","afcpayroll"],"client_id":"mvc","sub":"1","auth_time":1566291655,"idp":"local","name":"alice","email":"alice@email.com","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-08-20 12:00:58.908 +03:00 [DBG] Creating userinfo response
2019-08-20 12:00:58.909 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 12:00:58.910 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 12:00:58.910 +03:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 12:00:58.911 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 12:00:58.912 +03:00 [INF] Profile service returned the following claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 12:00:58.912 +03:00 [DBG] End userinfo request
2019-08-20 12:00:58.994 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-08-20 12:00:58.995 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-08-20 12:00:58.995 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-08-20 12:00:58.996 +03:00 [DBG] Start authorize request
2019-08-20 12:00:58.996 +03:00 [DBG] User in authorize request: 1
2019-08-20 12:00:58.997 +03:00 [DBG] Start authorize request protocol validation
2019-08-20 12:00:58.997 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:00:58.998 +03:00 [DBG] Checking for PKCE parameters
2019-08-20 12:00:58.998 +03:00 [DBG] No PKCE used.
2019-08-20 12:00:58.999 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-20 12:00:59.000 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/home/signin-oidc","AllowedRedirectUris":["http://localhost:5002/home/signin-oidc"],"SubjectId":"1","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9OS0r3HzRqZ4XgREiOj0eCUTWIa3k57-_ngH7-eHKoOR8MGGycH3iMspdF__i6VGBx3VVIVs025tbza6tJgtsMu0afBBmT3OejoiPjCzZZlhmfXnesEEMWjXn_Dq5UKfRgKD0jSLbrAEfjpmMjCwEzHytvuqooAFIkPo1k6jf3KLe25gQ7hicUKsVnBh1x5bNIcGk72BtXX3GVOHHqKFu_4nMdyFQy-MImidtz12Dr1f3grYrnST9W67LKhSp4jguzk7ljOfTbz67qTm4pcxNL9cPRLcfP-VGieXb7Zvbb8XQPx1pGZu5DNBal1VdKD6r8","UiLocales":null,"Nonce":"637018884589710704.M2M0MWQ2MDUtN2I4MC00NTJjLWI4ZjktYzdiODVhZTNjMDc1NWMyNGMyOWItMzlhZi00M2MyLThmYjQtMDlkNjRkNDdmZTAx","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"8a7f11d362fe2b6d0a970781023d5f73","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/home/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637018884589710704.M2M0MWQ2MDUtN2I4MC00NTJjLWI4ZjktYzdiODVhZTNjMDc1NWMyNGMyOWItMzlhZi00M2MyLThmYjQtMDlkNjRkNDdmZTAx","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9OS0r3HzRqZ4XgREiOj0eCUTWIa3k57-_ngH7-eHKoOR8MGGycH3iMspdF__i6VGBx3VVIVs025tbza6tJgtsMu0afBBmT3OejoiPjCzZZlhmfXnesEEMWjXn_Dq5UKfRgKD0jSLbrAEfjpmMjCwEzHytvuqooAFIkPo1k6jf3KLe25gQ7hicUKsVnBh1x5bNIcGk72BtXX3GVOHHqKFu_4nMdyFQy-MImidtz12Dr1f3grYrnST9W67LKhSp4jguzk7ljOfTbz67qTm4pcxNL9cPRLcfP-VGieXb7Zvbb8XQPx1pGZu5DNBal1VdKD6r8","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-20 12:00:59.006 +03:00 [DBG] Client is configured to not require consent, no consent is required
2019-08-20 12:00:59.006 +03:00 [DBG] Creating Hybrid Flow response.
2019-08-20 12:00:59.007 +03:00 [DBG] Creating Implicit Flow response.
2019-08-20 12:00:59.007 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 12:00:59.008 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 12:00:59.012 +03:00 [DBG] Authorize endpoint response
{"SubjectId":"1","ClientId":"mvc","RedirectUri":"http://localhost:5002/home/signin-oidc","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9OS0r3HzRqZ4XgREiOj0eCUTWIa3k57-_ngH7-eHKoOR8MGGycH3iMspdF__i6VGBx3VVIVs025tbza6tJgtsMu0afBBmT3OejoiPjCzZZlhmfXnesEEMWjXn_Dq5UKfRgKD0jSLbrAEfjpmMjCwEzHytvuqooAFIkPo1k6jf3KLe25gQ7hicUKsVnBh1x5bNIcGk72BtXX3GVOHHqKFu_4nMdyFQy-MImidtz12Dr1f3grYrnST9W67LKhSp4jguzk7ljOfTbz67qTm4pcxNL9cPRLcfP-VGieXb7Zvbb8XQPx1pGZu5DNBal1VdKD6r8","Scope":"openid profile afcpayroll offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-08-20 12:00:59.240 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-20 12:00:59.241 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-20 12:00:59.242 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-20 12:00:59.243 +03:00 [DBG] Start token request.
2019-08-20 12:00:59.245 +03:00 [DBG] Start client validation
2019-08-20 12:00:59.247 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-20 12:00:59.247 +03:00 [DBG] Start parsing for secret in post body
2019-08-20 12:00:59.248 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-20 12:00:59.248 +03:00 [DBG] Secret id found: mvc
2019-08-20 12:00:59.249 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:00:59.249 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-20 12:00:59.250 +03:00 [DBG] Client validation success
2019-08-20 12:00:59.251 +03:00 [DBG] Start token request validation
2019-08-20 12:00:59.251 +03:00 [DBG] Start validation of authorization code token request
2019-08-20 12:00:59.252 +03:00 [DBG] Validation of authorization code token request success
2019-08-20 12:00:59.254 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"267a6180824431332718b09a5c1937ea61f8c38dc0a5754eef65c0f2f45be293","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"mvc","client_secret":"***REDACTED***","code":"267a6180824431332718b09a5c1937ea61f8c38dc0a5754eef65c0f2f45be293","grant_type":"authorization_code","redirect_uri":"http://localhost:5002/home/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-08-20 12:00:59.276 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:00:59.277 +03:00 [DBG] Getting claims for access token for client: mvc
2019-08-20 12:00:59.277 +03:00 [DBG] Getting claims for access token for subject: 1
2019-08-20 12:00:59.282 +03:00 [DBG] Creating refresh token
2019-08-20 12:00:59.283 +03:00 [DBG] Setting an absolute lifetime: 2592000
2019-08-20 12:00:59.283 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:00:59.284 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 12:00:59.285 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 12:00:59.290 +03:00 [DBG] Token request success.
2019-08-20 12:00:59.295 +03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-08-20 12:00:59.296 +03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-08-20 12:00:59.297 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-08-20 12:00:59.298 +03:00 [DBG] Start userinfo request
2019-08-20 12:00:59.298 +03:00 [DBG] Bearer token found in header
2019-08-20 12:00:59.302 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:00:59.303 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:00:59.304 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-08-20 12:00:59.305 +03:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1566291659,"exp":1566291719,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","afcpayroll"],"client_id":"mvc","sub":"1","auth_time":1566291655,"idp":"local","name":"alice","email":"alice@email.com","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-08-20 12:00:59.311 +03:00 [DBG] Creating userinfo response
2019-08-20 12:00:59.312 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 12:00:59.312 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 12:00:59.313 +03:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 12:00:59.313 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 12:00:59.314 +03:00 [INF] Profile service returned the following claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 12:00:59.315 +03:00 [DBG] End userinfo request
2019-08-20 12:00:59.380 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-08-20 12:00:59.382 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-08-20 12:00:59.384 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-08-20 12:00:59.385 +03:00 [DBG] Start authorize request
2019-08-20 12:00:59.386 +03:00 [DBG] User in authorize request: 1
2019-08-20 12:00:59.386 +03:00 [DBG] Start authorize request protocol validation
2019-08-20 12:00:59.387 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:00:59.387 +03:00 [DBG] Checking for PKCE parameters
2019-08-20 12:00:59.388 +03:00 [DBG] No PKCE used.
2019-08-20 12:00:59.388 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-20 12:00:59.389 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/home/signin-oidc","AllowedRedirectUris":["http://localhost:5002/home/signin-oidc"],"SubjectId":"1","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9MznUpY5L7aC76PvZzMGz9qDDhc76OwG-gkfdsmgrMXv9wFDy-3OtaFgS1OvyUA6krieIjhcs54NXAYHsxtLN_ax74i7nlv2Bib8sYEMZLFx96lMxPWuKTa8E1RguWkPpiZk5619oyACWkpfrzYGFD_sRd6zoS5fqdGIC3YQEASaZzv4VI_bSWR0znS18m0pF6j3LRJ-5_PVcBjfnO97_Gh6KE--cZmg0pfedsQNBQNTTsBRceHdA5x9ogA1A8SZc0AAqZvOWDx6QGlPwD9esCQXGXeyra9IBzBxyNRyfr6r5mJ_3yt9sEYsfhq5-v7gRE","UiLocales":null,"Nonce":"637018884593499042.ZTI4ZTQ0MjUtMTBhNC00ZTYxLWI0YWItOTljM2M0MDYxYmJiYWYxYzhmNjYtYzA2Ni00NGEwLThlMjQtNTExMThiYjY0ZGVi","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"8a7f11d362fe2b6d0a970781023d5f73","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/home/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637018884593499042.ZTI4ZTQ0MjUtMTBhNC00ZTYxLWI0YWItOTljM2M0MDYxYmJiYWYxYzhmNjYtYzA2Ni00NGEwLThlMjQtNTExMThiYjY0ZGVi","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9MznUpY5L7aC76PvZzMGz9qDDhc76OwG-gkfdsmgrMXv9wFDy-3OtaFgS1OvyUA6krieIjhcs54NXAYHsxtLN_ax74i7nlv2Bib8sYEMZLFx96lMxPWuKTa8E1RguWkPpiZk5619oyACWkpfrzYGFD_sRd6zoS5fqdGIC3YQEASaZzv4VI_bSWR0znS18m0pF6j3LRJ-5_PVcBjfnO97_Gh6KE--cZmg0pfedsQNBQNTTsBRceHdA5x9ogA1A8SZc0AAqZvOWDx6QGlPwD9esCQXGXeyra9IBzBxyNRyfr6r5mJ_3yt9sEYsfhq5-v7gRE","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-20 12:00:59.402 +03:00 [DBG] Client is configured to not require consent, no consent is required
2019-08-20 12:00:59.402 +03:00 [DBG] Creating Hybrid Flow response.
2019-08-20 12:00:59.403 +03:00 [DBG] Creating Implicit Flow response.
2019-08-20 12:00:59.403 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 12:00:59.404 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 12:00:59.409 +03:00 [DBG] Authorize endpoint response
{"SubjectId":"1","ClientId":"mvc","RedirectUri":"http://localhost:5002/home/signin-oidc","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9MznUpY5L7aC76PvZzMGz9qDDhc76OwG-gkfdsmgrMXv9wFDy-3OtaFgS1OvyUA6krieIjhcs54NXAYHsxtLN_ax74i7nlv2Bib8sYEMZLFx96lMxPWuKTa8E1RguWkPpiZk5619oyACWkpfrzYGFD_sRd6zoS5fqdGIC3YQEASaZzv4VI_bSWR0znS18m0pF6j3LRJ-5_PVcBjfnO97_Gh6KE--cZmg0pfedsQNBQNTTsBRceHdA5x9ogA1A8SZc0AAqZvOWDx6QGlPwD9esCQXGXeyra9IBzBxyNRyfr6r5mJ_3yt9sEYsfhq5-v7gRE","Scope":"openid profile afcpayroll offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-08-20 12:00:59.714 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-20 12:00:59.716 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-20 12:00:59.720 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-20 12:00:59.720 +03:00 [DBG] Start token request.
2019-08-20 12:00:59.721 +03:00 [DBG] Start client validation
2019-08-20 12:00:59.722 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-20 12:00:59.722 +03:00 [DBG] Start parsing for secret in post body
2019-08-20 12:00:59.722 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-20 12:00:59.723 +03:00 [DBG] Secret id found: mvc
2019-08-20 12:00:59.723 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:00:59.724 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-20 12:00:59.724 +03:00 [DBG] Client validation success
2019-08-20 12:00:59.725 +03:00 [DBG] Start token request validation
2019-08-20 12:00:59.726 +03:00 [DBG] Start validation of authorization code token request
2019-08-20 12:00:59.726 +03:00 [DBG] Validation of authorization code token request success
2019-08-20 12:00:59.727 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"c8b5179f15ab9f1669ee205e37708a5731f9f9c28788af6e618ab70f97711917","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"mvc","client_secret":"***REDACTED***","code":"c8b5179f15ab9f1669ee205e37708a5731f9f9c28788af6e618ab70f97711917","grant_type":"authorization_code","redirect_uri":"http://localhost:5002/home/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-08-20 12:00:59.731 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:00:59.732 +03:00 [DBG] Getting claims for access token for client: mvc
2019-08-20 12:00:59.732 +03:00 [DBG] Getting claims for access token for subject: 1
2019-08-20 12:00:59.737 +03:00 [DBG] Creating refresh token
2019-08-20 12:00:59.737 +03:00 [DBG] Setting an absolute lifetime: 2592000
2019-08-20 12:00:59.738 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:00:59.739 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 12:00:59.739 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 12:00:59.744 +03:00 [DBG] Token request success.
2019-08-20 12:00:59.747 +03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-08-20 12:00:59.750 +03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-08-20 12:00:59.752 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-08-20 12:00:59.752 +03:00 [DBG] Start userinfo request
2019-08-20 12:00:59.753 +03:00 [DBG] Bearer token found in header
2019-08-20 12:00:59.756 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:00:59.759 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:00:59.760 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-08-20 12:00:59.761 +03:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1566291659,"exp":1566291719,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","afcpayroll"],"client_id":"mvc","sub":"1","auth_time":1566291655,"idp":"local","name":"alice","email":"alice@email.com","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-08-20 12:00:59.766 +03:00 [DBG] Creating userinfo response
2019-08-20 12:00:59.767 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 12:00:59.767 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 12:00:59.768 +03:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 12:00:59.769 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 12:00:59.769 +03:00 [INF] Profile service returned the following claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 12:00:59.770 +03:00 [DBG] End userinfo request
2019-08-20 12:00:59.820 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-08-20 12:00:59.821 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-08-20 12:00:59.822 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-08-20 12:00:59.823 +03:00 [DBG] Start authorize request
2019-08-20 12:00:59.823 +03:00 [DBG] User in authorize request: 1
2019-08-20 12:00:59.824 +03:00 [DBG] Start authorize request protocol validation
2019-08-20 12:00:59.824 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:00:59.825 +03:00 [DBG] Checking for PKCE parameters
2019-08-20 12:00:59.825 +03:00 [DBG] No PKCE used.
2019-08-20 12:00:59.826 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-20 12:00:59.826 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/home/signin-oidc","AllowedRedirectUris":["http://localhost:5002/home/signin-oidc"],"SubjectId":"1","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9NftXKnG7jmeu3IDNhb1sRtkWphAtaEO7EvvHb5OBZ4-1pfVzEQKoN2kODMl6kFXMI2PDPJA1Ez7L_9qDSrGa0HWqKRJY-b5L99L2qs0fbDL-YsUryI0WkRbyPQh_zouJnNEqPEi1eUrBGC56BVlDABluNmhjIf1pac21GXcuzF60pVZuqi7ahUY7URyCTYfC3T5i5CyyfJvmJfI5atPg2HSPa2wQbFPUuge0hTQOOTGVx3ulGEwe1WI3HdoQ7LaSggvhSOUseSzRxcQ0jUijA6ohYYHdQo04ZvNNK_Z5cbwr9ow_LVWWig-z2f8FeL378","UiLocales":null,"Nonce":"637018884597993645.M2UwYjVhZDctYmVhMi00MGUxLWExOTctZDZiYzBmYTY2ZDI2YTM5YmMxMWYtZDFkNi00NDAyLTg3NzUtMWIyMGZiNDhkODJk","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"8a7f11d362fe2b6d0a970781023d5f73","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/home/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637018884597993645.M2UwYjVhZDctYmVhMi00MGUxLWExOTctZDZiYzBmYTY2ZDI2YTM5YmMxMWYtZDFkNi00NDAyLTg3NzUtMWIyMGZiNDhkODJk","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9NftXKnG7jmeu3IDNhb1sRtkWphAtaEO7EvvHb5OBZ4-1pfVzEQKoN2kODMl6kFXMI2PDPJA1Ez7L_9qDSrGa0HWqKRJY-b5L99L2qs0fbDL-YsUryI0WkRbyPQh_zouJnNEqPEi1eUrBGC56BVlDABluNmhjIf1pac21GXcuzF60pVZuqi7ahUY7URyCTYfC3T5i5CyyfJvmJfI5atPg2HSPa2wQbFPUuge0hTQOOTGVx3ulGEwe1WI3HdoQ7LaSggvhSOUseSzRxcQ0jUijA6ohYYHdQo04ZvNNK_Z5cbwr9ow_LVWWig-z2f8FeL378","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-20 12:00:59.839 +03:00 [DBG] Client is configured to not require consent, no consent is required
2019-08-20 12:00:59.839 +03:00 [DBG] Creating Hybrid Flow response.
2019-08-20 12:00:59.840 +03:00 [DBG] Creating Implicit Flow response.
2019-08-20 12:00:59.841 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 12:00:59.841 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 12:00:59.846 +03:00 [DBG] Authorize endpoint response
{"SubjectId":"1","ClientId":"mvc","RedirectUri":"http://localhost:5002/home/signin-oidc","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9NftXKnG7jmeu3IDNhb1sRtkWphAtaEO7EvvHb5OBZ4-1pfVzEQKoN2kODMl6kFXMI2PDPJA1Ez7L_9qDSrGa0HWqKRJY-b5L99L2qs0fbDL-YsUryI0WkRbyPQh_zouJnNEqPEi1eUrBGC56BVlDABluNmhjIf1pac21GXcuzF60pVZuqi7ahUY7URyCTYfC3T5i5CyyfJvmJfI5atPg2HSPa2wQbFPUuge0hTQOOTGVx3ulGEwe1WI3HdoQ7LaSggvhSOUseSzRxcQ0jUijA6ohYYHdQo04ZvNNK_Z5cbwr9ow_LVWWig-z2f8FeL378","Scope":"openid profile afcpayroll offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-08-20 12:01:00.098 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-20 12:01:00.099 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-20 12:01:00.101 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-20 12:01:00.102 +03:00 [DBG] Start token request.
2019-08-20 12:01:00.103 +03:00 [DBG] Start client validation
2019-08-20 12:01:00.103 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-20 12:01:00.103 +03:00 [DBG] Start parsing for secret in post body
2019-08-20 12:01:00.105 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-20 12:01:00.105 +03:00 [DBG] Secret id found: mvc
2019-08-20 12:01:00.106 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:01:00.107 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-20 12:01:00.108 +03:00 [DBG] Client validation success
2019-08-20 12:01:00.109 +03:00 [DBG] Start token request validation
2019-08-20 12:01:00.109 +03:00 [DBG] Start validation of authorization code token request
2019-08-20 12:01:00.110 +03:00 [DBG] Validation of authorization code token request success
2019-08-20 12:01:00.110 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"45558b3abdbe9fbf512d531eafd17b4e6f9af121cbfefe8450ee9bd8fa3b5045","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"mvc","client_secret":"***REDACTED***","code":"45558b3abdbe9fbf512d531eafd17b4e6f9af121cbfefe8450ee9bd8fa3b5045","grant_type":"authorization_code","redirect_uri":"http://localhost:5002/home/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-08-20 12:01:00.115 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:01:00.115 +03:00 [DBG] Getting claims for access token for client: mvc
2019-08-20 12:01:00.116 +03:00 [DBG] Getting claims for access token for subject: 1
2019-08-20 12:01:00.123 +03:00 [DBG] Creating refresh token
2019-08-20 12:01:00.124 +03:00 [DBG] Setting an absolute lifetime: 2592000
2019-08-20 12:01:00.124 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:01:00.125 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 12:01:00.126 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 12:01:00.130 +03:00 [DBG] Token request success.
2019-08-20 12:01:00.135 +03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-08-20 12:01:00.136 +03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-08-20 12:01:00.137 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-08-20 12:01:00.137 +03:00 [DBG] Start userinfo request
2019-08-20 12:01:00.138 +03:00 [DBG] Bearer token found in header
2019-08-20 12:01:00.141 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:01:00.141 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:01:00.142 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-08-20 12:01:00.143 +03:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1566291660,"exp":1566291720,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","afcpayroll"],"client_id":"mvc","sub":"1","auth_time":1566291655,"idp":"local","name":"alice","email":"alice@email.com","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-08-20 12:01:00.147 +03:00 [DBG] Creating userinfo response
2019-08-20 12:01:00.147 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 12:01:00.148 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 12:01:00.149 +03:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 12:01:00.149 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 12:01:00.150 +03:00 [INF] Profile service returned the following claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 12:01:00.150 +03:00 [DBG] End userinfo request
2019-08-20 12:01:00.214 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-08-20 12:01:00.216 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-08-20 12:01:00.217 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-08-20 12:01:00.218 +03:00 [DBG] Start authorize request
2019-08-20 12:01:00.220 +03:00 [DBG] User in authorize request: 1
2019-08-20 12:01:00.221 +03:00 [DBG] Start authorize request protocol validation
2019-08-20 12:01:00.221 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:01:00.222 +03:00 [DBG] Checking for PKCE parameters
2019-08-20 12:01:00.223 +03:00 [DBG] No PKCE used.
2019-08-20 12:01:00.223 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-20 12:01:00.224 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/home/signin-oidc","AllowedRedirectUris":["http://localhost:5002/home/signin-oidc"],"SubjectId":"1","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9PSFXzKsdXj_fUL3hp3wu1WFztQPUPWDpBnfewI-NVg1_CNAO4YGikKQsupRQVLB_ZY7nrAmfyaq7xo_Peixygw5xOQYtvRmu-mijtl-_SMdrMZgdn_Rdf51IbVOBIdEbiVprt2-H74YRx3lI39teuhYpcmE4ZzNN9Q0wzjUNNtdjqazAWaMSrazFH5A3WzIxaIgf21TfMw2ixcLrfNLzEF6c8okTt4pSdcvXCVZKgB7CFIpJhtbCZSyx2neMxwJGSljl17qXsqQCg1jA9m0G5LwCL9Fb-id3M4zPCZQgc6T4xkuWhqWbZqsuT7tQ9w9hI","UiLocales":null,"Nonce":"637018884601933998.YWQzMDQ4ZmYtYmI0ZC00MjEwLTkyY2MtMjMzNzdhMjhlNzcwYjI0OTBkN2MtMTViNC00NDIzLWI0ODgtNzQxZTQwMTUyZDYx","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"8a7f11d362fe2b6d0a970781023d5f73","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/home/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637018884601933998.YWQzMDQ4ZmYtYmI0ZC00MjEwLTkyY2MtMjMzNzdhMjhlNzcwYjI0OTBkN2MtMTViNC00NDIzLWI0ODgtNzQxZTQwMTUyZDYx","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9PSFXzKsdXj_fUL3hp3wu1WFztQPUPWDpBnfewI-NVg1_CNAO4YGikKQsupRQVLB_ZY7nrAmfyaq7xo_Peixygw5xOQYtvRmu-mijtl-_SMdrMZgdn_Rdf51IbVOBIdEbiVprt2-H74YRx3lI39teuhYpcmE4ZzNN9Q0wzjUNNtdjqazAWaMSrazFH5A3WzIxaIgf21TfMw2ixcLrfNLzEF6c8okTt4pSdcvXCVZKgB7CFIpJhtbCZSyx2neMxwJGSljl17qXsqQCg1jA9m0G5LwCL9Fb-id3M4zPCZQgc6T4xkuWhqWbZqsuT7tQ9w9hI","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-20 12:01:00.232 +03:00 [DBG] Client is configured to not require consent, no consent is required
2019-08-20 12:01:00.235 +03:00 [DBG] Creating Hybrid Flow response.
2019-08-20 12:01:00.236 +03:00 [DBG] Creating Implicit Flow response.
2019-08-20 12:01:00.236 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 12:01:00.237 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 12:01:00.244 +03:00 [DBG] Authorize endpoint response
{"SubjectId":"1","ClientId":"mvc","RedirectUri":"http://localhost:5002/home/signin-oidc","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9PSFXzKsdXj_fUL3hp3wu1WFztQPUPWDpBnfewI-NVg1_CNAO4YGikKQsupRQVLB_ZY7nrAmfyaq7xo_Peixygw5xOQYtvRmu-mijtl-_SMdrMZgdn_Rdf51IbVOBIdEbiVprt2-H74YRx3lI39teuhYpcmE4ZzNN9Q0wzjUNNtdjqazAWaMSrazFH5A3WzIxaIgf21TfMw2ixcLrfNLzEF6c8okTt4pSdcvXCVZKgB7CFIpJhtbCZSyx2neMxwJGSljl17qXsqQCg1jA9m0G5LwCL9Fb-id3M4zPCZQgc6T4xkuWhqWbZqsuT7tQ9w9hI","Scope":"openid profile afcpayroll offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-08-20 12:01:00.538 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-20 12:01:00.541 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-20 12:01:00.543 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-20 12:01:00.543 +03:00 [DBG] Start token request.
2019-08-20 12:01:00.544 +03:00 [DBG] Start client validation
2019-08-20 12:01:00.544 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-20 12:01:00.545 +03:00 [DBG] Start parsing for secret in post body
2019-08-20 12:01:00.545 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-20 12:01:00.546 +03:00 [DBG] Secret id found: mvc
2019-08-20 12:01:00.546 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:01:00.547 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-20 12:01:00.548 +03:00 [DBG] Client validation success
2019-08-20 12:01:00.549 +03:00 [DBG] Start token request validation
2019-08-20 12:01:00.550 +03:00 [DBG] Start validation of authorization code token request
2019-08-20 12:01:00.550 +03:00 [DBG] Validation of authorization code token request success
2019-08-20 12:01:00.551 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"031f111035f3551181ff371a91bc16228c2692427143b15233d34df007b29a64","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"mvc","client_secret":"***REDACTED***","code":"031f111035f3551181ff371a91bc16228c2692427143b15233d34df007b29a64","grant_type":"authorization_code","redirect_uri":"http://localhost:5002/home/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-08-20 12:01:00.555 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:01:00.556 +03:00 [DBG] Getting claims for access token for client: mvc
2019-08-20 12:01:00.556 +03:00 [DBG] Getting claims for access token for subject: 1
2019-08-20 12:01:00.562 +03:00 [DBG] Creating refresh token
2019-08-20 12:01:00.562 +03:00 [DBG] Setting an absolute lifetime: 2592000
2019-08-20 12:01:00.563 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:01:00.564 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 12:01:00.565 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 12:01:00.569 +03:00 [DBG] Token request success.
2019-08-20 12:01:00.573 +03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-08-20 12:01:00.575 +03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-08-20 12:01:00.576 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-08-20 12:01:00.576 +03:00 [DBG] Start userinfo request
2019-08-20 12:01:00.577 +03:00 [DBG] Bearer token found in header
2019-08-20 12:01:00.579 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:01:00.580 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:01:00.581 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-08-20 12:01:00.581 +03:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1566291660,"exp":1566291720,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","afcpayroll"],"client_id":"mvc","sub":"1","auth_time":1566291655,"idp":"local","name":"alice","email":"alice@email.com","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-08-20 12:01:00.592 +03:00 [DBG] Creating userinfo response
2019-08-20 12:01:00.593 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 12:01:00.593 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 12:01:00.594 +03:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 12:01:00.594 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 12:01:00.595 +03:00 [INF] Profile service returned the following claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 12:01:00.595 +03:00 [DBG] End userinfo request
2019-08-20 12:01:00.647 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-08-20 12:01:00.649 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-08-20 12:01:00.650 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-08-20 12:01:00.650 +03:00 [DBG] Start authorize request
2019-08-20 12:01:00.651 +03:00 [DBG] User in authorize request: 1
2019-08-20 12:01:00.653 +03:00 [DBG] Start authorize request protocol validation
2019-08-20 12:01:00.654 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:01:00.655 +03:00 [DBG] Checking for PKCE parameters
2019-08-20 12:01:00.655 +03:00 [DBG] No PKCE used.
2019-08-20 12:01:00.656 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-20 12:01:00.656 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/home/signin-oidc","AllowedRedirectUris":["http://localhost:5002/home/signin-oidc"],"SubjectId":"1","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9MbNIAKkd4S6ufLbsuB-AWXVsvQUwhaN83CW0B6mEyTF4VSzyHvgxXo9lagCNvL_g_qJhxoQFjImB5PvuuA36lMpniwvRmWtq_2AEjXezZPzsR_lCODi4pXp2KahpNLc6q4ZWJlVxUklpsVGmAZY92feTB2eoQzhMaaNy89PhCl1s5on8XDjNZINMPZ4t1z18OdOvCO_hxVW63z0FLc67IZR2zC4GvSA5KjFxcZEaEWbR3IYFjhMqBcoo2qXAgDGNkyTgya6eAwzqQ8aFv8y89kHJOtg79kN5Awnxolu5OGvxidwVazHbeNtIbwVyoBsf0","UiLocales":null,"Nonce":"637018884606279465.MTMxM2YzYjYtNWFjYS00MzA4LWIyMjctZjNjZTcwOWVkOWY4Yjc2YWY0ZWMtNDZlOC00NTMzLThkMjYtM2NiNzU1Nzg1ZjAw","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"8a7f11d362fe2b6d0a970781023d5f73","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/home/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637018884606279465.MTMxM2YzYjYtNWFjYS00MzA4LWIyMjctZjNjZTcwOWVkOWY4Yjc2YWY0ZWMtNDZlOC00NTMzLThkMjYtM2NiNzU1Nzg1ZjAw","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9MbNIAKkd4S6ufLbsuB-AWXVsvQUwhaN83CW0B6mEyTF4VSzyHvgxXo9lagCNvL_g_qJhxoQFjImB5PvuuA36lMpniwvRmWtq_2AEjXezZPzsR_lCODi4pXp2KahpNLc6q4ZWJlVxUklpsVGmAZY92feTB2eoQzhMaaNy89PhCl1s5on8XDjNZINMPZ4t1z18OdOvCO_hxVW63z0FLc67IZR2zC4GvSA5KjFxcZEaEWbR3IYFjhMqBcoo2qXAgDGNkyTgya6eAwzqQ8aFv8y89kHJOtg79kN5Awnxolu5OGvxidwVazHbeNtIbwVyoBsf0","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-20 12:01:00.665 +03:00 [DBG] Client is configured to not require consent, no consent is required
2019-08-20 12:01:00.667 +03:00 [DBG] Creating Hybrid Flow response.
2019-08-20 12:01:00.668 +03:00 [DBG] Creating Implicit Flow response.
2019-08-20 12:01:00.669 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 12:01:00.670 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 12:01:00.674 +03:00 [DBG] Authorize endpoint response
{"SubjectId":"1","ClientId":"mvc","RedirectUri":"http://localhost:5002/home/signin-oidc","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9MbNIAKkd4S6ufLbsuB-AWXVsvQUwhaN83CW0B6mEyTF4VSzyHvgxXo9lagCNvL_g_qJhxoQFjImB5PvuuA36lMpniwvRmWtq_2AEjXezZPzsR_lCODi4pXp2KahpNLc6q4ZWJlVxUklpsVGmAZY92feTB2eoQzhMaaNy89PhCl1s5on8XDjNZINMPZ4t1z18OdOvCO_hxVW63z0FLc67IZR2zC4GvSA5KjFxcZEaEWbR3IYFjhMqBcoo2qXAgDGNkyTgya6eAwzqQ8aFv8y89kHJOtg79kN5Awnxolu5OGvxidwVazHbeNtIbwVyoBsf0","Scope":"openid profile afcpayroll offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-08-20 12:01:00.919 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-20 12:01:00.921 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-20 12:01:00.922 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-20 12:01:00.923 +03:00 [DBG] Start token request.
2019-08-20 12:01:00.924 +03:00 [DBG] Start client validation
2019-08-20 12:01:00.924 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-20 12:01:00.925 +03:00 [DBG] Start parsing for secret in post body
2019-08-20 12:01:00.925 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-20 12:01:00.926 +03:00 [DBG] Secret id found: mvc
2019-08-20 12:01:00.926 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:01:00.927 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-20 12:01:00.927 +03:00 [DBG] Client validation success
2019-08-20 12:01:00.928 +03:00 [DBG] Start token request validation
2019-08-20 12:01:00.928 +03:00 [DBG] Start validation of authorization code token request
2019-08-20 12:01:00.929 +03:00 [DBG] Validation of authorization code token request success
2019-08-20 12:01:00.930 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"d51d4724ee6d7be23b8c587afbdc90449f4fca6dfcd3f6d5d1cf3e9ae4df1c94","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"mvc","client_secret":"***REDACTED***","code":"d51d4724ee6d7be23b8c587afbdc90449f4fca6dfcd3f6d5d1cf3e9ae4df1c94","grant_type":"authorization_code","redirect_uri":"http://localhost:5002/home/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-08-20 12:01:00.936 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:01:00.936 +03:00 [DBG] Getting claims for access token for client: mvc
2019-08-20 12:01:00.937 +03:00 [DBG] Getting claims for access token for subject: 1
2019-08-20 12:01:00.942 +03:00 [DBG] Creating refresh token
2019-08-20 12:01:00.942 +03:00 [DBG] Setting an absolute lifetime: 2592000
2019-08-20 12:01:00.943 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:01:00.943 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 12:01:00.944 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 12:01:00.949 +03:00 [DBG] Token request success.
2019-08-20 12:01:00.953 +03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-08-20 12:01:00.954 +03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-08-20 12:01:00.955 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-08-20 12:01:00.955 +03:00 [DBG] Start userinfo request
2019-08-20 12:01:00.956 +03:00 [DBG] Bearer token found in header
2019-08-20 12:01:00.958 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:01:00.959 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:01:00.961 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-08-20 12:01:00.962 +03:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1566291660,"exp":1566291720,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","afcpayroll"],"client_id":"mvc","sub":"1","auth_time":1566291655,"idp":"local","name":"alice","email":"alice@email.com","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-08-20 12:01:00.968 +03:00 [DBG] Creating userinfo response
2019-08-20 12:01:00.968 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 12:01:00.968 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 12:01:00.969 +03:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 12:01:00.969 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 12:01:00.970 +03:00 [INF] Profile service returned the following claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 12:01:00.971 +03:00 [DBG] End userinfo request
2019-08-20 12:01:01.023 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-08-20 12:01:01.026 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-08-20 12:01:01.027 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-08-20 12:01:01.027 +03:00 [DBG] Start authorize request
2019-08-20 12:01:01.028 +03:00 [DBG] User in authorize request: 1
2019-08-20 12:01:01.029 +03:00 [DBG] Start authorize request protocol validation
2019-08-20 12:01:01.030 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:01:01.031 +03:00 [DBG] Checking for PKCE parameters
2019-08-20 12:01:01.031 +03:00 [DBG] No PKCE used.
2019-08-20 12:01:01.032 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-20 12:01:01.032 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/home/signin-oidc","AllowedRedirectUris":["http://localhost:5002/home/signin-oidc"],"SubjectId":"1","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9OEWs6WaEZ0l5L67vjIV5xj7gAhIvkaDexmBKG1QvXVoxkfxBsQvzu2JHzl55WMC7chbamozbx6eVdPBTCLMtViytyNVcyZ_UbT0DlKKuSLFWv-i68wUWMgJqcMUlS4EoVDG5hrcRGfLdbZcyXrECSG0agwFgVgiNZ63nokVIXJCPn4MKTd5AKLW1xAPA4knLG6tcR_5oaZhUU0YuJdiwMRx7sSTGUibIPylKYAITuU1WKxoqMAO9G2cS6PlOhqFJzoM0tjIJatx-fAQtZnUKE26L4jg8mGzwQfmPTZ_TH3fIRjxlvM1Qh-pwsjBj0aV-M","UiLocales":null,"Nonce":"637018884610029992.NzJmMWNiNTItN2U3MC00OGVkLTg2NzUtZTY0NzU1NjkzZWZjNzgwMWI2MDEtNTcwZi00MGI1LTlkNDItNWMxMDQ4ZGYyZjk0","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"8a7f11d362fe2b6d0a970781023d5f73","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/home/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637018884610029992.NzJmMWNiNTItN2U3MC00OGVkLTg2NzUtZTY0NzU1NjkzZWZjNzgwMWI2MDEtNTcwZi00MGI1LTlkNDItNWMxMDQ4ZGYyZjk0","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9OEWs6WaEZ0l5L67vjIV5xj7gAhIvkaDexmBKG1QvXVoxkfxBsQvzu2JHzl55WMC7chbamozbx6eVdPBTCLMtViytyNVcyZ_UbT0DlKKuSLFWv-i68wUWMgJqcMUlS4EoVDG5hrcRGfLdbZcyXrECSG0agwFgVgiNZ63nokVIXJCPn4MKTd5AKLW1xAPA4knLG6tcR_5oaZhUU0YuJdiwMRx7sSTGUibIPylKYAITuU1WKxoqMAO9G2cS6PlOhqFJzoM0tjIJatx-fAQtZnUKE26L4jg8mGzwQfmPTZ_TH3fIRjxlvM1Qh-pwsjBj0aV-M","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-20 12:01:01.040 +03:00 [DBG] Client is configured to not require consent, no consent is required
2019-08-20 12:01:01.040 +03:00 [DBG] Creating Hybrid Flow response.
2019-08-20 12:01:01.041 +03:00 [DBG] Creating Implicit Flow response.
2019-08-20 12:01:01.041 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 12:01:01.042 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 12:01:01.046 +03:00 [DBG] Authorize endpoint response
{"SubjectId":"1","ClientId":"mvc","RedirectUri":"http://localhost:5002/home/signin-oidc","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9OEWs6WaEZ0l5L67vjIV5xj7gAhIvkaDexmBKG1QvXVoxkfxBsQvzu2JHzl55WMC7chbamozbx6eVdPBTCLMtViytyNVcyZ_UbT0DlKKuSLFWv-i68wUWMgJqcMUlS4EoVDG5hrcRGfLdbZcyXrECSG0agwFgVgiNZ63nokVIXJCPn4MKTd5AKLW1xAPA4knLG6tcR_5oaZhUU0YuJdiwMRx7sSTGUibIPylKYAITuU1WKxoqMAO9G2cS6PlOhqFJzoM0tjIJatx-fAQtZnUKE26L4jg8mGzwQfmPTZ_TH3fIRjxlvM1Qh-pwsjBj0aV-M","Scope":"openid profile afcpayroll offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-08-20 12:01:01.280 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-20 12:01:01.282 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-20 12:01:01.283 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-20 12:01:01.288 +03:00 [DBG] Start token request.
2019-08-20 12:01:01.291 +03:00 [DBG] Start client validation
2019-08-20 12:01:01.294 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-20 12:01:01.295 +03:00 [DBG] Start parsing for secret in post body
2019-08-20 12:01:01.296 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-20 12:01:01.296 +03:00 [DBG] Secret id found: mvc
2019-08-20 12:01:01.297 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:01:01.298 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-20 12:01:01.299 +03:00 [DBG] Client validation success
2019-08-20 12:01:01.299 +03:00 [DBG] Start token request validation
2019-08-20 12:01:01.301 +03:00 [DBG] Start validation of authorization code token request
2019-08-20 12:01:01.302 +03:00 [DBG] Validation of authorization code token request success
2019-08-20 12:01:01.309 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"5e1d9c7724a3e9bade044f30a42dbf158add71920274cc58f2195080662d39bc","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"mvc","client_secret":"***REDACTED***","code":"5e1d9c7724a3e9bade044f30a42dbf158add71920274cc58f2195080662d39bc","grant_type":"authorization_code","redirect_uri":"http://localhost:5002/home/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-08-20 12:01:01.319 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:01:01.320 +03:00 [DBG] Getting claims for access token for client: mvc
2019-08-20 12:01:01.320 +03:00 [DBG] Getting claims for access token for subject: 1
2019-08-20 12:01:01.325 +03:00 [DBG] Creating refresh token
2019-08-20 12:01:01.326 +03:00 [DBG] Setting an absolute lifetime: 2592000
2019-08-20 12:01:01.327 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:01:01.327 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 12:01:01.328 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 12:01:01.332 +03:00 [DBG] Token request success.
2019-08-20 12:01:01.340 +03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-08-20 12:01:01.341 +03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-08-20 12:01:01.342 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-08-20 12:01:01.343 +03:00 [DBG] Start userinfo request
2019-08-20 12:01:01.343 +03:00 [DBG] Bearer token found in header
2019-08-20 12:01:01.346 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:01:01.347 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:01:01.347 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-08-20 12:01:01.348 +03:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1566291661,"exp":1566291721,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","afcpayroll"],"client_id":"mvc","sub":"1","auth_time":1566291655,"idp":"local","name":"alice","email":"alice@email.com","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-08-20 12:01:01.360 +03:00 [DBG] Creating userinfo response
2019-08-20 12:01:01.361 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 12:01:01.361 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 12:01:01.362 +03:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 12:01:01.362 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 12:01:01.363 +03:00 [INF] Profile service returned the following claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 12:01:01.363 +03:00 [DBG] End userinfo request
2019-08-20 12:01:01.422 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-08-20 12:01:01.423 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-08-20 12:01:01.424 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-08-20 12:01:01.424 +03:00 [DBG] Start authorize request
2019-08-20 12:01:01.425 +03:00 [DBG] User in authorize request: 1
2019-08-20 12:01:01.425 +03:00 [DBG] Start authorize request protocol validation
2019-08-20 12:01:01.425 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:01:01.426 +03:00 [DBG] Checking for PKCE parameters
2019-08-20 12:01:01.426 +03:00 [DBG] No PKCE used.
2019-08-20 12:01:01.427 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-20 12:01:01.427 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/home/signin-oidc","AllowedRedirectUris":["http://localhost:5002/home/signin-oidc"],"SubjectId":"1","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9O8zR5pS3E7GCIEoQKvcITKbmwUJ2-RMR6tHy2y5D1dxFdc3lLmkNhIcGRWnBlEitaSH7EuMKLPtcmrnI7iY47fza0sxi8kHXDhpYSgsyWXxtyYmMeMHgZ0VhMzsnhNiT7r_XvEfOv3rqQsNng3Fc9ZS0iOoHsAbr3CIUhDOye9dtVTCR9FZokkt4rxxKTnQQ2fCCwpFFb4PwtLfpi7iu_BhbD4_HR2X2F4e7SD__JJwWMUh82WOqvWv85xkSm-et9ImctrbkGJ3iJK_ZoQ_cT8_1z1fC_QPxVwWaQqxExlgZHBBpnL7ihy2gR6ILpAX70","UiLocales":null,"Nonce":"637018884614052560.YWU4NDExODEtMTg4MS00NTFhLWI5NTYtMDlhZjRjZmY0Y2NjMjc0MTBiYzQtZDk4OS00YzExLTg5Y2ItNTg0MDljMmVlNzY2","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"8a7f11d362fe2b6d0a970781023d5f73","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/home/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637018884614052560.YWU4NDExODEtMTg4MS00NTFhLWI5NTYtMDlhZjRjZmY0Y2NjMjc0MTBiYzQtZDk4OS00YzExLTg5Y2ItNTg0MDljMmVlNzY2","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9O8zR5pS3E7GCIEoQKvcITKbmwUJ2-RMR6tHy2y5D1dxFdc3lLmkNhIcGRWnBlEitaSH7EuMKLPtcmrnI7iY47fza0sxi8kHXDhpYSgsyWXxtyYmMeMHgZ0VhMzsnhNiT7r_XvEfOv3rqQsNng3Fc9ZS0iOoHsAbr3CIUhDOye9dtVTCR9FZokkt4rxxKTnQQ2fCCwpFFb4PwtLfpi7iu_BhbD4_HR2X2F4e7SD__JJwWMUh82WOqvWv85xkSm-et9ImctrbkGJ3iJK_ZoQ_cT8_1z1fC_QPxVwWaQqxExlgZHBBpnL7ihy2gR6ILpAX70","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-20 12:01:01.435 +03:00 [DBG] Client is configured to not require consent, no consent is required
2019-08-20 12:01:01.435 +03:00 [DBG] Creating Hybrid Flow response.
2019-08-20 12:01:01.436 +03:00 [DBG] Creating Implicit Flow response.
2019-08-20 12:01:01.436 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 12:01:01.437 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 12:01:01.441 +03:00 [DBG] Authorize endpoint response
{"SubjectId":"1","ClientId":"mvc","RedirectUri":"http://localhost:5002/home/signin-oidc","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9O8zR5pS3E7GCIEoQKvcITKbmwUJ2-RMR6tHy2y5D1dxFdc3lLmkNhIcGRWnBlEitaSH7EuMKLPtcmrnI7iY47fza0sxi8kHXDhpYSgsyWXxtyYmMeMHgZ0VhMzsnhNiT7r_XvEfOv3rqQsNng3Fc9ZS0iOoHsAbr3CIUhDOye9dtVTCR9FZokkt4rxxKTnQQ2fCCwpFFb4PwtLfpi7iu_BhbD4_HR2X2F4e7SD__JJwWMUh82WOqvWv85xkSm-et9ImctrbkGJ3iJK_ZoQ_cT8_1z1fC_QPxVwWaQqxExlgZHBBpnL7ihy2gR6ILpAX70","Scope":"openid profile afcpayroll offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-08-20 12:01:01.666 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-20 12:01:01.668 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-20 12:01:01.669 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-20 12:01:01.670 +03:00 [DBG] Start token request.
2019-08-20 12:01:01.670 +03:00 [DBG] Start client validation
2019-08-20 12:01:01.671 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-20 12:01:01.672 +03:00 [DBG] Start parsing for secret in post body
2019-08-20 12:01:01.672 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-20 12:01:01.673 +03:00 [DBG] Secret id found: mvc
2019-08-20 12:01:01.673 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:01:01.674 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-20 12:01:01.674 +03:00 [DBG] Client validation success
2019-08-20 12:01:01.675 +03:00 [DBG] Start token request validation
2019-08-20 12:01:01.675 +03:00 [DBG] Start validation of authorization code token request
2019-08-20 12:01:01.676 +03:00 [DBG] Validation of authorization code token request success
2019-08-20 12:01:01.676 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"4bdc97bdfd94705fc994ed6525976eea22753b013e3605fc6a13d018783c7e34","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"mvc","client_secret":"***REDACTED***","code":"4bdc97bdfd94705fc994ed6525976eea22753b013e3605fc6a13d018783c7e34","grant_type":"authorization_code","redirect_uri":"http://localhost:5002/home/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-08-20 12:01:01.681 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:01:01.682 +03:00 [DBG] Getting claims for access token for client: mvc
2019-08-20 12:01:01.682 +03:00 [DBG] Getting claims for access token for subject: 1
2019-08-20 12:01:01.689 +03:00 [DBG] Creating refresh token
2019-08-20 12:01:01.689 +03:00 [DBG] Setting an absolute lifetime: 2592000
2019-08-20 12:01:01.690 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:01:01.691 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 12:01:01.691 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 12:01:01.696 +03:00 [DBG] Token request success.
2019-08-20 12:01:01.700 +03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-08-20 12:01:01.701 +03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-08-20 12:01:01.701 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-08-20 12:01:01.702 +03:00 [DBG] Start userinfo request
2019-08-20 12:01:01.702 +03:00 [DBG] Bearer token found in header
2019-08-20 12:01:01.705 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:01:01.706 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:01:01.706 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-08-20 12:01:01.707 +03:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1566291661,"exp":1566291721,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","afcpayroll"],"client_id":"mvc","sub":"1","auth_time":1566291655,"idp":"local","name":"alice","email":"alice@email.com","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-08-20 12:01:01.711 +03:00 [DBG] Creating userinfo response
2019-08-20 12:01:01.711 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 12:01:01.712 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 12:01:01.712 +03:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 12:01:01.713 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 12:01:01.713 +03:00 [INF] Profile service returned the following claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 12:01:01.714 +03:00 [DBG] End userinfo request
2019-08-20 12:01:01.791 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-08-20 12:01:01.792 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-08-20 12:01:01.793 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-08-20 12:01:01.793 +03:00 [DBG] Start authorize request
2019-08-20 12:01:01.794 +03:00 [DBG] User in authorize request: 1
2019-08-20 12:01:01.794 +03:00 [DBG] Start authorize request protocol validation
2019-08-20 12:01:01.794 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:01:01.795 +03:00 [DBG] Checking for PKCE parameters
2019-08-20 12:01:01.795 +03:00 [DBG] No PKCE used.
2019-08-20 12:01:01.796 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-20 12:01:01.797 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/home/signin-oidc","AllowedRedirectUris":["http://localhost:5002/home/signin-oidc"],"SubjectId":"1","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9MikxbFlBsWbl2DaiAlGyZC-nIly42stqKUJxsLbzv_DyAASZJdU1buwYcJl9ruF1rF-pOdGlWcQeBSbuXgEKxEvGD7HX-s3yfdEUThKKoepz0nQjFMGJ2f0vv5SoLjoG6V-hi3PTeRpMXrE8oPfazHdG2yFTOF1NF6q6n-F00UK7Jg1Qc8mTABqt5OVcmxmVOpNq1ZrKiijV1vlClFDQFTl_aIWLL0Oj1MOs-LuBOqh6zaFP52l5UCen26yTNno5wV2GhjPmIeq_LqlrI7dNjmJ9Qf4X4HlxeOZ6mSFvr_aRiw4E7xjQfzI2YDbndnRh0","UiLocales":null,"Nonce":"637018884617642276.ZWRkNDA4YjYtMjlkMS00OTMyLWEwMDctNjEwNDYyMzQzMjIwNGI3NjMyMjAtODljMS00ZGRiLWJhNjAtNTc3MDhlNjY1NzRm","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"8a7f11d362fe2b6d0a970781023d5f73","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/home/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637018884617642276.ZWRkNDA4YjYtMjlkMS00OTMyLWEwMDctNjEwNDYyMzQzMjIwNGI3NjMyMjAtODljMS00ZGRiLWJhNjAtNTc3MDhlNjY1NzRm","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9MikxbFlBsWbl2DaiAlGyZC-nIly42stqKUJxsLbzv_DyAASZJdU1buwYcJl9ruF1rF-pOdGlWcQeBSbuXgEKxEvGD7HX-s3yfdEUThKKoepz0nQjFMGJ2f0vv5SoLjoG6V-hi3PTeRpMXrE8oPfazHdG2yFTOF1NF6q6n-F00UK7Jg1Qc8mTABqt5OVcmxmVOpNq1ZrKiijV1vlClFDQFTl_aIWLL0Oj1MOs-LuBOqh6zaFP52l5UCen26yTNno5wV2GhjPmIeq_LqlrI7dNjmJ9Qf4X4HlxeOZ6mSFvr_aRiw4E7xjQfzI2YDbndnRh0","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-20 12:01:01.803 +03:00 [DBG] Client is configured to not require consent, no consent is required
2019-08-20 12:01:01.804 +03:00 [DBG] Creating Hybrid Flow response.
2019-08-20 12:01:01.804 +03:00 [DBG] Creating Implicit Flow response.
2019-08-20 12:01:01.805 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 12:01:01.805 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 12:01:01.810 +03:00 [DBG] Authorize endpoint response
{"SubjectId":"1","ClientId":"mvc","RedirectUri":"http://localhost:5002/home/signin-oidc","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9MikxbFlBsWbl2DaiAlGyZC-nIly42stqKUJxsLbzv_DyAASZJdU1buwYcJl9ruF1rF-pOdGlWcQeBSbuXgEKxEvGD7HX-s3yfdEUThKKoepz0nQjFMGJ2f0vv5SoLjoG6V-hi3PTeRpMXrE8oPfazHdG2yFTOF1NF6q6n-F00UK7Jg1Qc8mTABqt5OVcmxmVOpNq1ZrKiijV1vlClFDQFTl_aIWLL0Oj1MOs-LuBOqh6zaFP52l5UCen26yTNno5wV2GhjPmIeq_LqlrI7dNjmJ9Qf4X4HlxeOZ6mSFvr_aRiw4E7xjQfzI2YDbndnRh0","Scope":"openid profile afcpayroll offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-08-20 12:01:02.081 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-20 12:01:02.082 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-20 12:01:02.083 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-20 12:01:02.084 +03:00 [DBG] Start token request.
2019-08-20 12:01:02.084 +03:00 [DBG] Start client validation
2019-08-20 12:01:02.085 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-20 12:01:02.086 +03:00 [DBG] Start parsing for secret in post body
2019-08-20 12:01:02.087 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-20 12:01:02.088 +03:00 [DBG] Secret id found: mvc
2019-08-20 12:01:02.089 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:01:02.089 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-20 12:01:02.090 +03:00 [DBG] Client validation success
2019-08-20 12:01:02.090 +03:00 [DBG] Start token request validation
2019-08-20 12:01:02.090 +03:00 [DBG] Start validation of authorization code token request
2019-08-20 12:01:02.091 +03:00 [DBG] Validation of authorization code token request success
2019-08-20 12:01:02.092 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"70f6bbf94cb7db7662fa68416be54fb9cfc5de135b90285d3e31749e5f60719d","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"mvc","client_secret":"***REDACTED***","code":"70f6bbf94cb7db7662fa68416be54fb9cfc5de135b90285d3e31749e5f60719d","grant_type":"authorization_code","redirect_uri":"http://localhost:5002/home/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-08-20 12:01:02.098 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:01:02.098 +03:00 [DBG] Getting claims for access token for client: mvc
2019-08-20 12:01:02.099 +03:00 [DBG] Getting claims for access token for subject: 1
2019-08-20 12:01:02.104 +03:00 [DBG] Creating refresh token
2019-08-20 12:01:02.104 +03:00 [DBG] Setting an absolute lifetime: 2592000
2019-08-20 12:01:02.105 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:01:02.106 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 12:01:02.106 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 12:01:02.110 +03:00 [DBG] Token request success.
2019-08-20 12:01:02.114 +03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-08-20 12:01:02.115 +03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-08-20 12:01:02.115 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-08-20 12:01:02.116 +03:00 [DBG] Start userinfo request
2019-08-20 12:01:02.116 +03:00 [DBG] Bearer token found in header
2019-08-20 12:01:02.119 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:01:02.120 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:01:02.120 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-08-20 12:01:02.121 +03:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1566291662,"exp":1566291722,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","afcpayroll"],"client_id":"mvc","sub":"1","auth_time":1566291655,"idp":"local","name":"alice","email":"alice@email.com","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-08-20 12:01:02.128 +03:00 [DBG] Creating userinfo response
2019-08-20 12:01:02.128 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 12:01:02.129 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 12:01:02.129 +03:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 12:01:02.130 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 12:01:02.130 +03:00 [INF] Profile service returned the following claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 12:01:02.131 +03:00 [DBG] End userinfo request
2019-08-20 12:01:02.194 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-08-20 12:01:02.195 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-08-20 12:01:02.196 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-08-20 12:01:02.197 +03:00 [DBG] Start authorize request
2019-08-20 12:01:02.197 +03:00 [DBG] User in authorize request: 1
2019-08-20 12:01:02.198 +03:00 [DBG] Start authorize request protocol validation
2019-08-20 12:01:02.198 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:01:02.199 +03:00 [DBG] Checking for PKCE parameters
2019-08-20 12:01:02.199 +03:00 [DBG] No PKCE used.
2019-08-20 12:01:02.202 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-20 12:01:02.204 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/home/signin-oidc","AllowedRedirectUris":["http://localhost:5002/home/signin-oidc"],"SubjectId":"1","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9NG5859K0nficBVebUomwWY33H0XFb2dofFNGfld0CzSzZtxg1sQS0aInXT8qJlb9cBq-tJ6aMCLFmTXm9sJBoNSy2ZJEfWhj9_d40138e_Vwhz30rLb1HQN8OqYnbrU1hOCOv1KcUcNpRXtqHwS9n8jEL13f9u2_m4NvEsuzsH-3FJXrySv_tG_Zk_y2dHD__vx78jOwgpogPnlzeWHxVqinxpnSET6Aam5KDFivlcWis-rAcxoH2AH6BMYzjwLkLYFqmwhq7d7hJ2pesYozuNoD9BwdbuUVeSKA9mqD2TSV8hs6shDSRuDCN6sTObIQM","UiLocales":null,"Nonce":"637018884621753111.ZDM3OWJhN2YtODkyZS00MGE3LTgwZmEtODFlYjg2MjQ1NWQwZTYxMTRlOTQtNTY1Yy00NWFjLTkwNGEtNjY2Y2U5OGQxOGFl","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"8a7f11d362fe2b6d0a970781023d5f73","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/home/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637018884621753111.ZDM3OWJhN2YtODkyZS00MGE3LTgwZmEtODFlYjg2MjQ1NWQwZTYxMTRlOTQtNTY1Yy00NWFjLTkwNGEtNjY2Y2U5OGQxOGFl","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9NG5859K0nficBVebUomwWY33H0XFb2dofFNGfld0CzSzZtxg1sQS0aInXT8qJlb9cBq-tJ6aMCLFmTXm9sJBoNSy2ZJEfWhj9_d40138e_Vwhz30rLb1HQN8OqYnbrU1hOCOv1KcUcNpRXtqHwS9n8jEL13f9u2_m4NvEsuzsH-3FJXrySv_tG_Zk_y2dHD__vx78jOwgpogPnlzeWHxVqinxpnSET6Aam5KDFivlcWis-rAcxoH2AH6BMYzjwLkLYFqmwhq7d7hJ2pesYozuNoD9BwdbuUVeSKA9mqD2TSV8hs6shDSRuDCN6sTObIQM","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-20 12:01:02.209 +03:00 [DBG] Client is configured to not require consent, no consent is required
2019-08-20 12:01:02.210 +03:00 [DBG] Creating Hybrid Flow response.
2019-08-20 12:01:02.211 +03:00 [DBG] Creating Implicit Flow response.
2019-08-20 12:01:02.212 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 12:01:02.212 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 12:01:02.217 +03:00 [DBG] Authorize endpoint response
{"SubjectId":"1","ClientId":"mvc","RedirectUri":"http://localhost:5002/home/signin-oidc","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9NG5859K0nficBVebUomwWY33H0XFb2dofFNGfld0CzSzZtxg1sQS0aInXT8qJlb9cBq-tJ6aMCLFmTXm9sJBoNSy2ZJEfWhj9_d40138e_Vwhz30rLb1HQN8OqYnbrU1hOCOv1KcUcNpRXtqHwS9n8jEL13f9u2_m4NvEsuzsH-3FJXrySv_tG_Zk_y2dHD__vx78jOwgpogPnlzeWHxVqinxpnSET6Aam5KDFivlcWis-rAcxoH2AH6BMYzjwLkLYFqmwhq7d7hJ2pesYozuNoD9BwdbuUVeSKA9mqD2TSV8hs6shDSRuDCN6sTObIQM","Scope":"openid profile afcpayroll offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-08-20 12:01:02.426 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-20 12:01:02.428 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-20 12:01:02.430 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-20 12:01:02.431 +03:00 [DBG] Start token request.
2019-08-20 12:01:02.431 +03:00 [DBG] Start client validation
2019-08-20 12:01:02.432 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-20 12:01:02.433 +03:00 [DBG] Start parsing for secret in post body
2019-08-20 12:01:02.434 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-20 12:01:02.435 +03:00 [DBG] Secret id found: mvc
2019-08-20 12:01:02.436 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:01:02.437 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-20 12:01:02.437 +03:00 [DBG] Client validation success
2019-08-20 12:01:02.438 +03:00 [DBG] Start token request validation
2019-08-20 12:01:02.438 +03:00 [DBG] Start validation of authorization code token request
2019-08-20 12:01:02.439 +03:00 [DBG] Validation of authorization code token request success
2019-08-20 12:01:02.439 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"e5c6ea85f5b4ce790ea8398e2bc6aaf42df74e850e3b511b8c76ea8e2e21b658","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"mvc","client_secret":"***REDACTED***","code":"e5c6ea85f5b4ce790ea8398e2bc6aaf42df74e850e3b511b8c76ea8e2e21b658","grant_type":"authorization_code","redirect_uri":"http://localhost:5002/home/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-08-20 12:01:02.442 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:01:02.443 +03:00 [DBG] Getting claims for access token for client: mvc
2019-08-20 12:01:02.443 +03:00 [DBG] Getting claims for access token for subject: 1
2019-08-20 12:01:02.447 +03:00 [DBG] Creating refresh token
2019-08-20 12:01:02.448 +03:00 [DBG] Setting an absolute lifetime: 2592000
2019-08-20 12:01:02.448 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:01:02.449 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 12:01:02.449 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 12:01:02.457 +03:00 [DBG] Token request success.
2019-08-20 12:01:02.462 +03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-08-20 12:01:02.463 +03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-08-20 12:01:02.464 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-08-20 12:01:02.464 +03:00 [DBG] Start userinfo request
2019-08-20 12:01:02.465 +03:00 [DBG] Bearer token found in header
2019-08-20 12:01:02.468 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:01:02.468 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:01:02.469 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-08-20 12:01:02.470 +03:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1566291662,"exp":1566291722,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","afcpayroll"],"client_id":"mvc","sub":"1","auth_time":1566291655,"idp":"local","name":"alice","email":"alice@email.com","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-08-20 12:01:02.474 +03:00 [DBG] Creating userinfo response
2019-08-20 12:01:02.474 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 12:01:02.475 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 12:01:02.475 +03:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 12:01:02.476 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 12:01:02.476 +03:00 [INF] Profile service returned the following claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 12:01:02.477 +03:00 [DBG] End userinfo request
2019-08-20 12:01:02.543 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-08-20 12:01:02.545 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-08-20 12:01:02.545 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-08-20 12:01:02.546 +03:00 [DBG] Start authorize request
2019-08-20 12:01:02.548 +03:00 [DBG] User in authorize request: 1
2019-08-20 12:01:02.549 +03:00 [DBG] Start authorize request protocol validation
2019-08-20 12:01:02.549 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:01:02.550 +03:00 [DBG] Checking for PKCE parameters
2019-08-20 12:01:02.550 +03:00 [DBG] No PKCE used.
2019-08-20 12:01:02.551 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-20 12:01:02.552 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/home/signin-oidc","AllowedRedirectUris":["http://localhost:5002/home/signin-oidc"],"SubjectId":"1","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9NkddrMO3oGHzwdF9pmHKftRivrZvBc5W0BGeLKb1JCzRBbEdIUbYxuypZUWCsqQW_1mvEEq3JjoRvnfYhXaQAwql-wMYGsObgI1cUPURqNxLO235DA_fmWdom1lVdoQqee04ydnUCr5Tfrn3OojTiqQ-K5dMunHXwTCybth1tPLlisUbLEXEPt35to28RjCESiBoUfhdTQ_B5ekpduKcK4Tbu2XlLs3OsbdcFKnjENLNm8qgSuHjHrtmA5uokUEeRXMV2EBKh-2GGayR-q1pfy7kyUiK9Zy4eH6sNUoN8DkG7_nK7R5ld0xb1UPt2XEDA","UiLocales":null,"Nonce":"637018884625213841.MGU0ZDYzNzktZDc2Ni00YjZkLTg5YjktODFmZDliNTFjNzMwNTg4MWZmZTQtNmIxMS00MTgyLTk3MGUtYWM0NTliMjZlNDdm","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"8a7f11d362fe2b6d0a970781023d5f73","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/home/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637018884625213841.MGU0ZDYzNzktZDc2Ni00YjZkLTg5YjktODFmZDliNTFjNzMwNTg4MWZmZTQtNmIxMS00MTgyLTk3MGUtYWM0NTliMjZlNDdm","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9NkddrMO3oGHzwdF9pmHKftRivrZvBc5W0BGeLKb1JCzRBbEdIUbYxuypZUWCsqQW_1mvEEq3JjoRvnfYhXaQAwql-wMYGsObgI1cUPURqNxLO235DA_fmWdom1lVdoQqee04ydnUCr5Tfrn3OojTiqQ-K5dMunHXwTCybth1tPLlisUbLEXEPt35to28RjCESiBoUfhdTQ_B5ekpduKcK4Tbu2XlLs3OsbdcFKnjENLNm8qgSuHjHrtmA5uokUEeRXMV2EBKh-2GGayR-q1pfy7kyUiK9Zy4eH6sNUoN8DkG7_nK7R5ld0xb1UPt2XEDA","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-20 12:01:02.559 +03:00 [DBG] Client is configured to not require consent, no consent is required
2019-08-20 12:01:02.561 +03:00 [DBG] Creating Hybrid Flow response.
2019-08-20 12:01:02.561 +03:00 [DBG] Creating Implicit Flow response.
2019-08-20 12:01:02.562 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 12:01:02.563 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 12:01:02.567 +03:00 [DBG] Authorize endpoint response
{"SubjectId":"1","ClientId":"mvc","RedirectUri":"http://localhost:5002/home/signin-oidc","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9NkddrMO3oGHzwdF9pmHKftRivrZvBc5W0BGeLKb1JCzRBbEdIUbYxuypZUWCsqQW_1mvEEq3JjoRvnfYhXaQAwql-wMYGsObgI1cUPURqNxLO235DA_fmWdom1lVdoQqee04ydnUCr5Tfrn3OojTiqQ-K5dMunHXwTCybth1tPLlisUbLEXEPt35to28RjCESiBoUfhdTQ_B5ekpduKcK4Tbu2XlLs3OsbdcFKnjENLNm8qgSuHjHrtmA5uokUEeRXMV2EBKh-2GGayR-q1pfy7kyUiK9Zy4eH6sNUoN8DkG7_nK7R5ld0xb1UPt2XEDA","Scope":"openid profile afcpayroll offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-08-20 12:01:02.824 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-20 12:01:02.825 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-20 12:01:02.841 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-20 12:01:02.842 +03:00 [DBG] Start token request.
2019-08-20 12:01:02.843 +03:00 [DBG] Start client validation
2019-08-20 12:01:02.843 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-20 12:01:02.844 +03:00 [DBG] Start parsing for secret in post body
2019-08-20 12:01:02.844 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-20 12:01:02.845 +03:00 [DBG] Secret id found: mvc
2019-08-20 12:01:02.845 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:01:02.846 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-20 12:01:02.846 +03:00 [DBG] Client validation success
2019-08-20 12:01:02.847 +03:00 [DBG] Start token request validation
2019-08-20 12:01:02.847 +03:00 [DBG] Start validation of authorization code token request
2019-08-20 12:01:02.848 +03:00 [DBG] Validation of authorization code token request success
2019-08-20 12:01:02.848 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"10d29180ef66b0b3967ae5ac48b975e4800ffa1783860febe5f9296c978daf6c","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"mvc","client_secret":"***REDACTED***","code":"10d29180ef66b0b3967ae5ac48b975e4800ffa1783860febe5f9296c978daf6c","grant_type":"authorization_code","redirect_uri":"http://localhost:5002/home/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-08-20 12:01:02.855 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:01:02.856 +03:00 [DBG] Getting claims for access token for client: mvc
2019-08-20 12:01:02.856 +03:00 [DBG] Getting claims for access token for subject: 1
2019-08-20 12:01:02.861 +03:00 [DBG] Creating refresh token
2019-08-20 12:01:02.862 +03:00 [DBG] Setting an absolute lifetime: 2592000
2019-08-20 12:01:02.862 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:01:02.863 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 12:01:02.863 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 12:01:02.869 +03:00 [DBG] Token request success.
2019-08-20 12:01:02.872 +03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-08-20 12:01:02.873 +03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-08-20 12:01:02.874 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-08-20 12:01:02.874 +03:00 [DBG] Start userinfo request
2019-08-20 12:01:02.875 +03:00 [DBG] Bearer token found in header
2019-08-20 12:01:02.877 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:01:02.878 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:01:02.879 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-08-20 12:01:02.880 +03:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1566291662,"exp":1566291722,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","afcpayroll"],"client_id":"mvc","sub":"1","auth_time":1566291655,"idp":"local","name":"alice","email":"alice@email.com","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-08-20 12:01:02.887 +03:00 [DBG] Creating userinfo response
2019-08-20 12:01:02.887 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 12:01:02.888 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 12:01:02.888 +03:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 12:01:02.889 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 12:01:02.889 +03:00 [INF] Profile service returned the following claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 12:01:02.890 +03:00 [DBG] End userinfo request
2019-08-20 12:01:27.905 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-08-20 12:01:27.906 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-08-20 12:01:27.908 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-08-20 12:01:27.911 +03:00 [DBG] Start authorize request
2019-08-20 12:01:27.912 +03:00 [DBG] User in authorize request: 1
2019-08-20 12:01:27.914 +03:00 [DBG] Start authorize request protocol validation
2019-08-20 12:01:27.915 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:01:27.915 +03:00 [DBG] Checking for PKCE parameters
2019-08-20 12:01:27.916 +03:00 [DBG] No PKCE used.
2019-08-20 12:01:27.917 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-20 12:01:27.918 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/home/signin-oidc","AllowedRedirectUris":["http://localhost:5002/home/signin-oidc"],"SubjectId":"1","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9O-UWjj00ZCA8vsI_aSom3Q32zO5qgRUEzh_IiJ0zu93E4gMXSoTYhbHZLmWOYzPS_oHlQZ7eYcC1ZxP4LAZsmV621iiqA9aB51h3efY2EgpzEvlc6UN27tRr-JiUJ68uExIWwnUzvBwTnf_Y7dxb749ceWRFrd8G_Wke0c6sIEZxRkAlGMHtltw0zredkCEw43iMcOPMchiUVb2-HTH-Jnd-iSfLnVOOniIwtnIFhgDyCS_48Zi1osbWJBSenxxcFWXcohMqKp7i13KkRj80xF20FIistGk_tXKLDu0yh3PMMYYKKYnyN67pufefGvtZI","UiLocales":null,"Nonce":"637018884878801478.Y2UxZDg4ZmYtMzJkOS00OWFlLWI1MWItMTVmNzk1ZGE3ZjFjN2JiNDRjZmQtZTBkNS00MDJjLTkzNzAtNGE5YjliYjZkNjI4","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"8a7f11d362fe2b6d0a970781023d5f73","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/home/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637018884878801478.Y2UxZDg4ZmYtMzJkOS00OWFlLWI1MWItMTVmNzk1ZGE3ZjFjN2JiNDRjZmQtZTBkNS00MDJjLTkzNzAtNGE5YjliYjZkNjI4","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9O-UWjj00ZCA8vsI_aSom3Q32zO5qgRUEzh_IiJ0zu93E4gMXSoTYhbHZLmWOYzPS_oHlQZ7eYcC1ZxP4LAZsmV621iiqA9aB51h3efY2EgpzEvlc6UN27tRr-JiUJ68uExIWwnUzvBwTnf_Y7dxb749ceWRFrd8G_Wke0c6sIEZxRkAlGMHtltw0zredkCEw43iMcOPMchiUVb2-HTH-Jnd-iSfLnVOOniIwtnIFhgDyCS_48Zi1osbWJBSenxxcFWXcohMqKp7i13KkRj80xF20FIistGk_tXKLDu0yh3PMMYYKKYnyN67pufefGvtZI","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-20 12:01:27.926 +03:00 [DBG] Client is configured to not require consent, no consent is required
2019-08-20 12:01:27.926 +03:00 [DBG] Creating Hybrid Flow response.
2019-08-20 12:01:27.927 +03:00 [DBG] Creating Implicit Flow response.
2019-08-20 12:01:27.928 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 12:01:27.928 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 12:01:27.933 +03:00 [DBG] Authorize endpoint response
{"SubjectId":"1","ClientId":"mvc","RedirectUri":"http://localhost:5002/home/signin-oidc","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9O-UWjj00ZCA8vsI_aSom3Q32zO5qgRUEzh_IiJ0zu93E4gMXSoTYhbHZLmWOYzPS_oHlQZ7eYcC1ZxP4LAZsmV621iiqA9aB51h3efY2EgpzEvlc6UN27tRr-JiUJ68uExIWwnUzvBwTnf_Y7dxb749ceWRFrd8G_Wke0c6sIEZxRkAlGMHtltw0zredkCEw43iMcOPMchiUVb2-HTH-Jnd-iSfLnVOOniIwtnIFhgDyCS_48Zi1osbWJBSenxxcFWXcohMqKp7i13KkRj80xF20FIistGk_tXKLDu0yh3PMMYYKKYnyN67pufefGvtZI","Scope":"openid profile afcpayroll offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-08-20 12:01:28.225 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-20 12:01:28.226 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-20 12:01:28.228 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-20 12:01:28.229 +03:00 [DBG] Start token request.
2019-08-20 12:01:28.230 +03:00 [DBG] Start client validation
2019-08-20 12:01:28.231 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-20 12:01:28.232 +03:00 [DBG] Start parsing for secret in post body
2019-08-20 12:01:28.233 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-20 12:01:28.233 +03:00 [DBG] Secret id found: mvc
2019-08-20 12:01:28.234 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:01:28.235 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-20 12:01:28.235 +03:00 [DBG] Client validation success
2019-08-20 12:01:28.236 +03:00 [DBG] Start token request validation
2019-08-20 12:01:28.236 +03:00 [DBG] Start validation of authorization code token request
2019-08-20 12:01:28.237 +03:00 [DBG] Validation of authorization code token request success
2019-08-20 12:01:28.237 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"09706bbbcf756d5420acc55dbda92dee66a4975a9bef33d40f5861d069d5eb2a","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"mvc","client_secret":"***REDACTED***","code":"09706bbbcf756d5420acc55dbda92dee66a4975a9bef33d40f5861d069d5eb2a","grant_type":"authorization_code","redirect_uri":"http://localhost:5002/home/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-08-20 12:01:28.240 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:01:28.241 +03:00 [DBG] Getting claims for access token for client: mvc
2019-08-20 12:01:28.241 +03:00 [DBG] Getting claims for access token for subject: 1
2019-08-20 12:01:28.245 +03:00 [DBG] Creating refresh token
2019-08-20 12:01:28.246 +03:00 [DBG] Setting an absolute lifetime: 2592000
2019-08-20 12:01:28.247 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:01:28.249 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 12:01:28.250 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 12:01:28.254 +03:00 [DBG] Token request success.
2019-08-20 12:01:28.258 +03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-08-20 12:01:28.259 +03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-08-20 12:01:28.261 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-08-20 12:01:28.262 +03:00 [DBG] Start userinfo request
2019-08-20 12:01:28.262 +03:00 [DBG] Bearer token found in header
2019-08-20 12:01:28.266 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:01:28.268 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:01:28.269 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-08-20 12:01:28.270 +03:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1566291688,"exp":1566291748,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","afcpayroll"],"client_id":"mvc","sub":"1","auth_time":1566291655,"idp":"local","name":"alice","email":"alice@email.com","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-08-20 12:01:28.280 +03:00 [DBG] Creating userinfo response
2019-08-20 12:01:28.281 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 12:01:28.281 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 12:01:28.282 +03:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 12:01:28.283 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 12:01:28.284 +03:00 [INF] Profile service returned the following claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 12:01:28.285 +03:00 [DBG] End userinfo request
2019-08-20 12:02:30.498 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-20 12:02:30.501 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-20 12:02:30.502 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-20 12:02:30.503 +03:00 [DBG] Start discovery request
2019-08-20 12:02:30.569 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-20 12:02:30.570 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-20 12:02:30.570 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-20 12:02:30.571 +03:00 [DBG] Start key discovery request
2019-08-20 12:02:30.647 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-08-20 12:02:30.648 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-08-20 12:02:30.651 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-08-20 12:02:30.653 +03:00 [DBG] Start authorize request
2019-08-20 12:02:30.653 +03:00 [DBG] No user present in authorize request
2019-08-20 12:02:30.654 +03:00 [DBG] Start authorize request protocol validation
2019-08-20 12:02:30.654 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:02:30.655 +03:00 [DBG] Checking for PKCE parameters
2019-08-20 12:02:30.655 +03:00 [DBG] No PKCE used.
2019-08-20 12:02:30.656 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-20 12:02:30.657 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/home/signin-oidc","AllowedRedirectUris":["http://localhost:5002/home/signin-oidc"],"SubjectId":"anonymous","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9MAsKUH7cKowygE4FJ81eewfcxdh2DXdRnnDRWm5nR9hWIGKCOPoWgy3W3UVw0MHag43Kp2wGRMP5AAHABZEDwG2Jg968Das8h-zS-y9GpSmofGBIcY20aBm8w5lpJcDVHaCtveBMZMp80nbL7X4twfVHhR-xBwau5Q2C8t0MFW4uXYTE0W1uygm24OvunY52iylnkKzFJlktjKDpHEfDpxF5N5IsW9r5-coaS3NoEgusmWZ-4Xd416R-endivwZVoh85ZGgS1sS9CBxOENnOav69-msm1uu-M_OzWxq13HveAjyTzjlbyGWbOEK3fo-JM","UiLocales":null,"Nonce":"637018885505912907.ZmI5MGIwNzItYWMyZC00M2RlLWEzMzEtYThlYWI4YjMwZGJhZTdhMDM2YjUtZjI3NC00Y2E1LTg2ZGYtM2U5YjU2Y2ZlMzAy","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/home/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637018885505912907.ZmI5MGIwNzItYWMyZC00M2RlLWEzMzEtYThlYWI4YjMwZGJhZTdhMDM2YjUtZjI3NC00Y2E1LTg2ZGYtM2U5YjU2Y2ZlMzAy","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9MAsKUH7cKowygE4FJ81eewfcxdh2DXdRnnDRWm5nR9hWIGKCOPoWgy3W3UVw0MHag43Kp2wGRMP5AAHABZEDwG2Jg968Das8h-zS-y9GpSmofGBIcY20aBm8w5lpJcDVHaCtveBMZMp80nbL7X4twfVHhR-xBwau5Q2C8t0MFW4uXYTE0W1uygm24OvunY52iylnkKzFJlktjKDpHEfDpxF5N5IsW9r5-coaS3NoEgusmWZ-4Xd416R-endivwZVoh85ZGgS1sS9CBxOENnOav69-msm1uu-M_OzWxq13HveAjyTzjlbyGWbOEK3fo-JM","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-20 12:02:30.663 +03:00 [INF] Showing login: User is not authenticated
2019-08-20 12:02:30.676 +03:00 [DBG] Start authorize request protocol validation
2019-08-20 12:02:30.678 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:02:30.679 +03:00 [DBG] Checking for PKCE parameters
2019-08-20 12:02:30.679 +03:00 [DBG] No PKCE used.
2019-08-20 12:02:30.680 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-20 12:02:30.681 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:02:33.089 +03:00 [DBG] CORS request made for path: /account/login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-08-20 12:02:33.091 +03:00 [DBG] Start authorize request protocol validation
2019-08-20 12:02:33.091 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:02:33.092 +03:00 [DBG] Checking for PKCE parameters
2019-08-20 12:02:33.093 +03:00 [DBG] No PKCE used.
2019-08-20 12:02:33.094 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-20 12:02:33.094 +03:00 [DBG] Augmenting SignInContext
2019-08-20 12:02:33.095 +03:00 [DBG] Adding idp claim with value: local
2019-08-20 12:02:33.096 +03:00 [DBG] Adding amr claim with value: pwd
2019-08-20 12:02:33.097 +03:00 [INF] AuthenticationScheme: idsrv signed in.
2019-08-20 12:02:33.098 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:02:33.112 +03:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-08-20 12:02:33.113 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-08-20 12:02:33.113 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-08-20 12:02:33.114 +03:00 [DBG] Start authorize callback request
2019-08-20 12:02:33.115 +03:00 [DBG] User in authorize request: 1
2019-08-20 12:02:33.115 +03:00 [DBG] Start authorize request protocol validation
2019-08-20 12:02:33.117 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:02:33.118 +03:00 [DBG] Checking for PKCE parameters
2019-08-20 12:02:33.118 +03:00 [DBG] No PKCE used.
2019-08-20 12:02:33.119 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-20 12:02:33.120 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/home/signin-oidc","AllowedRedirectUris":["http://localhost:5002/home/signin-oidc"],"SubjectId":"1","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9MAsKUH7cKowygE4FJ81eewfcxdh2DXdRnnDRWm5nR9hWIGKCOPoWgy3W3UVw0MHag43Kp2wGRMP5AAHABZEDwG2Jg968Das8h-zS-y9GpSmofGBIcY20aBm8w5lpJcDVHaCtveBMZMp80nbL7X4twfVHhR-xBwau5Q2C8t0MFW4uXYTE0W1uygm24OvunY52iylnkKzFJlktjKDpHEfDpxF5N5IsW9r5-coaS3NoEgusmWZ-4Xd416R-endivwZVoh85ZGgS1sS9CBxOENnOav69-msm1uu-M_OzWxq13HveAjyTzjlbyGWbOEK3fo-JM","UiLocales":null,"Nonce":"637018885505912907.ZmI5MGIwNzItYWMyZC00M2RlLWEzMzEtYThlYWI4YjMwZGJhZTdhMDM2YjUtZjI3NC00Y2E1LTg2ZGYtM2U5YjU2Y2ZlMzAy","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"47fe6affa600fe3e3a38d817d213e0b1","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/home/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637018885505912907.ZmI5MGIwNzItYWMyZC00M2RlLWEzMzEtYThlYWI4YjMwZGJhZTdhMDM2YjUtZjI3NC00Y2E1LTg2ZGYtM2U5YjU2Y2ZlMzAy","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9MAsKUH7cKowygE4FJ81eewfcxdh2DXdRnnDRWm5nR9hWIGKCOPoWgy3W3UVw0MHag43Kp2wGRMP5AAHABZEDwG2Jg968Das8h-zS-y9GpSmofGBIcY20aBm8w5lpJcDVHaCtveBMZMp80nbL7X4twfVHhR-xBwau5Q2C8t0MFW4uXYTE0W1uygm24OvunY52iylnkKzFJlktjKDpHEfDpxF5N5IsW9r5-coaS3NoEgusmWZ-4Xd416R-endivwZVoh85ZGgS1sS9CBxOENnOav69-msm1uu-M_OzWxq13HveAjyTzjlbyGWbOEK3fo-JM","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-20 12:02:33.127 +03:00 [DBG] Client is configured to not require consent, no consent is required
2019-08-20 12:02:33.128 +03:00 [DBG] Creating Hybrid Flow response.
2019-08-20 12:02:33.129 +03:00 [DBG] Creating Implicit Flow response.
2019-08-20 12:02:33.130 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 12:02:33.133 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 12:02:33.139 +03:00 [DBG] Authorize endpoint response
{"SubjectId":"1","ClientId":"mvc","RedirectUri":"http://localhost:5002/home/signin-oidc","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9MAsKUH7cKowygE4FJ81eewfcxdh2DXdRnnDRWm5nR9hWIGKCOPoWgy3W3UVw0MHag43Kp2wGRMP5AAHABZEDwG2Jg968Das8h-zS-y9GpSmofGBIcY20aBm8w5lpJcDVHaCtveBMZMp80nbL7X4twfVHhR-xBwau5Q2C8t0MFW4uXYTE0W1uygm24OvunY52iylnkKzFJlktjKDpHEfDpxF5N5IsW9r5-coaS3NoEgusmWZ-4Xd416R-endivwZVoh85ZGgS1sS9CBxOENnOav69-msm1uu-M_OzWxq13HveAjyTzjlbyGWbOEK3fo-JM","Scope":"openid profile afcpayroll offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-08-20 12:02:33.143 +03:00 [DBG] Augmenting SignInContext
2019-08-20 12:02:33.144 +03:00 [INF] AuthenticationScheme: idsrv signed in.
2019-08-20 12:02:33.556 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-20 12:02:33.557 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-20 12:02:33.558 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-20 12:02:33.558 +03:00 [DBG] Start token request.
2019-08-20 12:02:33.559 +03:00 [DBG] Start client validation
2019-08-20 12:02:33.559 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-20 12:02:33.560 +03:00 [DBG] Start parsing for secret in post body
2019-08-20 12:02:33.560 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-20 12:02:33.560 +03:00 [DBG] Secret id found: mvc
2019-08-20 12:02:33.562 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:02:33.563 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-20 12:02:33.563 +03:00 [DBG] Client validation success
2019-08-20 12:02:33.564 +03:00 [DBG] Start token request validation
2019-08-20 12:02:33.564 +03:00 [DBG] Start validation of authorization code token request
2019-08-20 12:02:33.565 +03:00 [DBG] Validation of authorization code token request success
2019-08-20 12:02:33.565 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"e9f3a9657ab3e894436161ce4da45f867176d0e86fa946ea8db2f27a51706449","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"mvc","client_secret":"***REDACTED***","code":"e9f3a9657ab3e894436161ce4da45f867176d0e86fa946ea8db2f27a51706449","grant_type":"authorization_code","redirect_uri":"http://localhost:5002/home/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-08-20 12:02:33.571 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:02:33.572 +03:00 [DBG] Getting claims for access token for client: mvc
2019-08-20 12:02:33.572 +03:00 [DBG] Getting claims for access token for subject: 1
2019-08-20 12:02:33.576 +03:00 [DBG] Creating refresh token
2019-08-20 12:02:33.577 +03:00 [DBG] Setting an absolute lifetime: 2592000
2019-08-20 12:02:33.577 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:02:33.578 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 12:02:33.579 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 12:02:33.583 +03:00 [DBG] Token request success.
2019-08-20 12:02:33.593 +03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-08-20 12:02:33.594 +03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-08-20 12:02:33.595 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-08-20 12:02:33.595 +03:00 [DBG] Start userinfo request
2019-08-20 12:02:33.596 +03:00 [DBG] Bearer token found in header
2019-08-20 12:02:33.598 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:02:33.599 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:02:33.602 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-08-20 12:02:33.602 +03:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1566291753,"exp":1566291813,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","afcpayroll"],"client_id":"mvc","sub":"1","auth_time":1566291753,"idp":"local","name":"alice","email":"alice@email.com","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-08-20 12:02:33.606 +03:00 [DBG] Creating userinfo response
2019-08-20 12:02:33.607 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 12:02:33.607 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 12:02:33.608 +03:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 12:02:33.608 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 12:02:33.609 +03:00 [INF] Profile service returned the following claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 12:02:33.609 +03:00 [DBG] End userinfo request
2019-08-20 12:02:52.941 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-08-20 12:02:52.942 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-08-20 12:02:52.943 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-08-20 12:02:52.943 +03:00 [DBG] Start authorize request
2019-08-20 12:02:52.944 +03:00 [DBG] User in authorize request: 1
2019-08-20 12:02:52.944 +03:00 [DBG] Start authorize request protocol validation
2019-08-20 12:02:52.945 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:02:52.945 +03:00 [DBG] Checking for PKCE parameters
2019-08-20 12:02:52.946 +03:00 [DBG] No PKCE used.
2019-08-20 12:02:52.946 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-20 12:02:52.947 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/home/signin-oidc","AllowedRedirectUris":["http://localhost:5002/home/signin-oidc"],"SubjectId":"1","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9P5XOb77Lus5F_FWooUFJpZchsHKSYrBtihCt1nAjaoNSVvI0aUWf-nFRIFH2IIXBQHh8i4wmsDAJEK7BonyUftVMeJh9Ys1AC-amf1yZq5bsToAVKRycFrzGSzo9XsmgxW0RwaAr8ZHTJuosxNV6vIxHBT_hlf0Yfh6ZE_vn1iS9utcTYHmBy2OcH18xizR65jsXWUYrRStXD1xSBb9ERy5t9sKaMXDFPXPpEDd8NmMG_9mNb7_-K2gRul3qmzwi5jIgWpgxALIKWK3mtkaR792ibFT6Xc6ef21KV4kcMcdDQG7B8vsAru_sTPy8iKgTs","UiLocales":null,"Nonce":"637018885729201864.OThjNTdkNGItYWVjMy00ZWY3LWI4NjQtMWMxYTFhM2VmYjU1Nzg2OWJlNGMtNzMyNS00OWU3LWI1NTMtZjUzZTBmNjkxZThm","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"47fe6affa600fe3e3a38d817d213e0b1","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/home/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637018885729201864.OThjNTdkNGItYWVjMy00ZWY3LWI4NjQtMWMxYTFhM2VmYjU1Nzg2OWJlNGMtNzMyNS00OWU3LWI1NTMtZjUzZTBmNjkxZThm","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9P5XOb77Lus5F_FWooUFJpZchsHKSYrBtihCt1nAjaoNSVvI0aUWf-nFRIFH2IIXBQHh8i4wmsDAJEK7BonyUftVMeJh9Ys1AC-amf1yZq5bsToAVKRycFrzGSzo9XsmgxW0RwaAr8ZHTJuosxNV6vIxHBT_hlf0Yfh6ZE_vn1iS9utcTYHmBy2OcH18xizR65jsXWUYrRStXD1xSBb9ERy5t9sKaMXDFPXPpEDd8NmMG_9mNb7_-K2gRul3qmzwi5jIgWpgxALIKWK3mtkaR792ibFT6Xc6ef21KV4kcMcdDQG7B8vsAru_sTPy8iKgTs","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-20 12:02:52.963 +03:00 [DBG] Client is configured to not require consent, no consent is required
2019-08-20 12:02:52.964 +03:00 [DBG] Creating Hybrid Flow response.
2019-08-20 12:02:52.965 +03:00 [DBG] Creating Implicit Flow response.
2019-08-20 12:02:52.965 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 12:02:52.966 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 12:02:52.970 +03:00 [DBG] Authorize endpoint response
{"SubjectId":"1","ClientId":"mvc","RedirectUri":"http://localhost:5002/home/signin-oidc","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9P5XOb77Lus5F_FWooUFJpZchsHKSYrBtihCt1nAjaoNSVvI0aUWf-nFRIFH2IIXBQHh8i4wmsDAJEK7BonyUftVMeJh9Ys1AC-amf1yZq5bsToAVKRycFrzGSzo9XsmgxW0RwaAr8ZHTJuosxNV6vIxHBT_hlf0Yfh6ZE_vn1iS9utcTYHmBy2OcH18xizR65jsXWUYrRStXD1xSBb9ERy5t9sKaMXDFPXPpEDd8NmMG_9mNb7_-K2gRul3qmzwi5jIgWpgxALIKWK3mtkaR792ibFT6Xc6ef21KV4kcMcdDQG7B8vsAru_sTPy8iKgTs","Scope":"openid profile afcpayroll offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-08-20 12:02:53.234 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-20 12:02:53.235 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-20 12:02:53.236 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-20 12:02:53.236 +03:00 [DBG] Start token request.
2019-08-20 12:02:53.237 +03:00 [DBG] Start client validation
2019-08-20 12:02:53.237 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-20 12:02:53.239 +03:00 [DBG] Start parsing for secret in post body
2019-08-20 12:02:53.240 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-20 12:02:53.240 +03:00 [DBG] Secret id found: mvc
2019-08-20 12:02:53.241 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:02:53.241 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-20 12:02:53.242 +03:00 [DBG] Client validation success
2019-08-20 12:02:53.242 +03:00 [DBG] Start token request validation
2019-08-20 12:02:53.242 +03:00 [DBG] Start validation of authorization code token request
2019-08-20 12:02:53.243 +03:00 [DBG] Validation of authorization code token request success
2019-08-20 12:02:53.243 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"ed109b1bfc8a95ad67aa49fe4a9b5ee85b5f5245ff5c1a97424750aef36b5029","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"mvc","client_secret":"***REDACTED***","code":"ed109b1bfc8a95ad67aa49fe4a9b5ee85b5f5245ff5c1a97424750aef36b5029","grant_type":"authorization_code","redirect_uri":"http://localhost:5002/home/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-08-20 12:02:53.248 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:02:53.249 +03:00 [DBG] Getting claims for access token for client: mvc
2019-08-20 12:02:53.249 +03:00 [DBG] Getting claims for access token for subject: 1
2019-08-20 12:02:53.253 +03:00 [DBG] Creating refresh token
2019-08-20 12:02:53.254 +03:00 [DBG] Setting an absolute lifetime: 2592000
2019-08-20 12:02:53.254 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:02:53.255 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 12:02:53.256 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 12:02:53.259 +03:00 [DBG] Token request success.
2019-08-20 12:02:53.267 +03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-08-20 12:02:53.267 +03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-08-20 12:02:53.268 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-08-20 12:02:53.268 +03:00 [DBG] Start userinfo request
2019-08-20 12:02:53.269 +03:00 [DBG] Bearer token found in header
2019-08-20 12:02:53.272 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:02:53.273 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:02:53.273 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-08-20 12:02:53.274 +03:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1566291773,"exp":1566291833,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","afcpayroll"],"client_id":"mvc","sub":"1","auth_time":1566291753,"idp":"local","name":"alice","email":"alice@email.com","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-08-20 12:02:53.278 +03:00 [DBG] Creating userinfo response
2019-08-20 12:02:53.278 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 12:02:53.279 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 12:02:53.279 +03:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 12:02:53.280 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 12:02:53.280 +03:00 [INF] Profile service returned the following claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 12:02:53.281 +03:00 [DBG] End userinfo request
2019-08-20 12:03:03.122 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-08-20 12:03:03.125 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-08-20 12:03:03.128 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-08-20 12:03:03.129 +03:00 [DBG] Start authorize request
2019-08-20 12:03:03.130 +03:00 [DBG] User in authorize request: 1
2019-08-20 12:03:03.131 +03:00 [DBG] Start authorize request protocol validation
2019-08-20 12:03:03.133 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:03:03.134 +03:00 [DBG] Checking for PKCE parameters
2019-08-20 12:03:03.135 +03:00 [DBG] No PKCE used.
2019-08-20 12:03:03.136 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-20 12:03:03.137 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/home/signin-oidc","AllowedRedirectUris":["http://localhost:5002/home/signin-oidc"],"SubjectId":"1","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9OjIyjEs-AxXNnn7EqmYE0365ODdWGx4gS6STxOj58IDTEHcKULzznU8VcTtYoCmIqh85Z7_5XaJkmfYgK8E_5FWql8NgYcCW2I2i04D2a85zh8YB6a4pSo8eloxKw7yDI2uScnCUk3xdNx0nr-xiR7ihSpXRmsnTruHbXbb5ZSyvu2VO0jB0aKgvBzP2hrUrE2YJ_MtQ3t3O2-i43C6VJZuTaRpXAd3PBlRgIEqblh_omqzQ-mKSPQv06GvcFFVQiDQUgcrYRu9M9zWm_6qhmQgQPaKT3EMMe23nsDv0Jc9Q5TB_R1yb47sT_yP15WIc0","UiLocales":null,"Nonce":"637018885831042460.MjI0OGE5YTYtMjVlYy00MDFmLTliNmUtYjMyMmE2OWYyNmY4NGIzMjI1YmMtN2Q1MC00ZjQ5LWE0N2EtYTIzZGMzNDJiYTA1","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"47fe6affa600fe3e3a38d817d213e0b1","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/home/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637018885831042460.MjI0OGE5YTYtMjVlYy00MDFmLTliNmUtYjMyMmE2OWYyNmY4NGIzMjI1YmMtN2Q1MC00ZjQ5LWE0N2EtYTIzZGMzNDJiYTA1","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9OjIyjEs-AxXNnn7EqmYE0365ODdWGx4gS6STxOj58IDTEHcKULzznU8VcTtYoCmIqh85Z7_5XaJkmfYgK8E_5FWql8NgYcCW2I2i04D2a85zh8YB6a4pSo8eloxKw7yDI2uScnCUk3xdNx0nr-xiR7ihSpXRmsnTruHbXbb5ZSyvu2VO0jB0aKgvBzP2hrUrE2YJ_MtQ3t3O2-i43C6VJZuTaRpXAd3PBlRgIEqblh_omqzQ-mKSPQv06GvcFFVQiDQUgcrYRu9M9zWm_6qhmQgQPaKT3EMMe23nsDv0Jc9Q5TB_R1yb47sT_yP15WIc0","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-20 12:03:03.143 +03:00 [DBG] Client is configured to not require consent, no consent is required
2019-08-20 12:03:03.143 +03:00 [DBG] Creating Hybrid Flow response.
2019-08-20 12:03:03.144 +03:00 [DBG] Creating Implicit Flow response.
2019-08-20 12:03:03.144 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 12:03:03.145 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 12:03:03.149 +03:00 [DBG] Authorize endpoint response
{"SubjectId":"1","ClientId":"mvc","RedirectUri":"http://localhost:5002/home/signin-oidc","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9OjIyjEs-AxXNnn7EqmYE0365ODdWGx4gS6STxOj58IDTEHcKULzznU8VcTtYoCmIqh85Z7_5XaJkmfYgK8E_5FWql8NgYcCW2I2i04D2a85zh8YB6a4pSo8eloxKw7yDI2uScnCUk3xdNx0nr-xiR7ihSpXRmsnTruHbXbb5ZSyvu2VO0jB0aKgvBzP2hrUrE2YJ_MtQ3t3O2-i43C6VJZuTaRpXAd3PBlRgIEqblh_omqzQ-mKSPQv06GvcFFVQiDQUgcrYRu9M9zWm_6qhmQgQPaKT3EMMe23nsDv0Jc9Q5TB_R1yb47sT_yP15WIc0","Scope":"openid profile afcpayroll offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-08-20 12:03:03.403 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-20 12:03:03.404 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-20 12:03:03.405 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-20 12:03:03.406 +03:00 [DBG] Start token request.
2019-08-20 12:03:03.406 +03:00 [DBG] Start client validation
2019-08-20 12:03:03.407 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-20 12:03:03.408 +03:00 [DBG] Start parsing for secret in post body
2019-08-20 12:03:03.408 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-20 12:03:03.409 +03:00 [DBG] Secret id found: mvc
2019-08-20 12:03:03.409 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:03:03.410 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-20 12:03:03.410 +03:00 [DBG] Client validation success
2019-08-20 12:03:03.411 +03:00 [DBG] Start token request validation
2019-08-20 12:03:03.411 +03:00 [DBG] Start validation of authorization code token request
2019-08-20 12:03:03.412 +03:00 [DBG] Validation of authorization code token request success
2019-08-20 12:03:03.412 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"c752458838bcac9dc8fcdc0034290d59a7bebd7177f8964800d014cb3cbb16ae","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"mvc","client_secret":"***REDACTED***","code":"c752458838bcac9dc8fcdc0034290d59a7bebd7177f8964800d014cb3cbb16ae","grant_type":"authorization_code","redirect_uri":"http://localhost:5002/home/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-08-20 12:03:03.417 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:03:03.418 +03:00 [DBG] Getting claims for access token for client: mvc
2019-08-20 12:03:03.418 +03:00 [DBG] Getting claims for access token for subject: 1
2019-08-20 12:03:03.423 +03:00 [DBG] Creating refresh token
2019-08-20 12:03:03.423 +03:00 [DBG] Setting an absolute lifetime: 2592000
2019-08-20 12:03:03.424 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:03:03.424 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 12:03:03.425 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 12:03:03.428 +03:00 [DBG] Token request success.
2019-08-20 12:03:03.432 +03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-08-20 12:03:03.433 +03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-08-20 12:03:03.433 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-08-20 12:03:03.434 +03:00 [DBG] Start userinfo request
2019-08-20 12:03:03.434 +03:00 [DBG] Bearer token found in header
2019-08-20 12:03:03.437 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:03:03.437 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:03:03.438 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-08-20 12:03:03.438 +03:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1566291783,"exp":1566291843,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","afcpayroll"],"client_id":"mvc","sub":"1","auth_time":1566291753,"idp":"local","name":"alice","email":"alice@email.com","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-08-20 12:03:03.443 +03:00 [DBG] Creating userinfo response
2019-08-20 12:03:03.443 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 12:03:03.444 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 12:03:03.444 +03:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 12:03:03.445 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 12:03:03.445 +03:00 [INF] Profile service returned the following claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 12:03:03.446 +03:00 [DBG] End userinfo request
2019-08-20 12:03:23.639 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-20 12:03:23.640 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-20 12:03:23.640 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-20 12:03:23.641 +03:00 [DBG] Start discovery request
2019-08-20 12:03:23.701 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-20 12:03:23.702 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-20 12:03:23.702 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-20 12:03:23.703 +03:00 [DBG] Start key discovery request
2019-08-20 12:03:23.791 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-08-20 12:03:23.797 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-08-20 12:03:23.803 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-08-20 12:03:23.804 +03:00 [DBG] Start authorize request
2019-08-20 12:03:23.804 +03:00 [DBG] User in authorize request: 1
2019-08-20 12:03:23.805 +03:00 [DBG] Start authorize request protocol validation
2019-08-20 12:03:23.806 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:03:23.807 +03:00 [DBG] Checking for PKCE parameters
2019-08-20 12:03:23.807 +03:00 [DBG] No PKCE used.
2019-08-20 12:03:23.808 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-20 12:03:23.810 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/home/signin-oidc","AllowedRedirectUris":["http://localhost:5002/home/signin-oidc"],"SubjectId":"1","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9O-k0KaK4RL8GkxgdTaUT_cc7n-IyfuCOtZj7qQo3jVu29koG9yfjeEd6o05zP4-IaDjIFgiAHh664pE4LAZ08wW90KV4WJKNLSMm3ZP2rHjLfi-XdR7nzoeN_FuuPn-6jxgEDi8UCQpnlXX4Od7YSGqRbq009sChWrxbGSrfWQ2KqCCAh2tgs3l8Q2nCAP6XrUC3GjdrzWR1iygDnhnoVR1KRKnEsY6OZYW699JM2cZjmz7C-grtaKkdgXldlsIgDSMKt1n36R3CNpRe-PPzenrmRttWWQQTzlBvaHxGHNP-qVk8Sc6VE58r_FDSHwFHc","UiLocales":null,"Nonce":"637018886037225746.NGVmOGZmZGQtNjNmZS00ZmJhLTk5ZDYtZGI1OTU0YTBlYzVmOTQ3YTg5YzYtY2U0MS00OGE4LWI0NzEtOTUyZGNlOTMyMjI2","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"47fe6affa600fe3e3a38d817d213e0b1","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/home/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637018886037225746.NGVmOGZmZGQtNjNmZS00ZmJhLTk5ZDYtZGI1OTU0YTBlYzVmOTQ3YTg5YzYtY2U0MS00OGE4LWI0NzEtOTUyZGNlOTMyMjI2","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9O-k0KaK4RL8GkxgdTaUT_cc7n-IyfuCOtZj7qQo3jVu29koG9yfjeEd6o05zP4-IaDjIFgiAHh664pE4LAZ08wW90KV4WJKNLSMm3ZP2rHjLfi-XdR7nzoeN_FuuPn-6jxgEDi8UCQpnlXX4Od7YSGqRbq009sChWrxbGSrfWQ2KqCCAh2tgs3l8Q2nCAP6XrUC3GjdrzWR1iygDnhnoVR1KRKnEsY6OZYW699JM2cZjmz7C-grtaKkdgXldlsIgDSMKt1n36R3CNpRe-PPzenrmRttWWQQTzlBvaHxGHNP-qVk8Sc6VE58r_FDSHwFHc","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-20 12:03:23.819 +03:00 [DBG] Client is configured to not require consent, no consent is required
2019-08-20 12:03:23.820 +03:00 [DBG] Creating Hybrid Flow response.
2019-08-20 12:03:23.820 +03:00 [DBG] Creating Implicit Flow response.
2019-08-20 12:03:23.821 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 12:03:23.822 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 12:03:23.826 +03:00 [DBG] Authorize endpoint response
{"SubjectId":"1","ClientId":"mvc","RedirectUri":"http://localhost:5002/home/signin-oidc","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9O-k0KaK4RL8GkxgdTaUT_cc7n-IyfuCOtZj7qQo3jVu29koG9yfjeEd6o05zP4-IaDjIFgiAHh664pE4LAZ08wW90KV4WJKNLSMm3ZP2rHjLfi-XdR7nzoeN_FuuPn-6jxgEDi8UCQpnlXX4Od7YSGqRbq009sChWrxbGSrfWQ2KqCCAh2tgs3l8Q2nCAP6XrUC3GjdrzWR1iygDnhnoVR1KRKnEsY6OZYW699JM2cZjmz7C-grtaKkdgXldlsIgDSMKt1n36R3CNpRe-PPzenrmRttWWQQTzlBvaHxGHNP-qVk8Sc6VE58r_FDSHwFHc","Scope":"openid profile afcpayroll offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-08-20 12:03:24.262 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-20 12:03:24.270 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-20 12:03:24.276 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-20 12:03:24.281 +03:00 [DBG] Start token request.
2019-08-20 12:03:24.282 +03:00 [DBG] Start client validation
2019-08-20 12:03:24.283 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-20 12:03:24.284 +03:00 [DBG] Start parsing for secret in post body
2019-08-20 12:03:24.287 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-20 12:03:24.289 +03:00 [DBG] Secret id found: mvc
2019-08-20 12:03:24.290 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:03:24.291 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-20 12:03:24.291 +03:00 [DBG] Client validation success
2019-08-20 12:03:24.292 +03:00 [DBG] Start token request validation
2019-08-20 12:03:24.294 +03:00 [DBG] Start validation of authorization code token request
2019-08-20 12:03:24.296 +03:00 [DBG] Validation of authorization code token request success
2019-08-20 12:03:24.296 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"7509a0b7bc86bc8a3007a847c84d6f0133b914dead553f1f1915714b81297f3b","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"mvc","client_secret":"***REDACTED***","code":"7509a0b7bc86bc8a3007a847c84d6f0133b914dead553f1f1915714b81297f3b","grant_type":"authorization_code","redirect_uri":"http://localhost:5002/home/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-08-20 12:03:24.300 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:03:24.301 +03:00 [DBG] Getting claims for access token for client: mvc
2019-08-20 12:03:24.301 +03:00 [DBG] Getting claims for access token for subject: 1
2019-08-20 12:03:24.306 +03:00 [DBG] Creating refresh token
2019-08-20 12:03:24.307 +03:00 [DBG] Setting an absolute lifetime: 2592000
2019-08-20 12:03:24.307 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:03:24.308 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 12:03:24.309 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 12:03:24.313 +03:00 [DBG] Token request success.
2019-08-20 12:03:24.324 +03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-08-20 12:03:24.325 +03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-08-20 12:03:24.326 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-08-20 12:03:24.327 +03:00 [DBG] Start userinfo request
2019-08-20 12:03:24.327 +03:00 [DBG] Bearer token found in header
2019-08-20 12:03:24.330 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:03:24.330 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:03:24.331 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-08-20 12:03:24.331 +03:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1566291804,"exp":1566291864,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","afcpayroll"],"client_id":"mvc","sub":"1","auth_time":1566291753,"idp":"local","name":"alice","email":"alice@email.com","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-08-20 12:03:24.338 +03:00 [DBG] Creating userinfo response
2019-08-20 12:03:24.338 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 12:03:24.339 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 12:03:24.339 +03:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 12:03:24.340 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 12:03:24.340 +03:00 [INF] Profile service returned the following claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 12:03:24.341 +03:00 [DBG] End userinfo request
2019-08-20 12:03:26.557 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-08-20 12:03:26.559 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-08-20 12:03:26.560 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-08-20 12:03:26.561 +03:00 [DBG] Start authorize request
2019-08-20 12:03:26.562 +03:00 [DBG] User in authorize request: 1
2019-08-20 12:03:26.562 +03:00 [DBG] Start authorize request protocol validation
2019-08-20 12:03:26.563 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:03:26.563 +03:00 [DBG] Checking for PKCE parameters
2019-08-20 12:03:26.564 +03:00 [DBG] No PKCE used.
2019-08-20 12:03:26.565 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-20 12:03:26.566 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/home/signin-oidc","AllowedRedirectUris":["http://localhost:5002/home/signin-oidc"],"SubjectId":"1","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9OcXi4id65amhERxMXcV4ndRM4J0UHlFPxr-6IW0Kvn_Om3ozdVAyfskIv8N7XtApZ6QOzScx8O86V-H0QRTs_Wi79wtt4I70uZhlknkZx80xPFks9ywZ9rYGsPMWHp59Dx01i3pcXI8gdj64DlVP4OxMT1VFq2ZxJSzfjlmlVamKlZZlkcFzj6wx6putL-XzCQBzGLbTBWgqr29_HC8AMkLOxF0Z5KAq78o1crQtgx5Vc7fMdkx9vlVE4qNa79v3mn_VntAeSbNpV0FqT8QRmEasEyL_7Nx9K-TPab04GP4o5RHVE8oI9-sLsWeh4CeVA","UiLocales":null,"Nonce":"637018886065343962.MTcwMTc0MGQtMWFiYS00MjBkLThiMmItZmYwMzU4OGMyYTQzMTcxZmZjYzktOTQxNi00OGVkLTg2ZGMtZjIwYzU5MzEwMTcz","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"47fe6affa600fe3e3a38d817d213e0b1","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/home/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637018886065343962.MTcwMTc0MGQtMWFiYS00MjBkLThiMmItZmYwMzU4OGMyYTQzMTcxZmZjYzktOTQxNi00OGVkLTg2ZGMtZjIwYzU5MzEwMTcz","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9OcXi4id65amhERxMXcV4ndRM4J0UHlFPxr-6IW0Kvn_Om3ozdVAyfskIv8N7XtApZ6QOzScx8O86V-H0QRTs_Wi79wtt4I70uZhlknkZx80xPFks9ywZ9rYGsPMWHp59Dx01i3pcXI8gdj64DlVP4OxMT1VFq2ZxJSzfjlmlVamKlZZlkcFzj6wx6putL-XzCQBzGLbTBWgqr29_HC8AMkLOxF0Z5KAq78o1crQtgx5Vc7fMdkx9vlVE4qNa79v3mn_VntAeSbNpV0FqT8QRmEasEyL_7Nx9K-TPab04GP4o5RHVE8oI9-sLsWeh4CeVA","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-20 12:03:26.572 +03:00 [DBG] Client is configured to not require consent, no consent is required
2019-08-20 12:03:26.572 +03:00 [DBG] Creating Hybrid Flow response.
2019-08-20 12:03:26.573 +03:00 [DBG] Creating Implicit Flow response.
2019-08-20 12:03:26.574 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 12:03:26.575 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 12:03:26.579 +03:00 [DBG] Authorize endpoint response
{"SubjectId":"1","ClientId":"mvc","RedirectUri":"http://localhost:5002/home/signin-oidc","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9OcXi4id65amhERxMXcV4ndRM4J0UHlFPxr-6IW0Kvn_Om3ozdVAyfskIv8N7XtApZ6QOzScx8O86V-H0QRTs_Wi79wtt4I70uZhlknkZx80xPFks9ywZ9rYGsPMWHp59Dx01i3pcXI8gdj64DlVP4OxMT1VFq2ZxJSzfjlmlVamKlZZlkcFzj6wx6putL-XzCQBzGLbTBWgqr29_HC8AMkLOxF0Z5KAq78o1crQtgx5Vc7fMdkx9vlVE4qNa79v3mn_VntAeSbNpV0FqT8QRmEasEyL_7Nx9K-TPab04GP4o5RHVE8oI9-sLsWeh4CeVA","Scope":"openid profile afcpayroll offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-08-20 12:03:26.829 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-20 12:03:26.830 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-20 12:03:26.831 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-20 12:03:26.831 +03:00 [DBG] Start token request.
2019-08-20 12:03:26.832 +03:00 [DBG] Start client validation
2019-08-20 12:03:26.835 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-20 12:03:26.835 +03:00 [DBG] Start parsing for secret in post body
2019-08-20 12:03:26.836 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-20 12:03:26.836 +03:00 [DBG] Secret id found: mvc
2019-08-20 12:03:26.837 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:03:26.837 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-20 12:03:26.838 +03:00 [DBG] Client validation success
2019-08-20 12:03:26.838 +03:00 [DBG] Start token request validation
2019-08-20 12:03:26.839 +03:00 [DBG] Start validation of authorization code token request
2019-08-20 12:03:26.839 +03:00 [DBG] Validation of authorization code token request success
2019-08-20 12:03:26.840 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"95c1cac81bc50e18166cff15a4bed55f721927cee5c070814aaa387cad61090c","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"mvc","client_secret":"***REDACTED***","code":"95c1cac81bc50e18166cff15a4bed55f721927cee5c070814aaa387cad61090c","grant_type":"authorization_code","redirect_uri":"http://localhost:5002/home/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-08-20 12:03:26.844 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:03:26.845 +03:00 [DBG] Getting claims for access token for client: mvc
2019-08-20 12:03:26.845 +03:00 [DBG] Getting claims for access token for subject: 1
2019-08-20 12:03:26.850 +03:00 [DBG] Creating refresh token
2019-08-20 12:03:26.850 +03:00 [DBG] Setting an absolute lifetime: 2592000
2019-08-20 12:03:26.851 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:03:26.855 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 12:03:26.856 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 12:03:26.860 +03:00 [DBG] Token request success.
2019-08-20 12:03:26.865 +03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-08-20 12:03:26.866 +03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-08-20 12:03:26.867 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-08-20 12:03:26.867 +03:00 [DBG] Start userinfo request
2019-08-20 12:03:26.867 +03:00 [DBG] Bearer token found in header
2019-08-20 12:03:26.870 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:03:26.871 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:03:26.871 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-08-20 12:03:26.872 +03:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1566291806,"exp":1566291866,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","afcpayroll"],"client_id":"mvc","sub":"1","auth_time":1566291753,"idp":"local","name":"alice","email":"alice@email.com","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-08-20 12:03:26.876 +03:00 [DBG] Creating userinfo response
2019-08-20 12:03:26.876 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 12:03:26.877 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 12:03:26.877 +03:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 12:03:26.878 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 12:03:26.878 +03:00 [INF] Profile service returned the following claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 12:03:26.879 +03:00 [DBG] End userinfo request
2019-08-20 12:03:28.439 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-08-20 12:03:28.440 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-08-20 12:03:28.440 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-08-20 12:03:28.441 +03:00 [DBG] Start authorize request
2019-08-20 12:03:28.444 +03:00 [DBG] User in authorize request: 1
2019-08-20 12:03:28.445 +03:00 [DBG] Start authorize request protocol validation
2019-08-20 12:03:28.446 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:03:28.448 +03:00 [DBG] Checking for PKCE parameters
2019-08-20 12:03:28.449 +03:00 [DBG] No PKCE used.
2019-08-20 12:03:28.450 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-20 12:03:28.450 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/home/signin-oidc","AllowedRedirectUris":["http://localhost:5002/home/signin-oidc"],"SubjectId":"1","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9Nilfviazxp4762qeldpCBcOhPAyXqmgJy4J6r0VAHMFZ1MLvF6PcZ5WJ4-pXwyfFUj53nmfpYKYDWjjXhW5vJcZf2HAdkc6BNW5K6iM5JZzZXy25TAmV0pa6ibp5FBKNTogp3qyxNdBRWS-XLZYIo1lWfbTxsEzDr6vnZJzj_8cmT7vPypvjGYiGlFQUyqYWc-QiUXZbIdgNxGKHkNIurP2t7LJCfJjediEynZbUPc6W9MKBdG--VnBRmtvivkr2q9ONy2JTEDI8W3Fn53-bhW5qZqQAWHyc3w-9aWX2T6C5GZUCbYlI4ZkKcPnk7ih9o","UiLocales":null,"Nonce":"637018886084215023.MjM0OWM2ZTctZjZlNC00NjBlLWFkYmEtNTgwMDc5YTFlYzQ3YTEzZmRhNjgtOTgyYy00MmNjLTgxMzYtNzA5YjgyNWI5ZTYx","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"47fe6affa600fe3e3a38d817d213e0b1","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/home/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637018886084215023.MjM0OWM2ZTctZjZlNC00NjBlLWFkYmEtNTgwMDc5YTFlYzQ3YTEzZmRhNjgtOTgyYy00MmNjLTgxMzYtNzA5YjgyNWI5ZTYx","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9Nilfviazxp4762qeldpCBcOhPAyXqmgJy4J6r0VAHMFZ1MLvF6PcZ5WJ4-pXwyfFUj53nmfpYKYDWjjXhW5vJcZf2HAdkc6BNW5K6iM5JZzZXy25TAmV0pa6ibp5FBKNTogp3qyxNdBRWS-XLZYIo1lWfbTxsEzDr6vnZJzj_8cmT7vPypvjGYiGlFQUyqYWc-QiUXZbIdgNxGKHkNIurP2t7LJCfJjediEynZbUPc6W9MKBdG--VnBRmtvivkr2q9ONy2JTEDI8W3Fn53-bhW5qZqQAWHyc3w-9aWX2T6C5GZUCbYlI4ZkKcPnk7ih9o","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-20 12:03:28.456 +03:00 [DBG] Client is configured to not require consent, no consent is required
2019-08-20 12:03:28.456 +03:00 [DBG] Creating Hybrid Flow response.
2019-08-20 12:03:28.457 +03:00 [DBG] Creating Implicit Flow response.
2019-08-20 12:03:28.457 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 12:03:28.458 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 12:03:28.462 +03:00 [DBG] Authorize endpoint response
{"SubjectId":"1","ClientId":"mvc","RedirectUri":"http://localhost:5002/home/signin-oidc","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9Nilfviazxp4762qeldpCBcOhPAyXqmgJy4J6r0VAHMFZ1MLvF6PcZ5WJ4-pXwyfFUj53nmfpYKYDWjjXhW5vJcZf2HAdkc6BNW5K6iM5JZzZXy25TAmV0pa6ibp5FBKNTogp3qyxNdBRWS-XLZYIo1lWfbTxsEzDr6vnZJzj_8cmT7vPypvjGYiGlFQUyqYWc-QiUXZbIdgNxGKHkNIurP2t7LJCfJjediEynZbUPc6W9MKBdG--VnBRmtvivkr2q9ONy2JTEDI8W3Fn53-bhW5qZqQAWHyc3w-9aWX2T6C5GZUCbYlI4ZkKcPnk7ih9o","Scope":"openid profile afcpayroll offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-08-20 12:03:28.726 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-20 12:03:28.729 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-20 12:03:28.729 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-20 12:03:28.730 +03:00 [DBG] Start token request.
2019-08-20 12:03:28.731 +03:00 [DBG] Start client validation
2019-08-20 12:03:28.731 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-20 12:03:28.732 +03:00 [DBG] Start parsing for secret in post body
2019-08-20 12:03:28.733 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-20 12:03:28.733 +03:00 [DBG] Secret id found: mvc
2019-08-20 12:03:28.734 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:03:28.735 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-20 12:03:28.735 +03:00 [DBG] Client validation success
2019-08-20 12:03:28.736 +03:00 [DBG] Start token request validation
2019-08-20 12:03:28.736 +03:00 [DBG] Start validation of authorization code token request
2019-08-20 12:03:28.737 +03:00 [DBG] Validation of authorization code token request success
2019-08-20 12:03:28.737 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"8ec7e932cde8b93fdef201ca7e036e6f0699249d2c708edaefbbab4742f6822b","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"mvc","client_secret":"***REDACTED***","code":"8ec7e932cde8b93fdef201ca7e036e6f0699249d2c708edaefbbab4742f6822b","grant_type":"authorization_code","redirect_uri":"http://localhost:5002/home/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-08-20 12:03:28.742 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:03:28.743 +03:00 [DBG] Getting claims for access token for client: mvc
2019-08-20 12:03:28.743 +03:00 [DBG] Getting claims for access token for subject: 1
2019-08-20 12:03:28.747 +03:00 [DBG] Creating refresh token
2019-08-20 12:03:28.748 +03:00 [DBG] Setting an absolute lifetime: 2592000
2019-08-20 12:03:28.748 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:03:28.749 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 12:03:28.750 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 12:03:28.754 +03:00 [DBG] Token request success.
2019-08-20 12:03:28.757 +03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-08-20 12:03:28.757 +03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-08-20 12:03:28.758 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-08-20 12:03:28.758 +03:00 [DBG] Start userinfo request
2019-08-20 12:03:28.759 +03:00 [DBG] Bearer token found in header
2019-08-20 12:03:28.762 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:03:28.762 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:03:28.763 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-08-20 12:03:28.764 +03:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1566291808,"exp":1566291868,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","afcpayroll"],"client_id":"mvc","sub":"1","auth_time":1566291753,"idp":"local","name":"alice","email":"alice@email.com","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-08-20 12:03:28.768 +03:00 [DBG] Creating userinfo response
2019-08-20 12:03:28.768 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 12:03:28.769 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 12:03:28.769 +03:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 12:03:28.770 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 12:03:28.770 +03:00 [INF] Profile service returned the following claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 12:03:28.771 +03:00 [DBG] End userinfo request
2019-08-20 12:04:11.135 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-08-20 12:04:11.143 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-08-20 12:04:11.144 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-08-20 12:04:11.145 +03:00 [DBG] Start authorize request
2019-08-20 12:04:11.145 +03:00 [DBG] No user present in authorize request
2019-08-20 12:04:11.146 +03:00 [DBG] Start authorize request protocol validation
2019-08-20 12:04:11.146 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:04:11.148 +03:00 [DBG] Checking for PKCE parameters
2019-08-20 12:04:11.149 +03:00 [DBG] No PKCE used.
2019-08-20 12:04:11.150 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-20 12:04:11.150 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/home/signin-oidc","AllowedRedirectUris":["http://localhost:5002/home/signin-oidc"],"SubjectId":"anonymous","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9PTYRtzhD43Y4wX7hWJO1G5rtCHIiG6hNgKEFIO97Vvn0wFsBBsiogkgHcTlMBrKyuc2NfUJue5FPlk3ifNCaTGQCS1SXemFCIwuUG1d73Pgbl675sYtsxV05ULWXkOim6BJkngZf0CwFZbNhxevcCESU4HB2DXob19XfDtA70hUyJEk9CW1liEdOpIXBujKuQ1Ox48aWjGY15KtY7pjFzXec_ORZADqkXTfTi1KIZztKeemOj-IcsiX8xOzurnPxvIu-gv1Qb_6QPGI1ZOzNJBRGggy6eHrmAxSynwVF-xNLT85iO7Tczv-BXu0_LekF0","UiLocales":null,"Nonce":"637018886511089366.NGY2MjZhZDktNTJjZC00ZTllLThkOTItYWQ0Yjk3MjI5ODNkYTVhMzQ5ZDQtODQ1Ny00M2U1LWJkNzctMDUyMGI2M2VlY2U1","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/home/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637018886511089366.NGY2MjZhZDktNTJjZC00ZTllLThkOTItYWQ0Yjk3MjI5ODNkYTVhMzQ5ZDQtODQ1Ny00M2U1LWJkNzctMDUyMGI2M2VlY2U1","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9PTYRtzhD43Y4wX7hWJO1G5rtCHIiG6hNgKEFIO97Vvn0wFsBBsiogkgHcTlMBrKyuc2NfUJue5FPlk3ifNCaTGQCS1SXemFCIwuUG1d73Pgbl675sYtsxV05ULWXkOim6BJkngZf0CwFZbNhxevcCESU4HB2DXob19XfDtA70hUyJEk9CW1liEdOpIXBujKuQ1Ox48aWjGY15KtY7pjFzXec_ORZADqkXTfTi1KIZztKeemOj-IcsiX8xOzurnPxvIu-gv1Qb_6QPGI1ZOzNJBRGggy6eHrmAxSynwVF-xNLT85iO7Tczv-BXu0_LekF0","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-20 12:04:11.157 +03:00 [INF] Showing login: User is not authenticated
2019-08-20 12:04:11.169 +03:00 [DBG] Start authorize request protocol validation
2019-08-20 12:04:11.170 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:04:11.170 +03:00 [DBG] Checking for PKCE parameters
2019-08-20 12:04:11.171 +03:00 [DBG] No PKCE used.
2019-08-20 12:04:11.171 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-20 12:04:11.172 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:04:35.496 +03:00 [DBG] CORS request made for path: /account/login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-08-20 12:04:35.506 +03:00 [DBG] Start authorize request protocol validation
2019-08-20 12:04:35.509 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:04:35.514 +03:00 [DBG] Checking for PKCE parameters
2019-08-20 12:04:35.514 +03:00 [DBG] No PKCE used.
2019-08-20 12:04:35.515 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-20 12:04:35.516 +03:00 [DBG] Augmenting SignInContext
2019-08-20 12:04:35.516 +03:00 [DBG] Adding idp claim with value: local
2019-08-20 12:04:35.517 +03:00 [DBG] Adding amr claim with value: pwd
2019-08-20 12:04:35.517 +03:00 [INF] AuthenticationScheme: idsrv signed in.
2019-08-20 12:04:35.518 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:04:35.533 +03:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-08-20 12:04:35.535 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-08-20 12:04:35.536 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-08-20 12:04:35.536 +03:00 [DBG] Start authorize callback request
2019-08-20 12:04:35.537 +03:00 [DBG] User in authorize request: 1
2019-08-20 12:04:35.537 +03:00 [DBG] Start authorize request protocol validation
2019-08-20 12:04:35.538 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:04:35.539 +03:00 [DBG] Checking for PKCE parameters
2019-08-20 12:04:35.539 +03:00 [DBG] No PKCE used.
2019-08-20 12:04:35.539 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-20 12:04:35.540 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/home/signin-oidc","AllowedRedirectUris":["http://localhost:5002/home/signin-oidc"],"SubjectId":"1","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9PTYRtzhD43Y4wX7hWJO1G5rtCHIiG6hNgKEFIO97Vvn0wFsBBsiogkgHcTlMBrKyuc2NfUJue5FPlk3ifNCaTGQCS1SXemFCIwuUG1d73Pgbl675sYtsxV05ULWXkOim6BJkngZf0CwFZbNhxevcCESU4HB2DXob19XfDtA70hUyJEk9CW1liEdOpIXBujKuQ1Ox48aWjGY15KtY7pjFzXec_ORZADqkXTfTi1KIZztKeemOj-IcsiX8xOzurnPxvIu-gv1Qb_6QPGI1ZOzNJBRGggy6eHrmAxSynwVF-xNLT85iO7Tczv-BXu0_LekF0","UiLocales":null,"Nonce":"637018886511089366.NGY2MjZhZDktNTJjZC00ZTllLThkOTItYWQ0Yjk3MjI5ODNkYTVhMzQ5ZDQtODQ1Ny00M2U1LWJkNzctMDUyMGI2M2VlY2U1","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"f18722ec2c927d69611a5fc40c1ebd21","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/home/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637018886511089366.NGY2MjZhZDktNTJjZC00ZTllLThkOTItYWQ0Yjk3MjI5ODNkYTVhMzQ5ZDQtODQ1Ny00M2U1LWJkNzctMDUyMGI2M2VlY2U1","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9PTYRtzhD43Y4wX7hWJO1G5rtCHIiG6hNgKEFIO97Vvn0wFsBBsiogkgHcTlMBrKyuc2NfUJue5FPlk3ifNCaTGQCS1SXemFCIwuUG1d73Pgbl675sYtsxV05ULWXkOim6BJkngZf0CwFZbNhxevcCESU4HB2DXob19XfDtA70hUyJEk9CW1liEdOpIXBujKuQ1Ox48aWjGY15KtY7pjFzXec_ORZADqkXTfTi1KIZztKeemOj-IcsiX8xOzurnPxvIu-gv1Qb_6QPGI1ZOzNJBRGggy6eHrmAxSynwVF-xNLT85iO7Tczv-BXu0_LekF0","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-20 12:04:35.560 +03:00 [DBG] Client is configured to not require consent, no consent is required
2019-08-20 12:04:35.561 +03:00 [DBG] Creating Hybrid Flow response.
2019-08-20 12:04:35.561 +03:00 [DBG] Creating Implicit Flow response.
2019-08-20 12:04:35.562 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 12:04:35.572 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 12:04:35.576 +03:00 [DBG] Authorize endpoint response
{"SubjectId":"1","ClientId":"mvc","RedirectUri":"http://localhost:5002/home/signin-oidc","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9PTYRtzhD43Y4wX7hWJO1G5rtCHIiG6hNgKEFIO97Vvn0wFsBBsiogkgHcTlMBrKyuc2NfUJue5FPlk3ifNCaTGQCS1SXemFCIwuUG1d73Pgbl675sYtsxV05ULWXkOim6BJkngZf0CwFZbNhxevcCESU4HB2DXob19XfDtA70hUyJEk9CW1liEdOpIXBujKuQ1Ox48aWjGY15KtY7pjFzXec_ORZADqkXTfTi1KIZztKeemOj-IcsiX8xOzurnPxvIu-gv1Qb_6QPGI1ZOzNJBRGggy6eHrmAxSynwVF-xNLT85iO7Tczv-BXu0_LekF0","Scope":"openid profile afcpayroll offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-08-20 12:04:35.579 +03:00 [DBG] Augmenting SignInContext
2019-08-20 12:04:35.588 +03:00 [INF] AuthenticationScheme: idsrv signed in.
2019-08-20 12:04:35.833 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-20 12:04:35.837 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-20 12:04:35.838 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-20 12:04:35.838 +03:00 [DBG] Start token request.
2019-08-20 12:04:35.839 +03:00 [DBG] Start client validation
2019-08-20 12:04:35.839 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-20 12:04:35.839 +03:00 [DBG] Start parsing for secret in post body
2019-08-20 12:04:35.840 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-20 12:04:35.840 +03:00 [DBG] Secret id found: mvc
2019-08-20 12:04:35.841 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:04:35.842 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-20 12:04:35.842 +03:00 [DBG] Client validation success
2019-08-20 12:04:35.843 +03:00 [DBG] Start token request validation
2019-08-20 12:04:35.843 +03:00 [DBG] Start validation of authorization code token request
2019-08-20 12:04:35.844 +03:00 [DBG] Validation of authorization code token request success
2019-08-20 12:04:35.844 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"ce1172018f0b2f8be9c62dc27bbdd71d549a77c9b770b8f7bdeb72e2adb4adcc","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"mvc","client_secret":"***REDACTED***","code":"ce1172018f0b2f8be9c62dc27bbdd71d549a77c9b770b8f7bdeb72e2adb4adcc","grant_type":"authorization_code","redirect_uri":"http://localhost:5002/home/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-08-20 12:04:35.865 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:04:35.866 +03:00 [DBG] Getting claims for access token for client: mvc
2019-08-20 12:04:35.868 +03:00 [DBG] Getting claims for access token for subject: 1
2019-08-20 12:04:35.873 +03:00 [DBG] Creating refresh token
2019-08-20 12:04:35.876 +03:00 [DBG] Setting an absolute lifetime: 2592000
2019-08-20 12:04:35.877 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:04:35.878 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 12:04:35.878 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 12:04:35.883 +03:00 [DBG] Token request success.
2019-08-20 12:04:35.900 +03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-08-20 12:04:35.900 +03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-08-20 12:04:35.901 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-08-20 12:04:35.906 +03:00 [DBG] Start userinfo request
2019-08-20 12:04:35.906 +03:00 [DBG] Bearer token found in header
2019-08-20 12:04:35.909 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:04:35.911 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:04:35.916 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-08-20 12:04:35.923 +03:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1566291875,"exp":1566291935,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","afcpayroll"],"client_id":"mvc","sub":"1","auth_time":1566291875,"idp":"local","name":"alice","email":"alice@email.com","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-08-20 12:04:35.927 +03:00 [DBG] Creating userinfo response
2019-08-20 12:04:35.927 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 12:04:35.927 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 12:04:35.928 +03:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 12:04:35.928 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 12:04:35.929 +03:00 [INF] Profile service returned the following claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 12:04:35.929 +03:00 [DBG] End userinfo request
2019-08-20 12:04:41.646 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-08-20 12:04:41.657 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-08-20 12:04:41.659 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-08-20 12:04:41.660 +03:00 [DBG] Start authorize request
2019-08-20 12:04:41.661 +03:00 [DBG] User in authorize request: 1
2019-08-20 12:04:41.661 +03:00 [DBG] Start authorize request protocol validation
2019-08-20 12:04:41.662 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:04:41.662 +03:00 [DBG] Checking for PKCE parameters
2019-08-20 12:04:41.663 +03:00 [DBG] No PKCE used.
2019-08-20 12:04:41.663 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-20 12:04:41.664 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/home/signin-oidc","AllowedRedirectUris":["http://localhost:5002/home/signin-oidc"],"SubjectId":"1","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9NB_A2VTfJllI_hviL-VVVC068PLlZTxtNfZkdIRiJiZ_-IWPnTE3BgZVTwnfe7zHsyQbaB2NI0s2rQ-VaNsoRdKhKoGZIspu4EuG85T4FAPiXYtmG2zyDSPpGVJBI09UD9zNeAyU9uCvHWCSaSr267McD0u5e59VYZz49XlSgVsWsWKYijhcAKeTN4u97axmwRM3k07Yxmz28j4wTjaL4laOFxuOHuwiN2WFRvoqbVl-xOCcnrzW94w-5vKnYd-L6LRxmXs0qJvQVnXvdfLJyJ_IuPqj9BERXlc79za32i01oy5scACYnME8AAbDT8R_E","UiLocales":null,"Nonce":"637018886816286756.MGM3Mjc2M2ItNzViYy00YWNhLTk2N2ItYzg1NTExNzk4MjBjN2FkNzdkZTYtNTVmNS00OWEzLTg0NzEtNGNiMTkzZmVhN2Uy","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"f18722ec2c927d69611a5fc40c1ebd21","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/home/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637018886816286756.MGM3Mjc2M2ItNzViYy00YWNhLTk2N2ItYzg1NTExNzk4MjBjN2FkNzdkZTYtNTVmNS00OWEzLTg0NzEtNGNiMTkzZmVhN2Uy","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9NB_A2VTfJllI_hviL-VVVC068PLlZTxtNfZkdIRiJiZ_-IWPnTE3BgZVTwnfe7zHsyQbaB2NI0s2rQ-VaNsoRdKhKoGZIspu4EuG85T4FAPiXYtmG2zyDSPpGVJBI09UD9zNeAyU9uCvHWCSaSr267McD0u5e59VYZz49XlSgVsWsWKYijhcAKeTN4u97axmwRM3k07Yxmz28j4wTjaL4laOFxuOHuwiN2WFRvoqbVl-xOCcnrzW94w-5vKnYd-L6LRxmXs0qJvQVnXvdfLJyJ_IuPqj9BERXlc79za32i01oy5scACYnME8AAbDT8R_E","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-20 12:04:41.682 +03:00 [DBG] Client is configured to not require consent, no consent is required
2019-08-20 12:04:41.683 +03:00 [DBG] Creating Hybrid Flow response.
2019-08-20 12:04:41.683 +03:00 [DBG] Creating Implicit Flow response.
2019-08-20 12:04:41.684 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 12:04:41.694 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 12:04:41.699 +03:00 [DBG] Authorize endpoint response
{"SubjectId":"1","ClientId":"mvc","RedirectUri":"http://localhost:5002/home/signin-oidc","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9NB_A2VTfJllI_hviL-VVVC068PLlZTxtNfZkdIRiJiZ_-IWPnTE3BgZVTwnfe7zHsyQbaB2NI0s2rQ-VaNsoRdKhKoGZIspu4EuG85T4FAPiXYtmG2zyDSPpGVJBI09UD9zNeAyU9uCvHWCSaSr267McD0u5e59VYZz49XlSgVsWsWKYijhcAKeTN4u97axmwRM3k07Yxmz28j4wTjaL4laOFxuOHuwiN2WFRvoqbVl-xOCcnrzW94w-5vKnYd-L6LRxmXs0qJvQVnXvdfLJyJ_IuPqj9BERXlc79za32i01oy5scACYnME8AAbDT8R_E","Scope":"openid profile afcpayroll offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-08-20 12:04:41.929 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-20 12:04:41.933 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-20 12:04:41.934 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-20 12:04:41.934 +03:00 [DBG] Start token request.
2019-08-20 12:04:41.935 +03:00 [DBG] Start client validation
2019-08-20 12:04:41.935 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-20 12:04:41.935 +03:00 [DBG] Start parsing for secret in post body
2019-08-20 12:04:41.936 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-20 12:04:41.936 +03:00 [DBG] Secret id found: mvc
2019-08-20 12:04:41.937 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:04:41.937 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-20 12:04:41.938 +03:00 [DBG] Client validation success
2019-08-20 12:04:41.938 +03:00 [DBG] Start token request validation
2019-08-20 12:04:41.938 +03:00 [DBG] Start validation of authorization code token request
2019-08-20 12:04:41.939 +03:00 [DBG] Validation of authorization code token request success
2019-08-20 12:04:41.939 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"f69342391acea354851ac3586e35bc6916254c44b9c8ba59b7e8465d6eadebac","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"mvc","client_secret":"***REDACTED***","code":"f69342391acea354851ac3586e35bc6916254c44b9c8ba59b7e8465d6eadebac","grant_type":"authorization_code","redirect_uri":"http://localhost:5002/home/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-08-20 12:04:41.959 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:04:41.959 +03:00 [DBG] Getting claims for access token for client: mvc
2019-08-20 12:04:41.960 +03:00 [DBG] Getting claims for access token for subject: 1
2019-08-20 12:04:41.964 +03:00 [DBG] Creating refresh token
2019-08-20 12:04:41.964 +03:00 [DBG] Setting an absolute lifetime: 2592000
2019-08-20 12:04:41.965 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:04:41.965 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 12:04:41.966 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 12:04:41.970 +03:00 [DBG] Token request success.
2019-08-20 12:04:41.979 +03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-08-20 12:04:41.980 +03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-08-20 12:04:41.981 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-08-20 12:04:41.981 +03:00 [DBG] Start userinfo request
2019-08-20 12:04:41.982 +03:00 [DBG] Bearer token found in header
2019-08-20 12:04:41.984 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:04:41.991 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:04:41.991 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-08-20 12:04:41.992 +03:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1566291881,"exp":1566291941,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","afcpayroll"],"client_id":"mvc","sub":"1","auth_time":1566291875,"idp":"local","name":"alice","email":"alice@email.com","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-08-20 12:04:41.995 +03:00 [DBG] Creating userinfo response
2019-08-20 12:04:41.996 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 12:04:41.998 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 12:04:41.999 +03:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 12:04:42.010 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 12:04:42.010 +03:00 [INF] Profile service returned the following claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 12:04:42.011 +03:00 [DBG] End userinfo request
2019-08-20 12:07:01.600 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-20 12:07:01.602 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-20 12:07:01.603 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-20 12:07:01.604 +03:00 [DBG] Start discovery request
2019-08-20 12:07:01.669 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-20 12:07:01.670 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-20 12:07:01.670 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-20 12:07:01.671 +03:00 [DBG] Start key discovery request
2019-08-20 12:07:01.753 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-08-20 12:07:01.754 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-08-20 12:07:01.755 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-08-20 12:07:01.755 +03:00 [DBG] Start authorize request
2019-08-20 12:07:01.756 +03:00 [DBG] No user present in authorize request
2019-08-20 12:07:01.757 +03:00 [DBG] Start authorize request protocol validation
2019-08-20 12:07:01.758 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:07:01.759 +03:00 [DBG] Checking for PKCE parameters
2019-08-20 12:07:01.759 +03:00 [DBG] No PKCE used.
2019-08-20 12:07:01.759 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-20 12:07:01.760 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/home/signin-oidc","AllowedRedirectUris":["http://localhost:5002/home/signin-oidc"],"SubjectId":"anonymous","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9N1wX6gzBTk35pIbnVxUH5tZufsTTlMJU67oC61nZQF6KRWLWZzZr6kp7uAiuw-B_qR_uJPp4spGiRJt1RA6eE84f5_n1xu3PxCLZaeGUid1FKs_xsTLrlqygUP_Uab5E--GzXSfVY7Hkni9GI89--a8mHTixlOubOkONfMLF0KyXPwZl9ZBH1pp4hze3Gr_ddy1f3V_UkPh6VsqvFJEkWxfWeDa4EBm7iPjKVEqMDT-SomkyIHf7AlywcsfyIPWavlFbAFKpDe4rdetl7zyiEvcr-wNjBPwHooR71wm4HjQmgmB3-GHzgQQW39ewQKCgY","UiLocales":null,"Nonce":"637018888216903551.ZWYxYmYzNTUtNjk5NS00NTc4LWFkMDItODc4YWU5OGM2YTk0ZGQwMDAwMmQtM2M0Ny00OGY5LTkzZDUtNDVhZDI3MmE0NmYx","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/home/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637018888216903551.ZWYxYmYzNTUtNjk5NS00NTc4LWFkMDItODc4YWU5OGM2YTk0ZGQwMDAwMmQtM2M0Ny00OGY5LTkzZDUtNDVhZDI3MmE0NmYx","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9N1wX6gzBTk35pIbnVxUH5tZufsTTlMJU67oC61nZQF6KRWLWZzZr6kp7uAiuw-B_qR_uJPp4spGiRJt1RA6eE84f5_n1xu3PxCLZaeGUid1FKs_xsTLrlqygUP_Uab5E--GzXSfVY7Hkni9GI89--a8mHTixlOubOkONfMLF0KyXPwZl9ZBH1pp4hze3Gr_ddy1f3V_UkPh6VsqvFJEkWxfWeDa4EBm7iPjKVEqMDT-SomkyIHf7AlywcsfyIPWavlFbAFKpDe4rdetl7zyiEvcr-wNjBPwHooR71wm4HjQmgmB3-GHzgQQW39ewQKCgY","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-20 12:07:01.766 +03:00 [INF] Showing login: User is not authenticated
2019-08-20 12:07:01.777 +03:00 [DBG] Start authorize request protocol validation
2019-08-20 12:07:01.778 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:07:01.778 +03:00 [DBG] Checking for PKCE parameters
2019-08-20 12:07:01.779 +03:00 [DBG] No PKCE used.
2019-08-20 12:07:01.779 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-20 12:07:01.780 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:07:04.433 +03:00 [DBG] CORS request made for path: /account/login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-08-20 12:07:04.435 +03:00 [DBG] Start authorize request protocol validation
2019-08-20 12:07:04.436 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:07:04.437 +03:00 [DBG] Checking for PKCE parameters
2019-08-20 12:07:04.437 +03:00 [DBG] No PKCE used.
2019-08-20 12:07:04.438 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-20 12:07:04.439 +03:00 [DBG] Augmenting SignInContext
2019-08-20 12:07:04.440 +03:00 [DBG] Adding idp claim with value: local
2019-08-20 12:07:04.442 +03:00 [DBG] Adding amr claim with value: pwd
2019-08-20 12:07:04.443 +03:00 [INF] AuthenticationScheme: idsrv signed in.
2019-08-20 12:07:04.444 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:07:04.456 +03:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-08-20 12:07:04.457 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-08-20 12:07:04.458 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-08-20 12:07:04.458 +03:00 [DBG] Start authorize callback request
2019-08-20 12:07:04.459 +03:00 [DBG] User in authorize request: 1
2019-08-20 12:07:04.459 +03:00 [DBG] Start authorize request protocol validation
2019-08-20 12:07:04.460 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:07:04.461 +03:00 [DBG] Checking for PKCE parameters
2019-08-20 12:07:04.461 +03:00 [DBG] No PKCE used.
2019-08-20 12:07:04.462 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-20 12:07:04.465 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/home/signin-oidc","AllowedRedirectUris":["http://localhost:5002/home/signin-oidc"],"SubjectId":"1","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9N1wX6gzBTk35pIbnVxUH5tZufsTTlMJU67oC61nZQF6KRWLWZzZr6kp7uAiuw-B_qR_uJPp4spGiRJt1RA6eE84f5_n1xu3PxCLZaeGUid1FKs_xsTLrlqygUP_Uab5E--GzXSfVY7Hkni9GI89--a8mHTixlOubOkONfMLF0KyXPwZl9ZBH1pp4hze3Gr_ddy1f3V_UkPh6VsqvFJEkWxfWeDa4EBm7iPjKVEqMDT-SomkyIHf7AlywcsfyIPWavlFbAFKpDe4rdetl7zyiEvcr-wNjBPwHooR71wm4HjQmgmB3-GHzgQQW39ewQKCgY","UiLocales":null,"Nonce":"637018888216903551.ZWYxYmYzNTUtNjk5NS00NTc4LWFkMDItODc4YWU5OGM2YTk0ZGQwMDAwMmQtM2M0Ny00OGY5LTkzZDUtNDVhZDI3MmE0NmYx","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"edd725bd270d0aacdb7ab4696261b6f1","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/home/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637018888216903551.ZWYxYmYzNTUtNjk5NS00NTc4LWFkMDItODc4YWU5OGM2YTk0ZGQwMDAwMmQtM2M0Ny00OGY5LTkzZDUtNDVhZDI3MmE0NmYx","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9N1wX6gzBTk35pIbnVxUH5tZufsTTlMJU67oC61nZQF6KRWLWZzZr6kp7uAiuw-B_qR_uJPp4spGiRJt1RA6eE84f5_n1xu3PxCLZaeGUid1FKs_xsTLrlqygUP_Uab5E--GzXSfVY7Hkni9GI89--a8mHTixlOubOkONfMLF0KyXPwZl9ZBH1pp4hze3Gr_ddy1f3V_UkPh6VsqvFJEkWxfWeDa4EBm7iPjKVEqMDT-SomkyIHf7AlywcsfyIPWavlFbAFKpDe4rdetl7zyiEvcr-wNjBPwHooR71wm4HjQmgmB3-GHzgQQW39ewQKCgY","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-20 12:07:04.474 +03:00 [DBG] Client is configured to not require consent, no consent is required
2019-08-20 12:07:04.475 +03:00 [DBG] Creating Hybrid Flow response.
2019-08-20 12:07:04.481 +03:00 [DBG] Creating Implicit Flow response.
2019-08-20 12:07:04.484 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 12:07:04.485 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 12:07:04.490 +03:00 [DBG] Authorize endpoint response
{"SubjectId":"1","ClientId":"mvc","RedirectUri":"http://localhost:5002/home/signin-oidc","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9N1wX6gzBTk35pIbnVxUH5tZufsTTlMJU67oC61nZQF6KRWLWZzZr6kp7uAiuw-B_qR_uJPp4spGiRJt1RA6eE84f5_n1xu3PxCLZaeGUid1FKs_xsTLrlqygUP_Uab5E--GzXSfVY7Hkni9GI89--a8mHTixlOubOkONfMLF0KyXPwZl9ZBH1pp4hze3Gr_ddy1f3V_UkPh6VsqvFJEkWxfWeDa4EBm7iPjKVEqMDT-SomkyIHf7AlywcsfyIPWavlFbAFKpDe4rdetl7zyiEvcr-wNjBPwHooR71wm4HjQmgmB3-GHzgQQW39ewQKCgY","Scope":"openid profile afcpayroll offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-08-20 12:07:04.492 +03:00 [DBG] Augmenting SignInContext
2019-08-20 12:07:04.493 +03:00 [INF] AuthenticationScheme: idsrv signed in.
2019-08-20 12:07:04.848 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-20 12:07:04.849 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-20 12:07:04.849 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-20 12:07:04.850 +03:00 [DBG] Start token request.
2019-08-20 12:07:04.850 +03:00 [DBG] Start client validation
2019-08-20 12:07:04.851 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-20 12:07:04.851 +03:00 [DBG] Start parsing for secret in post body
2019-08-20 12:07:04.852 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-20 12:07:04.852 +03:00 [DBG] Secret id found: mvc
2019-08-20 12:07:04.853 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:07:04.854 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-20 12:07:04.855 +03:00 [DBG] Client validation success
2019-08-20 12:07:04.856 +03:00 [DBG] Start token request validation
2019-08-20 12:07:04.856 +03:00 [DBG] Start validation of authorization code token request
2019-08-20 12:07:04.857 +03:00 [DBG] Validation of authorization code token request success
2019-08-20 12:07:04.857 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"de9af3fe61057f14a38e20cb1c1468c637089f045b37e2d44d4d1a2787632899","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"mvc","client_secret":"***REDACTED***","code":"de9af3fe61057f14a38e20cb1c1468c637089f045b37e2d44d4d1a2787632899","grant_type":"authorization_code","redirect_uri":"http://localhost:5002/home/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-08-20 12:07:04.860 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:07:04.861 +03:00 [DBG] Getting claims for access token for client: mvc
2019-08-20 12:07:04.861 +03:00 [DBG] Getting claims for access token for subject: 1
2019-08-20 12:07:04.866 +03:00 [DBG] Creating refresh token
2019-08-20 12:07:04.867 +03:00 [DBG] Setting an absolute lifetime: 2592000
2019-08-20 12:07:04.868 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:07:04.868 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 12:07:04.869 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 12:07:04.873 +03:00 [DBG] Token request success.
2019-08-20 12:07:04.886 +03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-08-20 12:07:04.888 +03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-08-20 12:07:04.889 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-08-20 12:07:04.890 +03:00 [DBG] Start userinfo request
2019-08-20 12:07:04.891 +03:00 [DBG] Bearer token found in header
2019-08-20 12:07:04.894 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:07:04.895 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:07:04.895 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-08-20 12:07:04.896 +03:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1566292024,"exp":1566292084,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","afcpayroll"],"client_id":"mvc","sub":"1","auth_time":1566292024,"idp":"local","name":"alice","email":"alice@email.com","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-08-20 12:07:04.900 +03:00 [DBG] Creating userinfo response
2019-08-20 12:07:04.900 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 12:07:04.901 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 12:07:04.901 +03:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 12:07:04.902 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 12:07:04.902 +03:00 [INF] Profile service returned the following claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 12:07:04.903 +03:00 [DBG] End userinfo request
2019-08-20 12:19:50.721 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-20 12:19:50.722 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-20 12:19:50.723 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-20 12:19:50.724 +03:00 [DBG] Start discovery request
2019-08-20 12:19:50.861 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-20 12:19:50.862 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-20 12:19:50.863 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-20 12:19:50.864 +03:00 [DBG] Start key discovery request
2019-08-20 12:19:50.931 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-08-20 12:19:50.932 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-08-20 12:19:50.933 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-08-20 12:19:50.933 +03:00 [DBG] Start authorize request
2019-08-20 12:19:50.934 +03:00 [DBG] No user present in authorize request
2019-08-20 12:19:50.935 +03:00 [DBG] Start authorize request protocol validation
2019-08-20 12:19:50.935 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:19:50.936 +03:00 [DBG] Checking for PKCE parameters
2019-08-20 12:19:50.936 +03:00 [DBG] No PKCE used.
2019-08-20 12:19:50.937 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-20 12:19:50.937 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/home/signin-oidc","AllowedRedirectUris":["http://localhost:5002/home/signin-oidc"],"SubjectId":"anonymous","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9P-QT083IfYU96ZY6VhwyHxLJKWoAqTVQakPLytjYbXsopbuIab6xzQtqoog4XGtdv732270YYmywY27qaMWTkRzblt4w4pfJiI83hLcOOP_GcEiLSwcbJQP-6i5533YRjymDhAg8oymoY7asYPGKtCLEZB34xcZa2aaZyqajz9Ze45rEUnw2P0VPWuggFvVGjamR5mDBXT0eralb7ZbglBh3lK3GluxNItia0xtqsYNr3imM7ykTFB5ujElEypvnjcIO1dkHPKDlvadqUS57Eq36MYtPEzpNECPdRcUt80XrBRQvZXKqt1liE8JCZZhfQ","UiLocales":null,"Nonce":"637018895908839944.Y2I0YTllNDAtNjI1OS00NmUxLWFkMmItM2QxMjlkZjI0NTZiZjNjYmQ5YWItNmUwOC00YTA0LWJiZWEtZjA5OWIzZjJkMDI1","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/home/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637018895908839944.Y2I0YTllNDAtNjI1OS00NmUxLWFkMmItM2QxMjlkZjI0NTZiZjNjYmQ5YWItNmUwOC00YTA0LWJiZWEtZjA5OWIzZjJkMDI1","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9P-QT083IfYU96ZY6VhwyHxLJKWoAqTVQakPLytjYbXsopbuIab6xzQtqoog4XGtdv732270YYmywY27qaMWTkRzblt4w4pfJiI83hLcOOP_GcEiLSwcbJQP-6i5533YRjymDhAg8oymoY7asYPGKtCLEZB34xcZa2aaZyqajz9Ze45rEUnw2P0VPWuggFvVGjamR5mDBXT0eralb7ZbglBh3lK3GluxNItia0xtqsYNr3imM7ykTFB5ujElEypvnjcIO1dkHPKDlvadqUS57Eq36MYtPEzpNECPdRcUt80XrBRQvZXKqt1liE8JCZZhfQ","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-20 12:19:50.943 +03:00 [INF] Showing login: User is not authenticated
2019-08-20 12:19:50.956 +03:00 [DBG] Start authorize request protocol validation
2019-08-20 12:19:50.957 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:19:50.958 +03:00 [DBG] Checking for PKCE parameters
2019-08-20 12:19:50.959 +03:00 [DBG] No PKCE used.
2019-08-20 12:19:50.959 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-20 12:19:50.960 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:19:59.342 +03:00 [DBG] CORS request made for path: /account/login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-08-20 12:19:59.347 +03:00 [DBG] Start authorize request protocol validation
2019-08-20 12:19:59.349 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:19:59.350 +03:00 [DBG] Checking for PKCE parameters
2019-08-20 12:19:59.351 +03:00 [DBG] No PKCE used.
2019-08-20 12:19:59.352 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-20 12:19:59.353 +03:00 [DBG] Augmenting SignInContext
2019-08-20 12:19:59.354 +03:00 [DBG] Adding idp claim with value: local
2019-08-20 12:19:59.355 +03:00 [DBG] Adding amr claim with value: pwd
2019-08-20 12:19:59.356 +03:00 [INF] AuthenticationScheme: idsrv signed in.
2019-08-20 12:19:59.356 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:19:59.372 +03:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-08-20 12:19:59.374 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-08-20 12:19:59.375 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-08-20 12:19:59.376 +03:00 [DBG] Start authorize callback request
2019-08-20 12:19:59.378 +03:00 [DBG] User in authorize request: 1
2019-08-20 12:19:59.379 +03:00 [DBG] Start authorize request protocol validation
2019-08-20 12:19:59.379 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:19:59.380 +03:00 [DBG] Checking for PKCE parameters
2019-08-20 12:19:59.380 +03:00 [DBG] No PKCE used.
2019-08-20 12:19:59.381 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-20 12:19:59.382 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/home/signin-oidc","AllowedRedirectUris":["http://localhost:5002/home/signin-oidc"],"SubjectId":"1","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9P-QT083IfYU96ZY6VhwyHxLJKWoAqTVQakPLytjYbXsopbuIab6xzQtqoog4XGtdv732270YYmywY27qaMWTkRzblt4w4pfJiI83hLcOOP_GcEiLSwcbJQP-6i5533YRjymDhAg8oymoY7asYPGKtCLEZB34xcZa2aaZyqajz9Ze45rEUnw2P0VPWuggFvVGjamR5mDBXT0eralb7ZbglBh3lK3GluxNItia0xtqsYNr3imM7ykTFB5ujElEypvnjcIO1dkHPKDlvadqUS57Eq36MYtPEzpNECPdRcUt80XrBRQvZXKqt1liE8JCZZhfQ","UiLocales":null,"Nonce":"637018895908839944.Y2I0YTllNDAtNjI1OS00NmUxLWFkMmItM2QxMjlkZjI0NTZiZjNjYmQ5YWItNmUwOC00YTA0LWJiZWEtZjA5OWIzZjJkMDI1","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"a52c7bfed5160263d8a8a07fb081712d","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/home/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637018895908839944.Y2I0YTllNDAtNjI1OS00NmUxLWFkMmItM2QxMjlkZjI0NTZiZjNjYmQ5YWItNmUwOC00YTA0LWJiZWEtZjA5OWIzZjJkMDI1","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9P-QT083IfYU96ZY6VhwyHxLJKWoAqTVQakPLytjYbXsopbuIab6xzQtqoog4XGtdv732270YYmywY27qaMWTkRzblt4w4pfJiI83hLcOOP_GcEiLSwcbJQP-6i5533YRjymDhAg8oymoY7asYPGKtCLEZB34xcZa2aaZyqajz9Ze45rEUnw2P0VPWuggFvVGjamR5mDBXT0eralb7ZbglBh3lK3GluxNItia0xtqsYNr3imM7ykTFB5ujElEypvnjcIO1dkHPKDlvadqUS57Eq36MYtPEzpNECPdRcUt80XrBRQvZXKqt1liE8JCZZhfQ","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-20 12:19:59.392 +03:00 [DBG] Client is configured to not require consent, no consent is required
2019-08-20 12:19:59.392 +03:00 [DBG] Creating Hybrid Flow response.
2019-08-20 12:19:59.393 +03:00 [DBG] Creating Implicit Flow response.
2019-08-20 12:19:59.393 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 12:19:59.394 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 12:19:59.399 +03:00 [DBG] Authorize endpoint response
{"SubjectId":"1","ClientId":"mvc","RedirectUri":"http://localhost:5002/home/signin-oidc","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9P-QT083IfYU96ZY6VhwyHxLJKWoAqTVQakPLytjYbXsopbuIab6xzQtqoog4XGtdv732270YYmywY27qaMWTkRzblt4w4pfJiI83hLcOOP_GcEiLSwcbJQP-6i5533YRjymDhAg8oymoY7asYPGKtCLEZB34xcZa2aaZyqajz9Ze45rEUnw2P0VPWuggFvVGjamR5mDBXT0eralb7ZbglBh3lK3GluxNItia0xtqsYNr3imM7ykTFB5ujElEypvnjcIO1dkHPKDlvadqUS57Eq36MYtPEzpNECPdRcUt80XrBRQvZXKqt1liE8JCZZhfQ","Scope":"openid profile afcpayroll offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-08-20 12:19:59.401 +03:00 [DBG] Augmenting SignInContext
2019-08-20 12:19:59.402 +03:00 [INF] AuthenticationScheme: idsrv signed in.
2019-08-20 12:19:59.784 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-20 12:19:59.797 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-20 12:19:59.800 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-20 12:19:59.800 +03:00 [DBG] Start token request.
2019-08-20 12:19:59.801 +03:00 [DBG] Start client validation
2019-08-20 12:19:59.804 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-20 12:19:59.805 +03:00 [DBG] Start parsing for secret in post body
2019-08-20 12:19:59.805 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-20 12:19:59.806 +03:00 [DBG] Secret id found: mvc
2019-08-20 12:19:59.806 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:19:59.807 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-20 12:19:59.807 +03:00 [DBG] Client validation success
2019-08-20 12:19:59.808 +03:00 [DBG] Start token request validation
2019-08-20 12:19:59.808 +03:00 [DBG] Start validation of authorization code token request
2019-08-20 12:19:59.809 +03:00 [DBG] Validation of authorization code token request success
2019-08-20 12:19:59.809 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"fc5ca0507371de7c498935cce5b95579f03de6d7cd0a59588e4a732b96994b1a","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"mvc","client_secret":"***REDACTED***","code":"fc5ca0507371de7c498935cce5b95579f03de6d7cd0a59588e4a732b96994b1a","grant_type":"authorization_code","redirect_uri":"http://localhost:5002/home/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-08-20 12:19:59.812 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:19:59.814 +03:00 [DBG] Getting claims for access token for client: mvc
2019-08-20 12:19:59.814 +03:00 [DBG] Getting claims for access token for subject: 1
2019-08-20 12:19:59.818 +03:00 [DBG] Creating refresh token
2019-08-20 12:19:59.819 +03:00 [DBG] Setting an absolute lifetime: 2592000
2019-08-20 12:19:59.820 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:19:59.820 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 12:19:59.821 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 12:19:59.825 +03:00 [DBG] Token request success.
2019-08-20 12:19:59.837 +03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-08-20 12:19:59.838 +03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-08-20 12:19:59.839 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-08-20 12:19:59.839 +03:00 [DBG] Start userinfo request
2019-08-20 12:19:59.840 +03:00 [DBG] Bearer token found in header
2019-08-20 12:19:59.842 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:19:59.843 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:19:59.843 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-08-20 12:19:59.844 +03:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1566292799,"exp":1566292859,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","afcpayroll"],"client_id":"mvc","sub":"1","auth_time":1566292799,"idp":"local","name":"alice","email":"alice@email.com","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-08-20 12:19:59.850 +03:00 [DBG] Creating userinfo response
2019-08-20 12:19:59.851 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 12:19:59.851 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 12:19:59.852 +03:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 12:19:59.853 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 12:19:59.853 +03:00 [INF] Profile service returned the following claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 12:19:59.854 +03:00 [DBG] End userinfo request
2019-08-20 12:22:05.852 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-20 12:22:05.855 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-20 12:22:05.855 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-20 12:22:05.856 +03:00 [DBG] Start discovery request
2019-08-20 12:22:05.894 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-20 12:22:05.895 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-20 12:22:05.896 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-20 12:22:05.896 +03:00 [DBG] Start key discovery request
2019-08-20 12:22:05.998 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-20 12:22:05.999 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-20 12:22:05.999 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-20 12:22:06.000 +03:00 [DBG] Start token request.
2019-08-20 12:22:06.000 +03:00 [DBG] Start client validation
2019-08-20 12:22:06.000 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-20 12:22:06.002 +03:00 [DBG] Start parsing for secret in post body
2019-08-20 12:22:06.003 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-20 12:22:06.004 +03:00 [DBG] Secret id found: mvc
2019-08-20 12:22:06.004 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:22:06.005 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-20 12:22:06.005 +03:00 [DBG] Client validation success
2019-08-20 12:22:06.006 +03:00 [DBG] Start token request validation
2019-08-20 12:22:06.006 +03:00 [DBG] Start validation of refresh token request
2019-08-20 12:22:06.007 +03:00 [DBG] Token validation success
{"ClientId":"mvc","ClientName":"MVC Client","ValidateLifetime":false,"AccessTokenType":null,"ExpectedScope":null,"TokenHandle":null,"JwtId":null,"Claims":{"sub":"1","client_id":"mvc","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"auth_time":1566292799,"idp":"local","amr":"pwd","name":"alice","email":"alice@email.com"},"$type":"TokenValidationLog"}
2019-08-20 12:22:06.010 +03:00 [DBG] Validation of refresh token request success
2019-08-20 12:22:06.010 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"refresh_token","Scopes":null,"AuthorizationCode":null,"RefreshToken":"291abc02148ee5928330bb95f76f593c1f515d2d6b29e0968758a8690e014f72","UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"refresh_token","refresh_token":"***REDACTED***","client_id":"mvc","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2019-08-20 12:22:06.017 +03:00 [DBG] Updating refresh token
2019-08-20 12:22:06.017 +03:00 [DBG] Token usage is one-time only. Generating new handle
2019-08-20 12:22:06.018 +03:00 [DBG] Created refresh token in store
2019-08-20 12:22:06.018 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 12:22:06.019 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 12:22:06.023 +03:00 [DBG] Token request success.
2019-08-20 12:24:39.153 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-20 12:24:39.157 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-20 12:24:39.158 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-20 12:24:39.158 +03:00 [DBG] Start discovery request
2019-08-20 12:24:39.193 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-20 12:24:39.196 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-20 12:24:39.197 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-20 12:24:39.197 +03:00 [DBG] Start key discovery request
2019-08-20 12:24:39.298 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-20 12:24:39.301 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-20 12:24:39.302 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-20 12:24:39.303 +03:00 [DBG] Start token request.
2019-08-20 12:24:39.303 +03:00 [DBG] Start client validation
2019-08-20 12:24:39.303 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-20 12:24:39.304 +03:00 [DBG] Start parsing for secret in post body
2019-08-20 12:24:39.304 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-20 12:24:39.305 +03:00 [DBG] Secret id found: mvc
2019-08-20 12:24:39.305 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:24:39.306 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-20 12:24:39.306 +03:00 [DBG] Client validation success
2019-08-20 12:24:39.306 +03:00 [DBG] Start token request validation
2019-08-20 12:24:39.307 +03:00 [DBG] Start validation of refresh token request
2019-08-20 12:24:39.307 +03:00 [DBG] Token validation success
{"ClientId":"mvc","ClientName":"MVC Client","ValidateLifetime":false,"AccessTokenType":null,"ExpectedScope":null,"TokenHandle":null,"JwtId":null,"Claims":{"sub":"1","client_id":"mvc","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"auth_time":1566292799,"idp":"local","amr":"pwd","name":"alice","email":"alice@email.com"},"$type":"TokenValidationLog"}
2019-08-20 12:24:39.325 +03:00 [DBG] Validation of refresh token request success
2019-08-20 12:24:39.325 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"refresh_token","Scopes":null,"AuthorizationCode":null,"RefreshToken":"977afc5669e70a88f8e996d2e412df00721347ca84166de6e8a26e6abbf4e6df","UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"refresh_token","refresh_token":"***REDACTED***","client_id":"mvc","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2019-08-20 12:24:39.331 +03:00 [DBG] Updating refresh token
2019-08-20 12:24:39.332 +03:00 [DBG] Token usage is one-time only. Generating new handle
2019-08-20 12:24:39.332 +03:00 [DBG] Created refresh token in store
2019-08-20 12:24:39.334 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 12:24:39.342 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 12:24:39.347 +03:00 [DBG] Token request success.
2019-08-20 12:24:43.579 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-20 12:24:43.584 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-20 12:24:43.584 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-20 12:24:43.585 +03:00 [DBG] Start discovery request
2019-08-20 12:24:43.588 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-20 12:24:43.589 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-20 12:24:43.589 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-20 12:24:43.590 +03:00 [DBG] Start key discovery request
2019-08-20 12:24:43.593 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-20 12:24:43.602 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-20 12:24:43.603 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-20 12:24:43.605 +03:00 [DBG] Start token request.
2019-08-20 12:24:43.605 +03:00 [DBG] Start client validation
2019-08-20 12:24:43.606 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-20 12:24:43.606 +03:00 [DBG] Start parsing for secret in post body
2019-08-20 12:24:43.607 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-20 12:24:43.608 +03:00 [DBG] Secret id found: mvc
2019-08-20 12:24:43.610 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:24:43.621 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-20 12:24:43.622 +03:00 [DBG] Client validation success
2019-08-20 12:24:43.622 +03:00 [DBG] Start token request validation
2019-08-20 12:24:43.622 +03:00 [DBG] Start validation of refresh token request
2019-08-20 12:24:43.623 +03:00 [DBG] Token validation success
{"ClientId":"mvc","ClientName":"MVC Client","ValidateLifetime":false,"AccessTokenType":null,"ExpectedScope":null,"TokenHandle":null,"JwtId":null,"Claims":{"sub":"1","client_id":"mvc","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"auth_time":1566292799,"idp":"local","amr":"pwd","name":"alice","email":"alice@email.com"},"$type":"TokenValidationLog"}
2019-08-20 12:24:43.626 +03:00 [DBG] Validation of refresh token request success
2019-08-20 12:24:43.626 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"refresh_token","Scopes":null,"AuthorizationCode":null,"RefreshToken":"abf857f00f54fdb8a08fbc128865c37515769fe327e9d4970ea9f5f3305acaa9","UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"refresh_token","refresh_token":"***REDACTED***","client_id":"mvc","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2019-08-20 12:24:43.645 +03:00 [DBG] Updating refresh token
2019-08-20 12:24:43.646 +03:00 [DBG] Token usage is one-time only. Generating new handle
2019-08-20 12:24:43.646 +03:00 [DBG] Created refresh token in store
2019-08-20 12:24:43.647 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 12:24:43.647 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 12:24:43.652 +03:00 [DBG] Token request success.
2019-08-20 12:24:43.835 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-20 12:24:43.838 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-20 12:24:43.838 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-20 12:24:43.839 +03:00 [DBG] Start discovery request
2019-08-20 12:24:43.944 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-20 12:24:43.947 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-20 12:24:43.948 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-20 12:24:43.949 +03:00 [DBG] Start key discovery request
2019-08-20 12:25:02.892 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-20 12:25:02.895 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-20 12:25:02.896 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-20 12:25:02.897 +03:00 [DBG] Start discovery request
2019-08-20 12:25:02.900 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-20 12:25:02.901 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-20 12:25:02.902 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-20 12:25:02.903 +03:00 [DBG] Start key discovery request
2019-08-20 12:25:02.909 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-20 12:25:02.914 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-20 12:25:02.915 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-20 12:25:02.916 +03:00 [DBG] Start token request.
2019-08-20 12:25:02.916 +03:00 [DBG] Start client validation
2019-08-20 12:25:02.917 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-20 12:25:02.917 +03:00 [DBG] Start parsing for secret in post body
2019-08-20 12:25:02.918 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-20 12:25:02.919 +03:00 [DBG] Secret id found: mvc
2019-08-20 12:25:02.919 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:25:02.920 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-20 12:25:02.920 +03:00 [DBG] Client validation success
2019-08-20 12:25:02.921 +03:00 [DBG] Start token request validation
2019-08-20 12:25:02.921 +03:00 [DBG] Start validation of refresh token request
2019-08-20 12:25:02.922 +03:00 [DBG] Token validation success
{"ClientId":"mvc","ClientName":"MVC Client","ValidateLifetime":false,"AccessTokenType":null,"ExpectedScope":null,"TokenHandle":null,"JwtId":null,"Claims":{"sub":"1","client_id":"mvc","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"auth_time":1566292799,"idp":"local","amr":"pwd","name":"alice","email":"alice@email.com"},"$type":"TokenValidationLog"}
2019-08-20 12:25:02.940 +03:00 [DBG] Validation of refresh token request success
2019-08-20 12:25:02.941 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"refresh_token","Scopes":null,"AuthorizationCode":null,"RefreshToken":"ffb10a6f613570bd0fe13271e4ba1a79d50804a4ea05f96d230af951f13d3f8b","UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"refresh_token","refresh_token":"***REDACTED***","client_id":"mvc","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2019-08-20 12:25:02.947 +03:00 [DBG] Updating refresh token
2019-08-20 12:25:02.952 +03:00 [DBG] Token usage is one-time only. Generating new handle
2019-08-20 12:25:02.953 +03:00 [DBG] Created refresh token in store
2019-08-20 12:25:02.953 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 12:25:02.954 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 12:25:02.958 +03:00 [DBG] Token request success.
2019-08-20 12:29:11.721 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-20 12:29:11.726 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-20 12:29:11.733 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-20 12:29:11.738 +03:00 [DBG] Start discovery request
2019-08-20 12:29:11.776 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-20 12:29:11.777 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-20 12:29:11.778 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-20 12:29:11.778 +03:00 [DBG] Start key discovery request
2019-08-20 12:29:11.898 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-20 12:29:11.900 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-20 12:29:11.901 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-20 12:29:11.902 +03:00 [DBG] Start token request.
2019-08-20 12:29:11.903 +03:00 [DBG] Start client validation
2019-08-20 12:29:11.903 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-20 12:29:11.904 +03:00 [DBG] Start parsing for secret in post body
2019-08-20 12:29:11.904 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-20 12:29:11.905 +03:00 [DBG] Secret id found: mvc
2019-08-20 12:29:11.905 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:29:11.906 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-20 12:29:11.907 +03:00 [DBG] Client validation success
2019-08-20 12:29:11.907 +03:00 [DBG] Start token request validation
2019-08-20 12:29:11.908 +03:00 [DBG] Start validation of refresh token request
2019-08-20 12:29:11.908 +03:00 [DBG] Token validation success
{"ClientId":"mvc","ClientName":"MVC Client","ValidateLifetime":false,"AccessTokenType":null,"ExpectedScope":null,"TokenHandle":null,"JwtId":null,"Claims":{"sub":"1","client_id":"mvc","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"auth_time":1566292799,"idp":"local","amr":"pwd","name":"alice","email":"alice@email.com"},"$type":"TokenValidationLog"}
2019-08-20 12:29:11.918 +03:00 [DBG] Validation of refresh token request success
2019-08-20 12:29:11.919 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"refresh_token","Scopes":null,"AuthorizationCode":null,"RefreshToken":"a7e3c5919a31352a9a6c9c26faaba0ce43d0937bb28ae25efc30432b16683abd","UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"refresh_token","refresh_token":"***REDACTED***","client_id":"mvc","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2019-08-20 12:29:11.928 +03:00 [DBG] Updating refresh token
2019-08-20 12:29:11.929 +03:00 [DBG] Token usage is one-time only. Generating new handle
2019-08-20 12:29:11.930 +03:00 [DBG] Created refresh token in store
2019-08-20 12:29:11.930 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 12:29:11.931 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 12:29:11.936 +03:00 [DBG] Token request success.
2019-08-20 12:29:16.037 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-20 12:29:16.038 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-20 12:29:16.039 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-20 12:29:16.039 +03:00 [DBG] Start discovery request
2019-08-20 12:29:16.042 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-20 12:29:16.043 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-20 12:29:16.043 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-20 12:29:16.044 +03:00 [DBG] Start key discovery request
2019-08-20 12:29:16.047 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-20 12:29:16.048 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-20 12:29:16.048 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-20 12:29:16.050 +03:00 [DBG] Start token request.
2019-08-20 12:29:16.050 +03:00 [DBG] Start client validation
2019-08-20 12:29:16.051 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-20 12:29:16.051 +03:00 [DBG] Start parsing for secret in post body
2019-08-20 12:29:16.052 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-20 12:29:16.052 +03:00 [DBG] Secret id found: mvc
2019-08-20 12:29:16.054 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:29:16.055 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-20 12:29:16.055 +03:00 [DBG] Client validation success
2019-08-20 12:29:16.056 +03:00 [DBG] Start token request validation
2019-08-20 12:29:16.056 +03:00 [DBG] Start validation of refresh token request
2019-08-20 12:29:16.057 +03:00 [DBG] Token validation success
{"ClientId":"mvc","ClientName":"MVC Client","ValidateLifetime":false,"AccessTokenType":null,"ExpectedScope":null,"TokenHandle":null,"JwtId":null,"Claims":{"sub":"1","client_id":"mvc","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"auth_time":1566292799,"idp":"local","amr":"pwd","name":"alice","email":"alice@email.com"},"$type":"TokenValidationLog"}
2019-08-20 12:29:16.062 +03:00 [DBG] Validation of refresh token request success
2019-08-20 12:29:16.062 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"refresh_token","Scopes":null,"AuthorizationCode":null,"RefreshToken":"e8c8792bde202f29df19bf69aebcbd54cc67a323feb57e09d8135a6809d63649","UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"refresh_token","refresh_token":"***REDACTED***","client_id":"mvc","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2019-08-20 12:29:16.073 +03:00 [DBG] Updating refresh token
2019-08-20 12:29:16.074 +03:00 [DBG] Token usage is one-time only. Generating new handle
2019-08-20 12:29:16.074 +03:00 [DBG] Created refresh token in store
2019-08-20 12:29:16.075 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 12:29:16.076 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 12:29:16.080 +03:00 [DBG] Token request success.
2019-08-20 12:29:16.254 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-20 12:29:16.255 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-20 12:29:16.256 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-20 12:29:16.257 +03:00 [DBG] Start discovery request
2019-08-20 12:29:16.366 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-20 12:29:16.367 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-20 12:29:16.368 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-20 12:29:16.369 +03:00 [DBG] Start key discovery request
2019-08-20 12:29:24.016 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-20 12:29:24.019 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-20 12:29:24.020 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-20 12:29:24.021 +03:00 [DBG] Start discovery request
2019-08-20 12:29:24.023 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-20 12:29:24.024 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-20 12:29:24.024 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-20 12:29:24.025 +03:00 [DBG] Start key discovery request
2019-08-20 12:29:24.027 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-20 12:29:24.028 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-20 12:29:24.028 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-20 12:29:24.029 +03:00 [DBG] Start token request.
2019-08-20 12:29:24.029 +03:00 [DBG] Start client validation
2019-08-20 12:29:24.030 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-20 12:29:24.030 +03:00 [DBG] Start parsing for secret in post body
2019-08-20 12:29:24.031 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-20 12:29:24.031 +03:00 [DBG] Secret id found: mvc
2019-08-20 12:29:24.032 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:29:24.034 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-20 12:29:24.034 +03:00 [DBG] Client validation success
2019-08-20 12:29:24.035 +03:00 [DBG] Start token request validation
2019-08-20 12:29:24.035 +03:00 [DBG] Start validation of refresh token request
2019-08-20 12:29:24.036 +03:00 [DBG] Token validation success
{"ClientId":"mvc","ClientName":"MVC Client","ValidateLifetime":false,"AccessTokenType":null,"ExpectedScope":null,"TokenHandle":null,"JwtId":null,"Claims":{"sub":"1","client_id":"mvc","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"auth_time":1566292799,"idp":"local","amr":"pwd","name":"alice","email":"alice@email.com"},"$type":"TokenValidationLog"}
2019-08-20 12:29:24.041 +03:00 [DBG] Validation of refresh token request success
2019-08-20 12:29:24.042 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"refresh_token","Scopes":null,"AuthorizationCode":null,"RefreshToken":"b781268d7eff905437f0c3f1e5271f76727370f0edae84efb18aaf18421c071e","UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"refresh_token","refresh_token":"***REDACTED***","client_id":"mvc","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2019-08-20 12:29:24.051 +03:00 [DBG] Updating refresh token
2019-08-20 12:29:24.051 +03:00 [DBG] Token usage is one-time only. Generating new handle
2019-08-20 12:29:24.052 +03:00 [DBG] Created refresh token in store
2019-08-20 12:29:24.053 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 12:29:24.053 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 12:29:24.058 +03:00 [DBG] Token request success.
2019-08-20 12:30:21.535 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-20 12:30:21.541 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-20 12:30:21.549 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-20 12:30:21.550 +03:00 [DBG] Start discovery request
2019-08-20 12:30:21.587 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-20 12:30:21.588 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-20 12:30:21.589 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-20 12:30:21.591 +03:00 [DBG] Start key discovery request
2019-08-20 12:30:21.727 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-20 12:30:21.728 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-20 12:30:21.729 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-20 12:30:21.729 +03:00 [DBG] Start token request.
2019-08-20 12:30:21.730 +03:00 [DBG] Start client validation
2019-08-20 12:30:21.730 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-20 12:30:21.731 +03:00 [DBG] Start parsing for secret in post body
2019-08-20 12:30:21.731 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-20 12:30:21.732 +03:00 [DBG] Secret id found: mvc
2019-08-20 12:30:21.733 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:30:21.734 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-20 12:30:21.734 +03:00 [DBG] Client validation success
2019-08-20 12:30:21.735 +03:00 [DBG] Start token request validation
2019-08-20 12:30:21.735 +03:00 [DBG] Start validation of refresh token request
2019-08-20 12:30:21.737 +03:00 [DBG] Token validation success
{"ClientId":"mvc","ClientName":"MVC Client","ValidateLifetime":false,"AccessTokenType":null,"ExpectedScope":null,"TokenHandle":null,"JwtId":null,"Claims":{"sub":"1","client_id":"mvc","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"auth_time":1566292799,"idp":"local","amr":"pwd","name":"alice","email":"alice@email.com"},"$type":"TokenValidationLog"}
2019-08-20 12:30:21.740 +03:00 [DBG] Validation of refresh token request success
2019-08-20 12:30:21.741 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"refresh_token","Scopes":null,"AuthorizationCode":null,"RefreshToken":"7977dbdfdd58928b553da1c45ffc8a06b637fcb66ab48127b1b8222faf642bb2","UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"refresh_token","refresh_token":"***REDACTED***","client_id":"mvc","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2019-08-20 12:30:21.747 +03:00 [DBG] Updating refresh token
2019-08-20 12:30:21.748 +03:00 [DBG] Token usage is one-time only. Generating new handle
2019-08-20 12:30:21.749 +03:00 [DBG] Created refresh token in store
2019-08-20 12:30:21.749 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 12:30:21.750 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 12:30:21.754 +03:00 [DBG] Token request success.
2019-08-20 12:30:24.692 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-20 12:30:24.694 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-20 12:30:24.695 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-20 12:30:24.695 +03:00 [DBG] Start discovery request
2019-08-20 12:30:24.703 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-20 12:30:24.704 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-20 12:30:24.704 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-20 12:30:24.705 +03:00 [DBG] Start key discovery request
2019-08-20 12:30:24.711 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-20 12:30:24.712 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-20 12:30:24.713 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-20 12:30:24.714 +03:00 [DBG] Start token request.
2019-08-20 12:30:24.714 +03:00 [DBG] Start client validation
2019-08-20 12:30:24.714 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-20 12:30:24.715 +03:00 [DBG] Start parsing for secret in post body
2019-08-20 12:30:24.715 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-20 12:30:24.716 +03:00 [DBG] Secret id found: mvc
2019-08-20 12:30:24.716 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:30:24.717 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-20 12:30:24.717 +03:00 [DBG] Client validation success
2019-08-20 12:30:24.718 +03:00 [DBG] Start token request validation
2019-08-20 12:30:24.718 +03:00 [DBG] Start validation of refresh token request
2019-08-20 12:30:24.719 +03:00 [DBG] Token validation success
{"ClientId":"mvc","ClientName":"MVC Client","ValidateLifetime":false,"AccessTokenType":null,"ExpectedScope":null,"TokenHandle":null,"JwtId":null,"Claims":{"sub":"1","client_id":"mvc","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"auth_time":1566292799,"idp":"local","amr":"pwd","name":"alice","email":"alice@email.com"},"$type":"TokenValidationLog"}
2019-08-20 12:30:24.722 +03:00 [DBG] Validation of refresh token request success
2019-08-20 12:30:24.723 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"refresh_token","Scopes":null,"AuthorizationCode":null,"RefreshToken":"1875de69ab152529cf759e9800247a0a2ef92a52f7d192a5a8b1ac96b8e1e65e","UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"refresh_token","refresh_token":"***REDACTED***","client_id":"mvc","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2019-08-20 12:30:24.731 +03:00 [DBG] Updating refresh token
2019-08-20 12:30:24.731 +03:00 [DBG] Token usage is one-time only. Generating new handle
2019-08-20 12:30:24.732 +03:00 [DBG] Created refresh token in store
2019-08-20 12:30:24.732 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 12:30:24.733 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 12:30:24.737 +03:00 [DBG] Token request success.
2019-08-20 12:30:33.714 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-20 12:30:33.717 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-20 12:30:33.718 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-20 12:30:33.718 +03:00 [DBG] Start discovery request
2019-08-20 12:30:33.721 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-20 12:30:33.722 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-20 12:30:33.722 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-20 12:30:33.723 +03:00 [DBG] Start key discovery request
2019-08-20 12:30:33.727 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-20 12:30:33.728 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-20 12:30:33.728 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-20 12:30:33.729 +03:00 [DBG] Start token request.
2019-08-20 12:30:33.730 +03:00 [DBG] Start client validation
2019-08-20 12:30:33.730 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-20 12:30:33.731 +03:00 [DBG] Start parsing for secret in post body
2019-08-20 12:30:33.731 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-20 12:30:33.732 +03:00 [DBG] Secret id found: mvc
2019-08-20 12:30:33.734 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:30:33.734 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-20 12:30:33.735 +03:00 [DBG] Client validation success
2019-08-20 12:30:33.735 +03:00 [DBG] Start token request validation
2019-08-20 12:30:33.736 +03:00 [DBG] Start validation of refresh token request
2019-08-20 12:30:33.736 +03:00 [DBG] Token validation success
{"ClientId":"mvc","ClientName":"MVC Client","ValidateLifetime":false,"AccessTokenType":null,"ExpectedScope":null,"TokenHandle":null,"JwtId":null,"Claims":{"sub":"1","client_id":"mvc","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"auth_time":1566292799,"idp":"local","amr":"pwd","name":"alice","email":"alice@email.com"},"$type":"TokenValidationLog"}
2019-08-20 12:30:33.740 +03:00 [DBG] Validation of refresh token request success
2019-08-20 12:30:33.757 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"refresh_token","Scopes":null,"AuthorizationCode":null,"RefreshToken":"6613dee16ec8bbecda8bbb8418ab07741f5d24330c799d3e7541e0b490716e7e","UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"refresh_token","refresh_token":"***REDACTED***","client_id":"mvc","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2019-08-20 12:30:33.764 +03:00 [DBG] Updating refresh token
2019-08-20 12:30:33.765 +03:00 [DBG] Token usage is one-time only. Generating new handle
2019-08-20 12:30:33.765 +03:00 [DBG] Created refresh token in store
2019-08-20 12:30:33.766 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 12:30:33.767 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 12:30:33.771 +03:00 [DBG] Token request success.
2019-08-20 12:30:33.953 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-20 12:30:33.954 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-20 12:30:33.955 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-20 12:30:33.955 +03:00 [DBG] Start discovery request
2019-08-20 12:30:34.077 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-20 12:30:34.078 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-20 12:30:34.080 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-20 12:30:34.081 +03:00 [DBG] Start key discovery request
2019-08-20 12:30:40.288 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-20 12:30:40.290 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-20 12:30:40.290 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-20 12:30:40.291 +03:00 [DBG] Start discovery request
2019-08-20 12:30:40.294 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-20 12:30:40.295 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-20 12:30:40.296 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-20 12:30:40.297 +03:00 [DBG] Start key discovery request
2019-08-20 12:30:40.300 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-20 12:30:40.302 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-20 12:30:40.302 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-20 12:30:40.303 +03:00 [DBG] Start token request.
2019-08-20 12:30:40.304 +03:00 [DBG] Start client validation
2019-08-20 12:30:40.304 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-20 12:30:40.305 +03:00 [DBG] Start parsing for secret in post body
2019-08-20 12:30:40.305 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-20 12:30:40.306 +03:00 [DBG] Secret id found: mvc
2019-08-20 12:30:40.307 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:30:40.308 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-20 12:30:40.308 +03:00 [DBG] Client validation success
2019-08-20 12:30:40.309 +03:00 [DBG] Start token request validation
2019-08-20 12:30:40.309 +03:00 [DBG] Start validation of refresh token request
2019-08-20 12:30:40.310 +03:00 [DBG] Token validation success
{"ClientId":"mvc","ClientName":"MVC Client","ValidateLifetime":false,"AccessTokenType":null,"ExpectedScope":null,"TokenHandle":null,"JwtId":null,"Claims":{"sub":"1","client_id":"mvc","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"auth_time":1566292799,"idp":"local","amr":"pwd","name":"alice","email":"alice@email.com"},"$type":"TokenValidationLog"}
2019-08-20 12:30:40.318 +03:00 [DBG] Validation of refresh token request success
2019-08-20 12:30:40.319 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"refresh_token","Scopes":null,"AuthorizationCode":null,"RefreshToken":"e5be656380171a41fd6ee6b53236c664b42172bc64b343128ab6f6b96a932071","UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"refresh_token","refresh_token":"***REDACTED***","client_id":"mvc","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2019-08-20 12:30:40.327 +03:00 [DBG] Updating refresh token
2019-08-20 12:30:40.328 +03:00 [DBG] Token usage is one-time only. Generating new handle
2019-08-20 12:30:40.329 +03:00 [DBG] Created refresh token in store
2019-08-20 12:30:40.329 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 12:30:40.330 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 12:30:40.334 +03:00 [DBG] Token request success.
2019-08-20 12:59:01.426 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-20 12:59:01.428 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-20 12:59:01.428 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-20 12:59:01.429 +03:00 [DBG] Start discovery request
2019-08-20 12:59:01.463 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-20 12:59:01.464 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-20 12:59:01.465 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-20 12:59:01.466 +03:00 [DBG] Start key discovery request
2019-08-20 12:59:01.562 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-20 12:59:01.563 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-20 12:59:01.563 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-20 12:59:01.564 +03:00 [DBG] Start token request.
2019-08-20 12:59:01.564 +03:00 [DBG] Start client validation
2019-08-20 12:59:01.565 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-20 12:59:01.565 +03:00 [DBG] Start parsing for secret in post body
2019-08-20 12:59:01.566 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-20 12:59:01.567 +03:00 [DBG] Secret id found: mvc
2019-08-20 12:59:01.567 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 12:59:01.568 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-20 12:59:01.568 +03:00 [DBG] Client validation success
2019-08-20 12:59:01.569 +03:00 [DBG] Start token request validation
2019-08-20 12:59:01.570 +03:00 [DBG] Start validation of refresh token request
2019-08-20 12:59:01.571 +03:00 [DBG] Token validation success
{"ClientId":"mvc","ClientName":"MVC Client","ValidateLifetime":false,"AccessTokenType":null,"ExpectedScope":null,"TokenHandle":null,"JwtId":null,"Claims":{"sub":"1","client_id":"mvc","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"auth_time":1566292799,"idp":"local","amr":"pwd","name":"alice","email":"alice@email.com"},"$type":"TokenValidationLog"}
2019-08-20 12:59:01.574 +03:00 [DBG] Validation of refresh token request success
2019-08-20 12:59:01.575 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"refresh_token","Scopes":null,"AuthorizationCode":null,"RefreshToken":"3dc748685a10ee23efbeb0623af715c07baa34b5a8c68cd3d1c62e3fbd7d254e","UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"refresh_token","refresh_token":"***REDACTED***","client_id":"mvc","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2019-08-20 12:59:01.581 +03:00 [DBG] Updating refresh token
2019-08-20 12:59:01.581 +03:00 [DBG] Token usage is one-time only. Generating new handle
2019-08-20 12:59:01.582 +03:00 [DBG] Created refresh token in store
2019-08-20 12:59:01.583 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 12:59:01.583 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 12:59:01.587 +03:00 [DBG] Token request success.
2019-08-20 13:03:38.885 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-20 13:03:38.887 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-20 13:03:38.887 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-20 13:03:38.888 +03:00 [DBG] Start discovery request
2019-08-20 13:03:38.921 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-20 13:03:38.921 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-20 13:03:38.922 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-20 13:03:38.923 +03:00 [DBG] Start key discovery request
2019-08-20 13:03:39.023 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-20 13:03:39.024 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-20 13:03:39.025 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-20 13:03:39.026 +03:00 [DBG] Start token request.
2019-08-20 13:03:39.026 +03:00 [DBG] Start client validation
2019-08-20 13:03:39.026 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-20 13:03:39.027 +03:00 [DBG] Start parsing for secret in post body
2019-08-20 13:03:39.027 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-20 13:03:39.028 +03:00 [DBG] Secret id found: mvc
2019-08-20 13:03:39.028 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 13:03:39.029 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-20 13:03:39.029 +03:00 [DBG] Client validation success
2019-08-20 13:03:39.030 +03:00 [DBG] Start token request validation
2019-08-20 13:03:39.030 +03:00 [DBG] Start validation of refresh token request
2019-08-20 13:03:39.031 +03:00 [DBG] Token validation success
{"ClientId":"mvc","ClientName":"MVC Client","ValidateLifetime":false,"AccessTokenType":null,"ExpectedScope":null,"TokenHandle":null,"JwtId":null,"Claims":{"sub":"1","client_id":"mvc","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"auth_time":1566292799,"idp":"local","amr":"pwd","name":"alice","email":"alice@email.com"},"$type":"TokenValidationLog"}
2019-08-20 13:03:39.035 +03:00 [DBG] Validation of refresh token request success
2019-08-20 13:03:39.035 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"refresh_token","Scopes":null,"AuthorizationCode":null,"RefreshToken":"3ec38388c478785221642df0b18ceb55ee855eebef63ee802b27232157a37423","UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"refresh_token","refresh_token":"***REDACTED***","client_id":"mvc","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2019-08-20 13:03:39.043 +03:00 [DBG] Updating refresh token
2019-08-20 13:03:39.044 +03:00 [DBG] Token usage is one-time only. Generating new handle
2019-08-20 13:03:39.044 +03:00 [DBG] Created refresh token in store
2019-08-20 13:03:39.045 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 13:03:39.046 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 13:03:39.049 +03:00 [DBG] Token request success.
2019-08-20 13:03:50.347 +03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-08-20 13:03:50.350 +03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-08-20 13:03:50.351 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-08-20 13:03:50.352 +03:00 [DBG] Start userinfo request
2019-08-20 13:03:50.352 +03:00 [DBG] Bearer token found in header
2019-08-20 13:03:50.356 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 13:03:50.357 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 13:03:50.358 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-08-20 13:03:50.359 +03:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1566295419,"exp":1566295479,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","afcpayroll"],"client_id":"mvc","sub":"1","auth_time":1566292799,"idp":"local","name":"alice","email":"alice@email.com","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-08-20 13:03:50.363 +03:00 [DBG] Creating userinfo response
2019-08-20 13:03:50.364 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 13:03:50.365 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 13:03:50.365 +03:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 13:03:50.366 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 13:03:50.366 +03:00 [INF] Profile service returned the following claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 13:03:50.367 +03:00 [DBG] End userinfo request
2019-08-20 13:04:03.919 +03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-08-20 13:04:03.920 +03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-08-20 13:04:03.921 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-08-20 13:04:03.921 +03:00 [DBG] Start userinfo request
2019-08-20 13:04:03.922 +03:00 [DBG] Bearer token found in header
2019-08-20 13:04:03.937 +03:00 [ERR] JWT token validation error: IDX12729: Unable to decode the header '[PII is hidden]' as Base64Url encoded string. jwtEncodedString: '[PII is hidden]'.
System.ArgumentException: IDX12729: Unable to decode the header '[PII is hidden]' as Base64Url encoded string. jwtEncodedString: '[PII is hidden]'. ---> Newtonsoft.Json.JsonReaderException: Bad JSON escape sequence: \. Path 'kid', line 2, position 8.
   at Newtonsoft.Json.JsonTextReader.ReadStringIntoBuffer(Char quote)
   at Newtonsoft.Json.JsonTextReader.ParseValue()
   at Newtonsoft.Json.JsonTextReader.Read()
   at Newtonsoft.Json.JsonReader.ReadForType(JsonContract contract, Boolean hasConverter)
   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateDictionary(IDictionary dictionary, JsonReader reader, JsonDictionaryContract contract, JsonProperty containerProperty, String id)
   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)
   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)
   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)
   at Newtonsoft.Json.JsonSerializer.DeserializeInternal(JsonReader reader, Type objectType)
   at Newtonsoft.Json.JsonConvert.DeserializeObject(String value, Type type, JsonSerializerSettings settings)
   at Newtonsoft.Json.JsonConvert.DeserializeObject(String value, Type type)
   at System.IdentityModel.Tokens.Jwt.JsonExtensions.DeserializeJwtHeader(String jsonString) in C:\agent2\_work\15\s\src\System.IdentityModel.Tokens.Jwt\JsonExtensions.cs:line 128
   at System.IdentityModel.Tokens.Jwt.JwtSecurityToken.Decode(String[] tokenParts, String rawData) in C:\agent2\_work\15\s\src\System.IdentityModel.Tokens.Jwt\JwtSecurityToken.cs:line 492
   --- End of inner exception stack trace ---
   at System.IdentityModel.Tokens.Jwt.JwtSecurityToken.Decode(String[] tokenParts, String rawData) in C:\agent2\_work\15\s\src\System.IdentityModel.Tokens.Jwt\JwtSecurityToken.cs:line 489
   at System.IdentityModel.Tokens.Jwt.JwtSecurityTokenHandler.ReadJwtToken(String token) in C:\agent2\_work\15\s\src\System.IdentityModel.Tokens.Jwt\JwtSecurityTokenHandler.cs:line 662
   at System.IdentityModel.Tokens.Jwt.JwtSecurityTokenHandler.ValidateSignature(String token, TokenValidationParameters validationParameters) in C:\agent2\_work\15\s\src\System.IdentityModel.Tokens.Jwt\JwtSecurityTokenHandler.cs:line 921
   at System.IdentityModel.Tokens.Jwt.JwtSecurityTokenHandler.ValidateToken(String token, TokenValidationParameters validationParameters, SecurityToken& validatedToken) in C:\agent2\_work\15\s\src\System.IdentityModel.Tokens.Jwt\JwtSecurityTokenHandler.cs:line 746
   at IdentityServer4.Validation.TokenValidator.ValidateJwtAsync(String jwt, String audience, IEnumerable`1 validationKeys, Boolean validateLifetime) in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\src\Validation\Default\TokenValidator.cs:line 287
2019-08-20 13:04:55.873 +03:00 [DBG] Request path /connect/introspect matched to endpoint type Introspection
2019-08-20 13:04:55.876 +03:00 [DBG] Endpoint enabled: Introspection, successfully created handler: IdentityServer4.Endpoints.IntrospectionEndpoint
2019-08-20 13:04:55.877 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.IntrospectionEndpoint for /connect/introspect
2019-08-20 13:04:55.883 +03:00 [WRN] Introspection endpoint only supports POST requests
2019-08-20 13:05:02.449 +03:00 [DBG] Request path /connect/introspect matched to endpoint type Introspection
2019-08-20 13:05:02.451 +03:00 [DBG] Endpoint enabled: Introspection, successfully created handler: IdentityServer4.Endpoints.IntrospectionEndpoint
2019-08-20 13:05:02.452 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.IntrospectionEndpoint for /connect/introspect
2019-08-20 13:05:02.453 +03:00 [WRN] Invalid media type for introspection endpoint
2019-08-20 13:05:28.662 +03:00 [DBG] Request path /connect/introspect matched to endpoint type Introspection
2019-08-20 13:05:28.664 +03:00 [DBG] Endpoint enabled: Introspection, successfully created handler: IdentityServer4.Endpoints.IntrospectionEndpoint
2019-08-20 13:05:28.668 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.IntrospectionEndpoint for /connect/introspect
2019-08-20 13:05:28.668 +03:00 [WRN] Invalid media type for introspection endpoint
2019-08-20 13:05:56.553 +03:00 [DBG] Request path /connect/introspect matched to endpoint type Introspection
2019-08-20 13:05:56.554 +03:00 [DBG] Endpoint enabled: Introspection, successfully created handler: IdentityServer4.Endpoints.IntrospectionEndpoint
2019-08-20 13:05:56.555 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.IntrospectionEndpoint for /connect/introspect
2019-08-20 13:05:56.565 +03:00 [DBG] Starting introspection request.
2019-08-20 13:05:56.575 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-20 13:05:56.575 +03:00 [DBG] Start parsing for secret in post body
2019-08-20 13:05:56.576 +03:00 [DBG] No secret in post body found
2019-08-20 13:05:56.578 +03:00 [DBG] Parser found no secret
2019-08-20 13:05:56.579 +03:00 [ERR] No API secret found
2019-08-20 13:05:56.580 +03:00 [ERR] API unauthorized to call introspection endpoint. aborting.
2019-08-20 13:10:24.377 +03:00 [DBG] Request path /connect/introspect matched to endpoint type Introspection
2019-08-20 13:10:24.381 +03:00 [DBG] Endpoint enabled: Introspection, successfully created handler: IdentityServer4.Endpoints.IntrospectionEndpoint
2019-08-20 13:10:24.381 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.IntrospectionEndpoint for /connect/introspect
2019-08-20 13:10:24.382 +03:00 [DBG] Starting introspection request.
2019-08-20 13:10:24.383 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-20 13:10:24.386 +03:00 [WRN] Malformed Basic Authentication credential.
2019-08-20 13:10:24.386 +03:00 [DBG] Start parsing for secret in post body
2019-08-20 13:10:24.387 +03:00 [DBG] No secret in post body found
2019-08-20 13:10:24.387 +03:00 [DBG] Parser found no secret
2019-08-20 13:10:24.388 +03:00 [ERR] No API secret found
2019-08-20 13:10:24.388 +03:00 [ERR] API unauthorized to call introspection endpoint. aborting.
2019-08-20 13:12:50.272 +03:00 [DBG] Request path /connect/introspect matched to endpoint type Introspection
2019-08-20 13:12:50.276 +03:00 [DBG] Endpoint enabled: Introspection, successfully created handler: IdentityServer4.Endpoints.IntrospectionEndpoint
2019-08-20 13:12:50.277 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.IntrospectionEndpoint for /connect/introspect
2019-08-20 13:12:50.278 +03:00 [DBG] Starting introspection request.
2019-08-20 13:12:50.278 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-20 13:12:50.279 +03:00 [WRN] Malformed Basic Authentication credential.
2019-08-20 13:12:50.280 +03:00 [DBG] Start parsing for secret in post body
2019-08-20 13:12:50.280 +03:00 [DBG] No secret in post body found
2019-08-20 13:12:50.281 +03:00 [DBG] Parser found no secret
2019-08-20 13:12:50.282 +03:00 [ERR] No API secret found
2019-08-20 13:12:50.282 +03:00 [ERR] API unauthorized to call introspection endpoint. aborting.
2019-08-20 13:13:10.262 +03:00 [DBG] Request path /connect/introspect matched to endpoint type Introspection
2019-08-20 13:13:10.264 +03:00 [DBG] Endpoint enabled: Introspection, successfully created handler: IdentityServer4.Endpoints.IntrospectionEndpoint
2019-08-20 13:13:10.265 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.IntrospectionEndpoint for /connect/introspect
2019-08-20 13:13:10.266 +03:00 [DBG] Starting introspection request.
2019-08-20 13:13:10.266 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-20 13:13:10.267 +03:00 [WRN] Malformed Basic Authentication credential.
2019-08-20 13:13:10.267 +03:00 [DBG] Start parsing for secret in post body
2019-08-20 13:13:10.268 +03:00 [DBG] No secret in post body found
2019-08-20 13:13:10.269 +03:00 [DBG] Parser found no secret
2019-08-20 13:13:10.269 +03:00 [ERR] No API secret found
2019-08-20 13:13:10.270 +03:00 [ERR] API unauthorized to call introspection endpoint. aborting.
2019-08-20 13:14:15.620 +03:00 [DBG] Request path /connect/introspect matched to endpoint type Introspection
2019-08-20 13:14:15.623 +03:00 [DBG] Endpoint enabled: Introspection, successfully created handler: IdentityServer4.Endpoints.IntrospectionEndpoint
2019-08-20 13:14:15.624 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.IntrospectionEndpoint for /connect/introspect
2019-08-20 13:14:15.624 +03:00 [DBG] Starting introspection request.
2019-08-20 13:14:15.626 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-20 13:14:15.627 +03:00 [WRN] Malformed Basic Authentication credential.
2019-08-20 13:14:15.627 +03:00 [DBG] Start parsing for secret in post body
2019-08-20 13:14:15.628 +03:00 [DBG] No secret in post body found
2019-08-20 13:14:15.628 +03:00 [DBG] Parser found no secret
2019-08-20 13:14:15.629 +03:00 [ERR] No API secret found
2019-08-20 13:14:15.629 +03:00 [ERR] API unauthorized to call introspection endpoint. aborting.
2019-08-20 13:17:24.373 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-20 13:17:24.376 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-20 13:17:24.377 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-20 13:17:24.378 +03:00 [DBG] Start discovery request
2019-08-20 13:17:24.506 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-20 13:17:24.507 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-20 13:17:24.508 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-20 13:17:24.508 +03:00 [DBG] Start key discovery request
2019-08-20 13:17:36.243 +03:00 [DBG] Request path /connect/introspect matched to endpoint type Introspection
2019-08-20 13:17:36.243 +03:00 [DBG] Endpoint enabled: Introspection, successfully created handler: IdentityServer4.Endpoints.IntrospectionEndpoint
2019-08-20 13:17:36.246 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.IntrospectionEndpoint for /connect/introspect
2019-08-20 13:17:36.247 +03:00 [DBG] Starting introspection request.
2019-08-20 13:17:36.247 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-20 13:17:36.248 +03:00 [DBG] Start parsing for secret in post body
2019-08-20 13:17:36.248 +03:00 [DBG] No secret in post body found
2019-08-20 13:17:36.249 +03:00 [DBG] Parser found no secret
2019-08-20 13:17:36.249 +03:00 [ERR] No API secret found
2019-08-20 13:17:36.250 +03:00 [ERR] API unauthorized to call introspection endpoint. aborting.
2019-08-20 13:18:30.621 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-20 13:18:30.629 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-20 13:18:30.630 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-20 13:18:30.631 +03:00 [DBG] Start discovery request
2019-08-20 13:18:30.763 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-20 13:18:30.766 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-20 13:18:30.766 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-20 13:18:30.767 +03:00 [DBG] Start key discovery request
2019-08-20 13:18:32.612 +03:00 [DBG] Request path /connect/introspect matched to endpoint type Introspection
2019-08-20 13:18:32.616 +03:00 [DBG] Endpoint enabled: Introspection, successfully created handler: IdentityServer4.Endpoints.IntrospectionEndpoint
2019-08-20 13:18:32.617 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.IntrospectionEndpoint for /connect/introspect
2019-08-20 13:18:32.617 +03:00 [DBG] Starting introspection request.
2019-08-20 13:18:32.618 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-20 13:18:32.618 +03:00 [DBG] Start parsing for secret in post body
2019-08-20 13:18:32.619 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-20 13:18:32.620 +03:00 [DBG] Secret id found: mvc
2019-08-20 13:18:32.622 +03:00 [ERR] No API resource with that name found. aborting
2019-08-20 13:18:32.623 +03:00 [ERR] API unauthorized to call introspection endpoint. aborting.
2019-08-20 13:20:12.954 +03:00 [DBG] Request path /connect/introspect matched to endpoint type Introspection
2019-08-20 13:20:12.955 +03:00 [DBG] Endpoint enabled: Introspection, successfully created handler: IdentityServer4.Endpoints.IntrospectionEndpoint
2019-08-20 13:20:12.960 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.IntrospectionEndpoint for /connect/introspect
2019-08-20 13:20:12.961 +03:00 [DBG] Starting introspection request.
2019-08-20 13:20:12.961 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-20 13:20:12.962 +03:00 [WRN] Malformed Basic Authentication credential.
2019-08-20 13:20:12.962 +03:00 [DBG] Start parsing for secret in post body
2019-08-20 13:20:12.963 +03:00 [DBG] No secret in post body found
2019-08-20 13:20:12.963 +03:00 [DBG] Parser found no secret
2019-08-20 13:20:12.963 +03:00 [ERR] No API secret found
2019-08-20 13:20:12.964 +03:00 [ERR] API unauthorized to call introspection endpoint. aborting.
2019-08-20 13:21:15.291 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-20 13:21:15.294 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-20 13:21:15.295 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-20 13:21:15.295 +03:00 [DBG] Start discovery request
2019-08-20 13:21:15.411 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-20 13:21:15.412 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-20 13:21:15.413 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-20 13:21:15.413 +03:00 [DBG] Start key discovery request
2019-08-20 13:21:17.194 +03:00 [DBG] Request path /connect/introspect matched to endpoint type Introspection
2019-08-20 13:21:17.195 +03:00 [DBG] Endpoint enabled: Introspection, successfully created handler: IdentityServer4.Endpoints.IntrospectionEndpoint
2019-08-20 13:21:17.196 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.IntrospectionEndpoint for /connect/introspect
2019-08-20 13:21:17.197 +03:00 [DBG] Starting introspection request.
2019-08-20 13:21:17.197 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-20 13:21:17.197 +03:00 [DBG] Start parsing for secret in post body
2019-08-20 13:21:17.199 +03:00 [DBG] client id without secret found
2019-08-20 13:21:17.199 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-20 13:21:17.200 +03:00 [DBG] Secret id found: afcpayroll
2019-08-20 13:21:17.201 +03:00 [DBG] Hashed shared secret validator cannot process NoSecret
2019-08-20 13:21:17.202 +03:00 [DBG] Secret validators could not validate secret
2019-08-20 13:21:17.205 +03:00 [ERR] API validation failed.
2019-08-20 13:21:17.208 +03:00 [ERR] API unauthorized to call introspection endpoint. aborting.
2019-08-20 13:21:45.989 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-20 13:21:45.990 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-20 13:21:45.991 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-20 13:21:45.992 +03:00 [DBG] Start discovery request
2019-08-20 13:21:45.994 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-20 13:21:45.995 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-20 13:21:45.997 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-20 13:21:45.998 +03:00 [DBG] Start key discovery request
2019-08-20 13:21:46.001 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-20 13:21:46.001 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-20 13:21:46.002 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-20 13:21:46.002 +03:00 [DBG] Start token request.
2019-08-20 13:21:46.003 +03:00 [DBG] Start client validation
2019-08-20 13:21:46.003 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-20 13:21:46.004 +03:00 [DBG] Start parsing for secret in post body
2019-08-20 13:21:46.004 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-20 13:21:46.005 +03:00 [DBG] Secret id found: mvc
2019-08-20 13:21:46.005 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 13:21:46.006 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-20 13:21:46.006 +03:00 [DBG] Client validation success
2019-08-20 13:21:46.006 +03:00 [DBG] Start token request validation
2019-08-20 13:21:46.007 +03:00 [DBG] Start validation of refresh token request
2019-08-20 13:21:46.010 +03:00 [DBG] Token validation success
{"ClientId":"mvc","ClientName":"MVC Client","ValidateLifetime":false,"AccessTokenType":null,"ExpectedScope":null,"TokenHandle":null,"JwtId":null,"Claims":{"sub":"1","client_id":"mvc","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"auth_time":1566292799,"idp":"local","amr":"pwd","name":"alice","email":"alice@email.com"},"$type":"TokenValidationLog"}
2019-08-20 13:21:46.014 +03:00 [DBG] Validation of refresh token request success
2019-08-20 13:21:46.014 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"refresh_token","Scopes":null,"AuthorizationCode":null,"RefreshToken":"9d66be211c1a8034aee671ec32833a86243b59ff1adfe8bf9b28cfd4abd75b62","UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"refresh_token","refresh_token":"***REDACTED***","client_id":"mvc","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2019-08-20 13:21:46.021 +03:00 [DBG] Updating refresh token
2019-08-20 13:21:46.021 +03:00 [DBG] Token usage is one-time only. Generating new handle
2019-08-20 13:21:46.022 +03:00 [DBG] Created refresh token in store
2019-08-20 13:21:46.022 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 13:21:46.023 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 13:21:46.028 +03:00 [DBG] Token request success.
2019-08-20 13:21:56.100 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-20 13:21:56.104 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-20 13:21:56.105 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-20 13:21:56.105 +03:00 [DBG] Start discovery request
2019-08-20 13:22:00.519 +03:00 [DBG] Request path /connect/introspect matched to endpoint type Introspection
2019-08-20 13:22:00.522 +03:00 [DBG] Endpoint enabled: Introspection, successfully created handler: IdentityServer4.Endpoints.IntrospectionEndpoint
2019-08-20 13:22:00.523 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.IntrospectionEndpoint for /connect/introspect
2019-08-20 13:22:00.528 +03:00 [WRN] Introspection endpoint only supports POST requests
2019-08-20 13:23:53.969 +03:00 [DBG] Request path /connect/introspect matched to endpoint type Introspection
2019-08-20 13:23:53.970 +03:00 [DBG] Endpoint enabled: Introspection, successfully created handler: IdentityServer4.Endpoints.IntrospectionEndpoint
2019-08-20 13:23:53.971 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.IntrospectionEndpoint for /connect/introspect
2019-08-20 13:23:53.972 +03:00 [DBG] Starting introspection request.
2019-08-20 13:23:53.973 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-20 13:23:53.973 +03:00 [WRN] Malformed Basic Authentication credential.
2019-08-20 13:23:53.974 +03:00 [DBG] Start parsing for secret in post body
2019-08-20 13:23:53.975 +03:00 [DBG] No secret in post body found
2019-08-20 13:23:53.975 +03:00 [DBG] Parser found no secret
2019-08-20 13:23:53.976 +03:00 [ERR] No API secret found
2019-08-20 13:23:53.977 +03:00 [ERR] API unauthorized to call introspection endpoint. aborting.
2019-08-20 13:24:12.365 +03:00 [DBG] Request path /connect/introspect matched to endpoint type Introspection
2019-08-20 13:24:12.369 +03:00 [DBG] Endpoint enabled: Introspection, successfully created handler: IdentityServer4.Endpoints.IntrospectionEndpoint
2019-08-20 13:24:12.370 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.IntrospectionEndpoint for /connect/introspect
2019-08-20 13:24:12.370 +03:00 [DBG] Starting introspection request.
2019-08-20 13:24:12.371 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-20 13:24:12.372 +03:00 [DBG] client id without secret found
2019-08-20 13:24:12.373 +03:00 [DBG] Parser found secret: BasicAuthenticationSecretParser
2019-08-20 13:24:12.373 +03:00 [DBG] Start parsing for secret in post body
2019-08-20 13:24:12.374 +03:00 [DBG] No secret in post body found
2019-08-20 13:24:12.374 +03:00 [DBG] Secret id found: afcpayroll
2019-08-20 13:24:12.375 +03:00 [DBG] Hashed shared secret validator cannot process NoSecret
2019-08-20 13:24:12.376 +03:00 [DBG] Secret validators could not validate secret
2019-08-20 13:24:12.376 +03:00 [ERR] API validation failed.
2019-08-20 13:24:12.376 +03:00 [ERR] API unauthorized to call introspection endpoint. aborting.
2019-08-20 13:25:17.742 +03:00 [DBG] Request path /connect/introspect matched to endpoint type Introspection
2019-08-20 13:25:17.746 +03:00 [DBG] Endpoint enabled: Introspection, successfully created handler: IdentityServer4.Endpoints.IntrospectionEndpoint
2019-08-20 13:25:17.746 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.IntrospectionEndpoint for /connect/introspect
2019-08-20 13:25:17.747 +03:00 [DBG] Starting introspection request.
2019-08-20 13:25:17.747 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-20 13:25:17.748 +03:00 [DBG] Parser found secret: BasicAuthenticationSecretParser
2019-08-20 13:25:17.748 +03:00 [DBG] Secret id found: afcpayroll
2019-08-20 13:25:17.749 +03:00 [DBG] No shared secret configured for client.
2019-08-20 13:25:17.749 +03:00 [DBG] Secret validators could not validate secret
2019-08-20 13:25:17.749 +03:00 [ERR] API validation failed.
2019-08-20 13:25:17.750 +03:00 [ERR] API unauthorized to call introspection endpoint. aborting.
2019-08-20 13:52:18.576 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-20 13:52:18.578 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-20 13:52:18.579 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-20 13:52:18.580 +03:00 [DBG] Start discovery request
2019-08-20 13:52:18.583 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-20 13:52:18.584 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-20 13:52:18.584 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-20 13:52:18.585 +03:00 [DBG] Start key discovery request
2019-08-20 13:52:18.587 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-20 13:52:18.589 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-20 13:52:18.590 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-20 13:52:18.591 +03:00 [DBG] Start token request.
2019-08-20 13:52:18.592 +03:00 [DBG] Start client validation
2019-08-20 13:52:18.593 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-20 13:52:18.593 +03:00 [DBG] Start parsing for secret in post body
2019-08-20 13:52:18.594 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-20 13:52:18.594 +03:00 [DBG] Secret id found: mvc
2019-08-20 13:52:18.595 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 13:52:18.596 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-20 13:52:18.596 +03:00 [DBG] Client validation success
2019-08-20 13:52:18.597 +03:00 [DBG] Start token request validation
2019-08-20 13:52:18.597 +03:00 [DBG] Start validation of refresh token request
2019-08-20 13:52:18.599 +03:00 [DBG] Token validation success
{"ClientId":"mvc","ClientName":"MVC Client","ValidateLifetime":false,"AccessTokenType":null,"ExpectedScope":null,"TokenHandle":null,"JwtId":null,"Claims":{"sub":"1","client_id":"mvc","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"auth_time":1566292799,"idp":"local","amr":"pwd","name":"alice","email":"alice@email.com"},"$type":"TokenValidationLog"}
2019-08-20 13:52:18.603 +03:00 [DBG] Validation of refresh token request success
2019-08-20 13:52:18.603 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"refresh_token","Scopes":null,"AuthorizationCode":null,"RefreshToken":"10fa776d93191995f49abf23ec576c65566a3f19d99787a66c53ad0edb6cb49d","UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"refresh_token","refresh_token":"***REDACTED***","client_id":"mvc","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2019-08-20 13:52:18.610 +03:00 [DBG] Updating refresh token
2019-08-20 13:52:18.612 +03:00 [DBG] Token usage is one-time only. Generating new handle
2019-08-20 13:52:18.613 +03:00 [DBG] Created refresh token in store
2019-08-20 13:52:18.613 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 13:52:18.614 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 13:52:18.619 +03:00 [DBG] Token request success.
2019-08-20 13:52:46.374 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-20 13:52:46.375 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-20 13:52:46.375 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-20 13:52:46.376 +03:00 [DBG] Start discovery request
2019-08-20 13:52:46.379 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-20 13:52:46.380 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-20 13:52:46.380 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-20 13:52:46.381 +03:00 [DBG] Start key discovery request
2019-08-20 13:52:46.384 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-20 13:52:46.385 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-20 13:52:46.386 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-20 13:52:46.387 +03:00 [DBG] Start token request.
2019-08-20 13:52:46.387 +03:00 [DBG] Start client validation
2019-08-20 13:52:46.388 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-20 13:52:46.388 +03:00 [DBG] Start parsing for secret in post body
2019-08-20 13:52:46.389 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-20 13:52:46.389 +03:00 [DBG] Secret id found: mvc
2019-08-20 13:52:46.390 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 13:52:46.390 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-20 13:52:46.391 +03:00 [DBG] Client validation success
2019-08-20 13:52:46.391 +03:00 [DBG] Start token request validation
2019-08-20 13:52:46.392 +03:00 [DBG] Start validation of refresh token request
2019-08-20 13:52:46.392 +03:00 [DBG] Token validation success
{"ClientId":"mvc","ClientName":"MVC Client","ValidateLifetime":false,"AccessTokenType":null,"ExpectedScope":null,"TokenHandle":null,"JwtId":null,"Claims":{"sub":"1","client_id":"mvc","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"auth_time":1566292799,"idp":"local","amr":"pwd","name":"alice","email":"alice@email.com"},"$type":"TokenValidationLog"}
2019-08-20 13:52:46.399 +03:00 [DBG] Validation of refresh token request success
2019-08-20 13:52:46.399 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"refresh_token","Scopes":null,"AuthorizationCode":null,"RefreshToken":"d936906111d09e736b6753474dd501a5f7a9246fdeececea071f726b428c1dc7","UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"refresh_token","refresh_token":"***REDACTED***","client_id":"mvc","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2019-08-20 13:52:46.405 +03:00 [DBG] Updating refresh token
2019-08-20 13:52:46.406 +03:00 [DBG] Token usage is one-time only. Generating new handle
2019-08-20 13:52:46.406 +03:00 [DBG] Created refresh token in store
2019-08-20 13:52:46.407 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 13:52:46.408 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 13:52:46.412 +03:00 [DBG] Token request success.
2019-08-20 13:54:14.253 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-20 13:54:14.254 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-20 13:54:14.255 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-20 13:54:14.256 +03:00 [DBG] Start discovery request
2019-08-20 13:54:14.295 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-20 13:54:14.296 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-20 13:54:14.297 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-20 13:54:14.300 +03:00 [DBG] Start key discovery request
2019-08-20 13:54:15.104 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-20 13:54:15.105 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-20 13:54:15.106 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-20 13:54:15.106 +03:00 [DBG] Start token request.
2019-08-20 13:54:15.107 +03:00 [DBG] Start client validation
2019-08-20 13:54:15.107 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-20 13:54:15.108 +03:00 [DBG] Start parsing for secret in post body
2019-08-20 13:54:15.109 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-20 13:54:15.109 +03:00 [DBG] Secret id found: mvc
2019-08-20 13:54:15.110 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 13:54:15.111 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-20 13:54:15.111 +03:00 [DBG] Client validation success
2019-08-20 13:54:15.112 +03:00 [DBG] Start token request validation
2019-08-20 13:54:15.116 +03:00 [DBG] Start validation of refresh token request
2019-08-20 13:54:15.121 +03:00 [DBG] refresh_token grant with value: d936906111d09e736b6753474dd501a5f7a9246fdeececea071f726b428c1dc7 not found in store.
2019-08-20 13:54:15.122 +03:00 [WRN] Invalid refresh token
2019-08-20 13:54:15.123 +03:00 [WRN] Refresh token validation failed. aborting, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"refresh_token","Scopes":null,"AuthorizationCode":null,"RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"refresh_token","refresh_token":"***REDACTED***","client_id":"mvc","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2019-08-20 13:54:37.669 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-20 13:54:37.673 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-20 13:54:37.674 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-20 13:54:37.676 +03:00 [DBG] Start token request.
2019-08-20 13:54:37.677 +03:00 [DBG] Start client validation
2019-08-20 13:54:37.678 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-20 13:54:37.678 +03:00 [DBG] Start parsing for secret in post body
2019-08-20 13:54:37.680 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-20 13:54:37.680 +03:00 [DBG] Secret id found: mvc
2019-08-20 13:54:37.681 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 13:54:37.691 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-20 13:54:37.691 +03:00 [DBG] Client validation success
2019-08-20 13:54:37.692 +03:00 [DBG] Start token request validation
2019-08-20 13:54:37.692 +03:00 [DBG] Start validation of refresh token request
2019-08-20 13:54:37.693 +03:00 [DBG] Token validation success
{"ClientId":"mvc","ClientName":"MVC Client","ValidateLifetime":false,"AccessTokenType":null,"ExpectedScope":null,"TokenHandle":null,"JwtId":null,"Claims":{"sub":"1","client_id":"mvc","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"auth_time":1566292799,"idp":"local","amr":"pwd","name":"alice","email":"alice@email.com"},"$type":"TokenValidationLog"}
2019-08-20 13:54:37.708 +03:00 [DBG] Validation of refresh token request success
2019-08-20 13:54:37.709 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"refresh_token","Scopes":null,"AuthorizationCode":null,"RefreshToken":"34963bc765e9cd2503855850991bb160604c3c9bb63ef833881e66c0f119e06c","UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"refresh_token","refresh_token":"***REDACTED***","client_id":"mvc","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2019-08-20 13:54:37.716 +03:00 [DBG] Updating refresh token
2019-08-20 13:54:37.722 +03:00 [DBG] Token usage is one-time only. Generating new handle
2019-08-20 13:54:37.723 +03:00 [DBG] Created refresh token in store
2019-08-20 13:54:37.724 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 13:54:37.724 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 13:54:37.731 +03:00 [DBG] Token request success.
2019-08-20 13:55:32.946 +03:00 [INF] Starting IdentityServer4 version 2.5.0.0
2019-08-20 13:55:33.022 +03:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2019-08-20 13:55:33.025 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for authentication
2019-08-20 13:55:33.026 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-in
2019-08-20 13:55:33.026 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-out
2019-08-20 13:55:33.026 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for challenge
2019-08-20 13:55:33.027 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for forbid
2019-08-20 13:55:38.493 +03:00 [DBG] Login Url: /account/login
2019-08-20 13:55:38.496 +03:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-08-20 13:55:38.499 +03:00 [DBG] Logout Url: /Account/Logout
2019-08-20 13:55:38.499 +03:00 [DBG] ConsentUrl Url: /consent
2019-08-20 13:55:38.499 +03:00 [DBG] Consent Return Url Parameter: returnUrl
2019-08-20 13:55:38.500 +03:00 [DBG] Error Url: /home/error
2019-08-20 13:55:38.500 +03:00 [DBG] Error Id Parameter: errorId
2019-08-20 13:55:38.538 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-20 13:55:38.544 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-20 13:55:38.545 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-20 13:55:38.551 +03:00 [DBG] Start discovery request
2019-08-20 13:55:38.671 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-20 13:55:38.673 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-20 13:55:38.678 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-20 13:55:38.684 +03:00 [DBG] Start key discovery request
2019-08-20 13:55:41.599 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-20 13:55:41.614 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-20 13:55:41.615 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-20 13:55:41.626 +03:00 [DBG] Start token request.
2019-08-20 13:55:41.638 +03:00 [DBG] Start client validation
2019-08-20 13:55:41.648 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-20 13:55:41.653 +03:00 [DBG] Start parsing for secret in post body
2019-08-20 13:55:41.683 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-20 13:55:41.684 +03:00 [DBG] Secret id found: mvc
2019-08-20 13:55:41.711 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 13:55:41.725 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-20 13:55:41.725 +03:00 [DBG] Client validation success
2019-08-20 13:55:41.738 +03:00 [DBG] Start token request validation
2019-08-20 13:55:41.749 +03:00 [DBG] Start validation of refresh token request
2019-08-20 13:55:41.761 +03:00 [DBG] refresh_token grant with value: c6c50433d192cf25295fa64043f4e29d4a8da154c027776bc16bddcb47e2eaa4 not found in store.
2019-08-20 13:55:41.762 +03:00 [WRN] Invalid refresh token
2019-08-20 13:55:41.780 +03:00 [WRN] Refresh token validation failed. aborting, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"refresh_token","Scopes":null,"AuthorizationCode":null,"RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"refresh_token","refresh_token":"***REDACTED***","client_id":"mvc","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2019-08-20 13:56:08.643 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-20 13:56:08.647 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-20 13:56:08.648 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-20 13:56:08.649 +03:00 [DBG] Start discovery request
2019-08-20 13:56:08.689 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-20 13:56:08.691 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-20 13:56:08.692 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-20 13:56:08.693 +03:00 [DBG] Start key discovery request
2019-08-20 13:56:10.591 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-20 13:56:10.593 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-20 13:56:10.594 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-20 13:56:10.596 +03:00 [DBG] Start token request.
2019-08-20 13:56:10.596 +03:00 [DBG] Start client validation
2019-08-20 13:56:10.597 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-20 13:56:10.597 +03:00 [DBG] Start parsing for secret in post body
2019-08-20 13:56:10.598 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-20 13:56:10.599 +03:00 [DBG] Secret id found: mvc
2019-08-20 13:56:10.599 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 13:56:10.603 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-20 13:56:10.604 +03:00 [DBG] Client validation success
2019-08-20 13:56:10.605 +03:00 [DBG] Start token request validation
2019-08-20 13:56:10.606 +03:00 [DBG] Start validation of refresh token request
2019-08-20 13:56:10.607 +03:00 [DBG] refresh_token grant with value: c6c50433d192cf25295fa64043f4e29d4a8da154c027776bc16bddcb47e2eaa4 not found in store.
2019-08-20 13:56:10.608 +03:00 [WRN] Invalid refresh token
2019-08-20 13:56:10.609 +03:00 [WRN] Refresh token validation failed. aborting, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"refresh_token","Scopes":null,"AuthorizationCode":null,"RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"refresh_token","refresh_token":"***REDACTED***","client_id":"mvc","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2019-08-20 13:56:21.656 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-20 13:56:21.657 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-20 13:56:21.658 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-20 13:56:21.659 +03:00 [DBG] Start discovery request
2019-08-20 13:56:21.713 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-20 13:56:21.715 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-20 13:56:21.715 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-20 13:56:21.716 +03:00 [DBG] Start key discovery request
2019-08-20 13:56:21.782 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-08-20 13:56:21.804 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-08-20 13:56:21.805 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-08-20 13:56:21.810 +03:00 [DBG] Start authorize request
2019-08-20 13:56:21.822 +03:00 [DBG] No user present in authorize request
2019-08-20 13:56:21.833 +03:00 [DBG] Start authorize request protocol validation
2019-08-20 13:56:21.838 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 13:56:21.858 +03:00 [DBG] Checking for PKCE parameters
2019-08-20 13:56:21.862 +03:00 [DBG] No PKCE used.
2019-08-20 13:56:21.918 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-20 13:56:21.926 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/home/signin-oidc","AllowedRedirectUris":["http://localhost:5002/home/signin-oidc"],"SubjectId":"anonymous","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9OctQoyUFOUxdbuLJHhsrrnLwdLr83NjPt8hUgoCJTXZpfgaO02dwtJan2kIXl6KXKmW5KWIYibC-G-Qi1mHQszuMcgHRbMEXCr_8Rt2DIWrqZKwM3ciJP9TKARP3ZYPAzW0K810RQFBxELJl2qlGxqurZrQOd20799M8A5bkWE4zQkNBWShLanDaQmGdJMZQhuvDpuz3NrRgKQwbVYeiG8yBF3YXPOJDzkAGQXaqMIEIE76yy359iPk_1foe9RVQyM5FtTqzgbIoufPoxRqAwOtUiRJeKjaC_Q68jGpfGISNj7C3pwv5LXef-dLinnlEw","UiLocales":null,"Nonce":"637018953817374747.MzQzZTNjOTEtY2UyZS00MTdjLWE5OWYtYTFhODA0ZDgwZjFiMTcyZjlhNzgtMzdiYS00YzczLWEzNDQtZDMxYTQ4MTQyZTY0","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/home/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637018953817374747.MzQzZTNjOTEtY2UyZS00MTdjLWE5OWYtYTFhODA0ZDgwZjFiMTcyZjlhNzgtMzdiYS00YzczLWEzNDQtZDMxYTQ4MTQyZTY0","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9OctQoyUFOUxdbuLJHhsrrnLwdLr83NjPt8hUgoCJTXZpfgaO02dwtJan2kIXl6KXKmW5KWIYibC-G-Qi1mHQszuMcgHRbMEXCr_8Rt2DIWrqZKwM3ciJP9TKARP3ZYPAzW0K810RQFBxELJl2qlGxqurZrQOd20799M8A5bkWE4zQkNBWShLanDaQmGdJMZQhuvDpuz3NrRgKQwbVYeiG8yBF3YXPOJDzkAGQXaqMIEIE76yy359iPk_1foe9RVQyM5FtTqzgbIoufPoxRqAwOtUiRJeKjaC_Q68jGpfGISNj7C3pwv5LXef-dLinnlEw","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-20 13:56:21.947 +03:00 [INF] Showing login: User is not authenticated
2019-08-20 13:56:22.166 +03:00 [DBG] Start authorize request protocol validation
2019-08-20 13:56:22.167 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 13:56:22.168 +03:00 [DBG] Checking for PKCE parameters
2019-08-20 13:56:22.169 +03:00 [DBG] No PKCE used.
2019-08-20 13:56:22.169 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-20 13:56:22.173 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 13:56:24.279 +03:00 [DBG] CORS request made for path: /account/login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-08-20 13:56:24.311 +03:00 [DBG] Start authorize request protocol validation
2019-08-20 13:56:24.312 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 13:56:24.313 +03:00 [DBG] Checking for PKCE parameters
2019-08-20 13:56:24.314 +03:00 [DBG] No PKCE used.
2019-08-20 13:56:24.314 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-20 13:56:24.340 +03:00 [DBG] Augmenting SignInContext
2019-08-20 13:56:24.343 +03:00 [DBG] Adding idp claim with value: local
2019-08-20 13:56:24.346 +03:00 [DBG] Adding amr claim with value: pwd
2019-08-20 13:56:24.360 +03:00 [INF] AuthenticationScheme: idsrv signed in.
2019-08-20 13:56:24.368 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 13:56:24.383 +03:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-08-20 13:56:24.386 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-08-20 13:56:24.387 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-08-20 13:56:24.398 +03:00 [DBG] Start authorize callback request
2019-08-20 13:56:24.403 +03:00 [DBG] User in authorize request: 1
2019-08-20 13:56:24.404 +03:00 [DBG] Start authorize request protocol validation
2019-08-20 13:56:24.405 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 13:56:24.405 +03:00 [DBG] Checking for PKCE parameters
2019-08-20 13:56:24.406 +03:00 [DBG] No PKCE used.
2019-08-20 13:56:24.406 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-20 13:56:24.408 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/home/signin-oidc","AllowedRedirectUris":["http://localhost:5002/home/signin-oidc"],"SubjectId":"1","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9OctQoyUFOUxdbuLJHhsrrnLwdLr83NjPt8hUgoCJTXZpfgaO02dwtJan2kIXl6KXKmW5KWIYibC-G-Qi1mHQszuMcgHRbMEXCr_8Rt2DIWrqZKwM3ciJP9TKARP3ZYPAzW0K810RQFBxELJl2qlGxqurZrQOd20799M8A5bkWE4zQkNBWShLanDaQmGdJMZQhuvDpuz3NrRgKQwbVYeiG8yBF3YXPOJDzkAGQXaqMIEIE76yy359iPk_1foe9RVQyM5FtTqzgbIoufPoxRqAwOtUiRJeKjaC_Q68jGpfGISNj7C3pwv5LXef-dLinnlEw","UiLocales":null,"Nonce":"637018953817374747.MzQzZTNjOTEtY2UyZS00MTdjLWE5OWYtYTFhODA0ZDgwZjFiMTcyZjlhNzgtMzdiYS00YzczLWEzNDQtZDMxYTQ4MTQyZTY0","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"27ab5c0296b925e5b1bff15302a94b36","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/home/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637018953817374747.MzQzZTNjOTEtY2UyZS00MTdjLWE5OWYtYTFhODA0ZDgwZjFiMTcyZjlhNzgtMzdiYS00YzczLWEzNDQtZDMxYTQ4MTQyZTY0","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9OctQoyUFOUxdbuLJHhsrrnLwdLr83NjPt8hUgoCJTXZpfgaO02dwtJan2kIXl6KXKmW5KWIYibC-G-Qi1mHQszuMcgHRbMEXCr_8Rt2DIWrqZKwM3ciJP9TKARP3ZYPAzW0K810RQFBxELJl2qlGxqurZrQOd20799M8A5bkWE4zQkNBWShLanDaQmGdJMZQhuvDpuz3NrRgKQwbVYeiG8yBF3YXPOJDzkAGQXaqMIEIE76yy359iPk_1foe9RVQyM5FtTqzgbIoufPoxRqAwOtUiRJeKjaC_Q68jGpfGISNj7C3pwv5LXef-dLinnlEw","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-20 13:56:24.435 +03:00 [DBG] Client is configured to not require consent, no consent is required
2019-08-20 13:56:24.453 +03:00 [DBG] Creating Hybrid Flow response.
2019-08-20 13:56:24.493 +03:00 [DBG] Creating Implicit Flow response.
2019-08-20 13:56:24.505 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 13:56:24.509 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 13:56:24.591 +03:00 [DBG] Authorize endpoint response
{"SubjectId":"1","ClientId":"mvc","RedirectUri":"http://localhost:5002/home/signin-oidc","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9OctQoyUFOUxdbuLJHhsrrnLwdLr83NjPt8hUgoCJTXZpfgaO02dwtJan2kIXl6KXKmW5KWIYibC-G-Qi1mHQszuMcgHRbMEXCr_8Rt2DIWrqZKwM3ciJP9TKARP3ZYPAzW0K810RQFBxELJl2qlGxqurZrQOd20799M8A5bkWE4zQkNBWShLanDaQmGdJMZQhuvDpuz3NrRgKQwbVYeiG8yBF3YXPOJDzkAGQXaqMIEIE76yy359iPk_1foe9RVQyM5FtTqzgbIoufPoxRqAwOtUiRJeKjaC_Q68jGpfGISNj7C3pwv5LXef-dLinnlEw","Scope":"openid profile afcpayroll offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-08-20 13:56:24.615 +03:00 [DBG] Augmenting SignInContext
2019-08-20 13:56:24.616 +03:00 [INF] AuthenticationScheme: idsrv signed in.
2019-08-20 13:56:24.935 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-20 13:56:24.936 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-20 13:56:24.937 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-20 13:56:24.940 +03:00 [DBG] Start token request.
2019-08-20 13:56:24.942 +03:00 [DBG] Start client validation
2019-08-20 13:56:24.943 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-20 13:56:24.943 +03:00 [DBG] Start parsing for secret in post body
2019-08-20 13:56:24.947 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-20 13:56:24.948 +03:00 [DBG] Secret id found: mvc
2019-08-20 13:56:24.948 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 13:56:24.949 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-20 13:56:24.950 +03:00 [DBG] Client validation success
2019-08-20 13:56:24.950 +03:00 [DBG] Start token request validation
2019-08-20 13:56:24.962 +03:00 [DBG] Start validation of authorization code token request
2019-08-20 13:56:24.975 +03:00 [DBG] Validation of authorization code token request success
2019-08-20 13:56:24.976 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"3cdd408bf5822c4b37893628dbd580d7f4ec362ce70479ffc6d99c2c7614b9b0","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"mvc","client_secret":"***REDACTED***","code":"3cdd408bf5822c4b37893628dbd580d7f4ec362ce70479ffc6d99c2c7614b9b0","grant_type":"authorization_code","redirect_uri":"http://localhost:5002/home/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-08-20 13:56:25.003 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 13:56:25.020 +03:00 [DBG] Getting claims for access token for client: mvc
2019-08-20 13:56:25.022 +03:00 [DBG] Getting claims for access token for subject: 1
2019-08-20 13:56:25.039 +03:00 [DBG] Creating refresh token
2019-08-20 13:56:25.040 +03:00 [DBG] Setting an absolute lifetime: 2592000
2019-08-20 13:56:25.061 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 13:56:25.062 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 13:56:25.063 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 13:56:25.071 +03:00 [DBG] Token request success.
2019-08-20 13:56:25.088 +03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-08-20 13:56:25.089 +03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-08-20 13:56:25.090 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-08-20 13:56:25.101 +03:00 [DBG] Start userinfo request
2019-08-20 13:56:25.105 +03:00 [DBG] Bearer token found in header
2019-08-20 13:56:25.187 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 13:56:25.192 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 13:56:25.194 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-08-20 13:56:25.198 +03:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1566298585,"exp":1566298645,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","afcpayroll"],"client_id":"mvc","sub":"1","auth_time":1566298584,"idp":"local","name":"alice","email":"alice@email.com","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-08-20 13:56:25.211 +03:00 [DBG] Creating userinfo response
2019-08-20 13:56:25.216 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 13:56:25.219 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 13:56:25.222 +03:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 13:56:25.223 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 13:56:25.224 +03:00 [INF] Profile service returned the following claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 13:56:25.225 +03:00 [DBG] End userinfo request
2019-08-20 13:57:30.912 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-20 13:57:30.914 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-20 13:57:30.915 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-20 13:57:30.915 +03:00 [DBG] Start discovery request
2019-08-20 13:57:30.918 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-20 13:57:30.919 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-20 13:57:30.920 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-20 13:57:30.921 +03:00 [DBG] Start key discovery request
2019-08-20 13:57:36.103 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-20 13:57:36.104 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-20 13:57:36.105 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-20 13:57:36.106 +03:00 [DBG] Start token request.
2019-08-20 13:57:36.106 +03:00 [DBG] Start client validation
2019-08-20 13:57:36.107 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-20 13:57:36.107 +03:00 [DBG] Start parsing for secret in post body
2019-08-20 13:57:36.108 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-20 13:57:36.108 +03:00 [DBG] Secret id found: mvc
2019-08-20 13:57:36.109 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 13:57:36.109 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-20 13:57:36.110 +03:00 [DBG] Client validation success
2019-08-20 13:57:36.110 +03:00 [DBG] Start token request validation
2019-08-20 13:57:36.111 +03:00 [DBG] Start validation of refresh token request
2019-08-20 13:57:36.127 +03:00 [DBG] Token validation success
{"ClientId":"mvc","ClientName":"MVC Client","ValidateLifetime":false,"AccessTokenType":null,"ExpectedScope":null,"TokenHandle":null,"JwtId":null,"Claims":{"sub":"1","client_id":"mvc","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"auth_time":1566298584,"idp":"local","amr":"pwd","name":"alice","email":"alice@email.com"},"$type":"TokenValidationLog"}
2019-08-20 13:57:36.132 +03:00 [DBG] Validation of refresh token request success
2019-08-20 13:57:36.133 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"refresh_token","Scopes":null,"AuthorizationCode":null,"RefreshToken":"a6a1714a05dfffe30e51653be3f7a4733a9b18c3f593ae749ef0d9a643ff5549","UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"refresh_token","refresh_token":"***REDACTED***","client_id":"mvc","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2019-08-20 13:57:36.153 +03:00 [DBG] Updating refresh token
2019-08-20 13:57:36.154 +03:00 [DBG] No updates to refresh token done
2019-08-20 13:57:36.162 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 13:57:36.163 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 13:57:36.168 +03:00 [DBG] Token request success.
2019-08-20 13:58:39.074 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-20 13:58:39.075 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-20 13:58:39.076 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-20 13:58:39.076 +03:00 [DBG] Start discovery request
2019-08-20 13:58:39.207 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-20 13:58:39.211 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-20 13:58:39.212 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-20 13:58:39.212 +03:00 [DBG] Start key discovery request
2019-08-20 13:58:46.542 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-20 13:58:46.543 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-20 13:58:46.544 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-20 13:58:46.544 +03:00 [DBG] Start discovery request
2019-08-20 13:58:46.578 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-20 13:58:46.580 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-20 13:58:46.580 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-20 13:58:46.581 +03:00 [DBG] Start key discovery request
2019-08-20 13:58:46.687 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-20 13:58:46.688 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-20 13:58:46.690 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-20 13:58:46.690 +03:00 [DBG] Start token request.
2019-08-20 13:58:46.691 +03:00 [DBG] Start client validation
2019-08-20 13:58:46.691 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-20 13:58:46.692 +03:00 [DBG] Start parsing for secret in post body
2019-08-20 13:58:46.692 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-20 13:58:46.693 +03:00 [DBG] Secret id found: mvc
2019-08-20 13:58:46.694 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 13:58:46.694 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-20 13:58:46.695 +03:00 [DBG] Client validation success
2019-08-20 13:58:46.695 +03:00 [DBG] Start token request validation
2019-08-20 13:58:46.696 +03:00 [DBG] Start validation of refresh token request
2019-08-20 13:58:46.697 +03:00 [DBG] Token validation success
{"ClientId":"mvc","ClientName":"MVC Client","ValidateLifetime":false,"AccessTokenType":null,"ExpectedScope":null,"TokenHandle":null,"JwtId":null,"Claims":{"sub":"1","client_id":"mvc","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"auth_time":1566298584,"idp":"local","amr":"pwd","name":"alice","email":"alice@email.com"},"$type":"TokenValidationLog"}
2019-08-20 13:58:46.700 +03:00 [DBG] Validation of refresh token request success
2019-08-20 13:58:46.700 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"refresh_token","Scopes":null,"AuthorizationCode":null,"RefreshToken":"a6a1714a05dfffe30e51653be3f7a4733a9b18c3f593ae749ef0d9a643ff5549","UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"refresh_token","refresh_token":"***REDACTED***","client_id":"mvc","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2019-08-20 13:58:46.709 +03:00 [DBG] Updating refresh token
2019-08-20 13:58:46.710 +03:00 [DBG] No updates to refresh token done
2019-08-20 13:58:46.711 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 13:58:46.712 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 13:58:46.716 +03:00 [DBG] Token request success.
2019-08-20 15:31:52.482 +03:00 [INF] Starting IdentityServer4 version 2.5.0.0
2019-08-20 15:31:52.553 +03:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2019-08-20 15:31:52.554 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for authentication
2019-08-20 15:31:52.554 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-in
2019-08-20 15:31:52.555 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-out
2019-08-20 15:31:52.555 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for challenge
2019-08-20 15:31:52.555 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for forbid
2019-08-20 15:33:13.807 +03:00 [INF] Starting IdentityServer4 version 2.5.0.0
2019-08-20 15:33:13.889 +03:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2019-08-20 15:33:13.891 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for authentication
2019-08-20 15:33:13.891 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-in
2019-08-20 15:33:13.892 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-out
2019-08-20 15:33:13.892 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for challenge
2019-08-20 15:33:13.893 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for forbid
2019-08-20 17:14:00.063 +03:00 [DBG] Login Url: /account/login
2019-08-20 17:14:00.069 +03:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-08-20 17:14:00.070 +03:00 [DBG] Logout Url: /Account/Logout
2019-08-20 17:14:00.071 +03:00 [DBG] ConsentUrl Url: /consent
2019-08-20 17:14:00.071 +03:00 [DBG] Consent Return Url Parameter: returnUrl
2019-08-20 17:14:00.071 +03:00 [DBG] Error Url: /home/error
2019-08-20 17:14:00.072 +03:00 [DBG] Error Id Parameter: errorId
2019-08-20 17:14:00.117 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-20 17:14:00.122 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-20 17:14:00.123 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-20 17:14:00.128 +03:00 [DBG] Start discovery request
2019-08-20 17:14:00.617 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-20 17:14:00.619 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-20 17:14:00.624 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-20 17:14:00.631 +03:00 [DBG] Start key discovery request
2019-08-20 17:14:00.854 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-08-20 17:14:00.883 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-08-20 17:14:00.884 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-08-20 17:14:00.891 +03:00 [DBG] Start authorize request
2019-08-20 17:14:00.907 +03:00 [DBG] No user present in authorize request
2019-08-20 17:14:00.916 +03:00 [DBG] Start authorize request protocol validation
2019-08-20 17:14:00.950 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 17:14:00.987 +03:00 [ERR] Invalid redirect_uri: http://localhost:57002/home/signin-oidc
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":null,"AllowedRedirectUris":["http://localhost:57004/home/signin-oidc"],"SubjectId":"anonymous","ResponseType":null,"ResponseMode":null,"GrantType":null,"RequestedScopes":"","State":null,"UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"mvc","redirect_uri":"http://localhost:57002/home/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637019072406851370.NDBmZGM5ZDgtYWUxZC00Y2RmLTg0N2MtOGRiMWZiNTk0NmRlZGYxZTg5ODgtODVhZC00Njg1LTllOTgtNTAyYjA3ZWNkM2Q1","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9N-7rccb_AKGFwXijmzdAdsJhCyVXARXVcP1bPZL-1VucqCgRvQoTGocuzrv4WF4-h77nF_Gp2qNVn0Ny6EAfKunaDxoYANEk5jVphOOQFUKfMNj5AgajpCxtl-5CiW_SbgNks2hYI-jy7Sr374x8Karn1Zr8T1P62-qKQU0c8Ule3Nfpzk3vMQOKJYKlrOdE3I5lr6zPK07ZPuQeuT4MkqOySFI26h7hmZXD4JyZ0jt4e29Gh2kCzi9ROYdUJ5Nviazyoxo0sBlVG0-TkvSZaE8pH5kJs6zqfgO8SsaFq_8mdCWCQsgw2WswCOT8S7uTE","x-client-SKU":"ID_NET461","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-20 17:14:01.021 +03:00 [ERR] Request validation failed
2019-08-20 17:14:01.021 +03:00 [INF] {"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":null,"AllowedRedirectUris":["http://localhost:57004/home/signin-oidc"],"SubjectId":"anonymous","ResponseType":null,"ResponseMode":null,"GrantType":null,"RequestedScopes":"","State":null,"UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"mvc","redirect_uri":"http://localhost:57002/home/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637019072406851370.NDBmZGM5ZDgtYWUxZC00Y2RmLTg0N2MtOGRiMWZiNTk0NmRlZGYxZTg5ODgtODVhZC00Njg1LTllOTgtNTAyYjA3ZWNkM2Q1","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9N-7rccb_AKGFwXijmzdAdsJhCyVXARXVcP1bPZL-1VucqCgRvQoTGocuzrv4WF4-h77nF_Gp2qNVn0Ny6EAfKunaDxoYANEk5jVphOOQFUKfMNj5AgajpCxtl-5CiW_SbgNks2hYI-jy7Sr374x8Karn1Zr8T1P62-qKQU0c8Ule3Nfpzk3vMQOKJYKlrOdE3I5lr6zPK07ZPuQeuT4MkqOySFI26h7hmZXD4JyZ0jt4e29Gh2kCzi9ROYdUJ5Nviazyoxo0sBlVG0-TkvSZaE8pH5kJs6zqfgO8SsaFq_8mdCWCQsgw2WswCOT8S7uTE","x-client-SKU":"ID_NET461","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-20 17:15:42.723 +03:00 [INF] Starting IdentityServer4 version 2.5.0.0
2019-08-20 17:15:42.791 +03:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2019-08-20 17:15:42.793 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for authentication
2019-08-20 17:15:42.793 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-in
2019-08-20 17:15:42.794 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-out
2019-08-20 17:15:42.794 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for challenge
2019-08-20 17:15:42.795 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for forbid
2019-08-20 17:15:47.503 +03:00 [DBG] Login Url: /account/login
2019-08-20 17:15:47.506 +03:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-08-20 17:15:47.508 +03:00 [DBG] Logout Url: /Account/Logout
2019-08-20 17:15:47.508 +03:00 [DBG] ConsentUrl Url: /consent
2019-08-20 17:15:47.509 +03:00 [DBG] Consent Return Url Parameter: returnUrl
2019-08-20 17:15:47.509 +03:00 [DBG] Error Url: /home/error
2019-08-20 17:15:47.509 +03:00 [DBG] Error Id Parameter: errorId
2019-08-20 17:15:47.550 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-08-20 17:15:47.570 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-08-20 17:15:47.572 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-08-20 17:15:47.577 +03:00 [DBG] Start authorize request
2019-08-20 17:15:47.592 +03:00 [DBG] No user present in authorize request
2019-08-20 17:15:47.601 +03:00 [DBG] Start authorize request protocol validation
2019-08-20 17:15:47.632 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 17:15:47.651 +03:00 [DBG] Checking for PKCE parameters
2019-08-20 17:15:47.654 +03:00 [DBG] No PKCE used.
2019-08-20 17:15:47.712 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-20 17:15:47.735 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:57002/home/signin-oidc","AllowedRedirectUris":["http://localhost:57002/home/signin-oidc"],"SubjectId":"anonymous","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9MrYF5Sfa1V-LqwIp6joAG80Wxl_hT59ZWbFTSS_t6I2K2u3OvX3fTAzoxT1I84toWL8iub2FKjOI4pPiQp6spUzZWDg7wzLIM7oBrq2PwbzVqvPFLjwlUcBLS_WwM8HnkmqVtvHBVBq3jlmpcFBqKpQ0JHUl4JKcBdUXw3b71nNPBk8KIDfOK5oxqURNJwf-hAG5AQXG9p_I2DAHyySP-kNWbwC76mcSoskcGXgvSAYOAC3BY97p325G3Gy1qtKxnwgoCphpApWtrjm5y-6EflRNwPZsQ8ECR96F0wR1OjwZ_NYmxEDHdQDPJHIG8Nt-w","UiLocales":null,"Nonce":"637019073473967373.OGJhNDQ0OTItYWVkMy00OTlmLWFhZTgtNDQ1ZTMxODdmMTBiMWIwM2VlMTEtYzFkYi00NGZiLWIxZDEtNTVlZGYwZWJiMGNh","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"mvc","redirect_uri":"http://localhost:57002/home/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637019073473967373.OGJhNDQ0OTItYWVkMy00OTlmLWFhZTgtNDQ1ZTMxODdmMTBiMWIwM2VlMTEtYzFkYi00NGZiLWIxZDEtNTVlZGYwZWJiMGNh","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9MrYF5Sfa1V-LqwIp6joAG80Wxl_hT59ZWbFTSS_t6I2K2u3OvX3fTAzoxT1I84toWL8iub2FKjOI4pPiQp6spUzZWDg7wzLIM7oBrq2PwbzVqvPFLjwlUcBLS_WwM8HnkmqVtvHBVBq3jlmpcFBqKpQ0JHUl4JKcBdUXw3b71nNPBk8KIDfOK5oxqURNJwf-hAG5AQXG9p_I2DAHyySP-kNWbwC76mcSoskcGXgvSAYOAC3BY97p325G3Gy1qtKxnwgoCphpApWtrjm5y-6EflRNwPZsQ8ECR96F0wR1OjwZ_NYmxEDHdQDPJHIG8Nt-w","x-client-SKU":"ID_NET461","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-20 17:15:47.774 +03:00 [INF] Showing login: User is not authenticated
2019-08-20 17:15:47.985 +03:00 [DBG] Start authorize request protocol validation
2019-08-20 17:15:47.986 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 17:15:47.998 +03:00 [DBG] Checking for PKCE parameters
2019-08-20 17:15:48.001 +03:00 [DBG] No PKCE used.
2019-08-20 17:15:48.003 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-20 17:15:48.019 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 17:15:54.586 +03:00 [DBG] CORS request made for path: /account/login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-08-20 17:15:54.682 +03:00 [DBG] Start authorize request protocol validation
2019-08-20 17:15:54.683 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 17:15:54.694 +03:00 [DBG] Checking for PKCE parameters
2019-08-20 17:15:54.701 +03:00 [DBG] No PKCE used.
2019-08-20 17:15:54.709 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-20 17:15:54.765 +03:00 [DBG] Augmenting SignInContext
2019-08-20 17:15:54.774 +03:00 [DBG] Adding idp claim with value: local
2019-08-20 17:15:54.775 +03:00 [DBG] Adding amr claim with value: pwd
2019-08-20 17:15:54.797 +03:00 [INF] AuthenticationScheme: idsrv signed in.
2019-08-20 17:15:54.804 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 17:15:54.829 +03:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-08-20 17:15:54.833 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-08-20 17:15:54.849 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-08-20 17:15:54.879 +03:00 [DBG] Start authorize callback request
2019-08-20 17:15:54.892 +03:00 [DBG] User in authorize request: 1
2019-08-20 17:15:54.894 +03:00 [DBG] Start authorize request protocol validation
2019-08-20 17:15:54.896 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 17:15:54.929 +03:00 [DBG] Checking for PKCE parameters
2019-08-20 17:15:54.940 +03:00 [DBG] No PKCE used.
2019-08-20 17:15:54.944 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-20 17:15:54.963 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:57002/home/signin-oidc","AllowedRedirectUris":["http://localhost:57002/home/signin-oidc"],"SubjectId":"1","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9MrYF5Sfa1V-LqwIp6joAG80Wxl_hT59ZWbFTSS_t6I2K2u3OvX3fTAzoxT1I84toWL8iub2FKjOI4pPiQp6spUzZWDg7wzLIM7oBrq2PwbzVqvPFLjwlUcBLS_WwM8HnkmqVtvHBVBq3jlmpcFBqKpQ0JHUl4JKcBdUXw3b71nNPBk8KIDfOK5oxqURNJwf-hAG5AQXG9p_I2DAHyySP-kNWbwC76mcSoskcGXgvSAYOAC3BY97p325G3Gy1qtKxnwgoCphpApWtrjm5y-6EflRNwPZsQ8ECR96F0wR1OjwZ_NYmxEDHdQDPJHIG8Nt-w","UiLocales":null,"Nonce":"637019073473967373.OGJhNDQ0OTItYWVkMy00OTlmLWFhZTgtNDQ1ZTMxODdmMTBiMWIwM2VlMTEtYzFkYi00NGZiLWIxZDEtNTVlZGYwZWJiMGNh","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"c90b6e18e51e101484bbd892b84c73e2","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:57002/home/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637019073473967373.OGJhNDQ0OTItYWVkMy00OTlmLWFhZTgtNDQ1ZTMxODdmMTBiMWIwM2VlMTEtYzFkYi00NGZiLWIxZDEtNTVlZGYwZWJiMGNh","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9MrYF5Sfa1V-LqwIp6joAG80Wxl_hT59ZWbFTSS_t6I2K2u3OvX3fTAzoxT1I84toWL8iub2FKjOI4pPiQp6spUzZWDg7wzLIM7oBrq2PwbzVqvPFLjwlUcBLS_WwM8HnkmqVtvHBVBq3jlmpcFBqKpQ0JHUl4JKcBdUXw3b71nNPBk8KIDfOK5oxqURNJwf-hAG5AQXG9p_I2DAHyySP-kNWbwC76mcSoskcGXgvSAYOAC3BY97p325G3Gy1qtKxnwgoCphpApWtrjm5y-6EflRNwPZsQ8ECR96F0wR1OjwZ_NYmxEDHdQDPJHIG8Nt-w","x-client-SKU":"ID_NET461","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-20 17:15:55.031 +03:00 [DBG] Client is configured to not require consent, no consent is required
2019-08-20 17:15:55.039 +03:00 [DBG] Creating Hybrid Flow response.
2019-08-20 17:15:55.086 +03:00 [DBG] Creating Implicit Flow response.
2019-08-20 17:15:55.100 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 17:15:55.104 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 17:15:55.206 +03:00 [DBG] Authorize endpoint response
{"SubjectId":"1","ClientId":"mvc","RedirectUri":"http://localhost:57002/home/signin-oidc","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9MrYF5Sfa1V-LqwIp6joAG80Wxl_hT59ZWbFTSS_t6I2K2u3OvX3fTAzoxT1I84toWL8iub2FKjOI4pPiQp6spUzZWDg7wzLIM7oBrq2PwbzVqvPFLjwlUcBLS_WwM8HnkmqVtvHBVBq3jlmpcFBqKpQ0JHUl4JKcBdUXw3b71nNPBk8KIDfOK5oxqURNJwf-hAG5AQXG9p_I2DAHyySP-kNWbwC76mcSoskcGXgvSAYOAC3BY97p325G3Gy1qtKxnwgoCphpApWtrjm5y-6EflRNwPZsQ8ECR96F0wR1OjwZ_NYmxEDHdQDPJHIG8Nt-w","Scope":"openid profile afcpayroll offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-08-20 17:15:55.247 +03:00 [DBG] Augmenting SignInContext
2019-08-20 17:15:55.249 +03:00 [INF] AuthenticationScheme: idsrv signed in.
2019-08-20 17:15:56.752 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-20 17:15:56.763 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-20 17:15:56.768 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-20 17:15:56.792 +03:00 [DBG] Start token request.
2019-08-20 17:15:56.801 +03:00 [DBG] Start client validation
2019-08-20 17:15:56.811 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-20 17:15:56.820 +03:00 [DBG] Start parsing for secret in post body
2019-08-20 17:15:56.844 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-20 17:15:56.845 +03:00 [DBG] Secret id found: mvc
2019-08-20 17:15:56.851 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 17:15:56.875 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-20 17:15:56.876 +03:00 [DBG] Client validation success
2019-08-20 17:15:56.888 +03:00 [DBG] Start token request validation
2019-08-20 17:15:56.903 +03:00 [DBG] Start validation of authorization code token request
2019-08-20 17:15:56.925 +03:00 [DBG] Validation of authorization code token request success
2019-08-20 17:15:56.930 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"0d1aaf7abaabe06ea8c54ade1f983d7cae729a8cad9a8f9532f26a60654b5d57","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"mvc","client_secret":"***REDACTED***","code":"0d1aaf7abaabe06ea8c54ade1f983d7cae729a8cad9a8f9532f26a60654b5d57","grant_type":"authorization_code","redirect_uri":"http://localhost:57002/home/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-08-20 17:15:56.973 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 17:15:56.990 +03:00 [DBG] Getting claims for access token for client: mvc
2019-08-20 17:15:56.992 +03:00 [DBG] Getting claims for access token for subject: 1
2019-08-20 17:15:57.012 +03:00 [DBG] Creating refresh token
2019-08-20 17:15:57.012 +03:00 [DBG] Setting an absolute lifetime: 2592000
2019-08-20 17:15:57.033 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 17:15:57.037 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-20 17:15:57.062 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-20 17:15:57.095 +03:00 [DBG] Token request success.
2019-08-20 17:15:57.161 +03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-08-20 17:15:57.166 +03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-08-20 17:15:57.176 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-08-20 17:15:57.198 +03:00 [DBG] Start userinfo request
2019-08-20 17:15:57.205 +03:00 [DBG] Bearer token found in header
2019-08-20 17:15:57.297 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 17:15:57.306 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-20 17:15:57.315 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-08-20 17:15:57.328 +03:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1566310557,"exp":1566310617,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","afcpayroll"],"client_id":"mvc","sub":"1","auth_time":1566310554,"idp":"local","name":"alice","email":"alice@email.com","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-08-20 17:15:57.366 +03:00 [DBG] Creating userinfo response
2019-08-20 17:15:57.374 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 17:15:57.383 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 17:15:57.398 +03:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 17:15:57.404 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-20 17:15:57.420 +03:00 [INF] Profile service returned the following claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-20 17:15:57.432 +03:00 [DBG] End userinfo request
2019-08-21 08:53:14.388 +03:00 [INF] Starting IdentityServer4 version 2.5.0.0
2019-08-21 08:53:14.495 +03:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2019-08-21 08:53:14.496 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for authentication
2019-08-21 08:53:14.497 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-in
2019-08-21 08:53:14.498 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-out
2019-08-21 08:53:14.498 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for challenge
2019-08-21 08:53:14.499 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for forbid
2019-08-21 08:54:20.252 +03:00 [DBG] Login Url: /account/login
2019-08-21 08:54:20.258 +03:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-08-21 08:54:20.258 +03:00 [DBG] Logout Url: /Account/Logout
2019-08-21 08:54:20.259 +03:00 [DBG] ConsentUrl Url: /consent
2019-08-21 08:54:20.261 +03:00 [DBG] Consent Return Url Parameter: returnUrl
2019-08-21 08:54:20.263 +03:00 [DBG] Error Url: /home/error
2019-08-21 08:54:20.264 +03:00 [DBG] Error Id Parameter: errorId
2019-08-21 08:54:20.318 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-21 08:54:20.325 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-21 08:54:20.328 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-21 08:54:20.335 +03:00 [DBG] Start discovery request
2019-08-21 08:54:20.690 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-21 08:54:20.709 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-21 08:54:20.711 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-21 08:54:20.722 +03:00 [DBG] Start key discovery request
2019-08-21 08:54:20.845 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-08-21 08:54:20.868 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-08-21 08:54:20.870 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-08-21 08:54:20.876 +03:00 [DBG] Start authorize request
2019-08-21 08:54:20.896 +03:00 [DBG] No user present in authorize request
2019-08-21 08:54:20.908 +03:00 [DBG] Start authorize request protocol validation
2019-08-21 08:54:20.960 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-21 08:54:20.994 +03:00 [DBG] Checking for PKCE parameters
2019-08-21 08:54:20.998 +03:00 [DBG] No PKCE used.
2019-08-21 08:54:21.076 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-21 08:54:21.121 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/home/signin-oidc","AllowedRedirectUris":["http://localhost:57002/home/signin-oidc","http://localhost:5002/home/signin-oidc"],"SubjectId":"anonymous","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9MBh9MFsKdnd2QBrvNQShOIKAacq8QVZybjss7zs8Z3ZoivflG957LT3CBDEt8B-PEN8I26Rkp_5OdMxMx8sIduq4XyahzySNFbdPo7Onz9-kwJ489KfTj4TjRPqVM3xrA4wb9PoYSCOxF211SyV6Wdl7EbLopY7iCA5JAHXQNgNLwqbcHpbNz3mPEGxbl6YFE_vXSS3X2iXRxKoA_V_gGlnrzWI16qetQ-43OO6lw-iVWHY-_zfZ9mTlChBGk2Gua0pXUiPhMWgQuhZsY57HEBmP3B5wZZMJHd7HHt90ySJl3YpWmiKtB5ZGZkCqu2DN4","UiLocales":null,"Nonce":"637019636607810787.ZmIwNmEyMDQtNzYzMS00YTUyLWJlZGUtMmI3ZGE3MmI4Y2E0Y2YxM2IyYWItMmRkMi00ZTEwLWFjNzUtY2EwMzJiMzI4NjAz","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/home/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637019636607810787.ZmIwNmEyMDQtNzYzMS00YTUyLWJlZGUtMmI3ZGE3MmI4Y2E0Y2YxM2IyYWItMmRkMi00ZTEwLWFjNzUtY2EwMzJiMzI4NjAz","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9MBh9MFsKdnd2QBrvNQShOIKAacq8QVZybjss7zs8Z3ZoivflG957LT3CBDEt8B-PEN8I26Rkp_5OdMxMx8sIduq4XyahzySNFbdPo7Onz9-kwJ489KfTj4TjRPqVM3xrA4wb9PoYSCOxF211SyV6Wdl7EbLopY7iCA5JAHXQNgNLwqbcHpbNz3mPEGxbl6YFE_vXSS3X2iXRxKoA_V_gGlnrzWI16qetQ-43OO6lw-iVWHY-_zfZ9mTlChBGk2Gua0pXUiPhMWgQuhZsY57HEBmP3B5wZZMJHd7HHt90ySJl3YpWmiKtB5ZGZkCqu2DN4","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-21 08:54:21.214 +03:00 [INF] Showing login: User is not authenticated
2019-08-21 08:54:21.506 +03:00 [DBG] Start authorize request protocol validation
2019-08-21 08:54:21.507 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-21 08:54:21.516 +03:00 [DBG] Checking for PKCE parameters
2019-08-21 08:54:21.517 +03:00 [DBG] No PKCE used.
2019-08-21 08:54:21.519 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-21 08:54:21.537 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-21 08:54:24.176 +03:00 [DBG] CORS request made for path: /account/login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-08-21 08:54:24.320 +03:00 [DBG] Start authorize request protocol validation
2019-08-21 08:54:24.320 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-21 08:54:24.331 +03:00 [DBG] Checking for PKCE parameters
2019-08-21 08:54:24.338 +03:00 [DBG] No PKCE used.
2019-08-21 08:54:24.340 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-21 08:54:24.392 +03:00 [DBG] Augmenting SignInContext
2019-08-21 08:54:24.397 +03:00 [DBG] Adding idp claim with value: local
2019-08-21 08:54:24.398 +03:00 [DBG] Adding amr claim with value: pwd
2019-08-21 08:54:24.426 +03:00 [INF] AuthenticationScheme: idsrv signed in.
2019-08-21 08:54:24.433 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-21 08:54:24.459 +03:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-08-21 08:54:24.464 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-08-21 08:54:24.476 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-08-21 08:54:24.502 +03:00 [DBG] Start authorize callback request
2019-08-21 08:54:24.513 +03:00 [DBG] User in authorize request: 1
2019-08-21 08:54:24.514 +03:00 [DBG] Start authorize request protocol validation
2019-08-21 08:54:24.516 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-21 08:54:24.529 +03:00 [DBG] Checking for PKCE parameters
2019-08-21 08:54:24.537 +03:00 [DBG] No PKCE used.
2019-08-21 08:54:24.542 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-21 08:54:24.554 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/home/signin-oidc","AllowedRedirectUris":["http://localhost:57002/home/signin-oidc","http://localhost:5002/home/signin-oidc"],"SubjectId":"1","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9MBh9MFsKdnd2QBrvNQShOIKAacq8QVZybjss7zs8Z3ZoivflG957LT3CBDEt8B-PEN8I26Rkp_5OdMxMx8sIduq4XyahzySNFbdPo7Onz9-kwJ489KfTj4TjRPqVM3xrA4wb9PoYSCOxF211SyV6Wdl7EbLopY7iCA5JAHXQNgNLwqbcHpbNz3mPEGxbl6YFE_vXSS3X2iXRxKoA_V_gGlnrzWI16qetQ-43OO6lw-iVWHY-_zfZ9mTlChBGk2Gua0pXUiPhMWgQuhZsY57HEBmP3B5wZZMJHd7HHt90ySJl3YpWmiKtB5ZGZkCqu2DN4","UiLocales":null,"Nonce":"637019636607810787.ZmIwNmEyMDQtNzYzMS00YTUyLWJlZGUtMmI3ZGE3MmI4Y2E0Y2YxM2IyYWItMmRkMi00ZTEwLWFjNzUtY2EwMzJiMzI4NjAz","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"28e9fef8725023f4ee31ec68c29cf4b8","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/home/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637019636607810787.ZmIwNmEyMDQtNzYzMS00YTUyLWJlZGUtMmI3ZGE3MmI4Y2E0Y2YxM2IyYWItMmRkMi00ZTEwLWFjNzUtY2EwMzJiMzI4NjAz","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9MBh9MFsKdnd2QBrvNQShOIKAacq8QVZybjss7zs8Z3ZoivflG957LT3CBDEt8B-PEN8I26Rkp_5OdMxMx8sIduq4XyahzySNFbdPo7Onz9-kwJ489KfTj4TjRPqVM3xrA4wb9PoYSCOxF211SyV6Wdl7EbLopY7iCA5JAHXQNgNLwqbcHpbNz3mPEGxbl6YFE_vXSS3X2iXRxKoA_V_gGlnrzWI16qetQ-43OO6lw-iVWHY-_zfZ9mTlChBGk2Gua0pXUiPhMWgQuhZsY57HEBmP3B5wZZMJHd7HHt90ySJl3YpWmiKtB5ZGZkCqu2DN4","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-21 08:54:24.631 +03:00 [DBG] Client is configured to not require consent, no consent is required
2019-08-21 08:54:24.647 +03:00 [DBG] Creating Hybrid Flow response.
2019-08-21 08:54:24.717 +03:00 [DBG] Creating Implicit Flow response.
2019-08-21 08:54:24.739 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-21 08:54:24.753 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-21 08:54:24.878 +03:00 [DBG] Authorize endpoint response
{"SubjectId":"1","ClientId":"mvc","RedirectUri":"http://localhost:5002/home/signin-oidc","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9MBh9MFsKdnd2QBrvNQShOIKAacq8QVZybjss7zs8Z3ZoivflG957LT3CBDEt8B-PEN8I26Rkp_5OdMxMx8sIduq4XyahzySNFbdPo7Onz9-kwJ489KfTj4TjRPqVM3xrA4wb9PoYSCOxF211SyV6Wdl7EbLopY7iCA5JAHXQNgNLwqbcHpbNz3mPEGxbl6YFE_vXSS3X2iXRxKoA_V_gGlnrzWI16qetQ-43OO6lw-iVWHY-_zfZ9mTlChBGk2Gua0pXUiPhMWgQuhZsY57HEBmP3B5wZZMJHd7HHt90ySJl3YpWmiKtB5ZGZkCqu2DN4","Scope":"openid profile afcpayroll offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-08-21 08:54:24.931 +03:00 [DBG] Augmenting SignInContext
2019-08-21 08:54:24.936 +03:00 [INF] AuthenticationScheme: idsrv signed in.
2019-08-21 08:54:25.352 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-21 08:54:25.368 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-21 08:54:25.371 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-21 08:54:25.400 +03:00 [DBG] Start token request.
2019-08-21 08:54:25.415 +03:00 [DBG] Start client validation
2019-08-21 08:54:25.428 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-21 08:54:25.438 +03:00 [DBG] Start parsing for secret in post body
2019-08-21 08:54:25.439 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-21 08:54:25.440 +03:00 [DBG] Secret id found: mvc
2019-08-21 08:54:25.448 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-21 08:54:25.481 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-21 08:54:25.482 +03:00 [DBG] Client validation success
2019-08-21 08:54:25.496 +03:00 [DBG] Start token request validation
2019-08-21 08:54:25.522 +03:00 [DBG] Start validation of authorization code token request
2019-08-21 08:54:25.554 +03:00 [DBG] Validation of authorization code token request success
2019-08-21 08:54:25.563 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"e5e17b95b2dcfd612089c839a59785f93af2c0d5e612144dcb2c5ea07ba44f37","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"mvc","client_secret":"***REDACTED***","code":"e5e17b95b2dcfd612089c839a59785f93af2c0d5e612144dcb2c5ea07ba44f37","grant_type":"authorization_code","redirect_uri":"http://localhost:5002/home/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-08-21 08:54:25.608 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-21 08:54:25.637 +03:00 [DBG] Getting claims for access token for client: mvc
2019-08-21 08:54:25.639 +03:00 [DBG] Getting claims for access token for subject: 1
2019-08-21 08:54:25.666 +03:00 [DBG] Creating refresh token
2019-08-21 08:54:25.666 +03:00 [DBG] Setting an absolute lifetime: 2592000
2019-08-21 08:54:25.696 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-21 08:54:25.701 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-21 08:54:25.717 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-21 08:54:25.742 +03:00 [DBG] Token request success.
2019-08-21 08:54:25.774 +03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-08-21 08:54:25.782 +03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-08-21 08:54:25.793 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-08-21 08:54:25.820 +03:00 [DBG] Start userinfo request
2019-08-21 08:54:25.829 +03:00 [DBG] Bearer token found in header
2019-08-21 08:54:25.939 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-21 08:54:25.958 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-21 08:54:25.963 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-08-21 08:54:25.974 +03:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1566366865,"exp":1566366925,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","afcpayroll"],"client_id":"mvc","sub":"1","auth_time":1566366864,"idp":"local","name":"alice","email":"alice@email.com","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-08-21 08:54:26.013 +03:00 [DBG] Creating userinfo response
2019-08-21 08:54:26.023 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-21 08:54:26.032 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-21 08:54:26.051 +03:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-21 08:54:26.056 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-21 08:54:26.070 +03:00 [INF] Profile service returned the following claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-21 08:54:26.085 +03:00 [DBG] End userinfo request
2019-08-21 09:00:17.089 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-21 09:00:17.093 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-21 09:00:17.098 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-21 09:00:17.099 +03:00 [DBG] Start discovery request
2019-08-21 09:00:17.138 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-21 09:00:17.140 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-21 09:00:17.143 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-21 09:00:17.146 +03:00 [DBG] Start key discovery request
2019-08-21 09:00:17.193 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-21 09:00:17.197 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-21 09:00:17.198 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-21 09:00:17.200 +03:00 [DBG] Start token request.
2019-08-21 09:00:17.201 +03:00 [DBG] Start client validation
2019-08-21 09:00:17.207 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-21 09:00:17.210 +03:00 [DBG] Start parsing for secret in post body
2019-08-21 09:00:17.216 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-21 09:00:17.218 +03:00 [DBG] Secret id found: mvc
2019-08-21 09:00:17.220 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-21 09:00:17.221 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-21 09:00:17.222 +03:00 [DBG] Client validation success
2019-08-21 09:00:17.223 +03:00 [DBG] Start token request validation
2019-08-21 09:00:17.230 +03:00 [DBG] Start validation of refresh token request
2019-08-21 09:00:17.252 +03:00 [DBG] Token validation success
{"ClientId":"mvc","ClientName":"MVC Client","ValidateLifetime":false,"AccessTokenType":null,"ExpectedScope":null,"TokenHandle":null,"JwtId":null,"Claims":{"sub":"1","client_id":"mvc","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"auth_time":1566366864,"idp":"local","amr":"pwd","name":"alice","email":"alice@email.com"},"$type":"TokenValidationLog"}
2019-08-21 09:00:17.256 +03:00 [DBG] Validation of refresh token request success
2019-08-21 09:00:17.257 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"refresh_token","Scopes":null,"AuthorizationCode":null,"RefreshToken":"11be499bac65eb9b453387d2709080224dcfa4d702358f344aa02ec3ed4cc399","UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"refresh_token","refresh_token":"***REDACTED***","client_id":"mvc","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2019-08-21 09:00:17.279 +03:00 [DBG] Updating refresh token
2019-08-21 09:00:17.280 +03:00 [DBG] No updates to refresh token done
2019-08-21 09:00:17.286 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-21 09:00:17.287 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-21 09:00:17.291 +03:00 [DBG] Token request success.
2019-08-21 09:00:22.265 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-21 09:00:22.267 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-21 09:00:22.268 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-21 09:00:22.269 +03:00 [DBG] Start discovery request
2019-08-21 09:00:22.272 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-21 09:00:22.273 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-21 09:00:22.275 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-21 09:00:22.279 +03:00 [DBG] Start key discovery request
2019-08-21 09:00:22.282 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-21 09:00:22.283 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-21 09:00:22.285 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-21 09:00:22.286 +03:00 [DBG] Start token request.
2019-08-21 09:00:22.287 +03:00 [DBG] Start client validation
2019-08-21 09:00:22.287 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-21 09:00:22.288 +03:00 [DBG] Start parsing for secret in post body
2019-08-21 09:00:22.289 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-21 09:00:22.290 +03:00 [DBG] Secret id found: mvc
2019-08-21 09:00:22.290 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-21 09:00:22.292 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-21 09:00:22.292 +03:00 [DBG] Client validation success
2019-08-21 09:00:22.293 +03:00 [DBG] Start token request validation
2019-08-21 09:00:22.297 +03:00 [DBG] Start validation of refresh token request
2019-08-21 09:00:22.299 +03:00 [DBG] Token validation success
{"ClientId":"mvc","ClientName":"MVC Client","ValidateLifetime":false,"AccessTokenType":null,"ExpectedScope":null,"TokenHandle":null,"JwtId":null,"Claims":{"sub":"1","client_id":"mvc","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"auth_time":1566366864,"idp":"local","amr":"pwd","name":"alice","email":"alice@email.com"},"$type":"TokenValidationLog"}
2019-08-21 09:00:22.308 +03:00 [DBG] Validation of refresh token request success
2019-08-21 09:00:22.308 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"refresh_token","Scopes":null,"AuthorizationCode":null,"RefreshToken":"11be499bac65eb9b453387d2709080224dcfa4d702358f344aa02ec3ed4cc399","UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"refresh_token","refresh_token":"***REDACTED***","client_id":"mvc","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2019-08-21 09:00:22.320 +03:00 [DBG] Updating refresh token
2019-08-21 09:00:22.320 +03:00 [DBG] No updates to refresh token done
2019-08-21 09:00:22.321 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-21 09:00:22.322 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-21 09:00:22.328 +03:00 [DBG] Token request success.
2019-08-21 09:00:22.525 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-21 09:00:22.527 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-21 09:00:22.530 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-21 09:00:22.532 +03:00 [DBG] Start discovery request
2019-08-21 09:00:22.786 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-21 09:00:22.787 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-21 09:00:22.788 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-21 09:00:22.789 +03:00 [DBG] Start key discovery request
2019-08-21 09:00:40.726 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-21 09:00:40.728 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-21 09:00:40.729 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-21 09:00:40.730 +03:00 [DBG] Start discovery request
2019-08-21 09:00:40.733 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-21 09:00:40.735 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-21 09:00:40.737 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-21 09:00:40.738 +03:00 [DBG] Start key discovery request
2019-08-21 09:00:40.741 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-21 09:00:40.742 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-21 09:00:40.745 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-21 09:00:40.746 +03:00 [DBG] Start token request.
2019-08-21 09:00:40.747 +03:00 [DBG] Start client validation
2019-08-21 09:00:40.747 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-21 09:00:40.748 +03:00 [DBG] Start parsing for secret in post body
2019-08-21 09:00:40.749 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-21 09:00:40.749 +03:00 [DBG] Secret id found: mvc
2019-08-21 09:00:40.750 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-21 09:00:40.751 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-21 09:00:40.752 +03:00 [DBG] Client validation success
2019-08-21 09:00:40.752 +03:00 [DBG] Start token request validation
2019-08-21 09:00:40.753 +03:00 [DBG] Start validation of refresh token request
2019-08-21 09:00:40.754 +03:00 [DBG] Token validation success
{"ClientId":"mvc","ClientName":"MVC Client","ValidateLifetime":false,"AccessTokenType":null,"ExpectedScope":null,"TokenHandle":null,"JwtId":null,"Claims":{"sub":"1","client_id":"mvc","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"auth_time":1566366864,"idp":"local","amr":"pwd","name":"alice","email":"alice@email.com"},"$type":"TokenValidationLog"}
2019-08-21 09:00:40.758 +03:00 [DBG] Validation of refresh token request success
2019-08-21 09:00:40.759 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"refresh_token","Scopes":null,"AuthorizationCode":null,"RefreshToken":"11be499bac65eb9b453387d2709080224dcfa4d702358f344aa02ec3ed4cc399","UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"refresh_token","refresh_token":"***REDACTED***","client_id":"mvc","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2019-08-21 09:00:40.772 +03:00 [DBG] Updating refresh token
2019-08-21 09:00:40.772 +03:00 [DBG] No updates to refresh token done
2019-08-21 09:00:40.773 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-21 09:00:40.775 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-21 09:00:40.780 +03:00 [DBG] Token request success.
2019-08-21 09:01:24.629 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-21 09:01:24.651 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-21 09:01:24.654 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-21 09:01:24.657 +03:00 [DBG] Start discovery request
2019-08-21 09:01:24.696 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-21 09:01:24.697 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-21 09:01:24.698 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-21 09:01:24.699 +03:00 [DBG] Start key discovery request
2019-08-21 09:01:24.738 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-21 09:01:24.743 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-21 09:01:24.750 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-21 09:01:24.753 +03:00 [DBG] Start token request.
2019-08-21 09:01:24.754 +03:00 [DBG] Start client validation
2019-08-21 09:01:24.755 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-21 09:01:24.756 +03:00 [DBG] Start parsing for secret in post body
2019-08-21 09:01:24.759 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-21 09:01:24.763 +03:00 [DBG] Secret id found: mvc
2019-08-21 09:01:24.765 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-21 09:01:24.767 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-21 09:01:24.768 +03:00 [DBG] Client validation success
2019-08-21 09:01:24.769 +03:00 [DBG] Start token request validation
2019-08-21 09:01:24.770 +03:00 [DBG] Start validation of refresh token request
2019-08-21 09:01:24.771 +03:00 [DBG] Token validation success
{"ClientId":"mvc","ClientName":"MVC Client","ValidateLifetime":false,"AccessTokenType":null,"ExpectedScope":null,"TokenHandle":null,"JwtId":null,"Claims":{"sub":"1","client_id":"mvc","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"auth_time":1566366864,"idp":"local","amr":"pwd","name":"alice","email":"alice@email.com"},"$type":"TokenValidationLog"}
2019-08-21 09:01:24.780 +03:00 [DBG] Validation of refresh token request success
2019-08-21 09:01:24.781 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"refresh_token","Scopes":null,"AuthorizationCode":null,"RefreshToken":"11be499bac65eb9b453387d2709080224dcfa4d702358f344aa02ec3ed4cc399","UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"refresh_token","refresh_token":"***REDACTED***","client_id":"mvc","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2019-08-21 09:01:24.790 +03:00 [DBG] Updating refresh token
2019-08-21 09:01:24.790 +03:00 [DBG] No updates to refresh token done
2019-08-21 09:01:24.791 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-21 09:01:24.792 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-21 09:01:24.798 +03:00 [DBG] Token request success.
2019-08-21 09:05:03.162 +03:00 [INF] Starting IdentityServer4 version 2.5.0.0
2019-08-21 09:05:03.238 +03:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2019-08-21 09:05:03.244 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for authentication
2019-08-21 09:05:03.252 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-in
2019-08-21 09:05:03.257 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-out
2019-08-21 09:05:03.264 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for challenge
2019-08-21 09:05:03.270 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for forbid
2019-08-21 10:58:15.513 +03:00 [INF] Starting IdentityServer4 version 2.5.0.0
2019-08-21 10:58:15.589 +03:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2019-08-21 10:58:15.593 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for authentication
2019-08-21 10:58:15.599 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-in
2019-08-21 10:58:15.601 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-out
2019-08-21 10:58:15.602 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for challenge
2019-08-21 10:58:15.615 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for forbid
2019-08-21 10:58:42.911 +03:00 [DBG] Login Url: /account/login
2019-08-21 10:58:42.915 +03:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-08-21 10:58:42.921 +03:00 [DBG] Logout Url: /Account/Logout
2019-08-21 10:58:42.927 +03:00 [DBG] ConsentUrl Url: /consent
2019-08-21 10:58:42.931 +03:00 [DBG] Consent Return Url Parameter: returnUrl
2019-08-21 10:58:42.940 +03:00 [DBG] Error Url: /home/error
2019-08-21 10:58:42.945 +03:00 [DBG] Error Id Parameter: errorId
2019-08-21 10:58:42.992 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-21 10:58:43.002 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-21 10:58:43.008 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-21 10:58:43.024 +03:00 [DBG] Start discovery request
2019-08-21 10:58:43.201 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-21 10:58:43.209 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-21 10:58:43.221 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-21 10:58:43.237 +03:00 [DBG] Start key discovery request
2019-08-21 10:58:43.346 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-08-21 10:58:43.370 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-08-21 10:58:43.372 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-08-21 10:58:43.393 +03:00 [DBG] Start authorize request
2019-08-21 10:58:43.409 +03:00 [DBG] No user present in authorize request
2019-08-21 10:58:43.422 +03:00 [DBG] Start authorize request protocol validation
2019-08-21 10:58:43.456 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-21 10:58:43.481 +03:00 [DBG] Checking for PKCE parameters
2019-08-21 10:58:43.483 +03:00 [DBG] No PKCE used.
2019-08-21 10:58:43.554 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-21 10:58:43.580 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/home/signin-oidc","AllowedRedirectUris":["http://localhost:57002/home/signin-oidc","http://localhost:5002/home/signin-oidc"],"SubjectId":"anonymous","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9M5uBWuAtcqirLu-Ex13uKBwfRjf2drjwGJ_1b85jq0aqw5J-C9hA6gaQ6AwAoebPXcq3L-q9ATQl5VBF12zIusRieU_z41MA9No6ptLI7da1AeaXrVrZ9rPZCENW0CkY61SXdNq1EEoxYaiZrJjldk8lTMnvCj99jUj91vL4JnjEm2-yklR7K_egSfh-M-ZU5kEALxnG3Kfl1aWJ-zvGKL-qRNRe2oaWhNWdM1TDzP9c2TkesirztC-FFbLj0KVIyLn-Ax3XdovUdJuJ3SW3bZgPzMWEuDJTUgtKI0uTSfdoQUTEOhhBF90Bn_7BXnLE8","UiLocales":null,"Nonce":"637019711232913162.MmI3MmI0MmYtNjc0Ny00YWY1LTkyM2QtZjA0MDJiNTA2N2VlZWY0ODViYTAtMDljNC00NDU2LWI1ODMtNjlhOTNhYjA0MmNm","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/home/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637019711232913162.MmI3MmI0MmYtNjc0Ny00YWY1LTkyM2QtZjA0MDJiNTA2N2VlZWY0ODViYTAtMDljNC00NDU2LWI1ODMtNjlhOTNhYjA0MmNm","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9M5uBWuAtcqirLu-Ex13uKBwfRjf2drjwGJ_1b85jq0aqw5J-C9hA6gaQ6AwAoebPXcq3L-q9ATQl5VBF12zIusRieU_z41MA9No6ptLI7da1AeaXrVrZ9rPZCENW0CkY61SXdNq1EEoxYaiZrJjldk8lTMnvCj99jUj91vL4JnjEm2-yklR7K_egSfh-M-ZU5kEALxnG3Kfl1aWJ-zvGKL-qRNRe2oaWhNWdM1TDzP9c2TkesirztC-FFbLj0KVIyLn-Ax3XdovUdJuJ3SW3bZgPzMWEuDJTUgtKI0uTSfdoQUTEOhhBF90Bn_7BXnLE8","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-21 10:58:43.676 +03:00 [INF] Showing login: User is not authenticated
2019-08-21 10:58:43.875 +03:00 [DBG] Start authorize request protocol validation
2019-08-21 10:58:43.877 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-21 10:58:43.888 +03:00 [DBG] Checking for PKCE parameters
2019-08-21 10:58:43.891 +03:00 [DBG] No PKCE used.
2019-08-21 10:58:43.893 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-21 10:58:43.903 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-21 10:58:46.134 +03:00 [DBG] CORS request made for path: /account/login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-08-21 10:58:46.193 +03:00 [DBG] Start authorize request protocol validation
2019-08-21 10:58:46.195 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-21 10:58:46.207 +03:00 [DBG] Checking for PKCE parameters
2019-08-21 10:58:46.213 +03:00 [DBG] No PKCE used.
2019-08-21 10:58:46.216 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-21 10:58:46.279 +03:00 [DBG] Augmenting SignInContext
2019-08-21 10:58:46.286 +03:00 [DBG] Adding idp claim with value: local
2019-08-21 10:58:46.287 +03:00 [DBG] Adding amr claim with value: pwd
2019-08-21 10:58:46.310 +03:00 [INF] AuthenticationScheme: idsrv signed in.
2019-08-21 10:58:46.313 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-21 10:58:46.332 +03:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-08-21 10:58:46.335 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-08-21 10:58:46.336 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-08-21 10:58:46.351 +03:00 [DBG] Start authorize callback request
2019-08-21 10:58:46.357 +03:00 [DBG] User in authorize request: 1
2019-08-21 10:58:46.358 +03:00 [DBG] Start authorize request protocol validation
2019-08-21 10:58:46.359 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-21 10:58:46.378 +03:00 [DBG] Checking for PKCE parameters
2019-08-21 10:58:46.382 +03:00 [DBG] No PKCE used.
2019-08-21 10:58:46.391 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-21 10:58:46.403 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/home/signin-oidc","AllowedRedirectUris":["http://localhost:57002/home/signin-oidc","http://localhost:5002/home/signin-oidc"],"SubjectId":"1","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9M5uBWuAtcqirLu-Ex13uKBwfRjf2drjwGJ_1b85jq0aqw5J-C9hA6gaQ6AwAoebPXcq3L-q9ATQl5VBF12zIusRieU_z41MA9No6ptLI7da1AeaXrVrZ9rPZCENW0CkY61SXdNq1EEoxYaiZrJjldk8lTMnvCj99jUj91vL4JnjEm2-yklR7K_egSfh-M-ZU5kEALxnG3Kfl1aWJ-zvGKL-qRNRe2oaWhNWdM1TDzP9c2TkesirztC-FFbLj0KVIyLn-Ax3XdovUdJuJ3SW3bZgPzMWEuDJTUgtKI0uTSfdoQUTEOhhBF90Bn_7BXnLE8","UiLocales":null,"Nonce":"637019711232913162.MmI3MmI0MmYtNjc0Ny00YWY1LTkyM2QtZjA0MDJiNTA2N2VlZWY0ODViYTAtMDljNC00NDU2LWI1ODMtNjlhOTNhYjA0MmNm","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"2cd1ea55f26a210acd0ad1b38e5bcf0e","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/home/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637019711232913162.MmI3MmI0MmYtNjc0Ny00YWY1LTkyM2QtZjA0MDJiNTA2N2VlZWY0ODViYTAtMDljNC00NDU2LWI1ODMtNjlhOTNhYjA0MmNm","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9M5uBWuAtcqirLu-Ex13uKBwfRjf2drjwGJ_1b85jq0aqw5J-C9hA6gaQ6AwAoebPXcq3L-q9ATQl5VBF12zIusRieU_z41MA9No6ptLI7da1AeaXrVrZ9rPZCENW0CkY61SXdNq1EEoxYaiZrJjldk8lTMnvCj99jUj91vL4JnjEm2-yklR7K_egSfh-M-ZU5kEALxnG3Kfl1aWJ-zvGKL-qRNRe2oaWhNWdM1TDzP9c2TkesirztC-FFbLj0KVIyLn-Ax3XdovUdJuJ3SW3bZgPzMWEuDJTUgtKI0uTSfdoQUTEOhhBF90Bn_7BXnLE8","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-21 10:58:46.463 +03:00 [DBG] Client is configured to not require consent, no consent is required
2019-08-21 10:58:46.473 +03:00 [DBG] Creating Hybrid Flow response.
2019-08-21 10:58:46.519 +03:00 [DBG] Creating Implicit Flow response.
2019-08-21 10:58:46.532 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-21 10:58:46.537 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-21 10:58:46.624 +03:00 [DBG] Authorize endpoint response
{"SubjectId":"1","ClientId":"mvc","RedirectUri":"http://localhost:5002/home/signin-oidc","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9M5uBWuAtcqirLu-Ex13uKBwfRjf2drjwGJ_1b85jq0aqw5J-C9hA6gaQ6AwAoebPXcq3L-q9ATQl5VBF12zIusRieU_z41MA9No6ptLI7da1AeaXrVrZ9rPZCENW0CkY61SXdNq1EEoxYaiZrJjldk8lTMnvCj99jUj91vL4JnjEm2-yklR7K_egSfh-M-ZU5kEALxnG3Kfl1aWJ-zvGKL-qRNRe2oaWhNWdM1TDzP9c2TkesirztC-FFbLj0KVIyLn-Ax3XdovUdJuJ3SW3bZgPzMWEuDJTUgtKI0uTSfdoQUTEOhhBF90Bn_7BXnLE8","Scope":"openid profile afcpayroll offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-08-21 10:58:46.663 +03:00 [DBG] Augmenting SignInContext
2019-08-21 10:58:46.664 +03:00 [INF] AuthenticationScheme: idsrv signed in.
2019-08-21 10:58:47.903 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-21 10:58:47.917 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-21 10:58:47.926 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-21 10:58:47.951 +03:00 [DBG] Start token request.
2019-08-21 10:58:47.965 +03:00 [DBG] Start client validation
2019-08-21 10:58:47.976 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-21 10:58:47.983 +03:00 [DBG] Start parsing for secret in post body
2019-08-21 10:58:47.986 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-21 10:58:47.987 +03:00 [DBG] Secret id found: mvc
2019-08-21 10:58:47.994 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-21 10:58:48.020 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-21 10:58:48.020 +03:00 [DBG] Client validation success
2019-08-21 10:58:48.033 +03:00 [DBG] Start token request validation
2019-08-21 10:58:48.058 +03:00 [DBG] Start validation of authorization code token request
2019-08-21 10:58:48.084 +03:00 [DBG] Validation of authorization code token request success
2019-08-21 10:58:48.088 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"049ef026bb28a9a3059f3d37a7b32704db441b88973526f76c4dd27a25ba7a35","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"mvc","client_secret":"***REDACTED***","code":"049ef026bb28a9a3059f3d37a7b32704db441b88973526f76c4dd27a25ba7a35","grant_type":"authorization_code","redirect_uri":"http://localhost:5002/home/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-08-21 10:58:48.133 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-21 10:58:48.166 +03:00 [DBG] Getting claims for access token for client: mvc
2019-08-21 10:58:48.167 +03:00 [DBG] Getting claims for access token for subject: 1
2019-08-21 10:58:48.189 +03:00 [DBG] Creating refresh token
2019-08-21 10:58:48.189 +03:00 [DBG] Setting an absolute lifetime: 2592000
2019-08-21 10:58:48.212 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-21 10:58:48.217 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-21 10:58:48.229 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-21 10:58:48.245 +03:00 [DBG] Token request success.
2019-08-21 10:58:48.266 +03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-08-21 10:58:48.271 +03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-08-21 10:58:48.284 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-08-21 10:58:48.305 +03:00 [DBG] Start userinfo request
2019-08-21 10:58:48.310 +03:00 [DBG] Bearer token found in header
2019-08-21 10:58:48.400 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-21 10:58:48.409 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-21 10:58:48.418 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-08-21 10:58:48.432 +03:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1566374328,"exp":1566374388,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","afcpayroll"],"client_id":"mvc","sub":"1","auth_time":1566374326,"idp":"local","name":"alice","email":"alice@email.com","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-08-21 10:58:48.454 +03:00 [DBG] Creating userinfo response
2019-08-21 10:58:48.459 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-21 10:58:48.467 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-21 10:58:48.479 +03:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-21 10:58:48.487 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-21 10:58:48.492 +03:00 [INF] Profile service returned the following claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-21 10:58:48.503 +03:00 [DBG] End userinfo request
2019-08-21 11:00:27.071 +03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: https://jwt.io
2019-08-21 11:00:27.084 +03:00 [DBG] AllowedOrigins configured and origin https://jwt.io is not allowed
2019-08-21 11:00:27.088 +03:00 [DBG] Exiting; origin https://jwt.io is not allowed
2019-08-21 11:00:27.101 +03:00 [WRN] CorsPolicyService did not allow origin: https://jwt.io
2019-08-21 11:00:27.110 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-21 11:00:27.126 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-21 11:00:27.132 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-21 11:00:27.146 +03:00 [DBG] Start discovery request
2019-08-21 11:26:59.379 +03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: https://jwt.io
2019-08-21 11:26:59.395 +03:00 [DBG] AllowedOrigins configured and origin https://jwt.io is not allowed
2019-08-21 11:26:59.404 +03:00 [DBG] Exiting; origin https://jwt.io is not allowed
2019-08-21 11:26:59.418 +03:00 [WRN] CorsPolicyService did not allow origin: https://jwt.io
2019-08-21 11:26:59.425 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-21 11:26:59.438 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-21 11:26:59.456 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-21 11:26:59.464 +03:00 [DBG] Start discovery request
2019-08-21 13:16:36.614 +03:00 [INF] Starting IdentityServer4 version 2.5.0.0
2019-08-21 13:16:36.689 +03:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2019-08-21 13:16:36.693 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for authentication
2019-08-21 13:16:36.701 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-in
2019-08-21 13:16:36.706 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-out
2019-08-21 13:16:36.713 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for challenge
2019-08-21 13:16:36.719 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for forbid
2019-08-21 13:17:14.963 +03:00 [DBG] Login Url: /account/login
2019-08-21 13:17:14.968 +03:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-08-21 13:17:14.973 +03:00 [DBG] Logout Url: /Account/Logout
2019-08-21 13:17:14.981 +03:00 [DBG] ConsentUrl Url: /consent
2019-08-21 13:17:14.985 +03:00 [DBG] Consent Return Url Parameter: returnUrl
2019-08-21 13:17:14.986 +03:00 [DBG] Error Url: /home/error
2019-08-21 13:17:14.993 +03:00 [DBG] Error Id Parameter: errorId
2019-08-21 13:17:15.036 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-21 13:17:15.056 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-21 13:17:15.059 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-21 13:17:15.076 +03:00 [DBG] Start discovery request
2019-08-21 13:17:15.453 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-21 13:17:15.462 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-21 13:17:15.472 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-21 13:17:15.488 +03:00 [DBG] Start key discovery request
2019-08-21 13:17:15.608 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-08-21 13:17:15.634 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-08-21 13:17:15.638 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-08-21 13:17:15.667 +03:00 [DBG] Start authorize request
2019-08-21 13:17:15.692 +03:00 [DBG] No user present in authorize request
2019-08-21 13:17:15.704 +03:00 [DBG] Start authorize request protocol validation
2019-08-21 13:17:15.742 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-21 13:17:15.771 +03:00 [DBG] Checking for PKCE parameters
2019-08-21 13:17:15.774 +03:00 [DBG] No PKCE used.
2019-08-21 13:17:15.827 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-21 13:17:15.854 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/home/signin-oidc","AllowedRedirectUris":["http://localhost:57002/home/signin-oidc","http://localhost:5002/home/signin-oidc"],"SubjectId":"anonymous","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9Pi9ETVogI14IFPRQLNLRkr3lPSRvW25N22U7aTvcguIIdKq4oE6ZuNg4LYmb0ohty54UXjykPpKaBLQyaphTOyysfj8siIqx6JgDpnSSnnsv8o5tmK9Wi1Rc-Q2EIM3IljvW0vBVKxRq1SA6ul-SxwnTnOkavfGAr45UOKrwGa1iJQD-7_3tztdfoswVyEKowHkR6vFtnfb4hiRzoqkgLqKnA5GiFpQrP5-0kHVFfI64CIXc-91eVpFReZD-euheMPt2FdhnuPF8Ae8RDxdX4qmEHsuL23TO4d7H8ABB52FBqi-7MOhS9p_6BJQnnyZsc","UiLocales":null,"Nonce":"637019794355426002.ZjRjNmUxZGQtMDk1NS00NjlmLWJhZWMtOWVhZGFjODU5YjFiOTZmMmNjMWQtYjAwMS00NGY0LTg3NzAtNmRiMmFmMjBjNjJh","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/home/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637019794355426002.ZjRjNmUxZGQtMDk1NS00NjlmLWJhZWMtOWVhZGFjODU5YjFiOTZmMmNjMWQtYjAwMS00NGY0LTg3NzAtNmRiMmFmMjBjNjJh","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9Pi9ETVogI14IFPRQLNLRkr3lPSRvW25N22U7aTvcguIIdKq4oE6ZuNg4LYmb0ohty54UXjykPpKaBLQyaphTOyysfj8siIqx6JgDpnSSnnsv8o5tmK9Wi1Rc-Q2EIM3IljvW0vBVKxRq1SA6ul-SxwnTnOkavfGAr45UOKrwGa1iJQD-7_3tztdfoswVyEKowHkR6vFtnfb4hiRzoqkgLqKnA5GiFpQrP5-0kHVFfI64CIXc-91eVpFReZD-euheMPt2FdhnuPF8Ae8RDxdX4qmEHsuL23TO4d7H8ABB52FBqi-7MOhS9p_6BJQnnyZsc","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-21 13:17:15.940 +03:00 [INF] Showing login: User is not authenticated
2019-08-21 13:17:16.208 +03:00 [DBG] Start authorize request protocol validation
2019-08-21 13:17:16.209 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-21 13:17:16.221 +03:00 [DBG] Checking for PKCE parameters
2019-08-21 13:17:16.225 +03:00 [DBG] No PKCE used.
2019-08-21 13:17:16.226 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-21 13:17:16.235 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-21 13:17:18.590 +03:00 [DBG] CORS request made for path: /account/login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-08-21 13:17:18.658 +03:00 [DBG] Start authorize request protocol validation
2019-08-21 13:17:18.658 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-21 13:17:18.672 +03:00 [DBG] Checking for PKCE parameters
2019-08-21 13:17:18.676 +03:00 [DBG] No PKCE used.
2019-08-21 13:17:18.681 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-21 13:17:18.713 +03:00 [DBG] Augmenting SignInContext
2019-08-21 13:17:18.718 +03:00 [DBG] Adding idp claim with value: local
2019-08-21 13:17:18.719 +03:00 [DBG] Adding amr claim with value: pwd
2019-08-21 13:17:18.741 +03:00 [INF] AuthenticationScheme: idsrv signed in.
2019-08-21 13:17:18.744 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-21 13:17:18.758 +03:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-08-21 13:17:18.765 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-08-21 13:17:18.772 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-08-21 13:17:18.793 +03:00 [DBG] Start authorize callback request
2019-08-21 13:17:18.800 +03:00 [DBG] User in authorize request: 1
2019-08-21 13:17:18.801 +03:00 [DBG] Start authorize request protocol validation
2019-08-21 13:17:18.802 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-21 13:17:18.816 +03:00 [DBG] Checking for PKCE parameters
2019-08-21 13:17:18.823 +03:00 [DBG] No PKCE used.
2019-08-21 13:17:18.828 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-21 13:17:18.840 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/home/signin-oidc","AllowedRedirectUris":["http://localhost:57002/home/signin-oidc","http://localhost:5002/home/signin-oidc"],"SubjectId":"1","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9Pi9ETVogI14IFPRQLNLRkr3lPSRvW25N22U7aTvcguIIdKq4oE6ZuNg4LYmb0ohty54UXjykPpKaBLQyaphTOyysfj8siIqx6JgDpnSSnnsv8o5tmK9Wi1Rc-Q2EIM3IljvW0vBVKxRq1SA6ul-SxwnTnOkavfGAr45UOKrwGa1iJQD-7_3tztdfoswVyEKowHkR6vFtnfb4hiRzoqkgLqKnA5GiFpQrP5-0kHVFfI64CIXc-91eVpFReZD-euheMPt2FdhnuPF8Ae8RDxdX4qmEHsuL23TO4d7H8ABB52FBqi-7MOhS9p_6BJQnnyZsc","UiLocales":null,"Nonce":"637019794355426002.ZjRjNmUxZGQtMDk1NS00NjlmLWJhZWMtOWVhZGFjODU5YjFiOTZmMmNjMWQtYjAwMS00NGY0LTg3NzAtNmRiMmFmMjBjNjJh","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"084da2729964608c85cc271ae187b537","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/home/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll","response_mode":"form_post","nonce":"637019794355426002.ZjRjNmUxZGQtMDk1NS00NjlmLWJhZWMtOWVhZGFjODU5YjFiOTZmMmNjMWQtYjAwMS00NGY0LTg3NzAtNmRiMmFmMjBjNjJh","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9Pi9ETVogI14IFPRQLNLRkr3lPSRvW25N22U7aTvcguIIdKq4oE6ZuNg4LYmb0ohty54UXjykPpKaBLQyaphTOyysfj8siIqx6JgDpnSSnnsv8o5tmK9Wi1Rc-Q2EIM3IljvW0vBVKxRq1SA6ul-SxwnTnOkavfGAr45UOKrwGa1iJQD-7_3tztdfoswVyEKowHkR6vFtnfb4hiRzoqkgLqKnA5GiFpQrP5-0kHVFfI64CIXc-91eVpFReZD-euheMPt2FdhnuPF8Ae8RDxdX4qmEHsuL23TO4d7H8ABB52FBqi-7MOhS9p_6BJQnnyZsc","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-21 13:17:18.905 +03:00 [DBG] Client is configured to not require consent, no consent is required
2019-08-21 13:17:18.917 +03:00 [DBG] Creating Hybrid Flow response.
2019-08-21 13:17:18.955 +03:00 [DBG] Creating Implicit Flow response.
2019-08-21 13:17:18.972 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-21 13:17:18.979 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-21 13:17:19.072 +03:00 [DBG] Authorize endpoint response
{"SubjectId":"1","ClientId":"mvc","RedirectUri":"http://localhost:5002/home/signin-oidc","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9Pi9ETVogI14IFPRQLNLRkr3lPSRvW25N22U7aTvcguIIdKq4oE6ZuNg4LYmb0ohty54UXjykPpKaBLQyaphTOyysfj8siIqx6JgDpnSSnnsv8o5tmK9Wi1Rc-Q2EIM3IljvW0vBVKxRq1SA6ul-SxwnTnOkavfGAr45UOKrwGa1iJQD-7_3tztdfoswVyEKowHkR6vFtnfb4hiRzoqkgLqKnA5GiFpQrP5-0kHVFfI64CIXc-91eVpFReZD-euheMPt2FdhnuPF8Ae8RDxdX4qmEHsuL23TO4d7H8ABB52FBqi-7MOhS9p_6BJQnnyZsc","Scope":"openid profile afcpayroll offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-08-21 13:17:19.104 +03:00 [DBG] Augmenting SignInContext
2019-08-21 13:17:19.105 +03:00 [INF] AuthenticationScheme: idsrv signed in.
2019-08-21 13:17:20.302 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-21 13:17:20.323 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-21 13:17:20.325 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-21 13:17:20.352 +03:00 [DBG] Start token request.
2019-08-21 13:17:20.365 +03:00 [DBG] Start client validation
2019-08-21 13:17:20.405 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-21 13:17:20.411 +03:00 [DBG] Start parsing for secret in post body
2019-08-21 13:17:20.416 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-21 13:17:20.417 +03:00 [DBG] Secret id found: mvc
2019-08-21 13:17:20.422 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-21 13:17:20.444 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-21 13:17:20.444 +03:00 [DBG] Client validation success
2019-08-21 13:17:20.458 +03:00 [DBG] Start token request validation
2019-08-21 13:17:20.483 +03:00 [DBG] Start validation of authorization code token request
2019-08-21 13:17:20.517 +03:00 [DBG] Validation of authorization code token request success
2019-08-21 13:17:20.525 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"070edda0a19b0be05a84366e0e9c6a5b0d17ea7d1ace37911289a70b678318f5","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"mvc","client_secret":"***REDACTED***","code":"070edda0a19b0be05a84366e0e9c6a5b0d17ea7d1ace37911289a70b678318f5","grant_type":"authorization_code","redirect_uri":"http://localhost:5002/home/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-08-21 13:17:20.570 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-21 13:17:20.593 +03:00 [DBG] Getting claims for access token for client: mvc
2019-08-21 13:17:20.595 +03:00 [DBG] Getting claims for access token for subject: 1
2019-08-21 13:17:20.616 +03:00 [DBG] Creating refresh token
2019-08-21 13:17:20.616 +03:00 [DBG] Setting an absolute lifetime: 2592000
2019-08-21 13:17:20.634 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-21 13:17:20.639 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-21 13:17:20.652 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-21 13:17:20.681 +03:00 [DBG] Token request success.
2019-08-21 13:17:20.706 +03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-08-21 13:17:20.723 +03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-08-21 13:17:20.726 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-08-21 13:17:20.754 +03:00 [DBG] Start userinfo request
2019-08-21 13:17:20.762 +03:00 [DBG] Bearer token found in header
2019-08-21 13:17:20.856 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-21 13:17:20.867 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-21 13:17:20.873 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-08-21 13:17:20.885 +03:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1566382640,"exp":1566382700,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","afcpayroll"],"client_id":"mvc","sub":"1","auth_time":1566382638,"idp":"local","name":"alice","email":"alice@email.com","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-08-21 13:17:20.919 +03:00 [DBG] Creating userinfo response
2019-08-21 13:17:20.926 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-21 13:17:20.936 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-21 13:17:20.947 +03:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-21 13:17:20.953 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll offline_access
2019-08-21 13:17:20.966 +03:00 [INF] Profile service returned the following claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-21 13:17:20.970 +03:00 [DBG] End userinfo request
2019-08-21 13:17:30.980 +03:00 [DBG] Request path /connect/introspect matched to endpoint type Introspection
2019-08-21 13:17:30.983 +03:00 [DBG] Endpoint enabled: Introspection, successfully created handler: IdentityServer4.Endpoints.IntrospectionEndpoint
2019-08-21 13:17:30.987 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.IntrospectionEndpoint for /connect/introspect
2019-08-21 13:17:31.013 +03:00 [DBG] Starting introspection request.
2019-08-21 13:17:31.024 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-21 13:17:31.026 +03:00 [DBG] Parser found secret: BasicAuthenticationSecretParser
2019-08-21 13:17:31.027 +03:00 [DBG] Secret id found: afcpayroll
2019-08-21 13:17:31.032 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-21 13:17:31.044 +03:00 [DBG] API resource validation success
2019-08-21 13:17:31.056 +03:00 [DBG] Introspection request validation started.
2019-08-21 13:17:31.065 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-21 13:17:31.071 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-21 13:17:31.082 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-08-21 13:17:31.084 +03:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":null,"TokenHandle":null,"JwtId":null,"Claims":{"nbf":1566382640,"exp":1566382700,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","afcpayroll"],"client_id":"mvc","sub":"1","auth_time":1566382638,"idp":"local","name":"alice","email":"alice@email.com","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-08-21 13:17:31.103 +03:00 [DBG] Introspection request validation successful.
2019-08-21 13:17:31.121 +03:00 [DBG] Creating introspection response for active token.
2019-08-21 13:17:31.125 +03:00 [INF] Success token introspection. Token active: true, for API name: afcpayroll
2019-08-21 13:18:20.810 +03:00 [DBG] Request path /connect/introspect matched to endpoint type Introspection
2019-08-21 13:18:20.818 +03:00 [DBG] Endpoint enabled: Introspection, successfully created handler: IdentityServer4.Endpoints.IntrospectionEndpoint
2019-08-21 13:18:20.828 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.IntrospectionEndpoint for /connect/introspect
2019-08-21 13:18:20.840 +03:00 [DBG] Starting introspection request.
2019-08-21 13:18:20.849 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-21 13:18:20.854 +03:00 [DBG] Parser found secret: BasicAuthenticationSecretParser
2019-08-21 13:18:20.861 +03:00 [DBG] Secret id found: afcpayroll2
2019-08-21 13:18:20.872 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-21 13:18:20.872 +03:00 [DBG] API resource validation success
2019-08-21 13:18:20.874 +03:00 [DBG] Introspection request validation started.
2019-08-21 13:18:20.877 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-21 13:18:20.890 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-21 13:18:20.892 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-08-21 13:18:20.905 +03:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":null,"TokenHandle":null,"JwtId":null,"Claims":{"nbf":1566382640,"exp":1566382700,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","afcpayroll"],"client_id":"mvc","sub":"1","auth_time":1566382638,"idp":"local","name":"alice","email":"alice@email.com","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-08-21 13:18:20.926 +03:00 [DBG] Introspection request validation successful.
2019-08-21 13:18:20.931 +03:00 [ERR] Expected scope ["afcpayroll2"] is missing in token
2019-08-21 13:18:20.946 +03:00 [INF] Success token introspection. Token active: true, for API name: afcpayroll2
2019-08-21 13:18:51.025 +03:00 [DBG] Request path /connect/introspect matched to endpoint type Introspection
2019-08-21 13:18:51.030 +03:00 [DBG] Endpoint enabled: Introspection, successfully created handler: IdentityServer4.Endpoints.IntrospectionEndpoint
2019-08-21 13:18:51.044 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.IntrospectionEndpoint for /connect/introspect
2019-08-21 13:18:51.054 +03:00 [DBG] Starting introspection request.
2019-08-21 13:18:51.055 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-21 13:18:51.063 +03:00 [DBG] Parser found secret: BasicAuthenticationSecretParser
2019-08-21 13:18:51.069 +03:00 [DBG] Secret id found: afcpayroll
2019-08-21 13:18:51.076 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-21 13:18:51.083 +03:00 [DBG] API resource validation success
2019-08-21 13:18:51.088 +03:00 [DBG] Introspection request validation started.
2019-08-21 13:18:51.092 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-21 13:18:51.098 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-21 13:18:51.109 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-08-21 13:18:51.117 +03:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":null,"TokenHandle":null,"JwtId":null,"Claims":{"nbf":1566382640,"exp":1566382700,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","afcpayroll"],"client_id":"mvc","sub":"1","auth_time":1566382638,"idp":"local","name":"alice","email":"alice@email.com","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-08-21 13:18:51.137 +03:00 [DBG] Introspection request validation successful.
2019-08-21 13:18:51.144 +03:00 [DBG] Creating introspection response for active token.
2019-08-21 13:18:51.152 +03:00 [INF] Success token introspection. Token active: true, for API name: afcpayroll
2019-08-21 13:19:07.186 +03:00 [DBG] Request path /connect/introspect matched to endpoint type Introspection
2019-08-21 13:19:07.192 +03:00 [DBG] Endpoint enabled: Introspection, successfully created handler: IdentityServer4.Endpoints.IntrospectionEndpoint
2019-08-21 13:19:07.203 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.IntrospectionEndpoint for /connect/introspect
2019-08-21 13:19:07.217 +03:00 [DBG] Starting introspection request.
2019-08-21 13:19:07.224 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-21 13:19:07.232 +03:00 [DBG] Parser found secret: BasicAuthenticationSecretParser
2019-08-21 13:19:07.237 +03:00 [DBG] Secret id found: afcpayroll
2019-08-21 13:19:07.249 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-21 13:19:07.253 +03:00 [DBG] API resource validation success
2019-08-21 13:19:07.254 +03:00 [DBG] Introspection request validation started.
2019-08-21 13:19:07.279 +03:00 [ERR] JWT token validation error: IDX12729: Unable to decode the header '[PII is hidden]' as Base64Url encoded string. jwtEncodedString: '[PII is hidden]'.
System.ArgumentException: IDX12729: Unable to decode the header '[PII is hidden]' as Base64Url encoded string. jwtEncodedString: '[PII is hidden]'. ---> Newtonsoft.Json.JsonReaderException: Bad JSON escape sequence: \. Path 'kid', line 2, position 8.
   at Newtonsoft.Json.JsonTextReader.ReadStringIntoBuffer(Char quote)
   at Newtonsoft.Json.JsonTextReader.ParseValue()
   at Newtonsoft.Json.JsonTextReader.Read()
   at Newtonsoft.Json.JsonReader.ReadForType(JsonContract contract, Boolean hasConverter)
   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.PopulateDictionary(IDictionary dictionary, JsonReader reader, JsonDictionaryContract contract, JsonProperty containerProperty, String id)
   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateObject(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)
   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.CreateValueInternal(JsonReader reader, Type objectType, JsonContract contract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerMember, Object existingValue)
   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)
   at Newtonsoft.Json.JsonSerializer.DeserializeInternal(JsonReader reader, Type objectType)
   at Newtonsoft.Json.JsonConvert.DeserializeObject(String value, Type type, JsonSerializerSettings settings)
   at Newtonsoft.Json.JsonConvert.DeserializeObject(String value, Type type)
   at System.IdentityModel.Tokens.Jwt.JsonExtensions.DeserializeJwtHeader(String jsonString) in C:\agent2\_work\15\s\src\System.IdentityModel.Tokens.Jwt\JsonExtensions.cs:line 128
   at System.IdentityModel.Tokens.Jwt.JwtSecurityToken.Decode(String[] tokenParts, String rawData) in C:\agent2\_work\15\s\src\System.IdentityModel.Tokens.Jwt\JwtSecurityToken.cs:line 492
   --- End of inner exception stack trace ---
   at System.IdentityModel.Tokens.Jwt.JwtSecurityToken.Decode(String[] tokenParts, String rawData) in C:\agent2\_work\15\s\src\System.IdentityModel.Tokens.Jwt\JwtSecurityToken.cs:line 489
   at System.IdentityModel.Tokens.Jwt.JwtSecurityTokenHandler.ReadJwtToken(String token) in C:\agent2\_work\15\s\src\System.IdentityModel.Tokens.Jwt\JwtSecurityTokenHandler.cs:line 662
   at System.IdentityModel.Tokens.Jwt.JwtSecurityTokenHandler.ValidateSignature(String token, TokenValidationParameters validationParameters) in C:\agent2\_work\15\s\src\System.IdentityModel.Tokens.Jwt\JwtSecurityTokenHandler.cs:line 921
   at System.IdentityModel.Tokens.Jwt.JwtSecurityTokenHandler.ValidateToken(String token, TokenValidationParameters validationParameters, SecurityToken& validatedToken) in C:\agent2\_work\15\s\src\System.IdentityModel.Tokens.Jwt\JwtSecurityTokenHandler.cs:line 746
   at IdentityServer4.Validation.TokenValidator.ValidateJwtAsync(String jwt, String audience, IEnumerable`1 validationKeys, Boolean validateLifetime) in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\src\Validation\Default\TokenValidator.cs:line 287
2019-08-21 13:19:07.421 +03:00 [DBG] Token is invalid.
2019-08-21 13:19:07.424 +03:00 [DBG] Creating introspection response for inactive token.
2019-08-21 13:19:07.432 +03:00 [INF] Success token introspection. Token active: false, for API name: afcpayroll
2019-08-21 13:19:13.345 +03:00 [DBG] Request path /connect/introspect matched to endpoint type Introspection
2019-08-21 13:19:13.352 +03:00 [DBG] Endpoint enabled: Introspection, successfully created handler: IdentityServer4.Endpoints.IntrospectionEndpoint
2019-08-21 13:19:13.367 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.IntrospectionEndpoint for /connect/introspect
2019-08-21 13:19:13.381 +03:00 [DBG] Starting introspection request.
2019-08-21 13:19:13.388 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-21 13:19:13.393 +03:00 [DBG] Parser found secret: BasicAuthenticationSecretParser
2019-08-21 13:19:13.400 +03:00 [DBG] Secret id found: afcpayroll
2019-08-21 13:19:13.405 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-21 13:19:13.413 +03:00 [DBG] API resource validation success
2019-08-21 13:19:13.419 +03:00 [DBG] Introspection request validation started.
2019-08-21 13:19:13.423 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-21 13:19:13.435 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-21 13:19:13.449 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-08-21 13:19:13.462 +03:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":null,"TokenHandle":null,"JwtId":null,"Claims":{"nbf":1566382640,"exp":1566382700,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","afcpayroll"],"client_id":"mvc","sub":"1","auth_time":1566382638,"idp":"local","name":"alice","email":"alice@email.com","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-08-21 13:19:13.487 +03:00 [DBG] Introspection request validation successful.
2019-08-21 13:19:13.488 +03:00 [DBG] Creating introspection response for active token.
2019-08-21 13:19:13.497 +03:00 [INF] Success token introspection. Token active: true, for API name: afcpayroll
2019-08-21 13:20:57.394 +03:00 [DBG] Request path /connect/introspect matched to endpoint type Introspection
2019-08-21 13:20:57.406 +03:00 [DBG] Endpoint enabled: Introspection, successfully created handler: IdentityServer4.Endpoints.IntrospectionEndpoint
2019-08-21 13:20:57.420 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.IntrospectionEndpoint for /connect/introspect
2019-08-21 13:20:57.433 +03:00 [DBG] Starting introspection request.
2019-08-21 13:20:57.438 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-21 13:20:57.443 +03:00 [DBG] Parser found secret: BasicAuthenticationSecretParser
2019-08-21 13:20:57.446 +03:00 [DBG] Secret id found: afcpayroll2
2019-08-21 13:20:57.451 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-21 13:20:57.457 +03:00 [DBG] API resource validation success
2019-08-21 13:20:57.459 +03:00 [DBG] Introspection request validation started.
2019-08-21 13:20:57.469 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-21 13:20:57.479 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-21 13:20:57.485 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-08-21 13:20:57.493 +03:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":null,"TokenHandle":null,"JwtId":null,"Claims":{"nbf":1566382640,"exp":1566382700,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","afcpayroll"],"client_id":"mvc","sub":"1","auth_time":1566382638,"idp":"local","name":"alice","email":"alice@email.com","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-08-21 13:20:57.513 +03:00 [DBG] Introspection request validation successful.
2019-08-21 13:20:57.517 +03:00 [ERR] Expected scope ["afcpayroll2"] is missing in token
2019-08-21 13:20:57.525 +03:00 [INF] Success token introspection. Token active: true, for API name: afcpayroll2
2019-08-21 13:22:14.685 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-21 13:22:14.691 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-21 13:22:14.702 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-21 13:22:14.711 +03:00 [DBG] Start discovery request
2019-08-21 13:22:14.748 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-21 13:22:14.751 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-21 13:22:14.762 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-21 13:22:14.768 +03:00 [DBG] Start key discovery request
2019-08-21 13:22:14.801 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-21 13:22:14.807 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-21 13:22:14.819 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-21 13:22:14.834 +03:00 [DBG] Start token request.
2019-08-21 13:22:14.840 +03:00 [DBG] Start client validation
2019-08-21 13:22:14.844 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-21 13:22:14.850 +03:00 [DBG] Start parsing for secret in post body
2019-08-21 13:22:14.851 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-21 13:22:14.857 +03:00 [DBG] Secret id found: mvc
2019-08-21 13:22:14.858 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-21 13:22:14.872 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-21 13:22:14.879 +03:00 [DBG] Client validation success
2019-08-21 13:22:14.884 +03:00 [DBG] Start token request validation
2019-08-21 13:22:14.891 +03:00 [DBG] Start validation of refresh token request
2019-08-21 13:22:14.912 +03:00 [DBG] Token validation success
{"ClientId":"mvc","ClientName":"MVC Client","ValidateLifetime":false,"AccessTokenType":null,"ExpectedScope":null,"TokenHandle":null,"JwtId":null,"Claims":{"sub":"1","client_id":"mvc","scope":["openid","profile","test_identity","afcpayroll","offline_access"],"auth_time":1566382638,"idp":"local","amr":"pwd","name":"alice","email":"alice@email.com"},"$type":"TokenValidationLog"}
2019-08-21 13:22:14.921 +03:00 [DBG] Validation of refresh token request success
2019-08-21 13:22:14.928 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"refresh_token","Scopes":null,"AuthorizationCode":null,"RefreshToken":"c0895950f75a764960c20ef15220bedd179e46ad90a9aee54cc0bf818176fce7","UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"refresh_token","refresh_token":"***REDACTED***","client_id":"mvc","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2019-08-21 13:22:14.970 +03:00 [DBG] Updating refresh token
2019-08-21 13:22:14.971 +03:00 [DBG] No updates to refresh token done
2019-08-21 13:22:14.988 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-21 13:22:14.989 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-21 13:22:15.006 +03:00 [DBG] Token request success.
2019-08-21 13:24:13.860 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-21 13:24:13.862 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-21 13:24:13.863 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-21 13:24:13.869 +03:00 [DBG] Start discovery request
2019-08-21 13:24:14.158 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-21 13:24:14.162 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-21 13:24:14.169 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-21 13:24:14.175 +03:00 [DBG] Start key discovery request
2019-08-21 13:24:14.278 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-08-21 13:24:14.297 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-08-21 13:24:14.319 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-08-21 13:24:14.326 +03:00 [DBG] Start authorize request
2019-08-21 13:24:14.335 +03:00 [DBG] No user present in authorize request
2019-08-21 13:24:14.340 +03:00 [DBG] Start authorize request protocol validation
2019-08-21 13:24:14.345 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-21 13:24:14.355 +03:00 [DBG] Checking for PKCE parameters
2019-08-21 13:24:14.359 +03:00 [DBG] No PKCE used.
2019-08-21 13:24:14.363 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-21 13:24:14.375 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/home/signin-oidc","AllowedRedirectUris":["http://localhost:57002/home/signin-oidc","http://localhost:5002/home/signin-oidc"],"SubjectId":"anonymous","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll afcpayroll2","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9NjURMn03EqHN5DyjEwia_bRxjcKrjfzgCnbDDIO4J5Nv-czq_DIemmlZ-_QxbZNxEflKSFgRm4JMPmkPb4RI_5kR-a0oBCiiMAPVU_ShqPGGVDtaGJ7FMS01zQ2r_uJ2yN90jylR_Qr3iTNUq4TRgIjhhbbJcMKdNLoZFX5RhLDW83T24KcZHKso87SLxtlil9ziSzDug52RSoqF_5EJwejlZU7Fq2b-HsHmT3lJcj42Rw8loNmvzznuyaboWv2sKGFDLm1MmDhuRRE0ZeEFkcuWVvcIMJMQG8t6jeCGCs9cfqkSND5eDEMBKsCNpxqrk","UiLocales":null,"Nonce":"637019798542136736.ZDczNWQ0YWItMDExZi00ZjIyLTlhYzEtZTg1OGU1Yjg0ZDRlNWQ0ZTI5MzUtYWQ0Ni00ODZkLWFkZjYtZDczMDBhNWVkZGNi","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/home/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll afcpayroll2","response_mode":"form_post","nonce":"637019798542136736.ZDczNWQ0YWItMDExZi00ZjIyLTlhYzEtZTg1OGU1Yjg0ZDRlNWQ0ZTI5MzUtYWQ0Ni00ODZkLWFkZjYtZDczMDBhNWVkZGNi","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9NjURMn03EqHN5DyjEwia_bRxjcKrjfzgCnbDDIO4J5Nv-czq_DIemmlZ-_QxbZNxEflKSFgRm4JMPmkPb4RI_5kR-a0oBCiiMAPVU_ShqPGGVDtaGJ7FMS01zQ2r_uJ2yN90jylR_Qr3iTNUq4TRgIjhhbbJcMKdNLoZFX5RhLDW83T24KcZHKso87SLxtlil9ziSzDug52RSoqF_5EJwejlZU7Fq2b-HsHmT3lJcj42Rw8loNmvzznuyaboWv2sKGFDLm1MmDhuRRE0ZeEFkcuWVvcIMJMQG8t6jeCGCs9cfqkSND5eDEMBKsCNpxqrk","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-21 13:24:14.421 +03:00 [INF] Showing login: User is not authenticated
2019-08-21 13:24:14.430 +03:00 [DBG] Start authorize request protocol validation
2019-08-21 13:24:14.435 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-21 13:24:14.442 +03:00 [DBG] Checking for PKCE parameters
2019-08-21 13:24:14.452 +03:00 [DBG] No PKCE used.
2019-08-21 13:24:14.454 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-21 13:24:14.463 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-21 13:24:16.388 +03:00 [DBG] CORS request made for path: /account/login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-08-21 13:24:16.395 +03:00 [DBG] Start authorize request protocol validation
2019-08-21 13:24:16.407 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-21 13:24:16.420 +03:00 [DBG] Checking for PKCE parameters
2019-08-21 13:24:16.424 +03:00 [DBG] No PKCE used.
2019-08-21 13:24:16.432 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-21 13:24:16.445 +03:00 [DBG] Augmenting SignInContext
2019-08-21 13:24:16.454 +03:00 [DBG] Adding idp claim with value: local
2019-08-21 13:24:16.459 +03:00 [DBG] Adding amr claim with value: pwd
2019-08-21 13:24:16.469 +03:00 [INF] AuthenticationScheme: idsrv signed in.
2019-08-21 13:24:16.471 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-21 13:24:16.490 +03:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-08-21 13:24:16.492 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-08-21 13:24:16.506 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-08-21 13:24:16.518 +03:00 [DBG] Start authorize callback request
2019-08-21 13:24:16.526 +03:00 [DBG] User in authorize request: 1
2019-08-21 13:24:16.532 +03:00 [DBG] Start authorize request protocol validation
2019-08-21 13:24:16.533 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-21 13:24:16.547 +03:00 [DBG] Checking for PKCE parameters
2019-08-21 13:24:16.551 +03:00 [DBG] No PKCE used.
2019-08-21 13:24:16.553 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-21 13:24:16.559 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/home/signin-oidc","AllowedRedirectUris":["http://localhost:57002/home/signin-oidc","http://localhost:5002/home/signin-oidc"],"SubjectId":"1","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll afcpayroll2","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9NjURMn03EqHN5DyjEwia_bRxjcKrjfzgCnbDDIO4J5Nv-czq_DIemmlZ-_QxbZNxEflKSFgRm4JMPmkPb4RI_5kR-a0oBCiiMAPVU_ShqPGGVDtaGJ7FMS01zQ2r_uJ2yN90jylR_Qr3iTNUq4TRgIjhhbbJcMKdNLoZFX5RhLDW83T24KcZHKso87SLxtlil9ziSzDug52RSoqF_5EJwejlZU7Fq2b-HsHmT3lJcj42Rw8loNmvzznuyaboWv2sKGFDLm1MmDhuRRE0ZeEFkcuWVvcIMJMQG8t6jeCGCs9cfqkSND5eDEMBKsCNpxqrk","UiLocales":null,"Nonce":"637019798542136736.ZDczNWQ0YWItMDExZi00ZjIyLTlhYzEtZTg1OGU1Yjg0ZDRlNWQ0ZTI5MzUtYWQ0Ni00ODZkLWFkZjYtZDczMDBhNWVkZGNi","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"66b44ea8f66e75451e4c948368822922","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/home/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll afcpayroll2","response_mode":"form_post","nonce":"637019798542136736.ZDczNWQ0YWItMDExZi00ZjIyLTlhYzEtZTg1OGU1Yjg0ZDRlNWQ0ZTI5MzUtYWQ0Ni00ODZkLWFkZjYtZDczMDBhNWVkZGNi","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9NjURMn03EqHN5DyjEwia_bRxjcKrjfzgCnbDDIO4J5Nv-czq_DIemmlZ-_QxbZNxEflKSFgRm4JMPmkPb4RI_5kR-a0oBCiiMAPVU_ShqPGGVDtaGJ7FMS01zQ2r_uJ2yN90jylR_Qr3iTNUq4TRgIjhhbbJcMKdNLoZFX5RhLDW83T24KcZHKso87SLxtlil9ziSzDug52RSoqF_5EJwejlZU7Fq2b-HsHmT3lJcj42Rw8loNmvzznuyaboWv2sKGFDLm1MmDhuRRE0ZeEFkcuWVvcIMJMQG8t6jeCGCs9cfqkSND5eDEMBKsCNpxqrk","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-21 13:24:16.612 +03:00 [DBG] Client is configured to not require consent, no consent is required
2019-08-21 13:24:16.613 +03:00 [DBG] Creating Hybrid Flow response.
2019-08-21 13:24:16.618 +03:00 [DBG] Creating Implicit Flow response.
2019-08-21 13:24:16.619 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-21 13:24:16.628 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-21 13:24:16.638 +03:00 [DBG] Authorize endpoint response
{"SubjectId":"1","ClientId":"mvc","RedirectUri":"http://localhost:5002/home/signin-oidc","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9NjURMn03EqHN5DyjEwia_bRxjcKrjfzgCnbDDIO4J5Nv-czq_DIemmlZ-_QxbZNxEflKSFgRm4JMPmkPb4RI_5kR-a0oBCiiMAPVU_ShqPGGVDtaGJ7FMS01zQ2r_uJ2yN90jylR_Qr3iTNUq4TRgIjhhbbJcMKdNLoZFX5RhLDW83T24KcZHKso87SLxtlil9ziSzDug52RSoqF_5EJwejlZU7Fq2b-HsHmT3lJcj42Rw8loNmvzznuyaboWv2sKGFDLm1MmDhuRRE0ZeEFkcuWVvcIMJMQG8t6jeCGCs9cfqkSND5eDEMBKsCNpxqrk","Scope":"openid profile afcpayroll afcpayroll2 offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-08-21 13:24:16.654 +03:00 [DBG] Augmenting SignInContext
2019-08-21 13:24:16.661 +03:00 [INF] AuthenticationScheme: idsrv signed in.
2019-08-21 13:24:17.843 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-21 13:24:17.849 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-21 13:24:17.860 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-21 13:24:17.868 +03:00 [DBG] Start token request.
2019-08-21 13:24:17.873 +03:00 [DBG] Start client validation
2019-08-21 13:24:17.880 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-21 13:24:17.886 +03:00 [DBG] Start parsing for secret in post body
2019-08-21 13:24:17.893 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-21 13:24:17.898 +03:00 [DBG] Secret id found: mvc
2019-08-21 13:24:17.902 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-21 13:24:17.913 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-21 13:24:17.918 +03:00 [DBG] Client validation success
2019-08-21 13:24:17.919 +03:00 [DBG] Start token request validation
2019-08-21 13:24:17.920 +03:00 [DBG] Start validation of authorization code token request
2019-08-21 13:24:17.935 +03:00 [DBG] Validation of authorization code token request success
2019-08-21 13:24:17.937 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"bb38d0922998e4ba23251b86b751ff362298ae02d74d6137296147f27923a3d7","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"mvc","client_secret":"***REDACTED***","code":"bb38d0922998e4ba23251b86b751ff362298ae02d74d6137296147f27923a3d7","grant_type":"authorization_code","redirect_uri":"http://localhost:5002/home/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-08-21 13:24:17.961 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-21 13:24:17.974 +03:00 [DBG] Getting claims for access token for client: mvc
2019-08-21 13:24:17.975 +03:00 [DBG] Getting claims for access token for subject: 1
2019-08-21 13:24:17.990 +03:00 [DBG] Creating refresh token
2019-08-21 13:24:17.990 +03:00 [DBG] Setting an absolute lifetime: 2592000
2019-08-21 13:24:17.992 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-21 13:24:18.001 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-21 13:24:18.003 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-21 13:24:18.009 +03:00 [DBG] Token request success.
2019-08-21 13:24:18.025 +03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-08-21 13:24:18.028 +03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-08-21 13:24:18.038 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-08-21 13:24:18.046 +03:00 [DBG] Start userinfo request
2019-08-21 13:24:18.051 +03:00 [DBG] Bearer token found in header
2019-08-21 13:24:18.060 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-21 13:24:18.067 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-21 13:24:18.069 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-08-21 13:24:18.075 +03:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1566383057,"exp":1566383117,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","afcpayroll","afcpayroll2"],"client_id":"mvc","sub":"1","auth_time":1566383056,"idp":"local","name":"alice","email":"alice@email.com","scope":["openid","profile","test_identity","afcpayroll","afcpayroll2","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-08-21 13:24:18.101 +03:00 [DBG] Creating userinfo response
2019-08-21 13:24:18.102 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll afcpayroll2 offline_access
2019-08-21 13:24:18.115 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll afcpayroll2 offline_access
2019-08-21 13:24:18.126 +03:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-21 13:24:18.139 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll afcpayroll2 offline_access
2019-08-21 13:24:18.148 +03:00 [INF] Profile service returned the following claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-21 13:24:18.157 +03:00 [DBG] End userinfo request
2019-08-21 13:24:33.470 +03:00 [DBG] Request path /connect/introspect matched to endpoint type Introspection
2019-08-21 13:24:33.476 +03:00 [DBG] Endpoint enabled: Introspection, successfully created handler: IdentityServer4.Endpoints.IntrospectionEndpoint
2019-08-21 13:24:33.491 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.IntrospectionEndpoint for /connect/introspect
2019-08-21 13:24:33.504 +03:00 [DBG] Starting introspection request.
2019-08-21 13:24:33.512 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-21 13:24:33.520 +03:00 [DBG] Parser found secret: BasicAuthenticationSecretParser
2019-08-21 13:24:33.526 +03:00 [DBG] Secret id found: afcpayroll2
2019-08-21 13:24:33.531 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-21 13:24:33.537 +03:00 [DBG] API resource validation success
2019-08-21 13:24:33.542 +03:00 [DBG] Introspection request validation started.
2019-08-21 13:24:33.546 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-21 13:24:33.557 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-21 13:24:33.569 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-08-21 13:24:33.583 +03:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":null,"TokenHandle":null,"JwtId":null,"Claims":{"nbf":1566383057,"exp":1566383117,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","afcpayroll","afcpayroll2"],"client_id":"mvc","sub":"1","auth_time":1566383056,"idp":"local","name":"alice","email":"alice@email.com","scope":["openid","profile","test_identity","afcpayroll","afcpayroll2","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-08-21 13:24:33.605 +03:00 [DBG] Introspection request validation successful.
2019-08-21 13:24:33.607 +03:00 [DBG] Creating introspection response for active token.
2019-08-21 13:24:33.614 +03:00 [INF] Success token introspection. Token active: true, for API name: afcpayroll2
2019-08-21 13:24:50.156 +03:00 [DBG] Request path /connect/introspect matched to endpoint type Introspection
2019-08-21 13:24:50.160 +03:00 [DBG] Endpoint enabled: Introspection, successfully created handler: IdentityServer4.Endpoints.IntrospectionEndpoint
2019-08-21 13:24:50.172 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.IntrospectionEndpoint for /connect/introspect
2019-08-21 13:24:50.186 +03:00 [DBG] Starting introspection request.
2019-08-21 13:24:50.193 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-21 13:24:50.201 +03:00 [DBG] Parser found secret: BasicAuthenticationSecretParser
2019-08-21 13:24:50.206 +03:00 [DBG] Secret id found: afcpayroll
2019-08-21 13:24:50.217 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-21 13:24:50.219 +03:00 [DBG] API resource validation success
2019-08-21 13:24:50.224 +03:00 [DBG] Introspection request validation started.
2019-08-21 13:24:50.237 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-21 13:24:50.245 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-21 13:24:50.252 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-08-21 13:24:50.264 +03:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":null,"TokenHandle":null,"JwtId":null,"Claims":{"nbf":1566383057,"exp":1566383117,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","afcpayroll","afcpayroll2"],"client_id":"mvc","sub":"1","auth_time":1566383056,"idp":"local","name":"alice","email":"alice@email.com","scope":["openid","profile","test_identity","afcpayroll","afcpayroll2","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-08-21 13:24:50.292 +03:00 [DBG] Introspection request validation successful.
2019-08-21 13:24:50.293 +03:00 [DBG] Creating introspection response for active token.
2019-08-21 13:24:50.300 +03:00 [INF] Success token introspection. Token active: true, for API name: afcpayroll
2019-08-21 15:20:18.508 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-21 15:20:18.518 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-21 15:20:18.524 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-21 15:20:18.531 +03:00 [DBG] Start discovery request
2019-08-21 15:20:18.556 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-21 15:20:18.558 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-21 15:20:18.561 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-21 15:20:18.569 +03:00 [DBG] Start key discovery request
2019-08-21 15:20:18.606 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-21 15:20:18.612 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-21 15:20:18.626 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-21 15:20:18.647 +03:00 [DBG] Start token request.
2019-08-21 15:20:18.661 +03:00 [DBG] Start client validation
2019-08-21 15:20:18.665 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-21 15:20:18.672 +03:00 [DBG] Start parsing for secret in post body
2019-08-21 15:20:18.676 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-21 15:20:18.681 +03:00 [DBG] Secret id found: mvc
2019-08-21 15:20:18.689 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-21 15:20:18.701 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-21 15:20:18.706 +03:00 [DBG] Client validation success
2019-08-21 15:20:18.708 +03:00 [DBG] Start token request validation
2019-08-21 15:20:18.716 +03:00 [DBG] Start validation of refresh token request
2019-08-21 15:20:18.726 +03:00 [DBG] Token validation success
{"ClientId":"mvc","ClientName":"MVC Client","ValidateLifetime":false,"AccessTokenType":null,"ExpectedScope":null,"TokenHandle":null,"JwtId":null,"Claims":{"sub":"1","client_id":"mvc","scope":["openid","profile","test_identity","afcpayroll","afcpayroll2","offline_access"],"auth_time":1566383056,"idp":"local","amr":"pwd","name":"alice","email":"alice@email.com"},"$type":"TokenValidationLog"}
2019-08-21 15:20:18.738 +03:00 [DBG] Validation of refresh token request success
2019-08-21 15:20:18.740 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"refresh_token","Scopes":null,"AuthorizationCode":null,"RefreshToken":"bd858d272d2a9c106f822215bad8f8bf379942b20f11f0a932df7992100d9420","UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"refresh_token","refresh_token":"***REDACTED***","client_id":"mvc","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2019-08-21 15:20:18.756 +03:00 [DBG] Updating refresh token
2019-08-21 15:20:18.760 +03:00 [DBG] No updates to refresh token done
2019-08-21 15:20:18.762 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-21 15:20:18.770 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-21 15:20:18.781 +03:00 [DBG] Token request success.
2019-08-21 15:22:46.961 +03:00 [INF] Starting IdentityServer4 version 2.5.0.0
2019-08-21 15:22:47.042 +03:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2019-08-21 15:22:47.047 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for authentication
2019-08-21 15:22:47.054 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-in
2019-08-21 15:22:47.058 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-out
2019-08-21 15:22:47.066 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for challenge
2019-08-21 15:22:47.071 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for forbid
2019-08-21 15:23:03.906 +03:00 [DBG] Login Url: /account/login
2019-08-21 15:23:03.909 +03:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-08-21 15:23:03.912 +03:00 [DBG] Logout Url: /Account/Logout
2019-08-21 15:23:03.913 +03:00 [DBG] ConsentUrl Url: /consent
2019-08-21 15:23:03.914 +03:00 [DBG] Consent Return Url Parameter: returnUrl
2019-08-21 15:23:03.915 +03:00 [DBG] Error Url: /home/error
2019-08-21 15:23:03.915 +03:00 [DBG] Error Id Parameter: errorId
2019-08-21 15:23:03.969 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-21 15:23:03.975 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-21 15:23:03.977 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-21 15:23:03.983 +03:00 [DBG] Start discovery request
2019-08-21 15:23:04.308 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-21 15:23:04.342 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-21 15:23:04.343 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-21 15:23:04.350 +03:00 [DBG] Start key discovery request
2019-08-21 15:23:11.288 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-21 15:23:11.304 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-21 15:23:11.306 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-21 15:23:11.321 +03:00 [DBG] Start token request.
2019-08-21 15:23:11.330 +03:00 [DBG] Start client validation
2019-08-21 15:23:11.340 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-21 15:23:11.345 +03:00 [DBG] Start parsing for secret in post body
2019-08-21 15:23:11.375 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-21 15:23:11.376 +03:00 [DBG] Secret id found: mvc
2019-08-21 15:23:11.405 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-21 15:23:11.418 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-21 15:23:11.419 +03:00 [DBG] Client validation success
2019-08-21 15:23:11.435 +03:00 [DBG] Start token request validation
2019-08-21 15:23:11.445 +03:00 [DBG] Start client credentials token request validation
2019-08-21 15:23:11.473 +03:00 [ERR] Client not authorized for client credentials flow, check the AllowedGrantTypes setting{"clientId":"mvc"}, details: {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"client_credentials","Scopes":null,"AuthorizationCode":null,"RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"client_credentials","scope":"afcpayroll afcpayroll2","client_id":"mvc","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2019-08-21 15:24:07.170 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-21 15:24:07.174 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-21 15:24:07.175 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-21 15:24:07.177 +03:00 [DBG] Start discovery request
2019-08-21 15:24:07.360 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-21 15:24:07.362 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-21 15:24:07.363 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-21 15:24:07.364 +03:00 [DBG] Start key discovery request
2019-08-21 15:24:08.477 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-21 15:24:08.485 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-21 15:24:08.489 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-21 15:24:08.491 +03:00 [DBG] Start token request.
2019-08-21 15:24:08.491 +03:00 [DBG] Start client validation
2019-08-21 15:24:08.492 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-21 15:24:08.493 +03:00 [DBG] Start parsing for secret in post body
2019-08-21 15:24:08.494 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-21 15:24:08.495 +03:00 [DBG] Secret id found: client
2019-08-21 15:24:08.503 +03:00 [DBG] client configuration validation for client client succeeded.
2019-08-21 15:24:08.506 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-21 15:24:08.507 +03:00 [DBG] Client validation success
2019-08-21 15:24:08.508 +03:00 [DBG] Start token request validation
2019-08-21 15:24:08.509 +03:00 [DBG] Start client credentials token request validation
2019-08-21 15:24:08.564 +03:00 [DBG] client credentials token request validation success
2019-08-21 15:24:08.566 +03:00 [INF] Token request validation success, {"ClientId":"client","ClientName":null,"GrantType":"client_credentials","Scopes":"afcpayroll","AuthorizationCode":null,"RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"client_credentials","scope":"afcpayroll","client_id":"client","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2019-08-21 15:24:08.603 +03:00 [DBG] Getting claims for access token for client: client
2019-08-21 15:24:08.702 +03:00 [DBG] Token request success.
2019-08-21 15:24:49.560 +03:00 [INF] AuthenticationScheme: idsrv was challenged.
2019-08-21 15:27:17.179 +03:00 [INF] Starting IdentityServer4 version 2.5.0.0
2019-08-21 15:27:17.254 +03:00 [INF] Using the default authentication scheme Bearer for IdentityServer
2019-08-21 15:27:17.255 +03:00 [INF] Authentication scheme Bearer is configured for IdentityServer, but it is not a scheme that supports signin (like cookies). If you support interactive logins via the browser, then a cookie-based scheme should be used.
2019-08-21 15:27:17.256 +03:00 [DBG] Using Bearer as default ASP.NET Core scheme for authentication
2019-08-21 15:27:17.256 +03:00 [DBG] Using Bearer as default ASP.NET Core scheme for sign-in
2019-08-21 15:27:17.257 +03:00 [DBG] Using Bearer as default ASP.NET Core scheme for sign-out
2019-08-21 15:27:17.257 +03:00 [DBG] Using Bearer as default ASP.NET Core scheme for challenge
2019-08-21 15:27:17.257 +03:00 [DBG] Using Bearer as default ASP.NET Core scheme for forbid
2019-08-21 15:30:07.381 +03:00 [INF] Starting IdentityServer4 version 2.5.0.0
2019-08-21 15:30:07.461 +03:00 [INF] Using the default authentication scheme Bearer for IdentityServer
2019-08-21 15:30:07.462 +03:00 [INF] Authentication scheme Bearer is configured for IdentityServer, but it is not a scheme that supports signin (like cookies). If you support interactive logins via the browser, then a cookie-based scheme should be used.
2019-08-21 15:30:07.465 +03:00 [DBG] Using Bearer as default ASP.NET Core scheme for authentication
2019-08-21 15:30:07.466 +03:00 [DBG] Using Bearer as default ASP.NET Core scheme for sign-in
2019-08-21 15:30:07.467 +03:00 [DBG] Using Bearer as default ASP.NET Core scheme for sign-out
2019-08-21 15:30:07.467 +03:00 [DBG] Using Bearer as default ASP.NET Core scheme for challenge
2019-08-21 15:30:07.468 +03:00 [DBG] Using Bearer as default ASP.NET Core scheme for forbid
2019-08-21 15:30:32.067 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-21 15:30:32.073 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-21 15:30:32.074 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-21 15:30:32.079 +03:00 [DBG] Start discovery request
2019-08-21 15:30:33.825 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-21 15:30:33.827 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-21 15:30:33.828 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-21 15:30:33.832 +03:00 [DBG] Start key discovery request
2019-08-21 15:30:41.043 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-21 15:30:41.058 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-21 15:30:41.059 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-21 15:30:41.072 +03:00 [DBG] Start token request.
2019-08-21 15:30:41.081 +03:00 [DBG] Start client validation
2019-08-21 15:30:41.089 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-21 15:30:41.094 +03:00 [DBG] Start parsing for secret in post body
2019-08-21 15:30:41.121 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-21 15:30:41.121 +03:00 [DBG] Secret id found: client
2019-08-21 15:30:41.148 +03:00 [DBG] client configuration validation for client client succeeded.
2019-08-21 15:30:41.161 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-21 15:30:41.161 +03:00 [DBG] Client validation success
2019-08-21 15:30:41.176 +03:00 [DBG] Start token request validation
2019-08-21 15:30:41.188 +03:00 [DBG] Start client credentials token request validation
2019-08-21 15:30:41.223 +03:00 [ERR] Requested scope not allowed: afcpayroll
2019-08-21 15:30:41.248 +03:00 [ERR] {"ClientId":"client","ClientName":null,"GrantType":"client_credentials","Scopes":null,"AuthorizationCode":null,"RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"client_credentials","scope":"afcpayroll identity.provider","client_id":"client","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2019-08-21 15:31:27.231 +03:00 [INF] Starting IdentityServer4 version 2.5.0.0
2019-08-21 15:31:27.328 +03:00 [INF] Using the default authentication scheme Bearer for IdentityServer
2019-08-21 15:31:27.331 +03:00 [INF] Authentication scheme Bearer is configured for IdentityServer, but it is not a scheme that supports signin (like cookies). If you support interactive logins via the browser, then a cookie-based scheme should be used.
2019-08-21 15:31:27.332 +03:00 [DBG] Using Bearer as default ASP.NET Core scheme for authentication
2019-08-21 15:31:27.332 +03:00 [DBG] Using Bearer as default ASP.NET Core scheme for sign-in
2019-08-21 15:31:27.332 +03:00 [DBG] Using Bearer as default ASP.NET Core scheme for sign-out
2019-08-21 15:31:27.332 +03:00 [DBG] Using Bearer as default ASP.NET Core scheme for challenge
2019-08-21 15:31:27.333 +03:00 [DBG] Using Bearer as default ASP.NET Core scheme for forbid
2019-08-21 15:31:48.143 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-21 15:31:48.152 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-21 15:31:48.153 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-21 15:31:48.157 +03:00 [DBG] Start discovery request
2019-08-21 15:31:48.422 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-21 15:31:48.426 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-21 15:31:48.427 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-21 15:31:48.437 +03:00 [DBG] Start key discovery request
2019-08-21 15:31:50.509 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-21 15:31:50.523 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-21 15:31:50.527 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-21 15:31:50.543 +03:00 [DBG] Start token request.
2019-08-21 15:31:50.560 +03:00 [DBG] Start client validation
2019-08-21 15:31:50.570 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-21 15:31:50.578 +03:00 [DBG] Start parsing for secret in post body
2019-08-21 15:31:50.626 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-21 15:31:50.628 +03:00 [DBG] Secret id found: client
2019-08-21 15:31:50.662 +03:00 [DBG] client configuration validation for client client succeeded.
2019-08-21 15:31:50.682 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-21 15:31:50.688 +03:00 [DBG] Client validation success
2019-08-21 15:31:50.709 +03:00 [DBG] Start token request validation
2019-08-21 15:31:50.726 +03:00 [DBG] Start client credentials token request validation
2019-08-21 15:31:50.750 +03:00 [ERR] Requested scope not allowed: identityprovider
2019-08-21 15:31:50.774 +03:00 [ERR] {"ClientId":"client","ClientName":null,"GrantType":"client_credentials","Scopes":null,"AuthorizationCode":null,"RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"client_credentials","scope":"identityprovider","client_id":"client","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2019-08-21 15:32:23.130 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-21 15:32:23.139 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-21 15:32:23.144 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-21 15:32:23.152 +03:00 [DBG] Start discovery request
2019-08-21 15:32:23.294 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-21 15:32:23.298 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-21 15:32:23.300 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-21 15:32:23.302 +03:00 [DBG] Start key discovery request
2019-08-21 15:32:23.737 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-21 15:32:23.739 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-21 15:32:23.743 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-21 15:32:23.744 +03:00 [DBG] Start token request.
2019-08-21 15:32:23.744 +03:00 [DBG] Start client validation
2019-08-21 15:32:23.745 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-21 15:32:23.746 +03:00 [DBG] Start parsing for secret in post body
2019-08-21 15:32:23.747 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-21 15:32:23.752 +03:00 [DBG] Secret id found: client
2019-08-21 15:32:23.753 +03:00 [DBG] client configuration validation for client client succeeded.
2019-08-21 15:32:23.757 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-21 15:32:23.759 +03:00 [DBG] Client validation success
2019-08-21 15:32:23.761 +03:00 [DBG] Start token request validation
2019-08-21 15:32:23.764 +03:00 [DBG] Start client credentials token request validation
2019-08-21 15:32:23.769 +03:00 [ERR] Requested scope not allowed: afcpayroll
2019-08-21 15:32:23.770 +03:00 [ERR] {"ClientId":"client","ClientName":null,"GrantType":"client_credentials","Scopes":null,"AuthorizationCode":null,"RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"client_credentials","scope":"afcpayroll identityprovider","client_id":"client","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2019-08-21 15:33:08.415 +03:00 [INF] Starting IdentityServer4 version 2.5.0.0
2019-08-21 15:33:08.485 +03:00 [INF] Using the default authentication scheme Bearer for IdentityServer
2019-08-21 15:33:08.486 +03:00 [INF] Authentication scheme Bearer is configured for IdentityServer, but it is not a scheme that supports signin (like cookies). If you support interactive logins via the browser, then a cookie-based scheme should be used.
2019-08-21 15:33:08.486 +03:00 [DBG] Using Bearer as default ASP.NET Core scheme for authentication
2019-08-21 15:33:08.486 +03:00 [DBG] Using Bearer as default ASP.NET Core scheme for sign-in
2019-08-21 15:33:08.486 +03:00 [DBG] Using Bearer as default ASP.NET Core scheme for sign-out
2019-08-21 15:33:08.487 +03:00 [DBG] Using Bearer as default ASP.NET Core scheme for challenge
2019-08-21 15:33:08.487 +03:00 [DBG] Using Bearer as default ASP.NET Core scheme for forbid
2019-08-21 15:33:17.054 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-21 15:33:17.061 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-21 15:33:17.063 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-21 15:33:17.068 +03:00 [DBG] Start discovery request
2019-08-21 15:33:17.312 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-21 15:33:17.315 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-21 15:33:17.315 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-21 15:33:17.319 +03:00 [DBG] Start key discovery request
2019-08-21 15:33:20.486 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-21 15:33:20.500 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-21 15:33:20.502 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-21 15:33:20.516 +03:00 [DBG] Start token request.
2019-08-21 15:33:20.526 +03:00 [DBG] Start client validation
2019-08-21 15:33:20.543 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-21 15:33:20.550 +03:00 [DBG] Start parsing for secret in post body
2019-08-21 15:33:20.582 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-21 15:33:20.583 +03:00 [DBG] Secret id found: client
2019-08-21 15:33:20.613 +03:00 [DBG] client configuration validation for client client succeeded.
2019-08-21 15:33:20.636 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-21 15:33:20.637 +03:00 [DBG] Client validation success
2019-08-21 15:33:20.653 +03:00 [DBG] Start token request validation
2019-08-21 15:33:20.671 +03:00 [DBG] Start client credentials token request validation
2019-08-21 15:33:20.698 +03:00 [ERR] Requested scope not allowed: afcpayroll
2019-08-21 15:33:20.717 +03:00 [ERR] {"ClientId":"client","ClientName":null,"GrantType":"client_credentials","Scopes":null,"AuthorizationCode":null,"RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"client_credentials","scope":"afcpayroll identityprovider","client_id":"client","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2019-08-21 15:34:19.257 +03:00 [INF] Starting IdentityServer4 version 2.5.0.0
2019-08-21 15:34:19.337 +03:00 [INF] Using the default authentication scheme Bearer for IdentityServer
2019-08-21 15:34:19.347 +03:00 [INF] Authentication scheme Bearer is configured for IdentityServer, but it is not a scheme that supports signin (like cookies). If you support interactive logins via the browser, then a cookie-based scheme should be used.
2019-08-21 15:34:19.348 +03:00 [DBG] Using Bearer as default ASP.NET Core scheme for authentication
2019-08-21 15:34:19.348 +03:00 [DBG] Using Bearer as default ASP.NET Core scheme for sign-in
2019-08-21 15:34:19.348 +03:00 [DBG] Using Bearer as default ASP.NET Core scheme for sign-out
2019-08-21 15:34:19.349 +03:00 [DBG] Using Bearer as default ASP.NET Core scheme for challenge
2019-08-21 15:34:19.349 +03:00 [DBG] Using Bearer as default ASP.NET Core scheme for forbid
2019-08-21 15:34:28.996 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-21 15:34:29.004 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-21 15:34:29.004 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-21 15:34:29.008 +03:00 [DBG] Start discovery request
2019-08-21 15:34:29.274 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-21 15:34:29.283 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-21 15:34:29.283 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-21 15:34:29.287 +03:00 [DBG] Start key discovery request
2019-08-21 15:34:31.037 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-21 15:34:31.049 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-21 15:34:31.051 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-21 15:34:31.066 +03:00 [DBG] Start token request.
2019-08-21 15:34:31.074 +03:00 [DBG] Start client validation
2019-08-21 15:34:31.082 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-21 15:34:31.088 +03:00 [DBG] Start parsing for secret in post body
2019-08-21 15:34:31.116 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-21 15:34:31.116 +03:00 [DBG] Secret id found: client
2019-08-21 15:34:31.144 +03:00 [DBG] client configuration validation for client client succeeded.
2019-08-21 15:34:31.160 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-21 15:34:31.160 +03:00 [DBG] Client validation success
2019-08-21 15:34:31.175 +03:00 [DBG] Start token request validation
2019-08-21 15:34:31.190 +03:00 [DBG] Start client credentials token request validation
2019-08-21 15:34:31.243 +03:00 [DBG] client credentials token request validation success
2019-08-21 15:34:31.266 +03:00 [INF] Token request validation success, {"ClientId":"client","ClientName":null,"GrantType":"client_credentials","Scopes":"afcpayroll identityprovider","AuthorizationCode":null,"RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"client_credentials","scope":"afcpayroll identityprovider","client_id":"client","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2019-08-21 15:34:31.324 +03:00 [DBG] Getting claims for access token for client: client
2019-08-21 15:34:31.416 +03:00 [DBG] Token request success.
2019-08-21 15:34:47.346 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-21 15:34:47.349 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-21 15:34:47.352 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-21 15:34:47.353 +03:00 [DBG] Start discovery request
2019-08-21 15:34:47.423 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-21 15:34:47.425 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-21 15:34:47.432 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-21 15:34:47.435 +03:00 [DBG] Start key discovery request
2019-08-21 15:34:47.509 +03:00 [INF] Successfully validated the token.
2019-08-22 10:53:42.335 +03:00 [INF] Starting IdentityServer4 version 2.5.0.0
2019-08-22 10:53:42.449 +03:00 [INF] Using the default authentication scheme Bearer for IdentityServer
2019-08-22 10:53:42.451 +03:00 [INF] Authentication scheme Bearer is configured for IdentityServer, but it is not a scheme that supports signin (like cookies). If you support interactive logins via the browser, then a cookie-based scheme should be used.
2019-08-22 10:53:42.451 +03:00 [DBG] Using Bearer as default ASP.NET Core scheme for authentication
2019-08-22 10:53:42.451 +03:00 [DBG] Using Bearer as default ASP.NET Core scheme for sign-in
2019-08-22 10:53:42.453 +03:00 [DBG] Using Bearer as default ASP.NET Core scheme for sign-out
2019-08-22 10:53:42.454 +03:00 [DBG] Using Bearer as default ASP.NET Core scheme for challenge
2019-08-22 10:53:42.454 +03:00 [DBG] Using Bearer as default ASP.NET Core scheme for forbid
2019-08-22 10:59:27.392 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-22 10:59:27.404 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-22 10:59:27.416 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-22 10:59:27.428 +03:00 [DBG] Start discovery request
2019-08-22 10:59:28.055 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-22 10:59:28.062 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-22 10:59:28.063 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-22 10:59:28.077 +03:00 [DBG] Start key discovery request
2019-08-22 10:59:28.299 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-08-22 10:59:28.320 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-08-22 10:59:28.322 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-08-22 10:59:28.330 +03:00 [DBG] Start authorize request
2019-08-22 10:59:28.349 +03:00 [DBG] No user present in authorize request
2019-08-22 10:59:28.362 +03:00 [DBG] Start authorize request protocol validation
2019-08-22 10:59:28.429 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-22 10:59:28.469 +03:00 [DBG] Checking for PKCE parameters
2019-08-22 10:59:28.473 +03:00 [DBG] No PKCE used.
2019-08-22 10:59:28.558 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-22 10:59:28.609 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/home/signin-oidc","AllowedRedirectUris":["http://localhost:57002/home/signin-oidc","http://localhost:5002/home/signin-oidc"],"SubjectId":"anonymous","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll afcpayroll2","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9NW8nn53AhEoVkmdBce98OKGui1ITwVx_dNqXUx8XycpKFgpNC6rMFZHfGXp-RKqHoY5MWJB4sGlX6zNpEQ5-aNNp4ipL42R6Pvy0X6kcIAVx1fs3uGuYorLF15XDHAD1he8gqEZRif4YnPOmOLFsch6n7GpxdqgvlzpmzltFECsacbmFOTAL_RyJ6o-zfPA1gnMDxTiErra7yBg6_BJK8f6Q3rtRVG2c9W-48QoV4IHzQh5CwmWK3I3gZXcYDLs7GMHDGW4PZ--j-7JNH0fe8fnTt2sg4eunBA1nCRIoSOzPcVXfKoWTCMQcQfWOrYE4k","UiLocales":null,"Nonce":"637020575681447120.OTdlZWUwNmEtNzgyYi00ZjgzLWExZTMtNmY3NzY5MmIxNTdmMTk1ODQ2ZGMtNGExMi00YTkzLTk5NDMtMWU2MjMyNzgwMmY1","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/home/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll afcpayroll2","response_mode":"form_post","nonce":"637020575681447120.OTdlZWUwNmEtNzgyYi00ZjgzLWExZTMtNmY3NzY5MmIxNTdmMTk1ODQ2ZGMtNGExMi00YTkzLTk5NDMtMWU2MjMyNzgwMmY1","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9NW8nn53AhEoVkmdBce98OKGui1ITwVx_dNqXUx8XycpKFgpNC6rMFZHfGXp-RKqHoY5MWJB4sGlX6zNpEQ5-aNNp4ipL42R6Pvy0X6kcIAVx1fs3uGuYorLF15XDHAD1he8gqEZRif4YnPOmOLFsch6n7GpxdqgvlzpmzltFECsacbmFOTAL_RyJ6o-zfPA1gnMDxTiErra7yBg6_BJK8f6Q3rtRVG2c9W-48QoV4IHzQh5CwmWK3I3gZXcYDLs7GMHDGW4PZ--j-7JNH0fe8fnTt2sg4eunBA1nCRIoSOzPcVXfKoWTCMQcQfWOrYE4k","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-22 10:59:28.676 +03:00 [INF] Showing login: User is not authenticated
2019-08-22 10:59:29.022 +03:00 [DBG] Start authorize request protocol validation
2019-08-22 10:59:29.025 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-22 10:59:29.027 +03:00 [DBG] Checking for PKCE parameters
2019-08-22 10:59:29.028 +03:00 [DBG] No PKCE used.
2019-08-22 10:59:29.029 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-22 10:59:29.061 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-22 11:01:49.585 +03:00 [DBG] CORS request made for path: /account/login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-08-22 11:01:49.669 +03:00 [DBG] Start authorize request protocol validation
2019-08-22 11:01:49.670 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-22 11:01:49.675 +03:00 [DBG] Checking for PKCE parameters
2019-08-22 11:01:49.677 +03:00 [DBG] No PKCE used.
2019-08-22 11:01:49.678 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-22 11:01:49.724 +03:00 [DBG] Augmenting SignInContext
2019-08-22 11:01:49.729 +03:00 [DBG] Adding idp claim with value: local
2019-08-22 11:01:49.730 +03:00 [DBG] Adding amr claim with value: pwd
2019-08-22 11:01:49.753 +03:00 [ERR] An unhandled exception has occurred while executing the request.
System.InvalidOperationException: The authentication handler registered for scheme 'Bearer' is 'JwtBearerHandler' which cannot be used for SignInAsync. The registered sign-in schemes are: idsrv, idsrv.external.
   at Microsoft.AspNetCore.Authentication.AuthenticationService.SignInAsync(HttpContext context, String scheme, ClaimsPrincipal principal, AuthenticationProperties properties)
   at IdentityServer4.Hosting.IdentityServerAuthenticationService.SignInAsync(HttpContext context, String scheme, ClaimsPrincipal principal, AuthenticationProperties properties) in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\src\Hosting\IdentityServerAuthenticationService.cs:line 82
   at Microsoft.AspNetCore.Http.AuthenticationManagerExtensions.SignInAsync(HttpContext context, IdentityServerUser user, AuthenticationProperties properties) in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\src\Extensions\HttpContextAuthenticationExtensions.cs:line 279
   at Microsoft.AspNetCore.Http.AuthenticationManagerExtensions.SignInAsync(HttpContext context, String subject, String name, AuthenticationProperties properties, Claim[] claims) in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\src\Extensions\HttpContextAuthenticationExtensions.cs:line 105
   at IdentityServer.AccountController.Login(LoginInputModel model, String button) in E:\GIT\Identity\src\IdentityServer\Quickstart\Account\AccountController.cs:line 137
   at Microsoft.AspNetCore.Mvc.Internal.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at System.Threading.Tasks.ValueTask`1.get_Result()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.InvokeActionMethodAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.InvokeNextActionFilterAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.Rethrow(ActionExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.InvokeInnerFilterAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeNextResourceFilter()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Rethrow(ResourceExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeFilterPipelineAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeAsync()
   at Microsoft.AspNetCore.Builder.RouterMiddleware.Invoke(HttpContext httpContext)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events) in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\src\Hosting\IdentityServerMiddleware.cs:line 72
   at IdentityServer4.Hosting.MutualTlsTokenEndpointMiddleware.Invoke(HttpContext context, IAuthenticationSchemeProvider schemes) in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\src\Hosting\MtlsTokenEndpointMiddleware.cs:line 60
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Cors.Infrastructure.CorsMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context) in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\src\Hosting\BaseUrlMiddleware.cs:line 36
   at Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext context)
2019-08-22 11:07:43.646 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-22 11:07:43.651 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-22 11:07:43.653 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-22 11:07:43.654 +03:00 [DBG] Start discovery request
2019-08-22 11:07:44.142 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-22 11:07:44.145 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-22 11:07:44.151 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-22 11:07:44.154 +03:00 [DBG] Start key discovery request
2019-08-22 11:07:44.332 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-08-22 11:07:44.335 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-08-22 11:07:44.337 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-08-22 11:07:44.339 +03:00 [DBG] Start authorize request
2019-08-22 11:07:44.340 +03:00 [DBG] No user present in authorize request
2019-08-22 11:07:44.341 +03:00 [DBG] Start authorize request protocol validation
2019-08-22 11:07:44.342 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-22 11:07:44.343 +03:00 [DBG] Checking for PKCE parameters
2019-08-22 11:07:44.344 +03:00 [DBG] No PKCE used.
2019-08-22 11:07:44.346 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-22 11:07:44.350 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/home/signin-oidc","AllowedRedirectUris":["http://localhost:57002/home/signin-oidc","http://localhost:5002/home/signin-oidc"],"SubjectId":"anonymous","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll afcpayroll2","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9N-ffmDasApmqYArmTNmGxYyQzlNh-C-mxUf6l32Vd73VzUdm7FfDpSxORs8ZwJ9hdR-vxUZ52dvAsuNtY54sEWkm1VADXysO2qDKBHJ_pkn_9KL3G2Su7KH5IyTKTfMIsdnSh9__dA4pXbJZgmAAwgTWCXqBNW77MimeZWoA9bOD0FRBkJYpFyaba8ff1ckeXswFfNFf1Q9gvaRxYUMRU2z5ZZXNJ0FQK82GMUF6pvo888OMawEikL4De6NfevCfbvFKGzNJhwzKzTJlG02DfAc-j4QIVJUoeqJgEwx8zi-Dh1Sk7_yB9WMAXhbAFlJzc","UiLocales":null,"Nonce":"637020580642262874.OWEzODBmMjktMWMxZi00NjY2LTgwN2ItMGQ4NWM5Y2ZiZjY5ZTczYzcwNjAtNjJkOC00MTUzLWIxZWItYzBkODdiM2RkNWRk","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/home/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll afcpayroll2","response_mode":"form_post","nonce":"637020580642262874.OWEzODBmMjktMWMxZi00NjY2LTgwN2ItMGQ4NWM5Y2ZiZjY5ZTczYzcwNjAtNjJkOC00MTUzLWIxZWItYzBkODdiM2RkNWRk","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9N-ffmDasApmqYArmTNmGxYyQzlNh-C-mxUf6l32Vd73VzUdm7FfDpSxORs8ZwJ9hdR-vxUZ52dvAsuNtY54sEWkm1VADXysO2qDKBHJ_pkn_9KL3G2Su7KH5IyTKTfMIsdnSh9__dA4pXbJZgmAAwgTWCXqBNW77MimeZWoA9bOD0FRBkJYpFyaba8ff1ckeXswFfNFf1Q9gvaRxYUMRU2z5ZZXNJ0FQK82GMUF6pvo888OMawEikL4De6NfevCfbvFKGzNJhwzKzTJlG02DfAc-j4QIVJUoeqJgEwx8zi-Dh1Sk7_yB9WMAXhbAFlJzc","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-22 11:07:44.363 +03:00 [INF] Showing login: User is not authenticated
2019-08-22 11:07:44.373 +03:00 [DBG] Start authorize request protocol validation
2019-08-22 11:07:44.376 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-22 11:07:44.379 +03:00 [DBG] Checking for PKCE parameters
2019-08-22 11:07:44.380 +03:00 [DBG] No PKCE used.
2019-08-22 11:07:44.382 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-22 11:07:44.383 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-22 11:07:46.455 +03:00 [DBG] CORS request made for path: /account/login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-08-22 11:07:46.460 +03:00 [DBG] Start authorize request protocol validation
2019-08-22 11:07:46.460 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-22 11:07:46.462 +03:00 [DBG] Checking for PKCE parameters
2019-08-22 11:07:46.463 +03:00 [DBG] No PKCE used.
2019-08-22 11:07:46.465 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-22 11:07:46.470 +03:00 [DBG] Augmenting SignInContext
2019-08-22 11:07:46.471 +03:00 [DBG] Adding idp claim with value: local
2019-08-22 11:07:46.472 +03:00 [DBG] Adding amr claim with value: pwd
2019-08-22 11:07:46.475 +03:00 [ERR] An unhandled exception has occurred while executing the request.
System.InvalidOperationException: The authentication handler registered for scheme 'Bearer' is 'JwtBearerHandler' which cannot be used for SignInAsync. The registered sign-in schemes are: idsrv, idsrv.external.
   at Microsoft.AspNetCore.Authentication.AuthenticationService.SignInAsync(HttpContext context, String scheme, ClaimsPrincipal principal, AuthenticationProperties properties)
   at IdentityServer4.Hosting.IdentityServerAuthenticationService.SignInAsync(HttpContext context, String scheme, ClaimsPrincipal principal, AuthenticationProperties properties) in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\src\Hosting\IdentityServerAuthenticationService.cs:line 82
   at Microsoft.AspNetCore.Http.AuthenticationManagerExtensions.SignInAsync(HttpContext context, IdentityServerUser user, AuthenticationProperties properties) in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\src\Extensions\HttpContextAuthenticationExtensions.cs:line 279
   at Microsoft.AspNetCore.Http.AuthenticationManagerExtensions.SignInAsync(HttpContext context, String subject, String name, AuthenticationProperties properties, Claim[] claims) in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\src\Extensions\HttpContextAuthenticationExtensions.cs:line 105
   at IdentityServer.AccountController.Login(LoginInputModel model, String button) in E:\GIT\Identity\src\IdentityServer\Quickstart\Account\AccountController.cs:line 137
   at Microsoft.AspNetCore.Mvc.Internal.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at System.Threading.Tasks.ValueTask`1.get_Result()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.InvokeActionMethodAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.InvokeNextActionFilterAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.Rethrow(ActionExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.InvokeInnerFilterAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeNextResourceFilter()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Rethrow(ResourceExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeFilterPipelineAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeAsync()
   at Microsoft.AspNetCore.Builder.RouterMiddleware.Invoke(HttpContext httpContext)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events) in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\src\Hosting\IdentityServerMiddleware.cs:line 72
   at IdentityServer4.Hosting.MutualTlsTokenEndpointMiddleware.Invoke(HttpContext context, IAuthenticationSchemeProvider schemes) in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\src\Hosting\MtlsTokenEndpointMiddleware.cs:line 60
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Cors.Infrastructure.CorsMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context) in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\src\Hosting\BaseUrlMiddleware.cs:line 36
   at Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext context)
2019-08-22 11:08:11.115 +03:00 [INF] Starting IdentityServer4 version 2.5.0.0
2019-08-22 11:08:11.348 +03:00 [FTL] Application startup exception
System.InvalidOperationException: Scheme already exists: idsrv
   at Microsoft.AspNetCore.Authentication.AuthenticationOptions.AddScheme(String name, Action`1 configureBuilder)
   at Microsoft.AspNetCore.Authentication.AuthenticationBuilder.<>c__DisplayClass4_0`2.<AddSchemeHelper>b__0(AuthenticationOptions o)
   at Microsoft.Extensions.Options.ConfigureNamedOptions`1.Configure(String name, TOptions options)
   at Microsoft.Extensions.Options.OptionsFactory`1.Create(String name)
   at Microsoft.Extensions.Options.OptionsManager`1.<>c__DisplayClass5_0.<Get>b__0()
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
   at System.Lazy`1.ExecutionAndPublication(LazyHelper executionAndPublication, Boolean useDefaultConstructor)
   at System.Lazy`1.CreateValue()
   at Microsoft.Extensions.Options.OptionsCache`1.GetOrAdd(String name, Func`1 createOptions)
   at Microsoft.Extensions.Options.OptionsManager`1.Get(String name)
   at Microsoft.Extensions.Options.OptionsManager`1.get_Value()
   at Microsoft.AspNetCore.Authentication.AuthenticationSchemeProvider..ctor(IOptions`1 options, IDictionary`2 schemes)
   at Microsoft.AspNetCore.Authentication.AuthenticationSchemeProvider..ctor(IOptions`1 options)
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitConstructor(ConstructorCallSite constructorCallSite, ServiceProviderEngineScope scope)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSite(IServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitScoped(ScopedCallSite scopedCallSite, ServiceProviderEngineScope scope)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitSingleton(SingletonCallSite singletonCallSite, ServiceProviderEngineScope scope)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSite(IServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.DynamicServiceProviderEngine.<>c__DisplayClass1_0.<RealizeService>b__0(ServiceProviderEngineScope scope)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngine.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at Microsoft.AspNetCore.Builder.IdentityServerApplicationBuilderExtensions.ValidateAsync(IServiceProvider services, ILogger logger)
   at Microsoft.AspNetCore.Builder.IdentityServerApplicationBuilderExtensions.Validate(IApplicationBuilder app) in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\src\Configuration\IdentityServerApplicationBuilderExtensions.cs:line 77
   at Microsoft.AspNetCore.Builder.IdentityServerApplicationBuilderExtensions.UseIdentityServer(IApplicationBuilder app, IdentityServerMiddlewareOptions options) in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\src\Configuration\IdentityServerApplicationBuilderExtensions.cs:line 30
   at IdentityServer.Startup.Configure(IApplicationBuilder app) in E:\GIT\Identity\src\IdentityServer\Startup.cs:line 76
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.AspNetCore.Hosting.ConventionBasedStartup.Configure(IApplicationBuilder app)
   at Microsoft.AspNetCore.HostFilteringStartupFilter.<>c__DisplayClass0_0.<Configure>b__0(IApplicationBuilder app)
   at Microsoft.AspNetCore.Hosting.Internal.AutoRequestServicesStartupFilter.<>c__DisplayClass0_0.<Configure>b__0(IApplicationBuilder builder)
   at Microsoft.AspNetCore.Hosting.Internal.WebHost.BuildApplication()
2019-08-22 11:12:13.852 +03:00 [INF] Starting IdentityServer4 version 2.5.0.0
2019-08-22 11:12:13.981 +03:00 [WRN] No authentication scheme has been set. Setting either a default authentication scheme or a CookieAuthenticationScheme on IdentityServerOptions is required.
2019-08-22 11:12:32.024 +03:00 [ERR] An unhandled exception has occurred while executing the request.
System.InvalidOperationException: No DefaultAuthenticateScheme found.
   at IdentityServer4.Services.DefaultUserSession.GetCookieSchemeAsync() in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\src\Services\Default\DefaultUserSession.cs:line 114
   at IdentityServer4.Services.DefaultUserSession.AuthenticateAsync() in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\src\Services\Default\DefaultUserSession.cs:line 140
   at IdentityServer4.Services.DefaultUserSession.GetSessionIdAsync() in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\src\Services\Default\DefaultUserSession.cs:line 206
   at IdentityServer4.Services.DefaultUserSession.EnsureSessionIdCookieAsync() in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\src\Services\Default\DefaultUserSession.cs:line 220
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events) in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\src\Hosting\IdentityServerMiddleware.cs:line 45
   at IdentityServer4.Hosting.MutualTlsTokenEndpointMiddleware.Invoke(HttpContext context, IAuthenticationSchemeProvider schemes) in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\src\Hosting\MtlsTokenEndpointMiddleware.cs:line 60
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Cors.Infrastructure.CorsMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context) in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\src\Hosting\BaseUrlMiddleware.cs:line 36
   at Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext context)
2019-08-22 11:12:34.457 +03:00 [ERR] An unhandled exception has occurred while executing the request.
System.InvalidOperationException: No DefaultAuthenticateScheme found.
   at IdentityServer4.Services.DefaultUserSession.GetCookieSchemeAsync() in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\src\Services\Default\DefaultUserSession.cs:line 114
   at IdentityServer4.Services.DefaultUserSession.AuthenticateAsync() in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\src\Services\Default\DefaultUserSession.cs:line 140
   at IdentityServer4.Services.DefaultUserSession.GetSessionIdAsync() in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\src\Services\Default\DefaultUserSession.cs:line 206
   at IdentityServer4.Services.DefaultUserSession.EnsureSessionIdCookieAsync() in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\src\Services\Default\DefaultUserSession.cs:line 220
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events) in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\src\Hosting\IdentityServerMiddleware.cs:line 45
   at IdentityServer4.Hosting.MutualTlsTokenEndpointMiddleware.Invoke(HttpContext context, IAuthenticationSchemeProvider schemes) in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\src\Hosting\MtlsTokenEndpointMiddleware.cs:line 60
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Cors.Infrastructure.CorsMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context) in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\src\Hosting\BaseUrlMiddleware.cs:line 36
   at Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext context)
2019-08-22 11:13:16.329 +03:00 [INF] Starting IdentityServer4 version 2.5.0.0
2019-08-22 11:13:16.436 +03:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-08-22 11:13:16.437 +03:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-08-22 11:13:16.440 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-in
2019-08-22 11:13:16.440 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-out
2019-08-22 11:13:16.441 +03:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-08-22 11:13:16.441 +03:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-08-22 11:13:19.771 +03:00 [DBG] Login Url: /account/login
2019-08-22 11:13:19.776 +03:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-08-22 11:13:19.778 +03:00 [DBG] Logout Url: /Account/Logout
2019-08-22 11:13:19.778 +03:00 [DBG] ConsentUrl Url: /consent
2019-08-22 11:13:19.779 +03:00 [DBG] Consent Return Url Parameter: returnUrl
2019-08-22 11:13:19.780 +03:00 [DBG] Error Url: /home/error
2019-08-22 11:13:19.785 +03:00 [DBG] Error Id Parameter: errorId
2019-08-22 11:13:54.294 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-22 11:13:54.305 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-22 11:13:54.314 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-22 11:13:54.326 +03:00 [DBG] Start discovery request
2019-08-22 11:13:54.894 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-22 11:13:54.904 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-22 11:13:54.915 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-22 11:13:54.944 +03:00 [DBG] Start key discovery request
2019-08-22 11:13:55.189 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-08-22 11:13:55.225 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-08-22 11:13:55.241 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-08-22 11:13:55.264 +03:00 [DBG] Start authorize request
2019-08-22 11:13:55.285 +03:00 [DBG] No user present in authorize request
2019-08-22 11:13:55.300 +03:00 [DBG] Start authorize request protocol validation
2019-08-22 11:13:55.346 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-22 11:13:55.379 +03:00 [DBG] Checking for PKCE parameters
2019-08-22 11:13:55.383 +03:00 [DBG] No PKCE used.
2019-08-22 11:13:55.474 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-22 11:13:55.537 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/home/signin-oidc","AllowedRedirectUris":["http://localhost:57002/home/signin-oidc","http://localhost:5002/home/signin-oidc"],"SubjectId":"anonymous","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll afcpayroll2","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9NDfCkCsf8quOgNmuo8BBJvHFSSjoPmfOE0oG836yEMV1Md0vAvfyEUXJMvZCHq9dzfySpTHFHPSrDOOkZGdmTDQiPCS4L5kL0zwWBL159hgamge64Q6pnzaRDFf21EG-79CUfp6fQygw8y8yPO4CKXmzvHm0gudK8HbfTstOKGQEdmuEEsUfQ4o6Ch9_IfkcIR9v9IIBYohRW4dPkC8b1ziV9A_TRL0uCjsMuzqv5_X0kw0fjZuvhDfFm6e2xk_qB4iJVf6InObdjs4YP8T4OBiTZhDGyVHWF6Eo44I-B-qYdP4law3VtqCUzVHeks1tQ","UiLocales":null,"Nonce":"637020584350186565.N2M0YTljNWUtYmVkZC00NTgzLWJhODYtZTNjMWIxOTI2OTkyYTE1NWIyYWItMTJmZC00Yjc0LTkzNDItN2ZlMGQxODEzMTY0","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/home/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll afcpayroll2","response_mode":"form_post","nonce":"637020584350186565.N2M0YTljNWUtYmVkZC00NTgzLWJhODYtZTNjMWIxOTI2OTkyYTE1NWIyYWItMTJmZC00Yjc0LTkzNDItN2ZlMGQxODEzMTY0","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9NDfCkCsf8quOgNmuo8BBJvHFSSjoPmfOE0oG836yEMV1Md0vAvfyEUXJMvZCHq9dzfySpTHFHPSrDOOkZGdmTDQiPCS4L5kL0zwWBL159hgamge64Q6pnzaRDFf21EG-79CUfp6fQygw8y8yPO4CKXmzvHm0gudK8HbfTstOKGQEdmuEEsUfQ4o6Ch9_IfkcIR9v9IIBYohRW4dPkC8b1ziV9A_TRL0uCjsMuzqv5_X0kw0fjZuvhDfFm6e2xk_qB4iJVf6InObdjs4YP8T4OBiTZhDGyVHWF6Eo44I-B-qYdP4law3VtqCUzVHeks1tQ","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-22 11:13:55.664 +03:00 [INF] Showing login: User is not authenticated
2019-08-22 11:13:55.813 +03:00 [DBG] Start authorize request protocol validation
2019-08-22 11:13:55.815 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-22 11:13:55.828 +03:00 [DBG] Checking for PKCE parameters
2019-08-22 11:13:55.834 +03:00 [DBG] No PKCE used.
2019-08-22 11:13:55.845 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-22 11:13:55.853 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-22 11:14:03.750 +03:00 [DBG] CORS request made for path: /account/login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-08-22 11:14:03.847 +03:00 [DBG] Start authorize request protocol validation
2019-08-22 11:14:03.848 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-22 11:14:03.865 +03:00 [DBG] Checking for PKCE parameters
2019-08-22 11:14:03.867 +03:00 [DBG] No PKCE used.
2019-08-22 11:14:03.877 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-22 11:14:03.946 +03:00 [DBG] Augmenting SignInContext
2019-08-22 11:14:03.960 +03:00 [DBG] Adding idp claim with value: local
2019-08-22 11:14:03.963 +03:00 [DBG] Adding amr claim with value: pwd
2019-08-22 11:14:03.989 +03:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-08-22 11:14:03.998 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-22 11:14:04.036 +03:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-08-22 11:14:04.040 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-08-22 11:14:04.076 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-08-22 11:14:04.105 +03:00 [DBG] Start authorize callback request
2019-08-22 11:14:04.124 +03:00 [DBG] User in authorize request: 1
2019-08-22 11:14:04.124 +03:00 [DBG] Start authorize request protocol validation
2019-08-22 11:14:04.132 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-22 11:14:04.160 +03:00 [DBG] Checking for PKCE parameters
2019-08-22 11:14:04.169 +03:00 [DBG] No PKCE used.
2019-08-22 11:14:04.185 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-22 11:14:04.196 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/home/signin-oidc","AllowedRedirectUris":["http://localhost:57002/home/signin-oidc","http://localhost:5002/home/signin-oidc"],"SubjectId":"1","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll afcpayroll2","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9NDfCkCsf8quOgNmuo8BBJvHFSSjoPmfOE0oG836yEMV1Md0vAvfyEUXJMvZCHq9dzfySpTHFHPSrDOOkZGdmTDQiPCS4L5kL0zwWBL159hgamge64Q6pnzaRDFf21EG-79CUfp6fQygw8y8yPO4CKXmzvHm0gudK8HbfTstOKGQEdmuEEsUfQ4o6Ch9_IfkcIR9v9IIBYohRW4dPkC8b1ziV9A_TRL0uCjsMuzqv5_X0kw0fjZuvhDfFm6e2xk_qB4iJVf6InObdjs4YP8T4OBiTZhDGyVHWF6Eo44I-B-qYdP4law3VtqCUzVHeks1tQ","UiLocales":null,"Nonce":"637020584350186565.N2M0YTljNWUtYmVkZC00NTgzLWJhODYtZTNjMWIxOTI2OTkyYTE1NWIyYWItMTJmZC00Yjc0LTkzNDItN2ZlMGQxODEzMTY0","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"47a9891120631e71b66087a1d226c95f","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/home/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll afcpayroll2","response_mode":"form_post","nonce":"637020584350186565.N2M0YTljNWUtYmVkZC00NTgzLWJhODYtZTNjMWIxOTI2OTkyYTE1NWIyYWItMTJmZC00Yjc0LTkzNDItN2ZlMGQxODEzMTY0","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9NDfCkCsf8quOgNmuo8BBJvHFSSjoPmfOE0oG836yEMV1Md0vAvfyEUXJMvZCHq9dzfySpTHFHPSrDOOkZGdmTDQiPCS4L5kL0zwWBL159hgamge64Q6pnzaRDFf21EG-79CUfp6fQygw8y8yPO4CKXmzvHm0gudK8HbfTstOKGQEdmuEEsUfQ4o6Ch9_IfkcIR9v9IIBYohRW4dPkC8b1ziV9A_TRL0uCjsMuzqv5_X0kw0fjZuvhDfFm6e2xk_qB4iJVf6InObdjs4YP8T4OBiTZhDGyVHWF6Eo44I-B-qYdP4law3VtqCUzVHeks1tQ","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-22 11:14:04.296 +03:00 [DBG] Client is configured to not require consent, no consent is required
2019-08-22 11:14:04.309 +03:00 [DBG] Creating Hybrid Flow response.
2019-08-22 11:14:04.368 +03:00 [DBG] Creating Implicit Flow response.
2019-08-22 11:14:04.398 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-22 11:14:04.412 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-22 11:14:04.549 +03:00 [DBG] Authorize endpoint response
{"SubjectId":"1","ClientId":"mvc","RedirectUri":"http://localhost:5002/home/signin-oidc","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9NDfCkCsf8quOgNmuo8BBJvHFSSjoPmfOE0oG836yEMV1Md0vAvfyEUXJMvZCHq9dzfySpTHFHPSrDOOkZGdmTDQiPCS4L5kL0zwWBL159hgamge64Q6pnzaRDFf21EG-79CUfp6fQygw8y8yPO4CKXmzvHm0gudK8HbfTstOKGQEdmuEEsUfQ4o6Ch9_IfkcIR9v9IIBYohRW4dPkC8b1ziV9A_TRL0uCjsMuzqv5_X0kw0fjZuvhDfFm6e2xk_qB4iJVf6InObdjs4YP8T4OBiTZhDGyVHWF6Eo44I-B-qYdP4law3VtqCUzVHeks1tQ","Scope":"openid profile afcpayroll afcpayroll2 offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-08-22 11:14:04.600 +03:00 [DBG] Augmenting SignInContext
2019-08-22 11:14:04.602 +03:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-08-22 11:14:06.155 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-22 11:14:06.169 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-22 11:14:06.179 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-22 11:14:06.221 +03:00 [DBG] Start token request.
2019-08-22 11:14:06.234 +03:00 [DBG] Start client validation
2019-08-22 11:14:06.250 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-22 11:14:06.260 +03:00 [DBG] Start parsing for secret in post body
2019-08-22 11:14:06.281 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-22 11:14:06.282 +03:00 [DBG] Secret id found: mvc
2019-08-22 11:14:06.297 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-22 11:14:06.337 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-22 11:14:06.339 +03:00 [DBG] Client validation success
2019-08-22 11:14:06.352 +03:00 [DBG] Start token request validation
2019-08-22 11:14:06.384 +03:00 [DBG] Start validation of authorization code token request
2019-08-22 11:14:06.417 +03:00 [DBG] Validation of authorization code token request success
2019-08-22 11:14:06.423 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"3fd2d673d566871220d06030e3e60d073aebe51c37db82da1f987c2c49a80aad","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"mvc","client_secret":"***REDACTED***","code":"3fd2d673d566871220d06030e3e60d073aebe51c37db82da1f987c2c49a80aad","grant_type":"authorization_code","redirect_uri":"http://localhost:5002/home/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-08-22 11:14:06.488 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-22 11:14:06.514 +03:00 [DBG] Getting claims for access token for client: mvc
2019-08-22 11:14:06.516 +03:00 [DBG] Getting claims for access token for subject: 1
2019-08-22 11:14:06.548 +03:00 [DBG] Creating refresh token
2019-08-22 11:14:06.550 +03:00 [DBG] Setting an absolute lifetime: 2592000
2019-08-22 11:14:06.581 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-22 11:14:06.587 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-22 11:14:06.602 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-22 11:14:06.623 +03:00 [DBG] Token request success.
2019-08-22 11:14:06.650 +03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-08-22 11:14:06.663 +03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-08-22 11:14:06.677 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-08-22 11:14:06.705 +03:00 [DBG] Start userinfo request
2019-08-22 11:14:06.719 +03:00 [DBG] Bearer token found in header
2019-08-22 11:14:06.836 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-22 11:14:06.846 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-22 11:14:06.855 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-08-22 11:14:06.868 +03:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1566461646,"exp":1566461706,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","afcpayroll","afcpayroll2"],"client_id":"mvc","sub":"1","auth_time":1566461643,"idp":"local","name":"alice","email":"alice@email.com","scope":["openid","profile","test_identity","afcpayroll","afcpayroll2","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-08-22 11:14:06.922 +03:00 [DBG] Creating userinfo response
2019-08-22 11:14:06.931 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll afcpayroll2 offline_access
2019-08-22 11:14:06.957 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll afcpayroll2 offline_access
2019-08-22 11:14:06.969 +03:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-22 11:14:06.980 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll afcpayroll2 offline_access
2019-08-22 11:14:06.991 +03:00 [INF] Profile service returned the following claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-22 11:14:07.001 +03:00 [DBG] End userinfo request
2019-08-22 11:14:53.607 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-08-22 11:14:53.634 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-08-22 11:14:53.667 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-08-22 11:14:53.683 +03:00 [DBG] Start authorize request
2019-08-22 11:14:53.687 +03:00 [DBG] No user present in authorize request
2019-08-22 11:14:53.696 +03:00 [DBG] Start authorize request protocol validation
2019-08-22 11:14:53.706 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-22 11:14:53.718 +03:00 [DBG] Checking for PKCE parameters
2019-08-22 11:14:53.726 +03:00 [DBG] No PKCE used.
2019-08-22 11:14:53.733 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-22 11:14:53.753 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/home/signin-oidc","AllowedRedirectUris":["http://localhost:57002/home/signin-oidc","http://localhost:5002/home/signin-oidc"],"SubjectId":"anonymous","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll afcpayroll2","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9M52-2iy5HRTy-qDBgHYvfP87r11j3cHot1vorDj1tRkV-uDHdYMmcH3_S-lPkgf_OZ7_RBp8GJYD4zNkp3VxcroQJMlRBRdEB7ax_0CTAkk2Sa2gzBqU4xkERByumFtyhuqMJB306zt5WjvvC0tx-Rdl-kjbLYjtW1Q200Htt5HOVLgse-xA2AVJVBGqE7H9hc3cAYKCZsoKEEjjINd_DWdmNxux2L6a_FbhAjMeQ6MYB5CQSFNErkadsqwB-djlEhSJQZD-2Tz87Ih02zLFBIsl-08TOylQMoMpG1KApuRWYnCts_TMq-M47m_9sOR3g","UiLocales":null,"Nonce":"637020584935792391.NWJlNjgzZWEtNzczMi00MmNhLWIyNTMtY2JhOTJlZTFhYzNiZWQ1MWFmMjUtMzdhNC00N2NhLTgzNGQtNDUxMzA5ZjNkOWJm","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/home/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll afcpayroll2","response_mode":"form_post","nonce":"637020584935792391.NWJlNjgzZWEtNzczMi00MmNhLWIyNTMtY2JhOTJlZTFhYzNiZWQ1MWFmMjUtMzdhNC00N2NhLTgzNGQtNDUxMzA5ZjNkOWJm","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9M52-2iy5HRTy-qDBgHYvfP87r11j3cHot1vorDj1tRkV-uDHdYMmcH3_S-lPkgf_OZ7_RBp8GJYD4zNkp3VxcroQJMlRBRdEB7ax_0CTAkk2Sa2gzBqU4xkERByumFtyhuqMJB306zt5WjvvC0tx-Rdl-kjbLYjtW1Q200Htt5HOVLgse-xA2AVJVBGqE7H9hc3cAYKCZsoKEEjjINd_DWdmNxux2L6a_FbhAjMeQ6MYB5CQSFNErkadsqwB-djlEhSJQZD-2Tz87Ih02zLFBIsl-08TOylQMoMpG1KApuRWYnCts_TMq-M47m_9sOR3g","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-22 11:14:53.818 +03:00 [INF] Showing login: User is not authenticated
2019-08-22 11:14:53.839 +03:00 [DBG] Start authorize request protocol validation
2019-08-22 11:14:53.839 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-22 11:14:53.848 +03:00 [DBG] Checking for PKCE parameters
2019-08-22 11:14:53.856 +03:00 [DBG] No PKCE used.
2019-08-22 11:14:53.863 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-22 11:14:53.880 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-22 11:15:00.406 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-08-22 11:15:00.412 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-08-22 11:15:00.447 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-08-22 11:15:00.484 +03:00 [DBG] Start authorize request
2019-08-22 11:15:00.500 +03:00 [DBG] No user present in authorize request
2019-08-22 11:15:00.506 +03:00 [DBG] Start authorize request protocol validation
2019-08-22 11:15:00.515 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-22 11:15:00.528 +03:00 [DBG] Checking for PKCE parameters
2019-08-22 11:15:00.549 +03:00 [DBG] No PKCE used.
2019-08-22 11:15:00.562 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-22 11:15:00.571 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/home/signin-oidc","AllowedRedirectUris":["http://localhost:57002/home/signin-oidc","http://localhost:5002/home/signin-oidc"],"SubjectId":"anonymous","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll afcpayroll2","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9OdG0_hc7K2zk1OpzvmD0DekSY8x5tAcG67gPKf_l-gJDB21cwQocTLezm17xvKBb431zppZ4iT0-x33nnPpsKJRsqVzhhgZ3OH5lITuxPhAC85qbGNJLopBweEtkNmKMYzt8xF-Nrvc1M0KFuCyqg7FDyEYnR5p--H864R0PGcl0BITkgPNwkBB_qujC8RKmtGb7KtpFJUuTRoM_04uKZI_e_0rj3lxd2yroMGLt8AUn8w8gSA-fOBmOOkYOBsPu4NiRPT4bH6fTYSKwSdb0qEz0Y63_ZYkbNPgqXmT316c6GSjIzHnxDBfCQKMnfrq2Y","UiLocales":null,"Nonce":"637020585003413719.NzRhOWM3OTMtZTBhNi00ODU0LWE3ODctNGVjMjdhMjBlMTI4NzAyOTc0YzEtZGRkNS00MjM2LWJkOTMtNWY0ODI1MGZlYzgz","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/home/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll afcpayroll2","response_mode":"form_post","nonce":"637020585003413719.NzRhOWM3OTMtZTBhNi00ODU0LWE3ODctNGVjMjdhMjBlMTI4NzAyOTc0YzEtZGRkNS00MjM2LWJkOTMtNWY0ODI1MGZlYzgz","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9OdG0_hc7K2zk1OpzvmD0DekSY8x5tAcG67gPKf_l-gJDB21cwQocTLezm17xvKBb431zppZ4iT0-x33nnPpsKJRsqVzhhgZ3OH5lITuxPhAC85qbGNJLopBweEtkNmKMYzt8xF-Nrvc1M0KFuCyqg7FDyEYnR5p--H864R0PGcl0BITkgPNwkBB_qujC8RKmtGb7KtpFJUuTRoM_04uKZI_e_0rj3lxd2yroMGLt8AUn8w8gSA-fOBmOOkYOBsPu4NiRPT4bH6fTYSKwSdb0qEz0Y63_ZYkbNPgqXmT316c6GSjIzHnxDBfCQKMnfrq2Y","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-22 11:15:00.629 +03:00 [INF] Showing login: User is not authenticated
2019-08-22 11:15:00.655 +03:00 [DBG] Start authorize request protocol validation
2019-08-22 11:15:00.660 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-22 11:15:00.664 +03:00 [DBG] Checking for PKCE parameters
2019-08-22 11:15:00.673 +03:00 [DBG] No PKCE used.
2019-08-22 11:15:00.678 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-22 11:15:00.696 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-22 11:15:16.628 +03:00 [DBG] CORS request made for path: /account/login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-08-22 11:15:16.640 +03:00 [DBG] Start authorize request protocol validation
2019-08-22 11:15:16.654 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-22 11:15:16.674 +03:00 [DBG] Checking for PKCE parameters
2019-08-22 11:15:16.680 +03:00 [DBG] No PKCE used.
2019-08-22 11:15:16.684 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-22 11:15:16.703 +03:00 [DBG] Augmenting SignInContext
2019-08-22 11:15:16.719 +03:00 [DBG] Adding idp claim with value: local
2019-08-22 11:15:16.723 +03:00 [DBG] Adding amr claim with value: pwd
2019-08-22 11:15:16.739 +03:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-08-22 11:15:16.754 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-22 11:15:16.799 +03:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-08-22 11:15:16.807 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-08-22 11:15:16.822 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-08-22 11:15:16.836 +03:00 [DBG] Start authorize callback request
2019-08-22 11:15:16.850 +03:00 [DBG] User in authorize request: 1
2019-08-22 11:15:16.853 +03:00 [DBG] Start authorize request protocol validation
2019-08-22 11:15:16.865 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-22 11:15:16.877 +03:00 [DBG] Checking for PKCE parameters
2019-08-22 11:15:16.881 +03:00 [DBG] No PKCE used.
2019-08-22 11:15:16.896 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-22 11:15:16.913 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/home/signin-oidc","AllowedRedirectUris":["http://localhost:57002/home/signin-oidc","http://localhost:5002/home/signin-oidc"],"SubjectId":"1","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll afcpayroll2","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9OdG0_hc7K2zk1OpzvmD0DekSY8x5tAcG67gPKf_l-gJDB21cwQocTLezm17xvKBb431zppZ4iT0-x33nnPpsKJRsqVzhhgZ3OH5lITuxPhAC85qbGNJLopBweEtkNmKMYzt8xF-Nrvc1M0KFuCyqg7FDyEYnR5p--H864R0PGcl0BITkgPNwkBB_qujC8RKmtGb7KtpFJUuTRoM_04uKZI_e_0rj3lxd2yroMGLt8AUn8w8gSA-fOBmOOkYOBsPu4NiRPT4bH6fTYSKwSdb0qEz0Y63_ZYkbNPgqXmT316c6GSjIzHnxDBfCQKMnfrq2Y","UiLocales":null,"Nonce":"637020585003413719.NzRhOWM3OTMtZTBhNi00ODU0LWE3ODctNGVjMjdhMjBlMTI4NzAyOTc0YzEtZGRkNS00MjM2LWJkOTMtNWY0ODI1MGZlYzgz","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"26852b5b8ab876b7d8ba825a82211d4d","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/home/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll afcpayroll2","response_mode":"form_post","nonce":"637020585003413719.NzRhOWM3OTMtZTBhNi00ODU0LWE3ODctNGVjMjdhMjBlMTI4NzAyOTc0YzEtZGRkNS00MjM2LWJkOTMtNWY0ODI1MGZlYzgz","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9OdG0_hc7K2zk1OpzvmD0DekSY8x5tAcG67gPKf_l-gJDB21cwQocTLezm17xvKBb431zppZ4iT0-x33nnPpsKJRsqVzhhgZ3OH5lITuxPhAC85qbGNJLopBweEtkNmKMYzt8xF-Nrvc1M0KFuCyqg7FDyEYnR5p--H864R0PGcl0BITkgPNwkBB_qujC8RKmtGb7KtpFJUuTRoM_04uKZI_e_0rj3lxd2yroMGLt8AUn8w8gSA-fOBmOOkYOBsPu4NiRPT4bH6fTYSKwSdb0qEz0Y63_ZYkbNPgqXmT316c6GSjIzHnxDBfCQKMnfrq2Y","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-22 11:15:17.003 +03:00 [DBG] Client is configured to not require consent, no consent is required
2019-08-22 11:15:17.004 +03:00 [DBG] Creating Hybrid Flow response.
2019-08-22 11:15:17.015 +03:00 [DBG] Creating Implicit Flow response.
2019-08-22 11:15:17.036 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-22 11:15:17.055 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-22 11:15:17.073 +03:00 [DBG] Authorize endpoint response
{"SubjectId":"1","ClientId":"mvc","RedirectUri":"http://localhost:5002/home/signin-oidc","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9OdG0_hc7K2zk1OpzvmD0DekSY8x5tAcG67gPKf_l-gJDB21cwQocTLezm17xvKBb431zppZ4iT0-x33nnPpsKJRsqVzhhgZ3OH5lITuxPhAC85qbGNJLopBweEtkNmKMYzt8xF-Nrvc1M0KFuCyqg7FDyEYnR5p--H864R0PGcl0BITkgPNwkBB_qujC8RKmtGb7KtpFJUuTRoM_04uKZI_e_0rj3lxd2yroMGLt8AUn8w8gSA-fOBmOOkYOBsPu4NiRPT4bH6fTYSKwSdb0qEz0Y63_ZYkbNPgqXmT316c6GSjIzHnxDBfCQKMnfrq2Y","Scope":"openid profile afcpayroll afcpayroll2 offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-08-22 11:15:17.099 +03:00 [DBG] Augmenting SignInContext
2019-08-22 11:15:17.110 +03:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-08-22 11:15:17.528 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-22 11:15:17.539 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-22 11:15:17.568 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-22 11:15:17.572 +03:00 [DBG] Start token request.
2019-08-22 11:15:17.584 +03:00 [DBG] Start client validation
2019-08-22 11:15:17.586 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-22 11:15:17.597 +03:00 [DBG] Start parsing for secret in post body
2019-08-22 11:15:17.602 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-22 11:15:17.616 +03:00 [DBG] Secret id found: mvc
2019-08-22 11:15:17.618 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-22 11:15:17.638 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-22 11:15:17.646 +03:00 [DBG] Client validation success
2019-08-22 11:15:17.662 +03:00 [DBG] Start token request validation
2019-08-22 11:15:17.669 +03:00 [DBG] Start validation of authorization code token request
2019-08-22 11:15:17.678 +03:00 [DBG] Validation of authorization code token request success
2019-08-22 11:15:17.682 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"8a7c7558baac9412359eeed38400b8163144c0f4b37e65ad294c38a1d97f587f","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"mvc","client_secret":"***REDACTED***","code":"8a7c7558baac9412359eeed38400b8163144c0f4b37e65ad294c38a1d97f587f","grant_type":"authorization_code","redirect_uri":"http://localhost:5002/home/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-08-22 11:15:17.712 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-22 11:15:17.732 +03:00 [DBG] Getting claims for access token for client: mvc
2019-08-22 11:15:17.740 +03:00 [DBG] Getting claims for access token for subject: 1
2019-08-22 11:15:17.751 +03:00 [DBG] Creating refresh token
2019-08-22 11:15:17.756 +03:00 [DBG] Setting an absolute lifetime: 2592000
2019-08-22 11:15:17.764 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-22 11:15:17.781 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-22 11:15:17.796 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-22 11:15:17.813 +03:00 [DBG] Token request success.
2019-08-22 11:15:17.840 +03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-08-22 11:15:17.844 +03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-08-22 11:15:17.850 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-08-22 11:15:17.856 +03:00 [DBG] Start userinfo request
2019-08-22 11:15:17.862 +03:00 [DBG] Bearer token found in header
2019-08-22 11:15:17.871 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-22 11:15:17.882 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-22 11:15:17.896 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-08-22 11:15:17.913 +03:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1566461717,"exp":1566461777,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","afcpayroll","afcpayroll2"],"client_id":"mvc","sub":"1","auth_time":1566461716,"idp":"local","name":"alice","email":"alice@email.com","scope":["openid","profile","test_identity","afcpayroll","afcpayroll2","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-08-22 11:15:17.950 +03:00 [DBG] Creating userinfo response
2019-08-22 11:15:17.951 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll afcpayroll2 offline_access
2019-08-22 11:15:17.969 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll afcpayroll2 offline_access
2019-08-22 11:15:17.996 +03:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-22 11:15:17.999 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll afcpayroll2 offline_access
2019-08-22 11:15:18.015 +03:00 [INF] Profile service returned the following claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-22 11:15:18.033 +03:00 [DBG] End userinfo request
2019-08-22 11:15:29.848 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-08-22 11:15:29.853 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-08-22 11:15:29.874 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-08-22 11:15:29.888 +03:00 [DBG] Start authorize request
2019-08-22 11:15:29.899 +03:00 [DBG] User in authorize request: 1
2019-08-22 11:15:29.911 +03:00 [DBG] Start authorize request protocol validation
2019-08-22 11:15:29.919 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-22 11:15:29.939 +03:00 [DBG] Checking for PKCE parameters
2019-08-22 11:15:29.943 +03:00 [DBG] No PKCE used.
2019-08-22 11:15:29.952 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-22 11:15:29.969 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/home/signin-oidc","AllowedRedirectUris":["http://localhost:57002/home/signin-oidc","http://localhost:5002/home/signin-oidc"],"SubjectId":"1","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll afcpayroll2","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9OdG0_hc7K2zk1OpzvmD0DekSY8x5tAcG67gPKf_l-gJDB21cwQocTLezm17xvKBb431zppZ4iT0-x33nnPpsKJRsqVzhhgZ3OH5lITuxPhAC85qbGNJLopBweEtkNmKMYzt8xF-Nrvc1M0KFuCyqg7FDyEYnR5p--H864R0PGcl0BITkgPNwkBB_qujC8RKmtGb7KtpFJUuTRoM_04uKZI_e_0rj3lxd2yroMGLt8AUn8w8gSA-fOBmOOkYOBsPu4NiRPT4bH6fTYSKwSdb0qEz0Y63_ZYkbNPgqXmT316c6GSjIzHnxDBfCQKMnfrq2Y","UiLocales":null,"Nonce":"637020585003413719.NzRhOWM3OTMtZTBhNi00ODU0LWE3ODctNGVjMjdhMjBlMTI4NzAyOTc0YzEtZGRkNS00MjM2LWJkOTMtNWY0ODI1MGZlYzgz","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"26852b5b8ab876b7d8ba825a82211d4d","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/home/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll afcpayroll2","response_mode":"form_post","nonce":"637020585003413719.NzRhOWM3OTMtZTBhNi00ODU0LWE3ODctNGVjMjdhMjBlMTI4NzAyOTc0YzEtZGRkNS00MjM2LWJkOTMtNWY0ODI1MGZlYzgz","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9OdG0_hc7K2zk1OpzvmD0DekSY8x5tAcG67gPKf_l-gJDB21cwQocTLezm17xvKBb431zppZ4iT0-x33nnPpsKJRsqVzhhgZ3OH5lITuxPhAC85qbGNJLopBweEtkNmKMYzt8xF-Nrvc1M0KFuCyqg7FDyEYnR5p--H864R0PGcl0BITkgPNwkBB_qujC8RKmtGb7KtpFJUuTRoM_04uKZI_e_0rj3lxd2yroMGLt8AUn8w8gSA-fOBmOOkYOBsPu4NiRPT4bH6fTYSKwSdb0qEz0Y63_ZYkbNPgqXmT316c6GSjIzHnxDBfCQKMnfrq2Y","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-22 11:15:30.037 +03:00 [DBG] Client is configured to not require consent, no consent is required
2019-08-22 11:15:30.048 +03:00 [DBG] Creating Hybrid Flow response.
2019-08-22 11:15:30.052 +03:00 [DBG] Creating Implicit Flow response.
2019-08-22 11:15:30.061 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-22 11:15:30.075 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-22 11:15:30.086 +03:00 [DBG] Authorize endpoint response
{"SubjectId":"1","ClientId":"mvc","RedirectUri":"http://localhost:5002/home/signin-oidc","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9OdG0_hc7K2zk1OpzvmD0DekSY8x5tAcG67gPKf_l-gJDB21cwQocTLezm17xvKBb431zppZ4iT0-x33nnPpsKJRsqVzhhgZ3OH5lITuxPhAC85qbGNJLopBweEtkNmKMYzt8xF-Nrvc1M0KFuCyqg7FDyEYnR5p--H864R0PGcl0BITkgPNwkBB_qujC8RKmtGb7KtpFJUuTRoM_04uKZI_e_0rj3lxd2yroMGLt8AUn8w8gSA-fOBmOOkYOBsPu4NiRPT4bH6fTYSKwSdb0qEz0Y63_ZYkbNPgqXmT316c6GSjIzHnxDBfCQKMnfrq2Y","Scope":"openid profile afcpayroll afcpayroll2 offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-08-22 11:16:06.531 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-08-22 11:16:06.538 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-08-22 11:16:06.574 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-08-22 11:16:06.603 +03:00 [DBG] Start authorize request
2019-08-22 11:16:06.608 +03:00 [DBG] User in authorize request: 1
2019-08-22 11:16:06.620 +03:00 [DBG] Start authorize request protocol validation
2019-08-22 11:16:06.629 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-22 11:16:06.645 +03:00 [DBG] Checking for PKCE parameters
2019-08-22 11:16:06.649 +03:00 [DBG] No PKCE used.
2019-08-22 11:16:06.669 +03:00 [ERR] Nonce required for implicit and hybrid flow with openid scope
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/home/signin-oidc","AllowedRedirectUris":["http://localhost:57002/home/signin-oidc","http://localhost:5002/home/signin-oidc"],"SubjectId":"1","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll afcpayroll2","State":null,"UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/home/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll afcpayroll2","response_mode":"form_post"},"$type":"AuthorizeRequestValidationLog"}
2019-08-22 11:16:06.712 +03:00 [ERR] Request validation failed
2019-08-22 11:16:06.716 +03:00 [INF] {"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/home/signin-oidc","AllowedRedirectUris":["http://localhost:57002/home/signin-oidc","http://localhost:5002/home/signin-oidc"],"SubjectId":"1","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll afcpayroll2","State":null,"UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/home/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll afcpayroll2","response_mode":"form_post"},"$type":"AuthorizeRequestValidationLog"}
2019-08-22 11:16:39.783 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-22 11:16:39.789 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-22 11:16:39.802 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-22 11:16:39.824 +03:00 [DBG] Start discovery request
2019-08-22 11:16:39.847 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-22 11:16:39.848 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-22 11:16:39.851 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-22 11:16:39.853 +03:00 [DBG] Start key discovery request
2019-08-22 11:16:39.894 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-22 11:16:39.902 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-22 11:16:39.919 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-22 11:16:39.929 +03:00 [DBG] Start token request.
2019-08-22 11:16:39.942 +03:00 [DBG] Start client validation
2019-08-22 11:16:39.944 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-22 11:16:39.953 +03:00 [DBG] Start parsing for secret in post body
2019-08-22 11:16:39.959 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-22 11:16:39.972 +03:00 [DBG] Secret id found: mvc
2019-08-22 11:16:39.976 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-22 11:16:39.989 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-22 11:16:39.996 +03:00 [DBG] Client validation success
2019-08-22 11:16:39.998 +03:00 [DBG] Start token request validation
2019-08-22 11:16:40.010 +03:00 [DBG] Start validation of refresh token request
2019-08-22 11:16:40.040 +03:00 [DBG] Token validation success
{"ClientId":"mvc","ClientName":"MVC Client","ValidateLifetime":false,"AccessTokenType":null,"ExpectedScope":null,"TokenHandle":null,"JwtId":null,"Claims":{"sub":"1","client_id":"mvc","scope":["openid","profile","test_identity","afcpayroll","afcpayroll2","offline_access"],"auth_time":1566461716,"idp":"local","amr":"pwd","name":"alice","email":"alice@email.com"},"$type":"TokenValidationLog"}
2019-08-22 11:16:40.064 +03:00 [DBG] Validation of refresh token request success
2019-08-22 11:16:40.066 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"refresh_token","Scopes":null,"AuthorizationCode":null,"RefreshToken":"fadde434269683a1b3d52f6b4711bd57decc966f3091051d27b9087099c7a307","UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"refresh_token","refresh_token":"***REDACTED***","client_id":"mvc","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2019-08-22 11:16:40.119 +03:00 [DBG] Updating refresh token
2019-08-22 11:16:40.120 +03:00 [DBG] No updates to refresh token done
2019-08-22 11:16:40.137 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-22 11:16:40.143 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-22 11:16:40.166 +03:00 [DBG] Token request success.
2019-08-22 11:16:49.160 +03:00 [INF] AuthenticationScheme: Identity.Application was challenged.
2019-08-22 11:17:50.033 +03:00 [INF] Starting IdentityServer4 version 2.5.0.0
2019-08-22 11:17:50.221 +03:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-08-22 11:17:50.313 +03:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-08-22 11:17:50.382 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-in
2019-08-22 11:17:50.394 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-out
2019-08-22 11:17:50.400 +03:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-08-22 11:17:50.414 +03:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-08-22 11:17:59.604 +03:00 [DBG] Login Url: /account/login
2019-08-22 11:17:59.613 +03:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-08-22 11:17:59.619 +03:00 [DBG] Logout Url: /Account/Logout
2019-08-22 11:17:59.628 +03:00 [DBG] ConsentUrl Url: /consent
2019-08-22 11:17:59.634 +03:00 [DBG] Consent Return Url Parameter: returnUrl
2019-08-22 11:17:59.648 +03:00 [DBG] Error Url: /home/error
2019-08-22 11:17:59.653 +03:00 [DBG] Error Id Parameter: errorId
2019-08-22 11:17:59.760 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-22 11:17:59.772 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-22 11:17:59.781 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-22 11:17:59.804 +03:00 [DBG] Start discovery request
2019-08-22 11:18:00.111 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-22 11:18:00.126 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-22 11:18:00.137 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-22 11:18:00.166 +03:00 [DBG] Start key discovery request
2019-08-22 11:18:00.268 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-22 11:18:00.292 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-22 11:18:00.299 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-22 11:18:00.358 +03:00 [DBG] Start token request.
2019-08-22 11:18:00.376 +03:00 [DBG] Start client validation
2019-08-22 11:18:00.388 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-22 11:18:00.406 +03:00 [DBG] Start parsing for secret in post body
2019-08-22 11:18:00.448 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-22 11:18:00.449 +03:00 [DBG] Secret id found: mvc
2019-08-22 11:18:00.516 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-22 11:18:00.549 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-22 11:18:00.549 +03:00 [DBG] Client validation success
2019-08-22 11:18:00.585 +03:00 [DBG] Start token request validation
2019-08-22 11:18:00.603 +03:00 [DBG] Start validation of refresh token request
2019-08-22 11:18:00.632 +03:00 [DBG] refresh_token grant with value: fadde434269683a1b3d52f6b4711bd57decc966f3091051d27b9087099c7a307 not found in store.
2019-08-22 11:18:00.640 +03:00 [WRN] Invalid refresh token
2019-08-22 11:18:00.682 +03:00 [WRN] Refresh token validation failed. aborting, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"refresh_token","Scopes":null,"AuthorizationCode":null,"RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"refresh_token","refresh_token":"***REDACTED***","client_id":"mvc","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2019-08-22 11:18:12.966 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-22 11:18:12.971 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-22 11:18:12.980 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-22 11:18:13.019 +03:00 [DBG] Start discovery request
2019-08-22 11:18:13.142 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-22 11:18:13.150 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-22 11:18:13.164 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-22 11:18:13.178 +03:00 [DBG] Start key discovery request
2019-08-22 11:18:13.349 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-08-22 11:18:13.379 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-08-22 11:18:13.385 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-08-22 11:18:13.413 +03:00 [DBG] Start authorize request
2019-08-22 11:18:13.428 +03:00 [DBG] No user present in authorize request
2019-08-22 11:18:13.455 +03:00 [DBG] Start authorize request protocol validation
2019-08-22 11:18:13.469 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-22 11:18:13.501 +03:00 [DBG] Checking for PKCE parameters
2019-08-22 11:18:13.514 +03:00 [DBG] No PKCE used.
2019-08-22 11:18:13.603 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-22 11:18:13.625 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/home/signin-oidc","AllowedRedirectUris":["http://localhost:57002/home/signin-oidc","http://localhost:5002/home/signin-oidc"],"SubjectId":"anonymous","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll afcpayroll2","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9Oc8dCvriTuEAsMlU43HX06xln36uHF69ACPmYXO9eSw6cHgQy5JenjAy5WVID6yQ5sK7VLDsmLmmKhoH0JqGHXUh3p8TQCEHu82IMdpZHwniAsjrt6ueHI_Mv9ObMxo2aOdSx9Zxdf6JSDRSj3U3jbgs895BkjQBIwSLJw3vJUPPkV9Uo-FjC5kDkB5GWfEMlSvA6LlYUpCX8ZfU0P4Afj02u4uRs-cvC9FGbQK5JYWQwM1_1lUApbAuFfj6tW662veYYTe2ecWOxjApLHkmz6qX-jv0aUjrEF3agzIUXa6fii9Ne_X99lhWnrJlIcBXo","UiLocales":null,"Nonce":"637020586932534955.NjA2ZmIxODUtYmRjNC00ZDE0LWFiMjItYmViZDk3ZGZiMTYwZGNhZWQ2NTgtYmQ4MC00YTFiLTg0YjYtN2ViYjYxMzhjZDZh","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/home/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll afcpayroll2","response_mode":"form_post","nonce":"637020586932534955.NjA2ZmIxODUtYmRjNC00ZDE0LWFiMjItYmViZDk3ZGZiMTYwZGNhZWQ2NTgtYmQ4MC00YTFiLTg0YjYtN2ViYjYxMzhjZDZh","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9Oc8dCvriTuEAsMlU43HX06xln36uHF69ACPmYXO9eSw6cHgQy5JenjAy5WVID6yQ5sK7VLDsmLmmKhoH0JqGHXUh3p8TQCEHu82IMdpZHwniAsjrt6ueHI_Mv9ObMxo2aOdSx9Zxdf6JSDRSj3U3jbgs895BkjQBIwSLJw3vJUPPkV9Uo-FjC5kDkB5GWfEMlSvA6LlYUpCX8ZfU0P4Afj02u4uRs-cvC9FGbQK5JYWQwM1_1lUApbAuFfj6tW662veYYTe2ecWOxjApLHkmz6qX-jv0aUjrEF3agzIUXa6fii9Ne_X99lhWnrJlIcBXo","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-22 11:18:13.705 +03:00 [INF] Showing login: User is not authenticated
2019-08-22 11:18:14.020 +03:00 [DBG] Start authorize request protocol validation
2019-08-22 11:18:14.021 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-22 11:18:14.037 +03:00 [DBG] Checking for PKCE parameters
2019-08-22 11:18:14.040 +03:00 [DBG] No PKCE used.
2019-08-22 11:18:14.059 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-22 11:18:14.079 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-22 11:18:15.937 +03:00 [DBG] CORS request made for path: /account/login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-08-22 11:18:15.990 +03:00 [DBG] Start authorize request protocol validation
2019-08-22 11:18:15.992 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-22 11:18:16.011 +03:00 [DBG] Checking for PKCE parameters
2019-08-22 11:18:16.021 +03:00 [DBG] No PKCE used.
2019-08-22 11:18:16.048 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-22 11:18:16.101 +03:00 [DBG] Augmenting SignInContext
2019-08-22 11:18:16.107 +03:00 [DBG] Adding idp claim with value: local
2019-08-22 11:18:16.108 +03:00 [DBG] Adding amr claim with value: pwd
2019-08-22 11:18:16.143 +03:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-08-22 11:18:16.147 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-22 11:18:16.180 +03:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-08-22 11:18:16.188 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-08-22 11:18:16.214 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-08-22 11:18:16.250 +03:00 [DBG] Start authorize callback request
2019-08-22 11:18:16.270 +03:00 [DBG] User in authorize request: 1
2019-08-22 11:18:16.271 +03:00 [DBG] Start authorize request protocol validation
2019-08-22 11:18:16.281 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-22 11:18:16.304 +03:00 [DBG] Checking for PKCE parameters
2019-08-22 11:18:16.315 +03:00 [DBG] No PKCE used.
2019-08-22 11:18:16.328 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-22 11:18:16.334 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/home/signin-oidc","AllowedRedirectUris":["http://localhost:57002/home/signin-oidc","http://localhost:5002/home/signin-oidc"],"SubjectId":"1","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll afcpayroll2","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9Oc8dCvriTuEAsMlU43HX06xln36uHF69ACPmYXO9eSw6cHgQy5JenjAy5WVID6yQ5sK7VLDsmLmmKhoH0JqGHXUh3p8TQCEHu82IMdpZHwniAsjrt6ueHI_Mv9ObMxo2aOdSx9Zxdf6JSDRSj3U3jbgs895BkjQBIwSLJw3vJUPPkV9Uo-FjC5kDkB5GWfEMlSvA6LlYUpCX8ZfU0P4Afj02u4uRs-cvC9FGbQK5JYWQwM1_1lUApbAuFfj6tW662veYYTe2ecWOxjApLHkmz6qX-jv0aUjrEF3agzIUXa6fii9Ne_X99lhWnrJlIcBXo","UiLocales":null,"Nonce":"637020586932534955.NjA2ZmIxODUtYmRjNC00ZDE0LWFiMjItYmViZDk3ZGZiMTYwZGNhZWQ2NTgtYmQ4MC00YTFiLTg0YjYtN2ViYjYxMzhjZDZh","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"70c05c1e7671ddfacf3d933b8372dc95","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/home/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll afcpayroll2","response_mode":"form_post","nonce":"637020586932534955.NjA2ZmIxODUtYmRjNC00ZDE0LWFiMjItYmViZDk3ZGZiMTYwZGNhZWQ2NTgtYmQ4MC00YTFiLTg0YjYtN2ViYjYxMzhjZDZh","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9Oc8dCvriTuEAsMlU43HX06xln36uHF69ACPmYXO9eSw6cHgQy5JenjAy5WVID6yQ5sK7VLDsmLmmKhoH0JqGHXUh3p8TQCEHu82IMdpZHwniAsjrt6ueHI_Mv9ObMxo2aOdSx9Zxdf6JSDRSj3U3jbgs895BkjQBIwSLJw3vJUPPkV9Uo-FjC5kDkB5GWfEMlSvA6LlYUpCX8ZfU0P4Afj02u4uRs-cvC9FGbQK5JYWQwM1_1lUApbAuFfj6tW662veYYTe2ecWOxjApLHkmz6qX-jv0aUjrEF3agzIUXa6fii9Ne_X99lhWnrJlIcBXo","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-22 11:18:16.441 +03:00 [DBG] Client is configured to not require consent, no consent is required
2019-08-22 11:18:16.458 +03:00 [DBG] Creating Hybrid Flow response.
2019-08-22 11:18:16.521 +03:00 [DBG] Creating Implicit Flow response.
2019-08-22 11:18:16.545 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-22 11:18:16.555 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-22 11:18:16.703 +03:00 [DBG] Authorize endpoint response
{"SubjectId":"1","ClientId":"mvc","RedirectUri":"http://localhost:5002/home/signin-oidc","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9Oc8dCvriTuEAsMlU43HX06xln36uHF69ACPmYXO9eSw6cHgQy5JenjAy5WVID6yQ5sK7VLDsmLmmKhoH0JqGHXUh3p8TQCEHu82IMdpZHwniAsjrt6ueHI_Mv9ObMxo2aOdSx9Zxdf6JSDRSj3U3jbgs895BkjQBIwSLJw3vJUPPkV9Uo-FjC5kDkB5GWfEMlSvA6LlYUpCX8ZfU0P4Afj02u4uRs-cvC9FGbQK5JYWQwM1_1lUApbAuFfj6tW662veYYTe2ecWOxjApLHkmz6qX-jv0aUjrEF3agzIUXa6fii9Ne_X99lhWnrJlIcBXo","Scope":"openid profile afcpayroll afcpayroll2 offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-08-22 11:18:16.758 +03:00 [DBG] Augmenting SignInContext
2019-08-22 11:18:16.759 +03:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-08-22 11:18:18.298 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-22 11:18:18.304 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-22 11:18:18.320 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-22 11:18:18.335 +03:00 [DBG] Start token request.
2019-08-22 11:18:18.353 +03:00 [DBG] Start client validation
2019-08-22 11:18:18.362 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-22 11:18:18.376 +03:00 [DBG] Start parsing for secret in post body
2019-08-22 11:18:18.381 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-22 11:18:18.393 +03:00 [DBG] Secret id found: mvc
2019-08-22 11:18:18.400 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-22 11:18:18.419 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-22 11:18:18.427 +03:00 [DBG] Client validation success
2019-08-22 11:18:18.435 +03:00 [DBG] Start token request validation
2019-08-22 11:18:18.457 +03:00 [DBG] Start validation of authorization code token request
2019-08-22 11:18:18.491 +03:00 [DBG] Validation of authorization code token request success
2019-08-22 11:18:18.492 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"c2abf0356e24aa5afa90e6dccb54ea9de83a06cfa431163145bd654fdc56b59a","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"mvc","client_secret":"***REDACTED***","code":"c2abf0356e24aa5afa90e6dccb54ea9de83a06cfa431163145bd654fdc56b59a","grant_type":"authorization_code","redirect_uri":"http://localhost:5002/home/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-08-22 11:18:18.564 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-22 11:18:18.602 +03:00 [DBG] Getting claims for access token for client: mvc
2019-08-22 11:18:18.612 +03:00 [DBG] Getting claims for access token for subject: 1
2019-08-22 11:18:18.635 +03:00 [DBG] Creating refresh token
2019-08-22 11:18:18.637 +03:00 [DBG] Setting an absolute lifetime: 2592000
2019-08-22 11:18:18.665 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-22 11:18:18.671 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-22 11:18:18.686 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-22 11:18:18.713 +03:00 [DBG] Token request success.
2019-08-22 11:18:18.741 +03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-08-22 11:18:18.750 +03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-08-22 11:18:18.762 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-08-22 11:18:18.791 +03:00 [DBG] Start userinfo request
2019-08-22 11:18:18.803 +03:00 [DBG] Bearer token found in header
2019-08-22 11:18:18.939 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-22 11:18:18.953 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-22 11:18:18.957 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-08-22 11:18:18.974 +03:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1566461898,"exp":1566461958,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","afcpayroll","afcpayroll2"],"client_id":"mvc","sub":"1","auth_time":1566461896,"idp":"local","name":"alice","email":"alice@email.com","scope":["openid","profile","test_identity","afcpayroll","afcpayroll2","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-08-22 11:18:19.018 +03:00 [DBG] Creating userinfo response
2019-08-22 11:18:19.040 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll afcpayroll2 offline_access
2019-08-22 11:18:19.054 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll afcpayroll2 offline_access
2019-08-22 11:18:19.065 +03:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-22 11:18:19.079 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll afcpayroll2 offline_access
2019-08-22 11:18:19.095 +03:00 [INF] Profile service returned the following claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-22 11:18:19.115 +03:00 [DBG] End userinfo request
2019-08-22 11:18:34.696 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-22 11:18:34.707 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-22 11:18:34.721 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-22 11:18:34.744 +03:00 [DBG] Start discovery request
2019-08-22 11:18:34.836 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-22 11:18:34.843 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-22 11:18:34.861 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-22 11:18:34.874 +03:00 [DBG] Start key discovery request
2019-08-22 11:18:34.913 +03:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenInvalidAudienceException: IDX10214: Audience validation failed. Audiences: '[PII is hidden]'. Did not match: validationParameters.ValidAudience: '[PII is hidden]' or validationParameters.ValidAudiences: '[PII is hidden]'.
   at Microsoft.IdentityModel.Tokens.Validators.ValidateAudience(IEnumerable`1 audiences, SecurityToken securityToken, TokenValidationParameters validationParameters) in C:\agent2\_work\15\s\src\Microsoft.IdentityModel.Tokens\Validators.cs:line 108
   at System.IdentityModel.Tokens.Jwt.JwtSecurityTokenHandler.ValidateTokenPayload(JwtSecurityToken jwtToken, TokenValidationParameters validationParameters) in C:\agent2\_work\15\s\src\System.IdentityModel.Tokens.Jwt\JwtSecurityTokenHandler.cs:line 765
   at System.IdentityModel.Tokens.Jwt.JwtSecurityTokenHandler.ValidateToken(String token, TokenValidationParameters validationParameters, SecurityToken& validatedToken) in C:\agent2\_work\15\s\src\System.IdentityModel.Tokens.Jwt\JwtSecurityTokenHandler.cs:line 747
   at Microsoft.AspNetCore.Authentication.JwtBearer.JwtBearerHandler.HandleAuthenticateAsync()
2019-08-22 11:18:35.007 +03:00 [INF] Bearer was not authenticated. Failure message: IDX10214: Audience validation failed. Audiences: '[PII is hidden]'. Did not match: validationParameters.ValidAudience: '[PII is hidden]' or validationParameters.ValidAudiences: '[PII is hidden]'.
2019-08-22 11:18:35.059 +03:00 [INF] AuthenticationScheme: Bearer was challenged.
2019-08-22 11:18:48.149 +03:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenInvalidAudienceException: IDX10214: Audience validation failed. Audiences: '[PII is hidden]'. Did not match: validationParameters.ValidAudience: '[PII is hidden]' or validationParameters.ValidAudiences: '[PII is hidden]'.
   at Microsoft.IdentityModel.Tokens.Validators.ValidateAudience(IEnumerable`1 audiences, SecurityToken securityToken, TokenValidationParameters validationParameters) in C:\agent2\_work\15\s\src\Microsoft.IdentityModel.Tokens\Validators.cs:line 108
   at System.IdentityModel.Tokens.Jwt.JwtSecurityTokenHandler.ValidateTokenPayload(JwtSecurityToken jwtToken, TokenValidationParameters validationParameters) in C:\agent2\_work\15\s\src\System.IdentityModel.Tokens.Jwt\JwtSecurityTokenHandler.cs:line 765
   at System.IdentityModel.Tokens.Jwt.JwtSecurityTokenHandler.ValidateToken(String token, TokenValidationParameters validationParameters, SecurityToken& validatedToken) in C:\agent2\_work\15\s\src\System.IdentityModel.Tokens.Jwt\JwtSecurityTokenHandler.cs:line 747
   at Microsoft.AspNetCore.Authentication.JwtBearer.JwtBearerHandler.HandleAuthenticateAsync()
2019-08-22 11:18:48.183 +03:00 [INF] Bearer was not authenticated. Failure message: IDX10214: Audience validation failed. Audiences: '[PII is hidden]'. Did not match: validationParameters.ValidAudience: '[PII is hidden]' or validationParameters.ValidAudiences: '[PII is hidden]'.
2019-08-22 11:18:48.194 +03:00 [INF] AuthenticationScheme: Bearer was challenged.
2019-08-22 11:19:50.094 +03:00 [INF] Starting IdentityServer4 version 2.5.0.0
2019-08-22 11:19:50.234 +03:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-08-22 11:19:50.235 +03:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-08-22 11:19:50.236 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-in
2019-08-22 11:19:50.236 +03:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-out
2019-08-22 11:19:50.237 +03:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-08-22 11:19:50.237 +03:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-08-22 11:19:56.897 +03:00 [DBG] Login Url: /account/login
2019-08-22 11:19:56.902 +03:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-08-22 11:19:56.903 +03:00 [DBG] Logout Url: /Account/Logout
2019-08-22 11:19:56.903 +03:00 [DBG] ConsentUrl Url: /consent
2019-08-22 11:19:56.903 +03:00 [DBG] Consent Return Url Parameter: returnUrl
2019-08-22 11:19:56.904 +03:00 [DBG] Error Url: /home/error
2019-08-22 11:19:56.905 +03:00 [DBG] Error Id Parameter: errorId
2019-08-22 11:19:57.006 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-22 11:19:57.027 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-22 11:19:57.031 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-22 11:19:57.040 +03:00 [DBG] Start discovery request
2019-08-22 11:19:57.682 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-22 11:19:57.686 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-22 11:19:57.687 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-22 11:19:57.695 +03:00 [DBG] Start key discovery request
2019-08-22 11:19:57.870 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-08-22 11:19:57.896 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-08-22 11:19:57.897 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-08-22 11:19:57.910 +03:00 [DBG] Start authorize request
2019-08-22 11:19:57.932 +03:00 [DBG] No user present in authorize request
2019-08-22 11:19:57.968 +03:00 [DBG] Start authorize request protocol validation
2019-08-22 11:19:58.051 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-22 11:19:58.100 +03:00 [DBG] Checking for PKCE parameters
2019-08-22 11:19:58.106 +03:00 [DBG] No PKCE used.
2019-08-22 11:19:58.194 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-22 11:19:58.251 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/home/signin-oidc","AllowedRedirectUris":["http://localhost:57002/home/signin-oidc","http://localhost:5002/home/signin-oidc"],"SubjectId":"anonymous","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll afcpayroll2","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9MieijHQPG94AXT2pR0gIKq9ikYsrBFLXrzNf8aBTPmLr-4gaLiKPo33zloI03FBlftyQaRmDS_6U3Sht2-kEIqexFqLpLNYGe7kY8FVIVkynoAlo_wbWSokie9d1b61XFGZq09vrM4sBNkdYKmvspOPQqNn28KjqlaZshkF-QixAAXwFUdU4D85cIetEVJ8HVkbyVwlOTu5FOwtFJGezo8hx2x28NekRoNZnpFFiU8b1Ic5cAkxINzbKUYnjx-LTvEFxSW6v18RgVcCE_4GrNXt8InehW6Uzx6yyBqdWeXX_7B4upmh7N052SUG1pt0TM","UiLocales":null,"Nonce":"637020587977623058.NTFiZjFhYTItOTFmZS00MzEyLTg2MWMtMWI4YWFhNWY5YTEwZTE0NTgxMjItNjgxNy00MTBjLTgwMmUtMTg3ZjMyYWYwYjYx","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/home/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll afcpayroll2","response_mode":"form_post","nonce":"637020587977623058.NTFiZjFhYTItOTFmZS00MzEyLTg2MWMtMWI4YWFhNWY5YTEwZTE0NTgxMjItNjgxNy00MTBjLTgwMmUtMTg3ZjMyYWYwYjYx","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9MieijHQPG94AXT2pR0gIKq9ikYsrBFLXrzNf8aBTPmLr-4gaLiKPo33zloI03FBlftyQaRmDS_6U3Sht2-kEIqexFqLpLNYGe7kY8FVIVkynoAlo_wbWSokie9d1b61XFGZq09vrM4sBNkdYKmvspOPQqNn28KjqlaZshkF-QixAAXwFUdU4D85cIetEVJ8HVkbyVwlOTu5FOwtFJGezo8hx2x28NekRoNZnpFFiU8b1Ic5cAkxINzbKUYnjx-LTvEFxSW6v18RgVcCE_4GrNXt8InehW6Uzx6yyBqdWeXX_7B4upmh7N052SUG1pt0TM","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-22 11:19:58.395 +03:00 [INF] Showing login: User is not authenticated
2019-08-22 11:19:58.769 +03:00 [DBG] Start authorize request protocol validation
2019-08-22 11:19:58.770 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-22 11:19:58.790 +03:00 [DBG] Checking for PKCE parameters
2019-08-22 11:19:58.795 +03:00 [DBG] No PKCE used.
2019-08-22 11:19:58.808 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-22 11:19:58.845 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-22 11:20:01.117 +03:00 [DBG] CORS request made for path: /account/login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-08-22 11:20:01.249 +03:00 [DBG] Start authorize request protocol validation
2019-08-22 11:20:01.250 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-22 11:20:01.263 +03:00 [DBG] Checking for PKCE parameters
2019-08-22 11:20:01.268 +03:00 [DBG] No PKCE used.
2019-08-22 11:20:01.276 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-22 11:20:01.332 +03:00 [DBG] Augmenting SignInContext
2019-08-22 11:20:01.337 +03:00 [DBG] Adding idp claim with value: local
2019-08-22 11:20:01.337 +03:00 [DBG] Adding amr claim with value: pwd
2019-08-22 11:20:01.388 +03:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-08-22 11:20:01.395 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-22 11:20:01.438 +03:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-08-22 11:20:01.441 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-08-22 11:20:01.468 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-08-22 11:20:01.494 +03:00 [DBG] Start authorize callback request
2019-08-22 11:20:01.512 +03:00 [DBG] User in authorize request: 1
2019-08-22 11:20:01.513 +03:00 [DBG] Start authorize request protocol validation
2019-08-22 11:20:01.518 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-22 11:20:01.559 +03:00 [DBG] Checking for PKCE parameters
2019-08-22 11:20:01.564 +03:00 [DBG] No PKCE used.
2019-08-22 11:20:01.577 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-22 11:20:01.590 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/home/signin-oidc","AllowedRedirectUris":["http://localhost:57002/home/signin-oidc","http://localhost:5002/home/signin-oidc"],"SubjectId":"1","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll afcpayroll2","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9MieijHQPG94AXT2pR0gIKq9ikYsrBFLXrzNf8aBTPmLr-4gaLiKPo33zloI03FBlftyQaRmDS_6U3Sht2-kEIqexFqLpLNYGe7kY8FVIVkynoAlo_wbWSokie9d1b61XFGZq09vrM4sBNkdYKmvspOPQqNn28KjqlaZshkF-QixAAXwFUdU4D85cIetEVJ8HVkbyVwlOTu5FOwtFJGezo8hx2x28NekRoNZnpFFiU8b1Ic5cAkxINzbKUYnjx-LTvEFxSW6v18RgVcCE_4GrNXt8InehW6Uzx6yyBqdWeXX_7B4upmh7N052SUG1pt0TM","UiLocales":null,"Nonce":"637020587977623058.NTFiZjFhYTItOTFmZS00MzEyLTg2MWMtMWI4YWFhNWY5YTEwZTE0NTgxMjItNjgxNy00MTBjLTgwMmUtMTg3ZjMyYWYwYjYx","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"8792f100f333797da6bb81a6b1515c54","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/home/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll afcpayroll2","response_mode":"form_post","nonce":"637020587977623058.NTFiZjFhYTItOTFmZS00MzEyLTg2MWMtMWI4YWFhNWY5YTEwZTE0NTgxMjItNjgxNy00MTBjLTgwMmUtMTg3ZjMyYWYwYjYx","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9MieijHQPG94AXT2pR0gIKq9ikYsrBFLXrzNf8aBTPmLr-4gaLiKPo33zloI03FBlftyQaRmDS_6U3Sht2-kEIqexFqLpLNYGe7kY8FVIVkynoAlo_wbWSokie9d1b61XFGZq09vrM4sBNkdYKmvspOPQqNn28KjqlaZshkF-QixAAXwFUdU4D85cIetEVJ8HVkbyVwlOTu5FOwtFJGezo8hx2x28NekRoNZnpFFiU8b1Ic5cAkxINzbKUYnjx-LTvEFxSW6v18RgVcCE_4GrNXt8InehW6Uzx6yyBqdWeXX_7B4upmh7N052SUG1pt0TM","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-22 11:20:01.695 +03:00 [DBG] Client is configured to not require consent, no consent is required
2019-08-22 11:20:01.710 +03:00 [DBG] Creating Hybrid Flow response.
2019-08-22 11:20:01.776 +03:00 [DBG] Creating Implicit Flow response.
2019-08-22 11:20:01.801 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-22 11:20:01.810 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-22 11:20:01.975 +03:00 [DBG] Authorize endpoint response
{"SubjectId":"1","ClientId":"mvc","RedirectUri":"http://localhost:5002/home/signin-oidc","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9MieijHQPG94AXT2pR0gIKq9ikYsrBFLXrzNf8aBTPmLr-4gaLiKPo33zloI03FBlftyQaRmDS_6U3Sht2-kEIqexFqLpLNYGe7kY8FVIVkynoAlo_wbWSokie9d1b61XFGZq09vrM4sBNkdYKmvspOPQqNn28KjqlaZshkF-QixAAXwFUdU4D85cIetEVJ8HVkbyVwlOTu5FOwtFJGezo8hx2x28NekRoNZnpFFiU8b1Ic5cAkxINzbKUYnjx-LTvEFxSW6v18RgVcCE_4GrNXt8InehW6Uzx6yyBqdWeXX_7B4upmh7N052SUG1pt0TM","Scope":"openid profile afcpayroll afcpayroll2 offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-08-22 11:20:02.033 +03:00 [DBG] Augmenting SignInContext
2019-08-22 11:20:02.034 +03:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-08-22 11:20:03.499 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-22 11:20:03.517 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-22 11:20:03.519 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-22 11:20:03.548 +03:00 [DBG] Start token request.
2019-08-22 11:20:03.587 +03:00 [DBG] Start client validation
2019-08-22 11:20:03.602 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-22 11:20:03.614 +03:00 [DBG] Start parsing for secret in post body
2019-08-22 11:20:03.616 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-22 11:20:03.616 +03:00 [DBG] Secret id found: mvc
2019-08-22 11:20:03.625 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-22 11:20:03.658 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-22 11:20:03.660 +03:00 [DBG] Client validation success
2019-08-22 11:20:03.675 +03:00 [DBG] Start token request validation
2019-08-22 11:20:03.697 +03:00 [DBG] Start validation of authorization code token request
2019-08-22 11:20:03.734 +03:00 [DBG] Validation of authorization code token request success
2019-08-22 11:20:03.740 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"aeae69315ce9c8b5758511e419cc4ec029bb447d2fc2bfae70009c6d2fb72c7e","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"mvc","client_secret":"***REDACTED***","code":"aeae69315ce9c8b5758511e419cc4ec029bb447d2fc2bfae70009c6d2fb72c7e","grant_type":"authorization_code","redirect_uri":"http://localhost:5002/home/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-08-22 11:20:03.802 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-22 11:20:03.834 +03:00 [DBG] Getting claims for access token for client: mvc
2019-08-22 11:20:03.841 +03:00 [DBG] Getting claims for access token for subject: 1
2019-08-22 11:20:03.863 +03:00 [DBG] Creating refresh token
2019-08-22 11:20:03.863 +03:00 [DBG] Setting an absolute lifetime: 2592000
2019-08-22 11:20:03.895 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-22 11:20:03.901 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-22 11:20:03.913 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-22 11:20:03.941 +03:00 [DBG] Token request success.
2019-08-22 11:20:03.967 +03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-08-22 11:20:03.977 +03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-08-22 11:20:04.000 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-08-22 11:20:04.031 +03:00 [DBG] Start userinfo request
2019-08-22 11:20:04.044 +03:00 [DBG] Bearer token found in header
2019-08-22 11:20:04.231 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-22 11:20:04.249 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-22 11:20:04.254 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-08-22 11:20:04.272 +03:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1566462003,"exp":1566462063,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","afcpayroll","afcpayroll2"],"client_id":"mvc","sub":"1","auth_time":1566462001,"idp":"local","name":"alice","email":"alice@email.com","scope":["openid","profile","test_identity","afcpayroll","afcpayroll2","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-08-22 11:20:04.315 +03:00 [DBG] Creating userinfo response
2019-08-22 11:20:04.323 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll afcpayroll2 offline_access
2019-08-22 11:20:04.347 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll afcpayroll2 offline_access
2019-08-22 11:20:04.363 +03:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-22 11:20:04.373 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll afcpayroll2 offline_access
2019-08-22 11:20:04.384 +03:00 [INF] Profile service returned the following claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-22 11:20:04.397 +03:00 [DBG] End userinfo request
2019-08-22 11:20:12.282 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-22 11:20:12.300 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-22 11:20:12.313 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-22 11:20:12.328 +03:00 [DBG] Start discovery request
2019-08-22 11:20:12.411 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-22 11:20:12.419 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-22 11:20:12.432 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-22 11:20:12.444 +03:00 [DBG] Start key discovery request
2019-08-22 11:20:12.485 +03:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenInvalidAudienceException: IDX10214: Audience validation failed. Audiences: '[PII is hidden]'. Did not match: validationParameters.ValidAudience: '[PII is hidden]' or validationParameters.ValidAudiences: '[PII is hidden]'.
   at Microsoft.IdentityModel.Tokens.Validators.ValidateAudience(IEnumerable`1 audiences, SecurityToken securityToken, TokenValidationParameters validationParameters) in C:\agent2\_work\15\s\src\Microsoft.IdentityModel.Tokens\Validators.cs:line 108
   at System.IdentityModel.Tokens.Jwt.JwtSecurityTokenHandler.ValidateTokenPayload(JwtSecurityToken jwtToken, TokenValidationParameters validationParameters) in C:\agent2\_work\15\s\src\System.IdentityModel.Tokens.Jwt\JwtSecurityTokenHandler.cs:line 765
   at System.IdentityModel.Tokens.Jwt.JwtSecurityTokenHandler.ValidateToken(String token, TokenValidationParameters validationParameters, SecurityToken& validatedToken) in C:\agent2\_work\15\s\src\System.IdentityModel.Tokens.Jwt\JwtSecurityTokenHandler.cs:line 747
   at Microsoft.AspNetCore.Authentication.JwtBearer.JwtBearerHandler.HandleAuthenticateAsync()
2019-08-22 11:20:12.553 +03:00 [INF] Bearer was not authenticated. Failure message: IDX10214: Audience validation failed. Audiences: '[PII is hidden]'. Did not match: validationParameters.ValidAudience: '[PII is hidden]' or validationParameters.ValidAudiences: '[PII is hidden]'.
2019-08-22 11:20:12.590 +03:00 [INF] AuthenticationScheme: Bearer was challenged.
2019-08-22 11:20:48.924 +03:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenInvalidAudienceException: IDX10214: Audience validation failed. Audiences: '[PII is hidden]'. Did not match: validationParameters.ValidAudience: '[PII is hidden]' or validationParameters.ValidAudiences: '[PII is hidden]'.
   at Microsoft.IdentityModel.Tokens.Validators.ValidateAudience(IEnumerable`1 audiences, SecurityToken securityToken, TokenValidationParameters validationParameters) in C:\agent2\_work\15\s\src\Microsoft.IdentityModel.Tokens\Validators.cs:line 108
   at System.IdentityModel.Tokens.Jwt.JwtSecurityTokenHandler.ValidateTokenPayload(JwtSecurityToken jwtToken, TokenValidationParameters validationParameters) in C:\agent2\_work\15\s\src\System.IdentityModel.Tokens.Jwt\JwtSecurityTokenHandler.cs:line 765
   at System.IdentityModel.Tokens.Jwt.JwtSecurityTokenHandler.ValidateToken(String token, TokenValidationParameters validationParameters, SecurityToken& validatedToken) in C:\agent2\_work\15\s\src\System.IdentityModel.Tokens.Jwt\JwtSecurityTokenHandler.cs:line 747
   at Microsoft.AspNetCore.Authentication.JwtBearer.JwtBearerHandler.HandleAuthenticateAsync()
2019-08-22 11:20:48.956 +03:00 [INF] Bearer was not authenticated. Failure message: IDX10214: Audience validation failed. Audiences: '[PII is hidden]'. Did not match: validationParameters.ValidAudience: '[PII is hidden]' or validationParameters.ValidAudiences: '[PII is hidden]'.
2019-08-22 11:20:48.967 +03:00 [INF] AuthenticationScheme: Bearer was challenged.
2019-08-22 11:22:19.927 +03:00 [INF] Starting IdentityServer4 version 2.5.0.0
2019-08-22 11:22:20.036 +03:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-08-22 11:22:20.038 +03:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-08-22 11:22:20.038 +03:00 [DBG] Using Bearer as default ASP.NET Core scheme for sign-in
2019-08-22 11:22:20.039 +03:00 [DBG] Using Bearer as default ASP.NET Core scheme for sign-out
2019-08-22 11:22:20.039 +03:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-08-22 11:22:20.040 +03:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-08-22 11:22:24.755 +03:00 [DBG] Login Url: /account/login
2019-08-22 11:22:24.767 +03:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-08-22 11:22:24.773 +03:00 [DBG] Logout Url: /Account/Logout
2019-08-22 11:22:24.777 +03:00 [DBG] ConsentUrl Url: /consent
2019-08-22 11:22:24.782 +03:00 [DBG] Consent Return Url Parameter: returnUrl
2019-08-22 11:22:24.789 +03:00 [DBG] Error Url: /home/error
2019-08-22 11:22:24.790 +03:00 [DBG] Error Id Parameter: errorId
2019-08-22 11:22:24.895 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-22 11:22:24.910 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-22 11:22:24.911 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-22 11:22:24.917 +03:00 [DBG] Start discovery request
2019-08-22 11:22:25.584 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-22 11:22:25.601 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-22 11:22:25.618 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-22 11:22:25.633 +03:00 [DBG] Start key discovery request
2019-08-22 11:22:25.841 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-08-22 11:22:25.873 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-08-22 11:22:25.875 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-08-22 11:22:25.888 +03:00 [DBG] Start authorize request
2019-08-22 11:22:25.914 +03:00 [DBG] No user present in authorize request
2019-08-22 11:22:25.930 +03:00 [DBG] Start authorize request protocol validation
2019-08-22 11:22:25.990 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-22 11:22:26.036 +03:00 [DBG] Checking for PKCE parameters
2019-08-22 11:22:26.043 +03:00 [DBG] No PKCE used.
2019-08-22 11:22:26.127 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-22 11:22:26.175 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/home/signin-oidc","AllowedRedirectUris":["http://localhost:57002/home/signin-oidc","http://localhost:5002/home/signin-oidc"],"SubjectId":"anonymous","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll afcpayroll2","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9Na1kuE0IDLwwtsp0dpYxJL-VO18QdZJf1SJWBBDpTFq9jOYUG3ZELLBYvZ6qIotC96tMnNXgnSfSEzNODvr3u3mk6ffWxPdQkUXDBLeRpLswFpQKcNIA6EIv3CtPPfPpztNqz8h9OSmPV9uFG_FQiQUJskxIWLnh8ukN0I-ZcV_ySJHedk3SmabTnapQzJoobiNy1uGPaqvLm1KLfBIPgS2UtYiPtQr-8kAqDaCscSOPRP2TFIG2W5mIt1y3CS8oyNxc2pDn4rDM6COj94RoYlEszifO45v-EhRZrfLyvwrOACLZmppa6wCvvLnYT-3EU","UiLocales":null,"Nonce":"637020589457089180.ODJlMTcyNjAtMDM2OS00MTQ5LWFiMTItYzBlZDU4OTkzZWFmZmNiNTUyZjYtODdiYi00MjRmLWJiNzUtODllMmFlOGEzYmRk","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/home/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll afcpayroll2","response_mode":"form_post","nonce":"637020589457089180.ODJlMTcyNjAtMDM2OS00MTQ5LWFiMTItYzBlZDU4OTkzZWFmZmNiNTUyZjYtODdiYi00MjRmLWJiNzUtODllMmFlOGEzYmRk","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9Na1kuE0IDLwwtsp0dpYxJL-VO18QdZJf1SJWBBDpTFq9jOYUG3ZELLBYvZ6qIotC96tMnNXgnSfSEzNODvr3u3mk6ffWxPdQkUXDBLeRpLswFpQKcNIA6EIv3CtPPfPpztNqz8h9OSmPV9uFG_FQiQUJskxIWLnh8ukN0I-ZcV_ySJHedk3SmabTnapQzJoobiNy1uGPaqvLm1KLfBIPgS2UtYiPtQr-8kAqDaCscSOPRP2TFIG2W5mIt1y3CS8oyNxc2pDn4rDM6COj94RoYlEszifO45v-EhRZrfLyvwrOACLZmppa6wCvvLnYT-3EU","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-22 11:22:26.303 +03:00 [INF] Showing login: User is not authenticated
2019-08-22 11:22:26.625 +03:00 [DBG] Start authorize request protocol validation
2019-08-22 11:22:26.627 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-22 11:22:26.640 +03:00 [DBG] Checking for PKCE parameters
2019-08-22 11:22:26.645 +03:00 [DBG] No PKCE used.
2019-08-22 11:22:26.655 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-22 11:22:26.680 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-22 11:22:29.422 +03:00 [DBG] CORS request made for path: /account/login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-08-22 11:22:29.518 +03:00 [DBG] Start authorize request protocol validation
2019-08-22 11:22:29.521 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-22 11:22:29.539 +03:00 [DBG] Checking for PKCE parameters
2019-08-22 11:22:29.540 +03:00 [DBG] No PKCE used.
2019-08-22 11:22:29.562 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-22 11:22:29.626 +03:00 [DBG] Augmenting SignInContext
2019-08-22 11:22:29.632 +03:00 [DBG] Adding idp claim with value: local
2019-08-22 11:22:29.633 +03:00 [DBG] Adding amr claim with value: pwd
2019-08-22 11:22:29.661 +03:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-08-22 11:22:29.668 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-22 11:22:29.701 +03:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-08-22 11:22:29.705 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-08-22 11:22:29.723 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-08-22 11:22:29.776 +03:00 [DBG] Start authorize callback request
2019-08-22 11:22:29.785 +03:00 [DBG] User in authorize request: 1
2019-08-22 11:22:29.792 +03:00 [DBG] Start authorize request protocol validation
2019-08-22 11:22:29.796 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-22 11:22:29.808 +03:00 [DBG] Checking for PKCE parameters
2019-08-22 11:22:29.815 +03:00 [DBG] No PKCE used.
2019-08-22 11:22:29.826 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-22 11:22:29.843 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/home/signin-oidc","AllowedRedirectUris":["http://localhost:57002/home/signin-oidc","http://localhost:5002/home/signin-oidc"],"SubjectId":"1","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll afcpayroll2","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9Na1kuE0IDLwwtsp0dpYxJL-VO18QdZJf1SJWBBDpTFq9jOYUG3ZELLBYvZ6qIotC96tMnNXgnSfSEzNODvr3u3mk6ffWxPdQkUXDBLeRpLswFpQKcNIA6EIv3CtPPfPpztNqz8h9OSmPV9uFG_FQiQUJskxIWLnh8ukN0I-ZcV_ySJHedk3SmabTnapQzJoobiNy1uGPaqvLm1KLfBIPgS2UtYiPtQr-8kAqDaCscSOPRP2TFIG2W5mIt1y3CS8oyNxc2pDn4rDM6COj94RoYlEszifO45v-EhRZrfLyvwrOACLZmppa6wCvvLnYT-3EU","UiLocales":null,"Nonce":"637020589457089180.ODJlMTcyNjAtMDM2OS00MTQ5LWFiMTItYzBlZDU4OTkzZWFmZmNiNTUyZjYtODdiYi00MjRmLWJiNzUtODllMmFlOGEzYmRk","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"3b6f61598577a323e9a6ab5b52d34af7","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/home/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll afcpayroll2","response_mode":"form_post","nonce":"637020589457089180.ODJlMTcyNjAtMDM2OS00MTQ5LWFiMTItYzBlZDU4OTkzZWFmZmNiNTUyZjYtODdiYi00MjRmLWJiNzUtODllMmFlOGEzYmRk","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9Na1kuE0IDLwwtsp0dpYxJL-VO18QdZJf1SJWBBDpTFq9jOYUG3ZELLBYvZ6qIotC96tMnNXgnSfSEzNODvr3u3mk6ffWxPdQkUXDBLeRpLswFpQKcNIA6EIv3CtPPfPpztNqz8h9OSmPV9uFG_FQiQUJskxIWLnh8ukN0I-ZcV_ySJHedk3SmabTnapQzJoobiNy1uGPaqvLm1KLfBIPgS2UtYiPtQr-8kAqDaCscSOPRP2TFIG2W5mIt1y3CS8oyNxc2pDn4rDM6COj94RoYlEszifO45v-EhRZrfLyvwrOACLZmppa6wCvvLnYT-3EU","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-22 11:22:29.934 +03:00 [DBG] Client is configured to not require consent, no consent is required
2019-08-22 11:22:29.947 +03:00 [DBG] Creating Hybrid Flow response.
2019-08-22 11:22:30.042 +03:00 [DBG] Creating Implicit Flow response.
2019-08-22 11:22:30.074 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-22 11:22:30.096 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-22 11:22:30.268 +03:00 [DBG] Authorize endpoint response
{"SubjectId":"1","ClientId":"mvc","RedirectUri":"http://localhost:5002/home/signin-oidc","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9Na1kuE0IDLwwtsp0dpYxJL-VO18QdZJf1SJWBBDpTFq9jOYUG3ZELLBYvZ6qIotC96tMnNXgnSfSEzNODvr3u3mk6ffWxPdQkUXDBLeRpLswFpQKcNIA6EIv3CtPPfPpztNqz8h9OSmPV9uFG_FQiQUJskxIWLnh8ukN0I-ZcV_ySJHedk3SmabTnapQzJoobiNy1uGPaqvLm1KLfBIPgS2UtYiPtQr-8kAqDaCscSOPRP2TFIG2W5mIt1y3CS8oyNxc2pDn4rDM6COj94RoYlEszifO45v-EhRZrfLyvwrOACLZmppa6wCvvLnYT-3EU","Scope":"openid profile afcpayroll afcpayroll2 offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-08-22 11:22:30.321 +03:00 [DBG] Augmenting SignInContext
2019-08-22 11:22:30.323 +03:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-08-22 11:22:31.735 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-22 11:22:31.747 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-22 11:22:31.755 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-22 11:22:31.783 +03:00 [DBG] Start token request.
2019-08-22 11:22:31.796 +03:00 [DBG] Start client validation
2019-08-22 11:22:31.812 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-22 11:22:31.818 +03:00 [DBG] Start parsing for secret in post body
2019-08-22 11:22:31.829 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-22 11:22:31.833 +03:00 [DBG] Secret id found: mvc
2019-08-22 11:22:31.842 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-22 11:22:31.880 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-22 11:22:31.881 +03:00 [DBG] Client validation success
2019-08-22 11:22:31.900 +03:00 [DBG] Start token request validation
2019-08-22 11:22:31.925 +03:00 [DBG] Start validation of authorization code token request
2019-08-22 11:22:31.945 +03:00 [DBG] Validation of authorization code token request success
2019-08-22 11:22:31.950 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"7638fc7756316ba77d20154abc3e61e8108acdeda24b3555cea7743263e3feda","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"mvc","client_secret":"***REDACTED***","code":"7638fc7756316ba77d20154abc3e61e8108acdeda24b3555cea7743263e3feda","grant_type":"authorization_code","redirect_uri":"http://localhost:5002/home/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-08-22 11:22:32.016 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-22 11:22:32.070 +03:00 [DBG] Getting claims for access token for client: mvc
2019-08-22 11:22:32.072 +03:00 [DBG] Getting claims for access token for subject: 1
2019-08-22 11:22:32.166 +03:00 [DBG] Creating refresh token
2019-08-22 11:22:32.208 +03:00 [DBG] Setting an absolute lifetime: 2592000
2019-08-22 11:22:32.256 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-22 11:22:32.266 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-22 11:22:32.282 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-22 11:22:32.316 +03:00 [DBG] Token request success.
2019-08-22 11:22:32.358 +03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-08-22 11:22:32.365 +03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-08-22 11:22:32.371 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-08-22 11:22:32.416 +03:00 [DBG] Start userinfo request
2019-08-22 11:22:32.431 +03:00 [DBG] Bearer token found in header
2019-08-22 11:22:32.578 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-22 11:22:32.593 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-22 11:22:32.597 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-08-22 11:22:32.611 +03:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1566462152,"exp":1566462212,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","afcpayroll","afcpayroll2"],"client_id":"mvc","sub":"1","auth_time":1566462149,"idp":"local","name":"alice","email":"alice@email.com","scope":["openid","profile","test_identity","afcpayroll","afcpayroll2","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-08-22 11:22:32.658 +03:00 [DBG] Creating userinfo response
2019-08-22 11:22:32.665 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll afcpayroll2 offline_access
2019-08-22 11:22:32.677 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll afcpayroll2 offline_access
2019-08-22 11:22:32.689 +03:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-22 11:22:32.701 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll afcpayroll2 offline_access
2019-08-22 11:22:32.714 +03:00 [INF] Profile service returned the following claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-22 11:22:32.726 +03:00 [DBG] End userinfo request
2019-08-22 11:22:43.127 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-22 11:22:43.134 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-22 11:22:43.156 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-22 11:22:43.171 +03:00 [DBG] Start discovery request
2019-08-22 11:22:43.269 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-22 11:22:43.278 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-22 11:22:43.293 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-22 11:22:43.307 +03:00 [DBG] Start key discovery request
2019-08-22 11:22:43.348 +03:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenInvalidAudienceException: IDX10214: Audience validation failed. Audiences: '[PII is hidden]'. Did not match: validationParameters.ValidAudience: '[PII is hidden]' or validationParameters.ValidAudiences: '[PII is hidden]'.
   at Microsoft.IdentityModel.Tokens.Validators.ValidateAudience(IEnumerable`1 audiences, SecurityToken securityToken, TokenValidationParameters validationParameters) in C:\agent2\_work\15\s\src\Microsoft.IdentityModel.Tokens\Validators.cs:line 108
   at System.IdentityModel.Tokens.Jwt.JwtSecurityTokenHandler.ValidateTokenPayload(JwtSecurityToken jwtToken, TokenValidationParameters validationParameters) in C:\agent2\_work\15\s\src\System.IdentityModel.Tokens.Jwt\JwtSecurityTokenHandler.cs:line 765
   at System.IdentityModel.Tokens.Jwt.JwtSecurityTokenHandler.ValidateToken(String token, TokenValidationParameters validationParameters, SecurityToken& validatedToken) in C:\agent2\_work\15\s\src\System.IdentityModel.Tokens.Jwt\JwtSecurityTokenHandler.cs:line 747
   at Microsoft.AspNetCore.Authentication.JwtBearer.JwtBearerHandler.HandleAuthenticateAsync()
2019-08-22 11:22:43.417 +03:00 [INF] Bearer was not authenticated. Failure message: IDX10214: Audience validation failed. Audiences: '[PII is hidden]'. Did not match: validationParameters.ValidAudience: '[PII is hidden]' or validationParameters.ValidAudiences: '[PII is hidden]'.
2019-08-22 11:22:43.459 +03:00 [INF] AuthenticationScheme: Bearer was challenged.
2019-08-22 11:23:56.721 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-22 11:23:56.751 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-22 11:23:56.774 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-22 11:23:56.798 +03:00 [DBG] Start discovery request
2019-08-22 11:23:57.362 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-22 11:23:57.373 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-22 11:23:57.382 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-22 11:23:57.398 +03:00 [DBG] Start key discovery request
2019-08-22 11:23:57.541 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-08-22 11:23:57.556 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-08-22 11:23:57.581 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-08-22 11:23:57.605 +03:00 [DBG] Start authorize request
2019-08-22 11:23:57.633 +03:00 [DBG] No user present in authorize request
2019-08-22 11:23:57.640 +03:00 [DBG] Start authorize request protocol validation
2019-08-22 11:23:57.653 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-22 11:23:57.670 +03:00 [DBG] Checking for PKCE parameters
2019-08-22 11:23:57.672 +03:00 [DBG] No PKCE used.
2019-08-22 11:23:57.674 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-22 11:23:57.693 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/home/signin-oidc","AllowedRedirectUris":["http://localhost:57002/home/signin-oidc","http://localhost:5002/home/signin-oidc"],"SubjectId":"anonymous","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll afcpayroll2 identityprovider","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9OLzefsMGj2N8CvmnP-qG3rkXrkYLocP39E5CUScoUAS7Yjn6hMPWH0l5Wu_RB4DBQWiU3GvrCqiNBBrj6ZBEWs0fyZFe8QkyHMCfKQ-obgAfRI6EI2H7QH4-i6m0RWWp2TScQc3oh8SXfmKVE4q0UT5GViEEiHElMS_4E3Qi4ZLP9DagW0cFNI8diu70UxIDdltnzwE212ZhwDhRuokuBA4hjpSO47LteIctBsIvOIu3ey0h-QWNcoksqEtu8xe4D2CmMIWEPbNyRGiULSk7sS33wFee3MzB2dB-WJ7mIGc_dkpIBSRFjWqnU4FSvRphU","UiLocales":null,"Nonce":"637020590374426947.NDkwY2Q0ODMtZTNhOS00YzdiLWE5NWMtZWUzMGY1NzE1MTliNGQzNGM1Y2UtZjkwMi00NDUyLWE4YTMtNmJmNmRjZTBlMjlh","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/home/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll afcpayroll2 identityprovider","response_mode":"form_post","nonce":"637020590374426947.NDkwY2Q0ODMtZTNhOS00YzdiLWE5NWMtZWUzMGY1NzE1MTliNGQzNGM1Y2UtZjkwMi00NDUyLWE4YTMtNmJmNmRjZTBlMjlh","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9OLzefsMGj2N8CvmnP-qG3rkXrkYLocP39E5CUScoUAS7Yjn6hMPWH0l5Wu_RB4DBQWiU3GvrCqiNBBrj6ZBEWs0fyZFe8QkyHMCfKQ-obgAfRI6EI2H7QH4-i6m0RWWp2TScQc3oh8SXfmKVE4q0UT5GViEEiHElMS_4E3Qi4ZLP9DagW0cFNI8diu70UxIDdltnzwE212ZhwDhRuokuBA4hjpSO47LteIctBsIvOIu3ey0h-QWNcoksqEtu8xe4D2CmMIWEPbNyRGiULSk7sS33wFee3MzB2dB-WJ7mIGc_dkpIBSRFjWqnU4FSvRphU","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-22 11:23:57.756 +03:00 [INF] Showing login: User is not authenticated
2019-08-22 11:23:57.788 +03:00 [DBG] Start authorize request protocol validation
2019-08-22 11:23:57.791 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-22 11:23:57.810 +03:00 [DBG] Checking for PKCE parameters
2019-08-22 11:23:57.812 +03:00 [DBG] No PKCE used.
2019-08-22 11:23:57.829 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-22 11:23:57.846 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-22 11:24:02.787 +03:00 [DBG] CORS request made for path: /account/login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-08-22 11:24:02.795 +03:00 [DBG] Start authorize request protocol validation
2019-08-22 11:24:02.809 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-22 11:24:02.822 +03:00 [DBG] Checking for PKCE parameters
2019-08-22 11:24:02.831 +03:00 [DBG] No PKCE used.
2019-08-22 11:24:02.840 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-22 11:24:02.855 +03:00 [DBG] Augmenting SignInContext
2019-08-22 11:24:02.866 +03:00 [DBG] Adding idp claim with value: local
2019-08-22 11:24:02.871 +03:00 [DBG] Adding amr claim with value: pwd
2019-08-22 11:24:02.878 +03:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-08-22 11:24:02.894 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-22 11:24:02.934 +03:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-08-22 11:24:02.942 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-08-22 11:24:02.950 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-08-22 11:24:02.971 +03:00 [DBG] Start authorize callback request
2019-08-22 11:24:02.982 +03:00 [DBG] User in authorize request: 1
2019-08-22 11:24:02.983 +03:00 [DBG] Start authorize request protocol validation
2019-08-22 11:24:02.990 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-22 11:24:03.005 +03:00 [DBG] Checking for PKCE parameters
2019-08-22 11:24:03.013 +03:00 [DBG] No PKCE used.
2019-08-22 11:24:03.014 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-22 11:24:03.031 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/home/signin-oidc","AllowedRedirectUris":["http://localhost:57002/home/signin-oidc","http://localhost:5002/home/signin-oidc"],"SubjectId":"1","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll afcpayroll2 identityprovider","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9OLzefsMGj2N8CvmnP-qG3rkXrkYLocP39E5CUScoUAS7Yjn6hMPWH0l5Wu_RB4DBQWiU3GvrCqiNBBrj6ZBEWs0fyZFe8QkyHMCfKQ-obgAfRI6EI2H7QH4-i6m0RWWp2TScQc3oh8SXfmKVE4q0UT5GViEEiHElMS_4E3Qi4ZLP9DagW0cFNI8diu70UxIDdltnzwE212ZhwDhRuokuBA4hjpSO47LteIctBsIvOIu3ey0h-QWNcoksqEtu8xe4D2CmMIWEPbNyRGiULSk7sS33wFee3MzB2dB-WJ7mIGc_dkpIBSRFjWqnU4FSvRphU","UiLocales":null,"Nonce":"637020590374426947.NDkwY2Q0ODMtZTNhOS00YzdiLWE5NWMtZWUzMGY1NzE1MTliNGQzNGM1Y2UtZjkwMi00NDUyLWE4YTMtNmJmNmRjZTBlMjlh","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"cfa0f9fd83afb9f71c05fdbb0006ce71","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/home/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll afcpayroll2 identityprovider","response_mode":"form_post","nonce":"637020590374426947.NDkwY2Q0ODMtZTNhOS00YzdiLWE5NWMtZWUzMGY1NzE1MTliNGQzNGM1Y2UtZjkwMi00NDUyLWE4YTMtNmJmNmRjZTBlMjlh","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9OLzefsMGj2N8CvmnP-qG3rkXrkYLocP39E5CUScoUAS7Yjn6hMPWH0l5Wu_RB4DBQWiU3GvrCqiNBBrj6ZBEWs0fyZFe8QkyHMCfKQ-obgAfRI6EI2H7QH4-i6m0RWWp2TScQc3oh8SXfmKVE4q0UT5GViEEiHElMS_4E3Qi4ZLP9DagW0cFNI8diu70UxIDdltnzwE212ZhwDhRuokuBA4hjpSO47LteIctBsIvOIu3ey0h-QWNcoksqEtu8xe4D2CmMIWEPbNyRGiULSk7sS33wFee3MzB2dB-WJ7mIGc_dkpIBSRFjWqnU4FSvRphU","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-22 11:24:03.094 +03:00 [DBG] Client is configured to not require consent, no consent is required
2019-08-22 11:24:03.103 +03:00 [DBG] Creating Hybrid Flow response.
2019-08-22 11:24:03.110 +03:00 [DBG] Creating Implicit Flow response.
2019-08-22 11:24:03.121 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-22 11:24:03.136 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-22 11:24:03.158 +03:00 [DBG] Authorize endpoint response
{"SubjectId":"1","ClientId":"mvc","RedirectUri":"http://localhost:5002/home/signin-oidc","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9OLzefsMGj2N8CvmnP-qG3rkXrkYLocP39E5CUScoUAS7Yjn6hMPWH0l5Wu_RB4DBQWiU3GvrCqiNBBrj6ZBEWs0fyZFe8QkyHMCfKQ-obgAfRI6EI2H7QH4-i6m0RWWp2TScQc3oh8SXfmKVE4q0UT5GViEEiHElMS_4E3Qi4ZLP9DagW0cFNI8diu70UxIDdltnzwE212ZhwDhRuokuBA4hjpSO47LteIctBsIvOIu3ey0h-QWNcoksqEtu8xe4D2CmMIWEPbNyRGiULSk7sS33wFee3MzB2dB-WJ7mIGc_dkpIBSRFjWqnU4FSvRphU","Scope":"openid profile afcpayroll afcpayroll2 identityprovider offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-08-22 11:24:03.188 +03:00 [DBG] Augmenting SignInContext
2019-08-22 11:24:03.193 +03:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-08-22 11:24:04.581 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-22 11:24:04.590 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-22 11:24:04.608 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-22 11:24:04.621 +03:00 [DBG] Start token request.
2019-08-22 11:24:04.633 +03:00 [DBG] Start client validation
2019-08-22 11:24:04.639 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-22 11:24:04.656 +03:00 [DBG] Start parsing for secret in post body
2019-08-22 11:24:04.661 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-22 11:24:04.669 +03:00 [DBG] Secret id found: mvc
2019-08-22 11:24:04.675 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-22 11:24:04.693 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-22 11:24:04.703 +03:00 [DBG] Client validation success
2019-08-22 11:24:04.707 +03:00 [DBG] Start token request validation
2019-08-22 11:24:04.717 +03:00 [DBG] Start validation of authorization code token request
2019-08-22 11:24:04.724 +03:00 [DBG] Validation of authorization code token request success
2019-08-22 11:24:04.733 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"ffd8b686af645894f98fa45f3b7311bc10f050677f8135b1cff262177189cdca","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"mvc","client_secret":"***REDACTED***","code":"ffd8b686af645894f98fa45f3b7311bc10f050677f8135b1cff262177189cdca","grant_type":"authorization_code","redirect_uri":"http://localhost:5002/home/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-08-22 11:24:04.768 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-22 11:24:04.783 +03:00 [DBG] Getting claims for access token for client: mvc
2019-08-22 11:24:04.787 +03:00 [DBG] Getting claims for access token for subject: 1
2019-08-22 11:24:04.804 +03:00 [DBG] Creating refresh token
2019-08-22 11:24:04.805 +03:00 [DBG] Setting an absolute lifetime: 2592000
2019-08-22 11:24:04.817 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-22 11:24:04.834 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-22 11:24:04.855 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-22 11:24:04.876 +03:00 [DBG] Token request success.
2019-08-22 11:24:04.893 +03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-08-22 11:24:04.897 +03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-08-22 11:24:04.915 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-08-22 11:24:04.928 +03:00 [DBG] Start userinfo request
2019-08-22 11:24:04.936 +03:00 [DBG] Bearer token found in header
2019-08-22 11:24:04.944 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-22 11:24:04.955 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-22 11:24:04.972 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-08-22 11:24:04.987 +03:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1566462244,"exp":1566462304,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","afcpayroll","afcpayroll2","identityprovider"],"client_id":"mvc","sub":"1","auth_time":1566462242,"idp":"local","name":"alice","email":"alice@email.com","scope":["openid","profile","test_identity","afcpayroll","afcpayroll2","identityprovider","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-08-22 11:24:05.023 +03:00 [DBG] Creating userinfo response
2019-08-22 11:24:05.033 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll afcpayroll2 identityprovider offline_access
2019-08-22 11:24:05.049 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll afcpayroll2 identityprovider offline_access
2019-08-22 11:24:05.071 +03:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-22 11:24:05.084 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll afcpayroll2 identityprovider offline_access
2019-08-22 11:24:05.099 +03:00 [INF] Profile service returned the following claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-22 11:24:05.115 +03:00 [DBG] End userinfo request
2019-08-22 11:24:18.221 +03:00 [INF] Successfully validated the token.
2019-08-22 11:25:33.854 +03:00 [INF] Starting IdentityServer4 version 2.5.0.0
2019-08-22 11:25:33.970 +03:00 [INF] Using the default authentication scheme ivantage for IdentityServer
2019-08-22 11:25:33.971 +03:00 [DBG] Using ivantage as default ASP.NET Core scheme for authentication
2019-08-22 11:25:33.971 +03:00 [DBG] Using Bearer as default ASP.NET Core scheme for sign-in
2019-08-22 11:25:33.972 +03:00 [DBG] Using Bearer as default ASP.NET Core scheme for sign-out
2019-08-22 11:25:33.972 +03:00 [DBG] Using ivantage as default ASP.NET Core scheme for challenge
2019-08-22 11:25:33.973 +03:00 [DBG] Using ivantage as default ASP.NET Core scheme for forbid
2019-08-22 11:25:40.271 +03:00 [DBG] Login Url: /account/login
2019-08-22 11:25:40.277 +03:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-08-22 11:25:40.278 +03:00 [DBG] Logout Url: /Account/Logout
2019-08-22 11:25:40.279 +03:00 [DBG] ConsentUrl Url: /consent
2019-08-22 11:25:40.279 +03:00 [DBG] Consent Return Url Parameter: returnUrl
2019-08-22 11:25:40.279 +03:00 [DBG] Error Url: /home/error
2019-08-22 11:25:40.280 +03:00 [DBG] Error Id Parameter: errorId
2019-08-22 11:25:40.376 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-22 11:25:40.382 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-22 11:25:40.382 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-22 11:25:40.393 +03:00 [DBG] Start discovery request
2019-08-22 11:25:40.982 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-22 11:25:40.987 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-22 11:25:40.987 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-22 11:25:40.995 +03:00 [DBG] Start key discovery request
2019-08-22 11:25:41.180 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-08-22 11:25:41.222 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-08-22 11:25:41.223 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-08-22 11:25:41.231 +03:00 [DBG] Start authorize request
2019-08-22 11:25:41.250 +03:00 [DBG] No user present in authorize request
2019-08-22 11:25:41.264 +03:00 [DBG] Start authorize request protocol validation
2019-08-22 11:25:41.323 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-22 11:25:41.356 +03:00 [DBG] Checking for PKCE parameters
2019-08-22 11:25:41.360 +03:00 [DBG] No PKCE used.
2019-08-22 11:25:41.456 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-22 11:25:41.494 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/home/signin-oidc","AllowedRedirectUris":["http://localhost:57002/home/signin-oidc","http://localhost:5002/home/signin-oidc"],"SubjectId":"anonymous","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll afcpayroll2 identityprovider","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9Ot9ccojXdHfrVNnJxrFmn_txVYbhI1VtfFaa_DX1isAFHvOtzzU0-KTzPyfxI3Bv0qXwLDfoCy-rPpEH3-o41pzXmjLEYeJ29zOD-aKsjtb0w51FpiqN4C-ZxgFy1mci1bsWGHHlIf9gzORgvtYP7OoN0MMdEWda8CDsnfN2_XKN8CPMwnc8vJZSTNVl250Qtd5mZU-SiR9JlBZ66pbvonRkaixtK6oXEDmk_DFg91kzF6_KvWXpRSYYtk9e2LQu3Ol5dxlA_IGjZMT-zMO6qeqFK-Ddo7DMeg3LFGIcKwCvvH-6yWsKRqYJsu8U9MoWA","UiLocales":null,"Nonce":"637020591410619016.NzM5NDI2YmYtZDQ1MC00ZDUwLTk2NjAtMDZkMGIzZmQ3OWFmOGI5NjlhMGEtNjczMS00M2IxLThkMTktYmM1YzVmNDNhNGM2","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/home/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll afcpayroll2 identityprovider","response_mode":"form_post","nonce":"637020591410619016.NzM5NDI2YmYtZDQ1MC00ZDUwLTk2NjAtMDZkMGIzZmQ3OWFmOGI5NjlhMGEtNjczMS00M2IxLThkMTktYmM1YzVmNDNhNGM2","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9Ot9ccojXdHfrVNnJxrFmn_txVYbhI1VtfFaa_DX1isAFHvOtzzU0-KTzPyfxI3Bv0qXwLDfoCy-rPpEH3-o41pzXmjLEYeJ29zOD-aKsjtb0w51FpiqN4C-ZxgFy1mci1bsWGHHlIf9gzORgvtYP7OoN0MMdEWda8CDsnfN2_XKN8CPMwnc8vJZSTNVl250Qtd5mZU-SiR9JlBZ66pbvonRkaixtK6oXEDmk_DFg91kzF6_KvWXpRSYYtk9e2LQu3Ol5dxlA_IGjZMT-zMO6qeqFK-Ddo7DMeg3LFGIcKwCvvH-6yWsKRqYJsu8U9MoWA","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-22 11:25:41.591 +03:00 [INF] Showing login: User is not authenticated
2019-08-22 11:25:41.960 +03:00 [DBG] Start authorize request protocol validation
2019-08-22 11:25:41.964 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-22 11:25:41.976 +03:00 [DBG] Checking for PKCE parameters
2019-08-22 11:25:41.984 +03:00 [DBG] No PKCE used.
2019-08-22 11:25:41.994 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-22 11:25:42.019 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-22 11:25:51.539 +03:00 [DBG] CORS request made for path: /account/login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-08-22 11:25:51.652 +03:00 [DBG] Start authorize request protocol validation
2019-08-22 11:25:51.652 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-22 11:25:51.666 +03:00 [DBG] Checking for PKCE parameters
2019-08-22 11:25:51.672 +03:00 [DBG] No PKCE used.
2019-08-22 11:25:51.681 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-22 11:25:51.763 +03:00 [DBG] Augmenting SignInContext
2019-08-22 11:25:51.770 +03:00 [DBG] Adding idp claim with value: local
2019-08-22 11:25:51.774 +03:00 [DBG] Adding amr claim with value: pwd
2019-08-22 11:25:51.807 +03:00 [INF] AuthenticationScheme: ivantage signed in.
2019-08-22 11:25:51.813 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-22 11:25:51.844 +03:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-08-22 11:25:51.847 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-08-22 11:25:51.862 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-08-22 11:25:51.891 +03:00 [DBG] Start authorize callback request
2019-08-22 11:25:51.904 +03:00 [DBG] User in authorize request: 1
2019-08-22 11:25:51.904 +03:00 [DBG] Start authorize request protocol validation
2019-08-22 11:25:51.906 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-22 11:25:51.923 +03:00 [DBG] Checking for PKCE parameters
2019-08-22 11:25:51.932 +03:00 [DBG] No PKCE used.
2019-08-22 11:25:51.942 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-22 11:25:51.962 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/home/signin-oidc","AllowedRedirectUris":["http://localhost:57002/home/signin-oidc","http://localhost:5002/home/signin-oidc"],"SubjectId":"1","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll afcpayroll2 identityprovider","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9Ot9ccojXdHfrVNnJxrFmn_txVYbhI1VtfFaa_DX1isAFHvOtzzU0-KTzPyfxI3Bv0qXwLDfoCy-rPpEH3-o41pzXmjLEYeJ29zOD-aKsjtb0w51FpiqN4C-ZxgFy1mci1bsWGHHlIf9gzORgvtYP7OoN0MMdEWda8CDsnfN2_XKN8CPMwnc8vJZSTNVl250Qtd5mZU-SiR9JlBZ66pbvonRkaixtK6oXEDmk_DFg91kzF6_KvWXpRSYYtk9e2LQu3Ol5dxlA_IGjZMT-zMO6qeqFK-Ddo7DMeg3LFGIcKwCvvH-6yWsKRqYJsu8U9MoWA","UiLocales":null,"Nonce":"637020591410619016.NzM5NDI2YmYtZDQ1MC00ZDUwLTk2NjAtMDZkMGIzZmQ3OWFmOGI5NjlhMGEtNjczMS00M2IxLThkMTktYmM1YzVmNDNhNGM2","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"e30f9ce56d453588f6acfef1c63a2909","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/home/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll afcpayroll2 identityprovider","response_mode":"form_post","nonce":"637020591410619016.NzM5NDI2YmYtZDQ1MC00ZDUwLTk2NjAtMDZkMGIzZmQ3OWFmOGI5NjlhMGEtNjczMS00M2IxLThkMTktYmM1YzVmNDNhNGM2","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9Ot9ccojXdHfrVNnJxrFmn_txVYbhI1VtfFaa_DX1isAFHvOtzzU0-KTzPyfxI3Bv0qXwLDfoCy-rPpEH3-o41pzXmjLEYeJ29zOD-aKsjtb0w51FpiqN4C-ZxgFy1mci1bsWGHHlIf9gzORgvtYP7OoN0MMdEWda8CDsnfN2_XKN8CPMwnc8vJZSTNVl250Qtd5mZU-SiR9JlBZ66pbvonRkaixtK6oXEDmk_DFg91kzF6_KvWXpRSYYtk9e2LQu3Ol5dxlA_IGjZMT-zMO6qeqFK-Ddo7DMeg3LFGIcKwCvvH-6yWsKRqYJsu8U9MoWA","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-22 11:25:52.055 +03:00 [DBG] Client is configured to not require consent, no consent is required
2019-08-22 11:25:52.069 +03:00 [DBG] Creating Hybrid Flow response.
2019-08-22 11:25:52.127 +03:00 [DBG] Creating Implicit Flow response.
2019-08-22 11:25:52.147 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-22 11:25:52.158 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-22 11:25:52.290 +03:00 [DBG] Authorize endpoint response
{"SubjectId":"1","ClientId":"mvc","RedirectUri":"http://localhost:5002/home/signin-oidc","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9Ot9ccojXdHfrVNnJxrFmn_txVYbhI1VtfFaa_DX1isAFHvOtzzU0-KTzPyfxI3Bv0qXwLDfoCy-rPpEH3-o41pzXmjLEYeJ29zOD-aKsjtb0w51FpiqN4C-ZxgFy1mci1bsWGHHlIf9gzORgvtYP7OoN0MMdEWda8CDsnfN2_XKN8CPMwnc8vJZSTNVl250Qtd5mZU-SiR9JlBZ66pbvonRkaixtK6oXEDmk_DFg91kzF6_KvWXpRSYYtk9e2LQu3Ol5dxlA_IGjZMT-zMO6qeqFK-Ddo7DMeg3LFGIcKwCvvH-6yWsKRqYJsu8U9MoWA","Scope":"openid profile afcpayroll afcpayroll2 identityprovider offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-08-22 11:25:52.342 +03:00 [DBG] Augmenting SignInContext
2019-08-22 11:25:52.344 +03:00 [INF] AuthenticationScheme: ivantage signed in.
2019-08-22 11:25:53.820 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-22 11:25:53.842 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-22 11:25:53.847 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-22 11:25:53.881 +03:00 [DBG] Start token request.
2019-08-22 11:25:53.903 +03:00 [DBG] Start client validation
2019-08-22 11:25:53.915 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-22 11:25:53.928 +03:00 [DBG] Start parsing for secret in post body
2019-08-22 11:25:53.931 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-22 11:25:53.936 +03:00 [DBG] Secret id found: mvc
2019-08-22 11:25:53.937 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-22 11:25:53.978 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-22 11:25:53.979 +03:00 [DBG] Client validation success
2019-08-22 11:25:54.000 +03:00 [DBG] Start token request validation
2019-08-22 11:25:54.030 +03:00 [DBG] Start validation of authorization code token request
2019-08-22 11:25:54.069 +03:00 [DBG] Validation of authorization code token request success
2019-08-22 11:25:54.081 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"b635aed2612466ccbb580dd99179f7c670962e47ce31eccd865dc5f1105c98f6","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"mvc","client_secret":"***REDACTED***","code":"b635aed2612466ccbb580dd99179f7c670962e47ce31eccd865dc5f1105c98f6","grant_type":"authorization_code","redirect_uri":"http://localhost:5002/home/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-08-22 11:25:54.131 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-22 11:25:54.158 +03:00 [DBG] Getting claims for access token for client: mvc
2019-08-22 11:25:54.159 +03:00 [DBG] Getting claims for access token for subject: 1
2019-08-22 11:25:54.187 +03:00 [DBG] Creating refresh token
2019-08-22 11:25:54.188 +03:00 [DBG] Setting an absolute lifetime: 2592000
2019-08-22 11:25:54.222 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-22 11:25:54.227 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-22 11:25:54.241 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-22 11:25:54.264 +03:00 [DBG] Token request success.
2019-08-22 11:25:54.297 +03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-08-22 11:25:54.309 +03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-08-22 11:25:54.318 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-08-22 11:25:54.349 +03:00 [DBG] Start userinfo request
2019-08-22 11:25:54.360 +03:00 [DBG] Bearer token found in header
2019-08-22 11:25:54.504 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-22 11:25:54.521 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-22 11:25:54.530 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-08-22 11:25:54.547 +03:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1566462354,"exp":1566462414,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","afcpayroll","afcpayroll2","identityprovider"],"client_id":"mvc","sub":"1","auth_time":1566462351,"idp":"local","name":"alice","email":"alice@email.com","scope":["openid","profile","test_identity","afcpayroll","afcpayroll2","identityprovider","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-08-22 11:25:54.593 +03:00 [DBG] Creating userinfo response
2019-08-22 11:25:54.602 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll afcpayroll2 identityprovider offline_access
2019-08-22 11:25:54.613 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll afcpayroll2 identityprovider offline_access
2019-08-22 11:25:54.627 +03:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-22 11:25:54.637 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll afcpayroll2 identityprovider offline_access
2019-08-22 11:25:54.655 +03:00 [INF] Profile service returned the following claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-22 11:25:54.670 +03:00 [DBG] End userinfo request
2019-08-22 11:27:33.067 +03:00 [INF] AuthenticationScheme: ivantage was challenged.
2019-08-22 11:27:35.998 +03:00 [DBG] CORS request made for path: /Account/Login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-08-22 11:27:36.006 +03:00 [DBG] Augmenting SignInContext
2019-08-22 11:27:36.016 +03:00 [DBG] Adding idp claim with value: local
2019-08-22 11:27:36.021 +03:00 [DBG] Adding amr claim with value: pwd
2019-08-22 11:27:36.035 +03:00 [INF] AuthenticationScheme: ivantage signed in.
2019-08-22 11:27:36.123 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-22 11:28:02.468 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-22 11:28:06.693 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-22 11:28:06.703 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-22 11:28:06.720 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-22 11:28:06.735 +03:00 [DBG] Start discovery request
2019-08-22 11:28:06.756 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-22 11:28:06.765 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-22 11:28:06.775 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-22 11:28:06.784 +03:00 [DBG] Start key discovery request
2019-08-22 11:28:06.816 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-22 11:28:06.824 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-22 11:28:06.839 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-22 11:28:06.853 +03:00 [DBG] Start token request.
2019-08-22 11:28:06.861 +03:00 [DBG] Start client validation
2019-08-22 11:28:06.868 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-22 11:28:06.876 +03:00 [DBG] Start parsing for secret in post body
2019-08-22 11:28:06.881 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-22 11:28:06.888 +03:00 [DBG] Secret id found: mvc
2019-08-22 11:28:06.897 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-22 11:28:06.901 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-22 11:28:06.903 +03:00 [DBG] Client validation success
2019-08-22 11:28:06.905 +03:00 [DBG] Start token request validation
2019-08-22 11:28:06.920 +03:00 [DBG] Start validation of refresh token request
2019-08-22 11:28:06.950 +03:00 [DBG] Token validation success
{"ClientId":"mvc","ClientName":"MVC Client","ValidateLifetime":false,"AccessTokenType":null,"ExpectedScope":null,"TokenHandle":null,"JwtId":null,"Claims":{"sub":"1","client_id":"mvc","scope":["openid","profile","test_identity","afcpayroll","afcpayroll2","identityprovider","offline_access"],"auth_time":1566462351,"idp":"local","amr":"pwd","name":"alice","email":"alice@email.com"},"$type":"TokenValidationLog"}
2019-08-22 11:28:06.967 +03:00 [DBG] Validation of refresh token request success
2019-08-22 11:28:06.970 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"refresh_token","Scopes":null,"AuthorizationCode":null,"RefreshToken":"57a0ad4fc3fd220d88e17a553d7e746d9cbcc7b66dac868840da50310a979f87","UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"refresh_token","refresh_token":"***REDACTED***","client_id":"mvc","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2019-08-22 11:28:07.029 +03:00 [DBG] Updating refresh token
2019-08-22 11:28:07.034 +03:00 [DBG] No updates to refresh token done
2019-08-22 11:28:07.055 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-22 11:28:07.057 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-22 11:28:07.076 +03:00 [DBG] Token request success.
2019-08-22 11:28:26.083 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-22 11:29:33.023 +03:00 [INF] Starting IdentityServer4 version 2.5.0.0
2019-08-22 11:29:33.123 +03:00 [INF] Using the default authentication scheme Bearer for IdentityServer
2019-08-22 11:29:33.125 +03:00 [INF] Authentication scheme Bearer is configured for IdentityServer, but it is not a scheme that supports signin (like cookies). If you support interactive logins via the browser, then a cookie-based scheme should be used.
2019-08-22 11:29:33.125 +03:00 [DBG] Using Bearer as default ASP.NET Core scheme for authentication
2019-08-22 11:29:33.125 +03:00 [DBG] Using Bearer as default ASP.NET Core scheme for sign-in
2019-08-22 11:29:33.126 +03:00 [DBG] Using Bearer as default ASP.NET Core scheme for sign-out
2019-08-22 11:29:33.126 +03:00 [DBG] Using Bearer as default ASP.NET Core scheme for challenge
2019-08-22 11:29:33.127 +03:00 [DBG] Using Bearer as default ASP.NET Core scheme for forbid
2019-08-22 11:29:51.299 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-22 11:29:51.314 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-22 11:29:51.317 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-22 11:29:51.323 +03:00 [DBG] Start discovery request
2019-08-22 11:29:51.457 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-22 11:29:51.459 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-22 11:29:51.459 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-22 11:29:51.468 +03:00 [DBG] Start key discovery request
2019-08-22 11:29:51.549 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-22 11:29:51.566 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-22 11:29:51.566 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-22 11:29:51.582 +03:00 [DBG] Start token request.
2019-08-22 11:29:51.594 +03:00 [DBG] Start client validation
2019-08-22 11:29:51.606 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-22 11:29:51.613 +03:00 [DBG] Start parsing for secret in post body
2019-08-22 11:29:51.658 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-22 11:29:51.659 +03:00 [DBG] Secret id found: mvc
2019-08-22 11:29:51.702 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-22 11:29:51.725 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-22 11:29:51.725 +03:00 [DBG] Client validation success
2019-08-22 11:29:51.754 +03:00 [DBG] Start token request validation
2019-08-22 11:29:51.770 +03:00 [DBG] Start validation of refresh token request
2019-08-22 11:29:51.792 +03:00 [DBG] refresh_token grant with value: 57a0ad4fc3fd220d88e17a553d7e746d9cbcc7b66dac868840da50310a979f87 not found in store.
2019-08-22 11:29:51.798 +03:00 [WRN] Invalid refresh token
2019-08-22 11:29:51.853 +03:00 [WRN] Refresh token validation failed. aborting, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"refresh_token","Scopes":null,"AuthorizationCode":null,"RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"refresh_token","refresh_token":"***REDACTED***","client_id":"mvc","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2019-08-22 11:29:57.126 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-22 11:29:57.136 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-22 11:29:57.157 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-22 11:29:57.169 +03:00 [DBG] Start discovery request
2019-08-22 11:29:57.232 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-22 11:29:57.237 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-22 11:29:57.250 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-22 11:29:57.267 +03:00 [DBG] Start key discovery request
2019-08-22 11:29:57.373 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-08-22 11:29:57.386 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-08-22 11:29:57.399 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-08-22 11:29:57.423 +03:00 [DBG] Start authorize request
2019-08-22 11:29:57.447 +03:00 [DBG] No user present in authorize request
2019-08-22 11:29:57.456 +03:00 [DBG] Start authorize request protocol validation
2019-08-22 11:29:57.469 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-22 11:29:57.499 +03:00 [DBG] Checking for PKCE parameters
2019-08-22 11:29:57.503 +03:00 [DBG] No PKCE used.
2019-08-22 11:29:57.601 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-22 11:29:57.624 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/home/signin-oidc","AllowedRedirectUris":["http://localhost:57002/home/signin-oidc","http://localhost:5002/home/signin-oidc"],"SubjectId":"anonymous","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll afcpayroll2 identityprovider","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9MAWPZob3Hhnf0-H0GO0hmVwD4ymsH5fXkA8rT0BBvwzxm0hMqFIlIYgIBFdZW64fu6n9lkt4FHX8abb4TdaPqoFjBkbYng6AHU-xIt3eSu5UW0DKRv6Wr_Cv8KNXWgKSZiTc90EGY-KMi3ETfNRUbUAIHr0CGnhc3vRmUiihZ6REUQjQZupKnirZF-7TvSt1rtFdq8WgUB-kvokk9fvaeqmYcOVzXHnGKPyD7FH5TixhkM5VfI_t6p438Fhxh2aUGHeYnRafz5DV9jX35C__A_ELpLEHeYa6qAVV3v1Wd7TpQfB0NSjgHaoQoTVEAdIMg","UiLocales":null,"Nonce":"637020593973189586.OWU3Mjc2YjMtZTY3My00MjNkLTg5MmUtMTc1MGRiMGE0ZTg3ZTYyM2I1YzctNzFhZS00MjFkLTk0ODQtNmZiZWRmNDZmOTI4","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/home/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll afcpayroll2 identityprovider","response_mode":"form_post","nonce":"637020593973189586.OWU3Mjc2YjMtZTY3My00MjNkLTg5MmUtMTc1MGRiMGE0ZTg3ZTYyM2I1YzctNzFhZS00MjFkLTk0ODQtNmZiZWRmNDZmOTI4","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9MAWPZob3Hhnf0-H0GO0hmVwD4ymsH5fXkA8rT0BBvwzxm0hMqFIlIYgIBFdZW64fu6n9lkt4FHX8abb4TdaPqoFjBkbYng6AHU-xIt3eSu5UW0DKRv6Wr_Cv8KNXWgKSZiTc90EGY-KMi3ETfNRUbUAIHr0CGnhc3vRmUiihZ6REUQjQZupKnirZF-7TvSt1rtFdq8WgUB-kvokk9fvaeqmYcOVzXHnGKPyD7FH5TixhkM5VfI_t6p438Fhxh2aUGHeYnRafz5DV9jX35C__A_ELpLEHeYa6qAVV3v1Wd7TpQfB0NSjgHaoQoTVEAdIMg","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-22 11:29:57.701 +03:00 [INF] Showing login: User is not authenticated
2019-08-22 11:29:57.831 +03:00 [DBG] Start authorize request protocol validation
2019-08-22 11:29:57.832 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-22 11:29:57.846 +03:00 [DBG] Checking for PKCE parameters
2019-08-22 11:29:57.852 +03:00 [DBG] No PKCE used.
2019-08-22 11:29:57.861 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-22 11:29:57.886 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-22 11:30:05.038 +03:00 [DBG] CORS request made for path: /account/login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-08-22 11:30:05.106 +03:00 [DBG] Start authorize request protocol validation
2019-08-22 11:30:05.107 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-22 11:30:05.117 +03:00 [DBG] Checking for PKCE parameters
2019-08-22 11:30:05.121 +03:00 [DBG] No PKCE used.
2019-08-22 11:30:05.131 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-22 11:30:05.178 +03:00 [DBG] Augmenting SignInContext
2019-08-22 11:30:05.187 +03:00 [DBG] Adding idp claim with value: local
2019-08-22 11:30:05.188 +03:00 [DBG] Adding amr claim with value: pwd
2019-08-22 11:30:05.225 +03:00 [ERR] An unhandled exception has occurred while executing the request.
System.InvalidOperationException: The authentication handler registered for scheme 'Bearer' is 'JwtBearerHandler' which cannot be used for SignInAsync. The registered sign-in schemes are: idsrv, idsrv.external.
   at Microsoft.AspNetCore.Authentication.AuthenticationService.SignInAsync(HttpContext context, String scheme, ClaimsPrincipal principal, AuthenticationProperties properties)
   at IdentityServer4.Hosting.IdentityServerAuthenticationService.SignInAsync(HttpContext context, String scheme, ClaimsPrincipal principal, AuthenticationProperties properties) in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\src\Hosting\IdentityServerAuthenticationService.cs:line 82
   at Microsoft.AspNetCore.Http.AuthenticationManagerExtensions.SignInAsync(HttpContext context, IdentityServerUser user, AuthenticationProperties properties) in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\src\Extensions\HttpContextAuthenticationExtensions.cs:line 279
   at Microsoft.AspNetCore.Http.AuthenticationManagerExtensions.SignInAsync(HttpContext context, String subject, String name, AuthenticationProperties properties, Claim[] claims) in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\src\Extensions\HttpContextAuthenticationExtensions.cs:line 105
   at IdentityServer.AccountController.Login(LoginInputModel model, String button) in E:\GIT\Identity\src\IdentityServer\Quickstart\Account\AccountController.cs:line 137
   at Microsoft.AspNetCore.Mvc.Internal.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at System.Threading.Tasks.ValueTask`1.get_Result()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.InvokeActionMethodAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.InvokeNextActionFilterAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.Rethrow(ActionExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.InvokeInnerFilterAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeNextResourceFilter()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Rethrow(ResourceExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeFilterPipelineAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeAsync()
   at Microsoft.AspNetCore.Builder.RouterMiddleware.Invoke(HttpContext httpContext)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events) in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\src\Hosting\IdentityServerMiddleware.cs:line 72
   at IdentityServer4.Hosting.MutualTlsTokenEndpointMiddleware.Invoke(HttpContext context, IAuthenticationSchemeProvider schemes) in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\src\Hosting\MtlsTokenEndpointMiddleware.cs:line 60
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Cors.Infrastructure.CorsMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context) in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\src\Hosting\BaseUrlMiddleware.cs:line 36
   at Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext context)
2019-08-22 11:35:01.666 +03:00 [INF] Starting IdentityServer4 version 2.5.0.0
2019-08-22 11:35:01.950 +03:00 [INF] Using the default authentication scheme ivantage.idsrv for IdentityServer
2019-08-22 11:35:02.080 +03:00 [DBG] Using ivantage.idsrv as default ASP.NET Core scheme for authentication
2019-08-22 11:35:02.131 +03:00 [DBG] Using Bearer as default ASP.NET Core scheme for sign-in
2019-08-22 11:35:02.152 +03:00 [DBG] Using Bearer as default ASP.NET Core scheme for sign-out
2019-08-22 11:35:02.170 +03:00 [DBG] Using ivantage.idsrv as default ASP.NET Core scheme for challenge
2019-08-22 11:35:02.181 +03:00 [DBG] Using ivantage.idsrv as default ASP.NET Core scheme for forbid
2019-08-22 11:35:13.344 +03:00 [DBG] Login Url: /account/login
2019-08-22 11:35:13.352 +03:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-08-22 11:35:13.354 +03:00 [DBG] Logout Url: /Account/Logout
2019-08-22 11:35:13.364 +03:00 [DBG] ConsentUrl Url: /consent
2019-08-22 11:35:13.365 +03:00 [DBG] Consent Return Url Parameter: returnUrl
2019-08-22 11:35:13.366 +03:00 [DBG] Error Url: /home/error
2019-08-22 11:35:13.366 +03:00 [DBG] Error Id Parameter: errorId
2019-08-22 11:35:13.484 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-22 11:35:13.497 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-22 11:35:13.498 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-22 11:35:13.510 +03:00 [DBG] Start discovery request
2019-08-22 11:35:14.198 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-22 11:35:14.221 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-22 11:35:14.235 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-22 11:35:14.261 +03:00 [DBG] Start key discovery request
2019-08-22 11:35:14.441 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-08-22 11:35:14.464 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-08-22 11:35:14.465 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-08-22 11:35:14.480 +03:00 [DBG] Start authorize request
2019-08-22 11:35:14.510 +03:00 [DBG] No user present in authorize request
2019-08-22 11:35:14.525 +03:00 [DBG] Start authorize request protocol validation
2019-08-22 11:35:14.581 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-22 11:35:14.616 +03:00 [DBG] Checking for PKCE parameters
2019-08-22 11:35:14.627 +03:00 [DBG] No PKCE used.
2019-08-22 11:35:14.716 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-22 11:35:14.762 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/home/signin-oidc","AllowedRedirectUris":["http://localhost:57002/home/signin-oidc","http://localhost:5002/home/signin-oidc"],"SubjectId":"anonymous","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll afcpayroll2 identityprovider","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9NAdvLLe482IY2Aj_Q0Vec1O49h2JB4n3pJb2E5h4eDYqU0sLLjHxfqCxyPxMM6JA1Rt3XkOj2XUmRJ9HWwsmphr4rkam6SNz3Vgu1TZk5-k4TaZp7UAXiYz5pJKvEafwNVynagEun-gDGw0hzUArDCp7KuJJ0xFv9OHyZuG2S9P5tVH9oJ8mqGv75LWzwRSPhkt0R5fnvBdjeSRdCfOiQEDSSuG4ii-1Z2UGeoP2_uOQbaEl4wAjwN_1Tc-a9r4v_0EEl7Bw3TohB4XdSYzNKAJl3MrRBUtJBRvtNhfv-s97FYeu9yWQCw5zqVtWVwNtU","UiLocales":null,"Nonce":"637020597143342381.YzgyNTljZjgtMzQ2Yi00YmIwLTgxZjctYzI2ZGU3ZmU4ZTA5M2VmMjlkNGYtMTNmMS00ZmQyLWE1OTQtNjBmZTYyOTA5ZGY1","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/home/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll afcpayroll2 identityprovider","response_mode":"form_post","nonce":"637020597143342381.YzgyNTljZjgtMzQ2Yi00YmIwLTgxZjctYzI2ZGU3ZmU4ZTA5M2VmMjlkNGYtMTNmMS00ZmQyLWE1OTQtNjBmZTYyOTA5ZGY1","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9NAdvLLe482IY2Aj_Q0Vec1O49h2JB4n3pJb2E5h4eDYqU0sLLjHxfqCxyPxMM6JA1Rt3XkOj2XUmRJ9HWwsmphr4rkam6SNz3Vgu1TZk5-k4TaZp7UAXiYz5pJKvEafwNVynagEun-gDGw0hzUArDCp7KuJJ0xFv9OHyZuG2S9P5tVH9oJ8mqGv75LWzwRSPhkt0R5fnvBdjeSRdCfOiQEDSSuG4ii-1Z2UGeoP2_uOQbaEl4wAjwN_1Tc-a9r4v_0EEl7Bw3TohB4XdSYzNKAJl3MrRBUtJBRvtNhfv-s97FYeu9yWQCw5zqVtWVwNtU","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-22 11:35:14.871 +03:00 [INF] Showing login: User is not authenticated
2019-08-22 11:35:15.254 +03:00 [DBG] Start authorize request protocol validation
2019-08-22 11:35:15.255 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-22 11:35:15.270 +03:00 [DBG] Checking for PKCE parameters
2019-08-22 11:35:15.282 +03:00 [DBG] No PKCE used.
2019-08-22 11:35:15.295 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-22 11:35:15.329 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-22 11:35:25.251 +03:00 [DBG] CORS request made for path: /account/login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-08-22 11:35:25.368 +03:00 [DBG] Start authorize request protocol validation
2019-08-22 11:35:25.369 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-22 11:35:25.387 +03:00 [DBG] Checking for PKCE parameters
2019-08-22 11:35:25.394 +03:00 [DBG] No PKCE used.
2019-08-22 11:35:25.397 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-22 11:35:25.474 +03:00 [DBG] Augmenting SignInContext
2019-08-22 11:35:25.480 +03:00 [DBG] Adding idp claim with value: local
2019-08-22 11:35:25.481 +03:00 [DBG] Adding amr claim with value: pwd
2019-08-22 11:35:25.513 +03:00 [INF] AuthenticationScheme: ivantage.idsrv signed in.
2019-08-22 11:35:25.524 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-22 11:35:25.553 +03:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-08-22 11:35:25.560 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-08-22 11:35:25.575 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-08-22 11:35:25.597 +03:00 [DBG] Start authorize callback request
2019-08-22 11:35:25.615 +03:00 [DBG] User in authorize request: 1
2019-08-22 11:35:25.616 +03:00 [DBG] Start authorize request protocol validation
2019-08-22 11:35:25.618 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-22 11:35:25.634 +03:00 [DBG] Checking for PKCE parameters
2019-08-22 11:35:25.644 +03:00 [DBG] No PKCE used.
2019-08-22 11:35:25.651 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-08-22 11:35:25.669 +03:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/home/signin-oidc","AllowedRedirectUris":["http://localhost:57002/home/signin-oidc","http://localhost:5002/home/signin-oidc"],"SubjectId":"1","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access afcpayroll afcpayroll2 identityprovider","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9NAdvLLe482IY2Aj_Q0Vec1O49h2JB4n3pJb2E5h4eDYqU0sLLjHxfqCxyPxMM6JA1Rt3XkOj2XUmRJ9HWwsmphr4rkam6SNz3Vgu1TZk5-k4TaZp7UAXiYz5pJKvEafwNVynagEun-gDGw0hzUArDCp7KuJJ0xFv9OHyZuG2S9P5tVH9oJ8mqGv75LWzwRSPhkt0R5fnvBdjeSRdCfOiQEDSSuG4ii-1Z2UGeoP2_uOQbaEl4wAjwN_1Tc-a9r4v_0EEl7Bw3TohB4XdSYzNKAJl3MrRBUtJBRvtNhfv-s97FYeu9yWQCw5zqVtWVwNtU","UiLocales":null,"Nonce":"637020597143342381.YzgyNTljZjgtMzQ2Yi00YmIwLTgxZjctYzI2ZGU3ZmU4ZTA5M2VmMjlkNGYtMTNmMS00ZmQyLWE1OTQtNjBmZTYyOTA5ZGY1","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"16d1371b44d12ac29881013169aad341","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/home/signin-oidc","response_type":"code id_token","scope":"openid profile offline_access afcpayroll afcpayroll2 identityprovider","response_mode":"form_post","nonce":"637020597143342381.YzgyNTljZjgtMzQ2Yi00YmIwLTgxZjctYzI2ZGU3ZmU4ZTA5M2VmMjlkNGYtMTNmMS00ZmQyLWE1OTQtNjBmZTYyOTA5ZGY1","state":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9NAdvLLe482IY2Aj_Q0Vec1O49h2JB4n3pJb2E5h4eDYqU0sLLjHxfqCxyPxMM6JA1Rt3XkOj2XUmRJ9HWwsmphr4rkam6SNz3Vgu1TZk5-k4TaZp7UAXiYz5pJKvEafwNVynagEun-gDGw0hzUArDCp7KuJJ0xFv9OHyZuG2S9P5tVH9oJ8mqGv75LWzwRSPhkt0R5fnvBdjeSRdCfOiQEDSSuG4ii-1Z2UGeoP2_uOQbaEl4wAjwN_1Tc-a9r4v_0EEl7Bw3TohB4XdSYzNKAJl3MrRBUtJBRvtNhfv-s97FYeu9yWQCw5zqVtWVwNtU","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-08-22 11:35:25.774 +03:00 [DBG] Client is configured to not require consent, no consent is required
2019-08-22 11:35:25.793 +03:00 [DBG] Creating Hybrid Flow response.
2019-08-22 11:35:25.851 +03:00 [DBG] Creating Implicit Flow response.
2019-08-22 11:35:25.908 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-22 11:35:25.916 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-22 11:35:26.070 +03:00 [DBG] Authorize endpoint response
{"SubjectId":"1","ClientId":"mvc","RedirectUri":"http://localhost:5002/home/signin-oidc","State":"CfDJ8HEKaOl0dAVJkRGq7Dtlk9NAdvLLe482IY2Aj_Q0Vec1O49h2JB4n3pJb2E5h4eDYqU0sLLjHxfqCxyPxMM6JA1Rt3XkOj2XUmRJ9HWwsmphr4rkam6SNz3Vgu1TZk5-k4TaZp7UAXiYz5pJKvEafwNVynagEun-gDGw0hzUArDCp7KuJJ0xFv9OHyZuG2S9P5tVH9oJ8mqGv75LWzwRSPhkt0R5fnvBdjeSRdCfOiQEDSSuG4ii-1Z2UGeoP2_uOQbaEl4wAjwN_1Tc-a9r4v_0EEl7Bw3TohB4XdSYzNKAJl3MrRBUtJBRvtNhfv-s97FYeu9yWQCw5zqVtWVwNtU","Scope":"openid profile afcpayroll afcpayroll2 identityprovider offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-08-22 11:35:26.146 +03:00 [DBG] Augmenting SignInContext
2019-08-22 11:35:26.147 +03:00 [INF] AuthenticationScheme: ivantage.idsrv signed in.
2019-08-22 11:35:28.240 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-22 11:35:28.253 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-22 11:35:28.264 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-22 11:35:28.295 +03:00 [DBG] Start token request.
2019-08-22 11:35:28.311 +03:00 [DBG] Start client validation
2019-08-22 11:35:28.325 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-22 11:35:28.336 +03:00 [DBG] Start parsing for secret in post body
2019-08-22 11:35:28.341 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-22 11:35:28.342 +03:00 [DBG] Secret id found: mvc
2019-08-22 11:35:28.344 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-22 11:35:28.377 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-22 11:35:28.378 +03:00 [DBG] Client validation success
2019-08-22 11:35:28.396 +03:00 [DBG] Start token request validation
2019-08-22 11:35:28.437 +03:00 [DBG] Start validation of authorization code token request
2019-08-22 11:35:28.487 +03:00 [DBG] Validation of authorization code token request success
2019-08-22 11:35:28.497 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"883f29ea24a61d591008e703ae27fd58488f4dc5809b3706fc6f8cc26e417cc6","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"mvc","client_secret":"***REDACTED***","code":"883f29ea24a61d591008e703ae27fd58488f4dc5809b3706fc6f8cc26e417cc6","grant_type":"authorization_code","redirect_uri":"http://localhost:5002/home/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-08-22 11:35:28.555 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-22 11:35:28.585 +03:00 [DBG] Getting claims for access token for client: mvc
2019-08-22 11:35:28.586 +03:00 [DBG] Getting claims for access token for subject: 1
2019-08-22 11:35:28.614 +03:00 [DBG] Creating refresh token
2019-08-22 11:35:28.614 +03:00 [DBG] Setting an absolute lifetime: 2592000
2019-08-22 11:35:28.694 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-22 11:35:28.702 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-22 11:35:28.717 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-22 11:35:28.744 +03:00 [DBG] Token request success.
2019-08-22 11:35:28.770 +03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-08-22 11:35:28.779 +03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-08-22 11:35:28.797 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-08-22 11:35:28.852 +03:00 [DBG] Start userinfo request
2019-08-22 11:35:28.876 +03:00 [DBG] Bearer token found in header
2019-08-22 11:35:29.130 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-22 11:35:29.147 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-22 11:35:29.166 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-08-22 11:35:29.201 +03:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1566462928,"exp":1566462988,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","afcpayroll","afcpayroll2","identityprovider"],"client_id":"mvc","sub":"1","auth_time":1566462925,"idp":"local","name":"alice","email":"alice@email.com","scope":["openid","profile","test_identity","afcpayroll","afcpayroll2","identityprovider","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-08-22 11:35:29.250 +03:00 [DBG] Creating userinfo response
2019-08-22 11:35:29.272 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll afcpayroll2 identityprovider offline_access
2019-08-22 11:35:29.284 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll afcpayroll2 identityprovider offline_access
2019-08-22 11:35:29.333 +03:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-22 11:35:29.345 +03:00 [DBG] Scopes in access token: openid profile test_identity afcpayroll afcpayroll2 identityprovider offline_access
2019-08-22 11:35:29.369 +03:00 [INF] Profile service returned the following claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at phone sex
2019-08-22 11:35:29.384 +03:00 [DBG] End userinfo request
2019-08-22 11:35:46.636 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-23 09:26:19.067 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-23 09:26:19.103 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-23 09:26:19.108 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-23 09:26:19.111 +03:00 [DBG] Start discovery request
2019-08-23 09:26:19.157 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-23 09:26:19.159 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-23 09:26:19.160 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-23 09:26:19.165 +03:00 [DBG] Start key discovery request
2019-08-23 09:26:19.230 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-23 09:26:19.236 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-23 09:26:19.237 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-23 09:26:19.241 +03:00 [DBG] Start token request.
2019-08-23 09:26:19.242 +03:00 [DBG] Start client validation
2019-08-23 09:26:19.245 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-23 09:26:19.246 +03:00 [DBG] Start parsing for secret in post body
2019-08-23 09:26:19.250 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-23 09:26:19.251 +03:00 [DBG] Secret id found: mvc
2019-08-23 09:26:19.255 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-23 09:26:19.258 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-23 09:26:19.259 +03:00 [DBG] Client validation success
2019-08-23 09:26:19.261 +03:00 [DBG] Start token request validation
2019-08-23 09:26:19.293 +03:00 [DBG] Start validation of refresh token request
2019-08-23 09:26:19.332 +03:00 [DBG] Token validation success
{"ClientId":"mvc","ClientName":"MVC Client","ValidateLifetime":false,"AccessTokenType":null,"ExpectedScope":null,"TokenHandle":null,"JwtId":null,"Claims":{"sub":"1","client_id":"mvc","scope":["openid","profile","test_identity","afcpayroll","afcpayroll2","identityprovider","offline_access"],"auth_time":1566462925,"idp":"local","amr":"pwd","name":"alice","email":"alice@email.com"},"$type":"TokenValidationLog"}
2019-08-23 09:26:19.346 +03:00 [DBG] Validation of refresh token request success
2019-08-23 09:26:19.347 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"refresh_token","Scopes":null,"AuthorizationCode":null,"RefreshToken":"193c9e871f6f696fb3940a72632a9587c9fa4f602ba15ee98117a15488d90b24","UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"refresh_token","refresh_token":"***REDACTED***","client_id":"mvc","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2019-08-23 09:26:19.398 +03:00 [DBG] Updating refresh token
2019-08-23 09:26:19.401 +03:00 [DBG] No updates to refresh token done
2019-08-23 09:26:19.412 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-23 09:26:19.414 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-23 09:26:19.420 +03:00 [DBG] Token request success.
2019-08-23 09:27:04.372 +03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: https://jwt.io
2019-08-23 09:27:04.389 +03:00 [DBG] AllowedOrigins configured and origin https://jwt.io is not allowed
2019-08-23 09:27:04.390 +03:00 [DBG] Exiting; origin https://jwt.io is not allowed
2019-08-23 09:27:04.392 +03:00 [WRN] CorsPolicyService did not allow origin: https://jwt.io
2019-08-23 09:27:04.392 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-23 09:27:04.394 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-23 09:27:04.395 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-23 09:27:04.397 +03:00 [DBG] Start discovery request
2019-08-23 09:33:11.542 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-23 09:33:11.548 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-23 09:33:11.559 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-23 09:33:11.573 +03:00 [DBG] Start discovery request
2019-08-23 09:33:11.586 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-23 09:33:11.595 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-23 09:33:11.609 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-23 09:33:11.625 +03:00 [DBG] Start key discovery request
2019-08-23 09:33:11.643 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-23 09:33:11.645 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-23 09:33:11.661 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-23 09:33:11.695 +03:00 [DBG] Start token request.
2019-08-23 09:33:11.704 +03:00 [DBG] Start client validation
2019-08-23 09:33:11.708 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-23 09:33:11.734 +03:00 [DBG] Start parsing for secret in post body
2019-08-23 09:33:11.741 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-23 09:33:11.755 +03:00 [DBG] Secret id found: mvc
2019-08-23 09:33:11.758 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-23 09:33:11.771 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-23 09:33:11.776 +03:00 [DBG] Client validation success
2019-08-23 09:33:11.777 +03:00 [DBG] Start token request validation
2019-08-23 09:33:11.785 +03:00 [DBG] Start validation of refresh token request
2019-08-23 09:33:11.792 +03:00 [DBG] Token validation success
{"ClientId":"mvc","ClientName":"MVC Client","ValidateLifetime":false,"AccessTokenType":null,"ExpectedScope":null,"TokenHandle":null,"JwtId":null,"Claims":{"sub":"1","client_id":"mvc","scope":["openid","profile","test_identity","afcpayroll","afcpayroll2","identityprovider","offline_access"],"auth_time":1566462925,"idp":"local","amr":"pwd","name":"alice","email":"alice@email.com"},"$type":"TokenValidationLog"}
2019-08-23 09:33:11.818 +03:00 [DBG] Validation of refresh token request success
2019-08-23 09:33:11.820 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"refresh_token","Scopes":null,"AuthorizationCode":null,"RefreshToken":"193c9e871f6f696fb3940a72632a9587c9fa4f602ba15ee98117a15488d90b24","UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"refresh_token","refresh_token":"***REDACTED***","client_id":"mvc","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2019-08-23 09:33:11.848 +03:00 [DBG] Updating refresh token
2019-08-23 09:33:11.849 +03:00 [DBG] No updates to refresh token done
2019-08-23 09:33:11.854 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-23 09:33:11.866 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-23 09:33:11.877 +03:00 [DBG] Token request success.
2019-08-23 09:33:15.954 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-23 09:33:15.962 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-23 09:33:15.974 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-23 09:33:15.989 +03:00 [DBG] Start discovery request
2019-08-23 09:33:16.007 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-23 09:33:16.015 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-23 09:33:16.029 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-23 09:33:16.040 +03:00 [DBG] Start key discovery request
2019-08-23 09:33:16.052 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-23 09:33:16.061 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-23 09:33:16.074 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-23 09:33:16.076 +03:00 [DBG] Start token request.
2019-08-23 09:33:16.082 +03:00 [DBG] Start client validation
2019-08-23 09:33:16.090 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-23 09:33:16.096 +03:00 [DBG] Start parsing for secret in post body
2019-08-23 09:33:16.103 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-23 09:33:16.110 +03:00 [DBG] Secret id found: mvc
2019-08-23 09:33:16.115 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-23 09:33:16.126 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-23 09:33:16.132 +03:00 [DBG] Client validation success
2019-08-23 09:33:16.142 +03:00 [DBG] Start token request validation
2019-08-23 09:33:16.142 +03:00 [DBG] Start validation of refresh token request
2019-08-23 09:33:16.151 +03:00 [DBG] Token validation success
{"ClientId":"mvc","ClientName":"MVC Client","ValidateLifetime":false,"AccessTokenType":null,"ExpectedScope":null,"TokenHandle":null,"JwtId":null,"Claims":{"sub":"1","client_id":"mvc","scope":["openid","profile","test_identity","afcpayroll","afcpayroll2","identityprovider","offline_access"],"auth_time":1566462925,"idp":"local","amr":"pwd","name":"alice","email":"alice@email.com"},"$type":"TokenValidationLog"}
2019-08-23 09:33:16.171 +03:00 [DBG] Validation of refresh token request success
2019-08-23 09:33:16.182 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"refresh_token","Scopes":null,"AuthorizationCode":null,"RefreshToken":"193c9e871f6f696fb3940a72632a9587c9fa4f602ba15ee98117a15488d90b24","UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"refresh_token","refresh_token":"***REDACTED***","client_id":"mvc","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2019-08-23 09:33:16.203 +03:00 [DBG] Updating refresh token
2019-08-23 09:33:16.206 +03:00 [DBG] No updates to refresh token done
2019-08-23 09:33:16.216 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-23 09:33:16.228 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-23 09:33:16.243 +03:00 [DBG] Token request success.
2019-08-23 09:33:17.615 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-23 09:33:17.622 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-23 09:33:17.633 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-23 09:33:17.646 +03:00 [DBG] Start discovery request
2019-08-23 09:33:18.006 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-23 09:33:18.010 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-23 09:33:18.023 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-23 09:33:18.038 +03:00 [DBG] Start key discovery request
2019-08-23 09:34:31.635 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-23 09:34:31.643 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-23 09:34:31.655 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-23 09:34:31.681 +03:00 [DBG] Start discovery request
2019-08-23 09:34:43.913 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-23 09:34:43.918 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-23 09:34:43.930 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-23 09:34:43.950 +03:00 [DBG] Start key discovery request
2019-08-23 09:35:17.450 +03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: https://jwt.io
2019-08-23 09:35:17.457 +03:00 [DBG] AllowedOrigins configured and origin https://jwt.io is not allowed
2019-08-23 09:35:17.469 +03:00 [DBG] Exiting; origin https://jwt.io is not allowed
2019-08-23 09:35:17.485 +03:00 [WRN] CorsPolicyService did not allow origin: https://jwt.io
2019-08-23 09:35:17.490 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-23 09:35:17.507 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-23 09:35:17.525 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-23 09:35:17.534 +03:00 [DBG] Start discovery request
2019-08-23 10:18:42.834 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-23 10:18:42.834 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-23 10:18:42.850 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-23 10:18:42.854 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-23 10:18:42.862 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-23 10:18:42.875 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-23 10:18:42.891 +03:00 [DBG] Start discovery request
2019-08-23 10:18:42.899 +03:00 [DBG] Start discovery request
2019-08-23 10:18:42.951 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-23 10:18:42.951 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-23 10:18:42.955 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-23 10:18:42.971 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-23 10:18:42.986 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-23 10:18:42.998 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-23 10:18:43.015 +03:00 [DBG] Start key discovery request
2019-08-23 10:18:43.026 +03:00 [DBG] Start key discovery request
2019-08-23 10:18:43.078 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-23 10:18:43.079 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-23 10:18:43.085 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-23 10:18:43.100 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-23 10:18:43.111 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-23 10:18:43.120 +03:00 [DBG] Start token request.
2019-08-23 10:18:43.132 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-23 10:18:43.137 +03:00 [DBG] Start client validation
2019-08-23 10:18:43.149 +03:00 [DBG] Start token request.
2019-08-23 10:18:43.154 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-23 10:18:43.162 +03:00 [DBG] Start client validation
2019-08-23 10:18:43.169 +03:00 [DBG] Start parsing for secret in post body
2019-08-23 10:18:43.176 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-23 10:18:43.182 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-23 10:18:43.182 +03:00 [DBG] Start parsing for secret in post body
2019-08-23 10:18:43.189 +03:00 [DBG] Secret id found: mvc
2019-08-23 10:18:43.196 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-23 10:18:43.203 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-23 10:18:43.210 +03:00 [DBG] Secret id found: mvc
2019-08-23 10:18:43.223 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-23 10:18:43.229 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-23 10:18:43.234 +03:00 [DBG] Client validation success
2019-08-23 10:18:43.243 +03:00 [DBG] Start token request validation
2019-08-23 10:18:43.254 +03:00 [DBG] Start validation of refresh token request
2019-08-23 10:18:43.264 +03:00 [DBG] Token validation success
{"ClientId":"mvc","ClientName":"MVC Client","ValidateLifetime":false,"AccessTokenType":null,"ExpectedScope":null,"TokenHandle":null,"JwtId":null,"Claims":{"sub":"1","client_id":"mvc","scope":["openid","profile","test_identity","afcpayroll","afcpayroll2","identityprovider","offline_access"],"auth_time":1566462925,"idp":"local","amr":"pwd","name":"alice","email":"alice@email.com"},"$type":"TokenValidationLog"}
2019-08-23 10:18:43.276 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-23 10:18:43.300 +03:00 [DBG] Validation of refresh token request success
2019-08-23 10:18:43.307 +03:00 [DBG] Client validation success
2019-08-23 10:18:43.316 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"refresh_token","Scopes":null,"AuthorizationCode":null,"RefreshToken":"193c9e871f6f696fb3940a72632a9587c9fa4f602ba15ee98117a15488d90b24","UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"refresh_token","refresh_token":"***REDACTED***","client_id":"mvc","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2019-08-23 10:18:43.323 +03:00 [DBG] Start token request validation
2019-08-23 10:18:43.330 +03:00 [DBG] Start validation of refresh token request
2019-08-23 10:18:43.359 +03:00 [DBG] Token validation success
{"ClientId":"mvc","ClientName":"MVC Client","ValidateLifetime":false,"AccessTokenType":null,"ExpectedScope":null,"TokenHandle":null,"JwtId":null,"Claims":{"sub":"1","client_id":"mvc","scope":["openid","profile","test_identity","afcpayroll","afcpayroll2","identityprovider","offline_access"],"auth_time":1566462925,"idp":"local","amr":"pwd","name":"alice","email":"alice@email.com"},"$type":"TokenValidationLog"}
2019-08-23 10:18:43.362 +03:00 [DBG] Updating refresh token
2019-08-23 10:18:43.372 +03:00 [DBG] Validation of refresh token request success
2019-08-23 10:18:43.378 +03:00 [DBG] No updates to refresh token done
2019-08-23 10:18:43.388 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"refresh_token","Scopes":null,"AuthorizationCode":null,"RefreshToken":"193c9e871f6f696fb3940a72632a9587c9fa4f602ba15ee98117a15488d90b24","UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"refresh_token","refresh_token":"***REDACTED***","client_id":"mvc","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2019-08-23 10:18:43.421 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-23 10:18:43.423 +03:00 [DBG] Updating refresh token
2019-08-23 10:18:43.429 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-23 10:18:43.436 +03:00 [DBG] No updates to refresh token done
2019-08-23 10:18:43.450 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-23 10:18:43.453 +03:00 [DBG] Token request success.
2019-08-23 10:18:43.456 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-23 10:18:43.477 +03:00 [DBG] Token request success.
2019-08-23 10:18:46.991 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-23 10:18:47.001 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-23 10:18:47.016 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-23 10:18:47.028 +03:00 [DBG] Start discovery request
2019-08-23 10:18:47.034 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-23 10:18:47.040 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-23 10:18:47.058 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-23 10:18:47.070 +03:00 [DBG] Start key discovery request
2019-08-23 10:18:47.080 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-23 10:18:47.096 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-23 10:18:47.109 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-23 10:18:47.128 +03:00 [DBG] Start token request.
2019-08-23 10:18:47.141 +03:00 [DBG] Start client validation
2019-08-23 10:18:47.146 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-23 10:18:47.154 +03:00 [DBG] Start parsing for secret in post body
2019-08-23 10:18:47.160 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-23 10:18:47.172 +03:00 [DBG] Secret id found: mvc
2019-08-23 10:18:47.178 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-23 10:18:47.193 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-23 10:18:47.205 +03:00 [DBG] Client validation success
2019-08-23 10:18:47.209 +03:00 [DBG] Start token request validation
2019-08-23 10:18:47.220 +03:00 [DBG] Start validation of refresh token request
2019-08-23 10:18:47.226 +03:00 [DBG] Token validation success
{"ClientId":"mvc","ClientName":"MVC Client","ValidateLifetime":false,"AccessTokenType":null,"ExpectedScope":null,"TokenHandle":null,"JwtId":null,"Claims":{"sub":"1","client_id":"mvc","scope":["openid","profile","test_identity","afcpayroll","afcpayroll2","identityprovider","offline_access"],"auth_time":1566462925,"idp":"local","amr":"pwd","name":"alice","email":"alice@email.com"},"$type":"TokenValidationLog"}
2019-08-23 10:18:47.251 +03:00 [DBG] Validation of refresh token request success
2019-08-23 10:18:47.252 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"refresh_token","Scopes":null,"AuthorizationCode":null,"RefreshToken":"193c9e871f6f696fb3940a72632a9587c9fa4f602ba15ee98117a15488d90b24","UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"refresh_token","refresh_token":"***REDACTED***","client_id":"mvc","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2019-08-23 10:18:47.283 +03:00 [DBG] Updating refresh token
2019-08-23 10:18:47.284 +03:00 [DBG] No updates to refresh token done
2019-08-23 10:18:47.288 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-23 10:18:47.302 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-23 10:18:47.319 +03:00 [DBG] Token request success.
2019-08-23 10:19:14.282 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-23 10:19:14.286 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-23 10:19:14.288 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-23 10:19:14.289 +03:00 [DBG] Start discovery request
2019-08-23 10:19:14.440 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-23 10:19:14.442 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-23 10:19:14.443 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-23 10:19:14.445 +03:00 [DBG] Start key discovery request
2019-08-23 10:29:37.012 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-23 10:29:37.014 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-23 10:29:37.015 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-23 10:29:37.016 +03:00 [DBG] Start discovery request
2019-08-23 10:29:37.152 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-23 10:29:37.153 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-23 10:29:37.154 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-23 10:29:37.158 +03:00 [DBG] Start key discovery request
2019-08-23 10:44:17.524 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-23 10:44:17.526 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-23 10:44:17.527 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-23 10:44:17.528 +03:00 [DBG] Start discovery request
2019-08-23 10:44:17.683 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-23 10:44:17.685 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-23 10:44:17.686 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-23 10:44:17.688 +03:00 [DBG] Start key discovery request
2019-08-23 10:45:32.727 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-23 10:45:32.730 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-23 10:45:32.732 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-23 10:45:32.734 +03:00 [DBG] Start discovery request
2019-08-23 10:45:32.943 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-23 10:45:32.948 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-23 10:45:32.952 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-23 10:45:32.955 +03:00 [DBG] Start key discovery request
2019-08-23 10:45:54.128 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-23 10:45:54.133 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-23 10:45:54.135 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-23 10:45:54.136 +03:00 [DBG] Start discovery request
2019-08-23 10:45:54.139 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-23 10:45:54.140 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-23 10:45:54.142 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-23 10:45:54.143 +03:00 [DBG] Start key discovery request
2019-08-23 10:45:54.146 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-23 10:45:54.147 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-23 10:45:54.147 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-23 10:45:54.154 +03:00 [DBG] Start token request.
2019-08-23 10:45:54.155 +03:00 [DBG] Start client validation
2019-08-23 10:45:54.156 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-23 10:45:54.158 +03:00 [DBG] Start parsing for secret in post body
2019-08-23 10:45:54.162 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-23 10:45:54.163 +03:00 [DBG] Secret id found: mvc
2019-08-23 10:45:54.165 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-23 10:45:54.166 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-23 10:45:54.166 +03:00 [DBG] Client validation success
2019-08-23 10:45:54.167 +03:00 [DBG] Start token request validation
2019-08-23 10:45:54.168 +03:00 [DBG] Start validation of refresh token request
2019-08-23 10:45:54.169 +03:00 [DBG] Token validation success
{"ClientId":"mvc","ClientName":"MVC Client","ValidateLifetime":false,"AccessTokenType":null,"ExpectedScope":null,"TokenHandle":null,"JwtId":null,"Claims":{"sub":"1","client_id":"mvc","scope":["openid","profile","test_identity","afcpayroll","afcpayroll2","identityprovider","offline_access"],"auth_time":1566462925,"idp":"local","amr":"pwd","name":"alice","email":"alice@email.com"},"$type":"TokenValidationLog"}
2019-08-23 10:45:54.175 +03:00 [DBG] Validation of refresh token request success
2019-08-23 10:45:54.176 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"refresh_token","Scopes":null,"AuthorizationCode":null,"RefreshToken":"193c9e871f6f696fb3940a72632a9587c9fa4f602ba15ee98117a15488d90b24","UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"refresh_token","refresh_token":"***REDACTED***","client_id":"mvc","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2019-08-23 10:45:54.187 +03:00 [DBG] Updating refresh token
2019-08-23 10:45:54.188 +03:00 [DBG] No updates to refresh token done
2019-08-23 10:45:54.196 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-23 10:45:54.199 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-23 10:45:54.205 +03:00 [DBG] Token request success.
2019-08-23 10:46:23.262 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-23 10:46:23.264 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-23 10:46:23.265 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-23 10:46:23.266 +03:00 [DBG] Start discovery request
2019-08-23 10:46:23.409 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-23 10:46:23.412 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-23 10:46:23.416 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-23 10:46:23.418 +03:00 [DBG] Start key discovery request
2019-08-23 11:32:34.203 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-23 11:32:34.218 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-23 11:32:34.250 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-23 11:32:34.276 +03:00 [DBG] Start discovery request
2019-08-23 11:32:34.299 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-23 11:32:34.307 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-23 11:32:34.327 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-23 11:32:34.346 +03:00 [DBG] Start key discovery request
2019-08-23 11:32:34.384 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-23 11:32:34.392 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-23 11:32:34.400 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-23 11:32:34.421 +03:00 [DBG] Start token request.
2019-08-23 11:32:34.429 +03:00 [DBG] Start client validation
2019-08-23 11:32:34.444 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-23 11:32:34.445 +03:00 [DBG] Start parsing for secret in post body
2019-08-23 11:32:34.460 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-23 11:32:34.465 +03:00 [DBG] Secret id found: mvc
2019-08-23 11:32:34.474 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-23 11:32:34.494 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-23 11:32:34.503 +03:00 [DBG] Client validation success
2019-08-23 11:32:34.511 +03:00 [DBG] Start token request validation
2019-08-23 11:32:34.534 +03:00 [DBG] Start validation of refresh token request
2019-08-23 11:32:34.547 +03:00 [DBG] Token validation success
{"ClientId":"mvc","ClientName":"MVC Client","ValidateLifetime":false,"AccessTokenType":null,"ExpectedScope":null,"TokenHandle":null,"JwtId":null,"Claims":{"sub":"1","client_id":"mvc","scope":["openid","profile","test_identity","afcpayroll","afcpayroll2","identityprovider","offline_access"],"auth_time":1566462925,"idp":"local","amr":"pwd","name":"alice","email":"alice@email.com"},"$type":"TokenValidationLog"}
2019-08-23 11:32:34.578 +03:00 [DBG] Validation of refresh token request success
2019-08-23 11:32:34.580 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"refresh_token","Scopes":null,"AuthorizationCode":null,"RefreshToken":"193c9e871f6f696fb3940a72632a9587c9fa4f602ba15ee98117a15488d90b24","UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"refresh_token","refresh_token":"***REDACTED***","client_id":"mvc","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2019-08-23 11:32:34.622 +03:00 [DBG] Updating refresh token
2019-08-23 11:32:34.623 +03:00 [DBG] No updates to refresh token done
2019-08-23 11:32:34.632 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-23 11:32:34.646 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-23 11:32:34.663 +03:00 [DBG] Token request success.
2019-08-23 11:32:40.318 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-23 11:32:40.328 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-23 11:32:40.340 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-23 11:32:40.374 +03:00 [DBG] Start discovery request
2019-08-23 11:32:40.401 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-23 11:32:40.440 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-23 11:32:40.456 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-23 11:32:40.481 +03:00 [DBG] Start key discovery request
2019-08-23 11:32:40.495 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-23 11:32:40.539 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-23 11:32:40.551 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-23 11:32:40.578 +03:00 [DBG] Start token request.
2019-08-23 11:32:40.587 +03:00 [DBG] Start client validation
2019-08-23 11:32:40.596 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-23 11:32:40.609 +03:00 [DBG] Start parsing for secret in post body
2019-08-23 11:32:40.617 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-23 11:32:40.634 +03:00 [DBG] Secret id found: mvc
2019-08-23 11:32:40.651 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-23 11:32:40.661 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-23 11:32:40.669 +03:00 [DBG] Client validation success
2019-08-23 11:32:40.675 +03:00 [DBG] Start token request validation
2019-08-23 11:32:40.689 +03:00 [DBG] Start validation of refresh token request
2019-08-23 11:32:40.695 +03:00 [DBG] Token validation success
{"ClientId":"mvc","ClientName":"MVC Client","ValidateLifetime":false,"AccessTokenType":null,"ExpectedScope":null,"TokenHandle":null,"JwtId":null,"Claims":{"sub":"1","client_id":"mvc","scope":["openid","profile","test_identity","afcpayroll","afcpayroll2","identityprovider","offline_access"],"auth_time":1566462925,"idp":"local","amr":"pwd","name":"alice","email":"alice@email.com"},"$type":"TokenValidationLog"}
2019-08-23 11:32:40.729 +03:00 [DBG] Validation of refresh token request success
2019-08-23 11:32:40.730 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"refresh_token","Scopes":null,"AuthorizationCode":null,"RefreshToken":"193c9e871f6f696fb3940a72632a9587c9fa4f602ba15ee98117a15488d90b24","UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"refresh_token","refresh_token":"***REDACTED***","client_id":"mvc","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2019-08-23 11:32:40.767 +03:00 [DBG] Updating refresh token
2019-08-23 11:32:40.768 +03:00 [DBG] No updates to refresh token done
2019-08-23 11:32:40.781 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-23 11:32:40.792 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-23 11:32:40.817 +03:00 [DBG] Token request success.
2019-08-23 11:47:22.562 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-23 11:47:22.611 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-23 11:47:22.712 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-23 11:47:22.731 +03:00 [DBG] Start discovery request
2019-08-23 11:47:22.745 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-23 11:47:22.875 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-23 11:47:22.909 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-23 11:47:22.984 +03:00 [DBG] Start key discovery request
2019-08-23 11:47:23.013 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-23 11:47:23.047 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-23 11:47:23.187 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-23 11:47:23.302 +03:00 [DBG] Start token request.
2019-08-23 11:47:23.330 +03:00 [DBG] Start client validation
2019-08-23 11:47:23.358 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-23 11:47:23.392 +03:00 [DBG] Start parsing for secret in post body
2019-08-23 11:47:23.404 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-23 11:47:23.430 +03:00 [DBG] Secret id found: mvc
2019-08-23 11:47:23.441 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-23 11:47:23.508 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-23 11:47:23.514 +03:00 [DBG] Client validation success
2019-08-23 11:47:23.610 +03:00 [DBG] Start token request validation
2019-08-23 11:47:23.707 +03:00 [DBG] Start validation of refresh token request
2019-08-23 11:47:23.770 +03:00 [DBG] Token validation success
{"ClientId":"mvc","ClientName":"MVC Client","ValidateLifetime":false,"AccessTokenType":null,"ExpectedScope":null,"TokenHandle":null,"JwtId":null,"Claims":{"sub":"1","client_id":"mvc","scope":["openid","profile","test_identity","afcpayroll","afcpayroll2","identityprovider","offline_access"],"auth_time":1566462925,"idp":"local","amr":"pwd","name":"alice","email":"alice@email.com"},"$type":"TokenValidationLog"}
2019-08-23 11:47:23.848 +03:00 [DBG] Validation of refresh token request success
2019-08-23 11:47:23.863 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"refresh_token","Scopes":null,"AuthorizationCode":null,"RefreshToken":"193c9e871f6f696fb3940a72632a9587c9fa4f602ba15ee98117a15488d90b24","UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"refresh_token","refresh_token":"***REDACTED***","client_id":"mvc","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2019-08-23 11:47:24.128 +03:00 [DBG] Updating refresh token
2019-08-23 11:47:24.129 +03:00 [DBG] No updates to refresh token done
2019-08-23 11:47:24.130 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-23 11:47:24.131 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-23 11:47:24.137 +03:00 [DBG] Token request success.
2019-08-23 14:28:58.172 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-08-23 14:28:58.178 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-08-23 14:28:58.179 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-08-23 14:28:58.184 +03:00 [DBG] Start discovery request
2019-08-23 14:28:58.196 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-08-23 14:28:58.197 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-08-23 14:28:58.198 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-08-23 14:28:58.199 +03:00 [DBG] Start key discovery request
2019-08-23 14:28:58.206 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-08-23 14:28:58.211 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-08-23 14:28:58.213 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-08-23 14:28:58.218 +03:00 [DBG] Start token request.
2019-08-23 14:28:58.219 +03:00 [DBG] Start client validation
2019-08-23 14:28:58.219 +03:00 [DBG] Start parsing Basic Authentication secret
2019-08-23 14:28:58.220 +03:00 [DBG] Start parsing for secret in post body
2019-08-23 14:28:58.223 +03:00 [DBG] Parser found secret: PostBodySecretParser
2019-08-23 14:28:58.225 +03:00 [DBG] Secret id found: mvc
2019-08-23 14:28:58.227 +03:00 [DBG] client configuration validation for client mvc succeeded.
2019-08-23 14:28:58.228 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-08-23 14:28:58.229 +03:00 [DBG] Client validation success
2019-08-23 14:28:58.230 +03:00 [DBG] Start token request validation
2019-08-23 14:28:58.231 +03:00 [DBG] Start validation of refresh token request
2019-08-23 14:28:58.235 +03:00 [DBG] Token validation success
{"ClientId":"mvc","ClientName":"MVC Client","ValidateLifetime":false,"AccessTokenType":null,"ExpectedScope":null,"TokenHandle":null,"JwtId":null,"Claims":{"sub":"1","client_id":"mvc","scope":["openid","profile","test_identity","afcpayroll","afcpayroll2","identityprovider","offline_access"],"auth_time":1566462925,"idp":"local","amr":"pwd","name":"alice","email":"alice@email.com"},"$type":"TokenValidationLog"}
2019-08-23 14:28:58.244 +03:00 [DBG] Validation of refresh token request success
2019-08-23 14:28:58.246 +03:00 [INF] Token request validation success, {"ClientId":"mvc","ClientName":"MVC Client","GrantType":"refresh_token","Scopes":null,"AuthorizationCode":null,"RefreshToken":"193c9e871f6f696fb3940a72632a9587c9fa4f602ba15ee98117a15488d90b24","UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"refresh_token","refresh_token":"***REDACTED***","client_id":"mvc","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2019-08-23 14:28:58.258 +03:00 [DBG] Updating refresh token
2019-08-23 14:28:58.260 +03:00 [DBG] No updates to refresh token done
2019-08-23 14:28:58.261 +03:00 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2019-08-23 14:28:58.262 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-08-23 14:28:58.268 +03:00 [DBG] Token request success.
